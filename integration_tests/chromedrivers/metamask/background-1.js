LavaPack.loadBundle([[1695,{"./bytes":1687,"./constants":1688,"./helpers":1690,buffer:3998,"ethereum-cryptography/keccak":4224,"ethereum-cryptography/secp256k1":4241},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toCompactSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;const n=e("ethereum-cryptography/keccak"),s=e("ethereum-cryptography/secp256k1"),i=e("./bytes"),a=e("./constants"),o=e("./helpers");function c(e,t){return e===BigInt(0)||e===BigInt(1)?e:t===undefined?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}function l(e){return e===BigInt(0)||e===BigInt(1)}r.ecsign=function(e,r,n){const i=s.secp256k1.sign(e,r),a=i.toCompactRawBytes();return{r:t.from(a.slice(0,32)),s:t.from(a.slice(32,64)),v:n===undefined?BigInt(i.recovery+27):BigInt(i.recovery+35)+BigInt(n)*BigInt(2)}};r.ecrecover=function(e,r,n,a,o){const u=t.concat([(0,i.setLengthLeft)(n,32),(0,i.setLengthLeft)(a,32)],64),d=c(r,o);if(!l(d))throw new Error("Invalid signature v value");const h=s.secp256k1.Signature.fromCompact(u).addRecoveryBit(Number(d)).recoverPublicKey(e);return t.from(h.toRawBytes(!1).slice(1))};r.toRpcSig=function(e,r,n,s){if(!l(c(e,s)))throw new Error("Invalid signature v value");return(0,i.bufferToHex)(t.concat([(0,i.setLengthLeft)(r,32),(0,i.setLengthLeft)(n,32),(0,i.toBuffer)(e)]))};r.toCompactSig=function(e,r,n,s){if(!l(c(e,s)))throw new Error("Invalid signature v value");let a=n;return(e>BigInt(28)&&e%BigInt(2)===BigInt(1)||e===BigInt(1)||e===BigInt(28))&&(a=t.from(n),a[0]|=128),(0,i.bufferToHex)(t.concat([(0,i.setLengthLeft)(r,32),(0,i.setLengthLeft)(a,32)]))};r.fromRpcSig=function(e){const t=(0,i.toBuffer)(e);let r,n,s;if(t.length>=65)r=t.slice(0,32),n=t.slice(32,64),s=(0,i.bufferToBigInt)(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");r=t.slice(0,32),n=t.slice(32,64),s=BigInt((0,i.bufferToInt)(t.slice(32,33))>>7),n[0]&=127}return s<27&&(s+=BigInt(27)),{v:s,r:r,s:n}};r.isValidSignature=function(e,t,r,n=!0,s){if(32!==t.length||32!==r.length)return!1;if(!l(c(e,s)))return!1;const o=(0,i.bufferToBigInt)(t),u=(0,i.bufferToBigInt)(r);return!(o===BigInt(0)||o>=a.SECP256K1_ORDER||u===BigInt(0)||u>=a.SECP256K1_ORDER)&&!(n&&u>=a.SECP256K1_ORDER_DIV_2)};r.hashPersonalMessage=function(e){(0,o.assertIsBuffer)(e);const r=t.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return t.from((0,n.keccak256)(t.concat([r,e])))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@ethereumjs/util/dist/signature.js"}],[1696,{"./bytes":1687,"./internal":1692},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toType=r.TypeOutput=void 0;const n=e("./bytes"),s=e("./internal");var i;!function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(i=r.TypeOutput||(r.TypeOutput={})),r.toType=function(e,t){if(null===e)return null;if(e===undefined)return undefined;if("string"==typeof e&&!(0,s.isHexString)(e))throw new Error(`A string must be provided with a 0x-prefix, given: ${e}`);if("number"==typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const r=(0,n.toBuffer)(e);switch(t){case i.Buffer:return r;case i.BigInt:return(0,n.bufferToBigInt)(r);case i.Number:{const e=(0,n.bufferToBigInt)(r);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case i.PrefixedHexString:return(0,n.bufferToHex)(r);default:throw new Error("unknown outputType")}}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@ethereumjs/util/dist/types.js"}],[1697,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.GWEI_TO_WEI=void 0,r.GWEI_TO_WEI=BigInt(1e9)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@ethereumjs/util/dist/units.js"}],[1698,{"./address":1685,"./bytes":1687,"./types":1696,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Withdrawal=void 0;const n=e("./address"),s=e("./bytes"),i=e("./types");class a{constructor(e,t,r,n){this.index=e,this.validatorIndex=t,this.address=r,this.amount=n}static fromWithdrawalData(e){const{index:t,validatorIndex:r,address:s,amount:o}=e,c=(0,i.toType)(t,i.TypeOutput.BigInt),l=(0,i.toType)(r,i.TypeOutput.BigInt),u=new n.Address((0,i.toType)(s,i.TypeOutput.Buffer)),d=(0,i.toType)(o,i.TypeOutput.BigInt);return new a(c,l,u,d)}static fromValuesArray(e){if(4!==e.length)throw Error(`Invalid withdrawalArray length expected=4 actual=${e.length}`);const[t,r,n,s]=e;return a.fromWithdrawalData({index:t,validatorIndex:r,address:n,amount:s})}static toBufferArray(e){const{index:r,validatorIndex:s,address:a,amount:o}=e,c=(0,i.toType)(r,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(r,i.TypeOutput.Buffer),l=(0,i.toType)(s,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(s,i.TypeOutput.Buffer);let u;u=a instanceof n.Address?a.buf:(0,i.toType)(a,i.TypeOutput.Buffer);return[c,l,u,(0,i.toType)(o,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(o,i.TypeOutput.Buffer)]}raw(){return a.toBufferArray(this)}toValue(){return{index:this.index,validatorIndex:this.validatorIndex,address:this.address.buf,amount:this.amount}}toJSON(){return{index:(0,s.bigIntToHex)(this.index),validatorIndex:(0,s.bigIntToHex)(this.validatorIndex),address:"0x"+this.address.buf.toString("hex"),amount:(0,s.bigIntToHex)(this.amount)}}}r.Withdrawal=a}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@ethereumjs/util/dist/withdrawal.js"}],[1699,{"./errors":1700,"./packer":1703,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeSingle=r.decode=r.encodePacked=r.encodeSingle=r.encode=void 0;const n=e("@metamask/utils"),s=e("./errors"),i=e("./packer");r.encode=(e,t,r,n)=>{try{return(0,i.pack)({types:e,values:t,packed:r,tight:n})}catch(e){if(e instanceof s.ParserError)throw new s.ParserError(`Unable to encode value: ${e.message}`,e);throw new s.ParserError(`An unexpected error occurred: ${(0,s.getErrorMessage)(e)}`,e)}};r.encodeSingle=(e,t)=>(0,r.encode)([e],[t]);r.encodePacked=(e,t,n)=>(0,r.encode)(e,t,!0,n);r.decode=(e,t)=>{const r=(0,n.createBytes)(t);try{return(0,i.unpack)(e,r)}catch(e){if(e instanceof s.ParserError)throw new s.ParserError(`Unable to decode value: ${e.message}`,e);throw new s.ParserError(`An unexpected error occurred: ${(0,s.getErrorMessage)(e)}`,e)}};r.decodeSingle=(e,t)=>{const i=(0,r.decode)([e],t);return(0,n.assert)(1===i.length,new s.ParserError("Decoded value array has unexpected length.")),i[0]}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/abi.js"}],[17,{"./multichain-assets-controller-messenger":18,"./multichain-assets-rates-controller-messenger":19,"./multichain-balances-controller-messenger":20,"./multichain-network-controller-messenger":21,"./multichain-transactions-controller-messenger":22},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getMultichainAssetsControllerMessenger",{enumerable:!0,get:function(){return n.getMultichainAssetsControllerMessenger}}),Object.defineProperty(r,"getMultichainAssetsRatesControllerMessenger",{enumerable:!0,get:function(){return s.getMultichainAssetsRatesControllerMessenger}}),Object.defineProperty(r,"getMultichainBalancesControllerMessenger",{enumerable:!0,get:function(){return i.getMultichainBalancesControllerMessenger}}),Object.defineProperty(r,"getMultichainNetworkControllerMessenger",{enumerable:!0,get:function(){return o.getMultichainNetworkControllerMessenger}}),Object.defineProperty(r,"getMultichainTransactionsControllerMessenger",{enumerable:!0,get:function(){return a.getMultichainTransactionsControllerMessenger}});var n=e("./multichain-assets-controller-messenger"),s=e("./multichain-assets-rates-controller-messenger"),i=e("./multichain-balances-controller-messenger"),a=e("./multichain-transactions-controller-messenger"),o=e("./multichain-network-controller-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/index.ts"}],[1700,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ParserError=r.getErrorStack=r.getErrorMessage=void 0;const n=e("@metamask/utils");r.getErrorMessage=e=>"string"==typeof e?e:e instanceof Error||(0,n.isObject)(e)&&(0,n.hasProperty)(e,"message")&&"string"==typeof e.message?e.message:"Unknown error.";r.getErrorStack=e=>e instanceof Error?e.stack:undefined;class s extends Error{constructor(e,t){super(e),this.name="ParserError";const n=(0,r.getErrorStack)(t);n&&(this.stack=n)}}r.ParserError=s}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/errors.js"}],[1701,{"./abi":1699,"./errors":1700,"./types":1716},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./abi"),r),s(e("./errors"),r),s(e("./types"),r)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/index.js"}],[1702,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.iterate=void 0;const n=e("@metamask/utils");r.iterate=function*(e,t=32){for(let r=0;r<e.length;r+=t){const s=e=>{(0,n.assert)(e>=0,"Cannot skip a negative number of bytes."),(0,n.assert)(e%t==0,"Length must be a multiple of the size."),r+=e},i=e.subarray(r);yield{skip:s,value:i}}return{skip:()=>undefined,value:new Uint8Array}}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/iterator.js"}],[1703,{"./errors":1700,"./iterator":1702,"./parsers":1710,"./utils":1718,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.unpack=r.pack=r.isDynamicParser=r.getParser=void 0;const n=e("@metamask/utils"),s=e("./errors"),i=e("./iterator"),a=e("./parsers"),o=e("./utils");r.getParser=e=>{const t={address:a.address,array:a.array,bool:a.bool,bytes:a.bytes,fixedBytes:a.fixedBytes,function:a.fn,number:a.number,string:a.string,tuple:a.tuple},r=t[e];if(r)return r;const n=Object.values(t).find((t=>t.isType(e)));if(n)return n;throw new s.ParserError(`The type "${e}" is not supported.`)};r.isDynamicParser=(e,t)=>{const{isDynamic:r}=e;return"function"==typeof r?r(t):r};r.pack=({types:e,values:t,packed:i=!1,tight:a=!1,arrayPacked:c=!1,byteArray:l=new Uint8Array})=>{(0,n.assert)(e.length===t.length,new s.ParserError(`The number of types (${e.length}) does not match the number of values (${t.length}).`));const{staticBuffer:u,dynamicBuffer:d,pointers:h}=e.reduce((({staticBuffer:e,dynamicBuffer:s,pointers:o},l,u)=>{const d=(0,r.getParser)(l),h=t[u];if(i||c||!(0,r.isDynamicParser)(d,l))return{staticBuffer:d.encode({buffer:e,value:h,type:l,packed:i,tight:a}),dynamicBuffer:s,pointers:o};return{staticBuffer:(0,n.concatBytes)([e,new Uint8Array(32)]),dynamicBuffer:d.encode({buffer:s,value:h,type:l,packed:i,tight:a}),pointers:[...o,{position:e.length,pointer:s.length}]}}),{staticBuffer:new Uint8Array,dynamicBuffer:new Uint8Array,pointers:[]});(0,n.assert)(!i&&!c||0===d.length,new s.ParserError("Invalid pack state."));const p=u.length,m=h.reduce(((e,{pointer:t,position:r})=>{const s=(0,o.padStart)((0,n.numberToBytes)(p+t));return(0,o.set)(e,s,r)}),u);return(0,n.concatBytes)([l,m,d])};r.unpack=(e,t)=>{const a=(0,i.iterate)(t);return e.map((e=>{const{value:{value:i,skip:o},done:c}=a.next();(0,n.assert)(!c,new s.ParserError(`The encoded value is invalid for the provided types. Reached end of buffer while attempting to parse "${e}".`));const l=(0,r.getParser)(e);if((0,r.isDynamicParser)(l,e)){const r=(0,n.bytesToNumber)(i.subarray(0,32)),s=t.subarray(r);return l.decode({type:e,value:s,skip:o})}return l.decode({type:e,value:i,skip:o})}))}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/packer.js"}],[1704,{"../errors":1700,"../utils":1718,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.address=r.getAddress=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../utils");r.getAddress=e=>{const t=(0,n.createBytes)(e);return(0,n.assert)(t.length<=20,new s.ParserError(`Invalid address value. Expected address to be 20 bytes long, but received ${t.length} bytes.`)),(0,i.padStart)(t,20)},r.address={isDynamic:!1,isType:e=>"address"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:s}){const a=(0,r.getAddress)(t);if(s)return(0,n.concatBytes)([e,a]);const o=(0,i.padStart)(a);return(0,n.concatBytes)([e,o])},decode:({value:e})=>(0,n.add0x)((0,n.bytesToHex)(e.slice(12,32)))}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/address.js"}],[1705,{"../errors":1700,"../packer":1703,"../utils":1718,"./fixed-bytes":1708,"./tuple":1714,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.array=r.getTupleType=r.getArrayType=r.isArrayType=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../packer"),a=e("../utils"),o=e("./fixed-bytes"),c=e("./tuple"),l=/^(?<type>.*)\[(?<length>\d*?)\]$/u;r.isArrayType=e=>l.test(e);r.getArrayType=e=>{const t=e.match(l);return(0,n.assert)(t?.groups?.type,new s.ParserError(`Invalid array type. Expected an array type, but received "${e}".`)),[t.groups.type,t.groups.length?parseInt(t.groups.length,10):undefined]};r.getTupleType=(e,t)=>`(${new Array(t).fill(e).join(",")})`,r.array={isDynamic(e){const[t,n]=(0,r.getArrayType)(e);return n===undefined||(0,i.isDynamicParser)((0,i.getParser)(t),t)},isType:e=>(0,r.isArrayType)(e),getByteLength(e){(0,n.assert)((0,r.isArrayType)(e),new s.ParserError(`Expected an array type, but received "${e}".`));const[t,a]=(0,r.getArrayType)(e);return(0,i.isDynamicParser)(this,e)||a===undefined?32:c.tuple.getByteLength((0,r.getTupleType)(t,a))},encode({type:e,buffer:t,value:l,packed:u,tight:d}){const[h,p]=(0,r.getArrayType)(e);if((0,n.assert)(!u||!(0,r.isArrayType)(h),new s.ParserError("Cannot pack nested arrays.")),u&&(0,i.isDynamicParser)((0,i.getParser)(h),h))return(0,i.pack)({types:new Array(l.length).fill(h),values:l,byteArray:t,packed:u,arrayPacked:!0,tight:d});if(p)return(0,n.assert)(p===l.length,new s.ParserError(`Array length does not match type length. Expected a length of ${p}, but received ${l.length}.`)),c.tuple.encode({type:(0,r.getTupleType)(h,p),buffer:t,value:l,packed:o.fixedBytes.isType(h)&&d,tight:d});if(u)return(0,i.pack)({types:new Array(l.length).fill(h),values:l,byteArray:t,packed:o.fixedBytes.isType(h)&&d,arrayPacked:!0,tight:d});const m=(0,a.padStart)((0,n.numberToBytes)(l.length));return(0,i.pack)({types:new Array(l.length).fill(h),values:l,byteArray:(0,n.concatBytes)([t,m]),packed:u,tight:d})},decode({type:e,value:t,...a}){const[o,l]=(0,r.getArrayType)(e);if(l){const e=c.tuple.decode({type:(0,r.getTupleType)(o,l),value:t,...a});return(0,n.assert)(e.length===l,new s.ParserError(`Array length does not match type length. Expected a length of ${l}, but received ${e.length}.`)),e}const u=(0,n.bytesToNumber)(t.subarray(0,32));return(0,i.unpack)(new Array(u).fill(o),t.subarray(32))}}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/array.js"}],[1706,{"../errors":1700,"./number":1711,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.bool=r.getBooleanValue=void 0;const n=e("@metamask/superstruct"),s=e("@metamask/utils"),i=e("../errors"),a=e("./number"),o=(0,n.coerce)((0,n.boolean)(),(0,n.union)([(0,n.literal)("true"),(0,n.literal)("false")]),(e=>"true"===e));r.getBooleanValue=e=>{try{return(0,n.create)(e,o)?BigInt(1):BigInt(0)}catch{throw new i.ParserError(`Invalid boolean value. Expected a boolean literal, or the string "true" or "false", but received "${e}".`)}},r.bool={isDynamic:!1,isType:e=>"bool"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:n,tight:i}){const o=(0,r.getBooleanValue)(t);return n?(0,s.concatBytes)([e,(0,s.bigIntToBytes)(o)]):a.number.encode({type:"uint256",buffer:e,value:o,packed:n,tight:i})},decode:e=>a.number.decode({...e,type:"uint256"})===BigInt(1)}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/bool.js"}],[1707,{"../utils":1718,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.bytes=void 0;const n=e("@metamask/utils"),s=e("../utils");r.bytes={isDynamic:!0,isType:e=>"bytes"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:r}){const i=(0,n.createBytes)(t);if(r)return(0,n.concatBytes)([e,i]);const a=32*Math.ceil(i.byteLength/32);return(0,n.concatBytes)([e,(0,s.padStart)((0,n.numberToBytes)(i.byteLength)),(0,s.padEnd)(i,a)])},decode({value:e}){const t=e.subarray(0,32),r=(0,n.bytesToNumber)(t);return e.slice(32,32+r)}}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/bytes.js"}],[1708,{"../errors":1700,"../utils":1718,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.fixedBytes=r.getByteLength=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../utils"),a=/^bytes([0-9]{1,2})$/u;r.getByteLength=e=>{const t=e.match(a)?.[1];(0,n.assert)(t,`Invalid byte length. Expected a number between 1 and 32, but received "${e}".`);const r=Number(t);return(0,n.assert)(r>0&&r<=32,new s.ParserError(`Invalid byte length. Expected a number between 1 and 32, but received "${e}".`)),r},r.fixedBytes={isDynamic:!1,isType:e=>a.test(e),getByteLength:()=>32,encode({type:e,buffer:t,value:a,packed:o}){const c=(0,r.getByteLength)(e),l=(0,n.createBytes)(a);return(0,n.assert)(l.length<=c,new s.ParserError(`Expected a value of length ${c}, but received a value of length ${l.length}.`)),o?(0,n.concatBytes)([t,(0,i.padEnd)(l,c)]):(0,n.concatBytes)([t,(0,i.padEnd)(l)])},decode({type:e,value:t}){const n=(0,r.getByteLength)(e);return t.slice(0,n)}}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/fixed-bytes.js"}],[1709,{"../errors":1700,"./fixed-bytes":1708,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.fn=r.getFunction=void 0;const n=e("@metamask/superstruct"),s=e("@metamask/utils"),i=e("../errors"),a=e("./fixed-bytes"),o=(0,n.coerce)((0,n.object)({address:s.StrictHexStruct,selector:s.StrictHexStruct}),(0,n.union)([s.StrictHexStruct,(0,n.instance)(Uint8Array)]),(e=>{const t=(0,s.createBytes)(e);return(0,s.assert)(24===t.length,new i.ParserError(`Invalid Solidity function. Expected function to be 24 bytes long, but received ${t.length} bytes.`)),{address:(0,s.bytesToHex)(t.subarray(0,20)),selector:(0,s.bytesToHex)(t.subarray(20,24))}}));r.getFunction=e=>{const t=(0,n.create)(e,o);return(0,s.concatBytes)([(0,s.hexToBytes)(t.address),(0,s.hexToBytes)(t.selector)])},r.fn={isDynamic:!1,isType:e=>"function"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:n,tight:s}){const i=(0,r.getFunction)(t);return a.fixedBytes.encode({type:"bytes24",buffer:e,value:i,packed:n,tight:s})},decode:({value:e})=>({address:(0,s.bytesToHex)(e.slice(0,20)),selector:(0,s.bytesToHex)(e.slice(20,24))})}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/function.js"}],[1710,{"./address":1704,"./array":1705,"./bool":1706,"./bytes":1707,"./fixed-bytes":1708,"./function":1709,"./number":1711,"./parser":1712,"./string":1713,"./tuple":1714},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./address"),r),s(e("./array"),r),s(e("./bool"),r),s(e("./bytes"),r),s(e("./fixed-bytes"),r),s(e("./function"),r),s(e("./number"),r),s(e("./parser"),r),s(e("./string"),r),s(e("./tuple"),r)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/index.js"}],[1711,{"../errors":1700,"../utils":1718,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.number=r.getBigInt=r.assertNumberLength=r.getLength=r.isSigned=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../utils"),a=/^u?int(?<length>[0-9]*)?$/u;r.isSigned=e=>!e.startsWith("u");r.getLength=e=>{if("int"===e||"uint"===e)return 256;const t=e.match(a);(0,n.assert)(t?.groups?.length,new s.ParserError(`Invalid number type. Expected a number type, but received "${e}".`));const r=parseInt(t.groups.length,10);return(0,n.assert)(r>=8&&r<=256,new s.ParserError(`Invalid number length. Expected a number between 8 and 256, but received "${e}".`)),(0,n.assert)(r%8==0,new s.ParserError(`Invalid number length. Expected a multiple of 8, but received "${e}".`)),r};r.assertNumberLength=(e,t)=>{const i=(0,r.getLength)(t),a=BigInt(2)**BigInt(i-((0,r.isSigned)(t)?1:0))-BigInt(1);(0,r.isSigned)(t)?(0,n.assert)(e>=-(a+BigInt(1))&&e<=a,new s.ParserError(`Number "${e}" is out of range for type "${t}".`)):(0,n.assert)(e<=a,new s.ParserError(`Number "${e}" is out of range for type "${t}".`))};r.getBigInt=e=>{try{return(0,n.createBigInt)(e)}catch{throw new s.ParserError(`Invalid number. Expected a valid number value, but received "${e}".`)}},r.number={isDynamic:!1,isType:e=>a.test(e),getByteLength:()=>32,encode({type:e,buffer:t,value:s,packed:a}){const o=(0,r.getBigInt)(s);if((0,r.assertNumberLength)(o,e),(0,r.isSigned)(e)){if(a){const s=(0,r.getLength)(e)/8;return(0,n.concatBytes)([t,(0,n.signedBigIntToBytes)(o,s)])}return(0,n.concatBytes)([t,(0,i.padStart)((0,n.signedBigIntToBytes)(o,32))])}if(a){const s=(0,r.getLength)(e)/8;return(0,n.concatBytes)([t,(0,i.padStart)((0,n.bigIntToBytes)(o),s)])}return(0,n.concatBytes)([t,(0,i.padStart)((0,n.bigIntToBytes)(o))])},decode({type:e,value:t}){const s=t.subarray(0,32);if((0,r.isSigned)(e)){const t=(0,n.bytesToSignedBigInt)(s);return(0,r.assertNumberLength)(t,e),t}const i=(0,n.bytesToBigInt)(s);return(0,r.assertNumberLength)(i,e),i}}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/number.js"}],[1712,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/parser.js"}],[1713,{"./bytes":1707,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.string=void 0;const n=e("@metamask/utils"),s=e("./bytes");r.string={isDynamic:!0,isType:e=>"string"===e,getByteLength:()=>32,encode:({buffer:e,value:t,packed:r,tight:i})=>s.bytes.encode({type:"bytes",buffer:e,value:(0,n.stringToBytes)(t),packed:r,tight:i}),decode:e=>(0,n.bytesToString)(s.bytes.decode(e))}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/string.js"}],[1714,{"../errors":1700,"../packer":1703,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.tuple=r.getTupleElements=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../packer"),a=/^\((.+)\)$/u;r.getTupleElements=e=>{(0,n.assert)(e.startsWith("(")&&e.endsWith(")"),new s.ParserError(`Invalid tuple type. Expected tuple type, but received "${e}".`));const t=[];let r="",i=0;for(let n=1;n<e.length-1;n++){const s=e[n];","===s&&0===i?(t.push(r.trim()),r=""):(r+=s,"("===s?i+=1:")"===s&&(i-=1))}return r.trim()&&t.push(r.trim()),t},r.tuple={isDynamic:e=>(0,r.getTupleElements)(e).some((e=>{const t=(0,i.getParser)(e);return(0,i.isDynamicParser)(t,e)})),isType:e=>(e=>a.test(e))(e),getByteLength(e){if((0,i.isDynamicParser)(this,e))return 32;return(0,r.getTupleElements)(e).reduce(((e,t)=>e+(0,i.getParser)(t).getByteLength(t)),0)},encode({type:e,buffer:t,value:n,packed:s,tight:a}){const o=(0,r.getTupleElements)(e);return(0,i.pack)({types:o,values:n,byteArray:t,packed:s,tight:a})},decode({type:e,value:t,skip:n}){const s=(0,r.getTupleElements)(e);return n(this.getByteLength(e)-32),(0,i.unpack)(s,t)}}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/parsers/tuple.js"}],[1715,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/types/abi.js"}],[1716,{"./abi":1715},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./abi"),r)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/types/index.js"}],[1717,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.padEnd=r.padStart=r.set=void 0;const n=e("@metamask/utils");r.set=(e,t,r)=>(0,n.concatBytes)([e.subarray(0,r),t,e.subarray(r+t.length)]);r.padStart=(e,t=32)=>{const r=new Uint8Array(Math.max(t-e.length,0)).fill(0);return(0,n.concatBytes)([r,e])};r.padEnd=(e,t=32)=>{const r=new Uint8Array(Math.max(t-e.length,0)).fill(0);return(0,n.concatBytes)([e,r])}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/utils/buffer.js"}],[1718,{"./buffer":1717},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./buffer"),r)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/abi-utils/dist/utils/index.js"}],[1719,{"./utils":1724,"@scure/base":2951,buffer:3998,tweetnacl:5540},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.getEncryptionPublicKey=r.decryptSafely=r.decrypt=r.encryptSafely=r.encrypt=void 0;const a=e("@scure/base"),o=i(e("tweetnacl")),c=e("./utils");function l({publicKey:e,data:t,version:r}){if((0,c.isNullish)(e))throw new Error("Missing publicKey parameter");if((0,c.isNullish)(t))throw new Error("Missing data parameter");if((0,c.isNullish)(r))throw new Error("Missing version parameter");if("x25519-xsalsa20-poly1305"===r){if("string"!=typeof t)throw new Error("Message data must be given as a string");const r=o.box.keyPair();let n;try{n=a.base64.decode(e)}catch(e){throw new Error("Bad public key")}const s=a.utf8.decode(t),i=o.randomBytes(o.box.nonceLength),c=o.box(s,i,n,r.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:a.base64.encode(i),ephemPublicKey:a.base64.encode(r.publicKey),ciphertext:a.base64.encode(c)}}throw new Error("Encryption type/version not supported")}function u({encryptedData:e,privateKey:r}){if((0,c.isNullish)(e))throw new Error("Missing encryptedData parameter");if((0,c.isNullish)(r))throw new Error("Missing privateKey parameter");if("x25519-xsalsa20-poly1305"===e.version){const n=t.from(r,"hex"),s=o.box.keyPair.fromSecretKey(n).secretKey,i=a.base64.decode(e.nonce),c=a.base64.decode(e.ciphertext),l=a.base64.decode(e.ephemPublicKey),u=o.box.open(c,i,l,s);try{if(!u)throw new Error;const e=a.utf8.encode(u);if(!e)throw new Error;return e}catch(e){if(e&&"string"==typeof e.message&&e.message.length)throw new Error(`Decryption failed: ${e.message}`);throw new Error("Decryption failed.")}}throw new Error("Encryption type/version not supported.")}r.encrypt=l,r.encryptSafely=function({publicKey:e,data:r,version:n}){if((0,c.isNullish)(e))throw new Error("Missing publicKey parameter");if((0,c.isNullish)(r))throw new Error("Missing data parameter");if((0,c.isNullish)(n))throw new Error("Missing version parameter");if("object"==typeof r&&r&&"toJSON"in r)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");const s={data:r,padding:""},i=t.byteLength(JSON.stringify(s),"utf-8")%2048;let a=0;return i>0&&(a=2048-i-16),s.padding="0".repeat(a),l({publicKey:e,data:JSON.stringify(s),version:n})},r.decrypt=u,r.decryptSafely=function({encryptedData:e,privateKey:t}){if((0,c.isNullish)(e))throw new Error("Missing encryptedData parameter");if((0,c.isNullish)(t))throw new Error("Missing privateKey parameter");return JSON.parse(u({encryptedData:e,privateKey:t})).data},r.getEncryptionPublicKey=function(e){const r=t.from(e,"hex"),n=o.box.keyPair.fromSecretKey(r).publicKey;return a.base64.encode(n)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/eth-sig-util/dist/encryption.js"}],[172,{"../../../../../shared/lib/four-byte":5687,"@ethersproject/abi":476,"@metamask/utils":2874,"ethereumjs-util":4251},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTransactionDataWithFourByte=async function(e){const t=e.slice(0,10),r=await(0,a.getMethodFrom4Byte)(t);if(!r)return undefined;const i=r.split("(")[0],d=function(e){let t=e.slice(e.indexOf("(")+1,-1);const r=[];for(;t.includes("(");){const e=u(t);if(!e)break;r.push(e.value),t=`${t.slice(0,e.start)}${r.length-1}#${t.slice(e.end+1)}`}return l(t,r)}(r);o("Generated inputs",d);const h=(0,n.addHexPrefix)(e.slice(10)),p=s.Interface.getAbiCoder().decode(d,h),m=d.map(((e,t)=>c(e,t,p)));return{name:i,params:m}};var n=e("ethereumjs-util"),s=e("@ethersproject/abi"),i=e("@metamask/utils"),a=e("../../../../../shared/lib/four-byte");const o=(0,i.createProjectLogger)("four-byte");function c(e,t,r){var n;const s=r[t],{type:i,name:a}=e;let o=null===(n=e.components)||void 0===n?void 0:n.map(((e,t)=>c(e,t,s)));if(i.endsWith("[]")){const t=i.slice(0,-2);o=s.map(((r,n)=>{const i=`Item ${n+1}`;return c({...e,name:i,type:t},n,s)}))}return{name:a,type:i,value:s,children:o}}function l(e,t){return e.split(",").map((e=>{const r=e.split("#"),n=r.length>1?parseInt(r[0],10):undefined;return{type:n===undefined?e:`tuple${r[1]??""}`,components:n===undefined?undefined:l(t[n],t)}}))}function u(e){let t=-1;for(let r=0;r<e.length;r++)if("("===e[r])t=r;else if(")"===e[r]&&-1!==t)return{start:t,end:r,value:e.slice(t+1,r)};return undefined}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/four-byte.ts"}],[1720,{"./encryption":1719,"./personal-sign":1721,"./sign-eip7702-authorization":1722,"./sign-typed-data":1723,"./utils":1724},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=r.concatSig=void 0,s(e("./personal-sign"),r),s(e("./sign-typed-data"),r),s(e("./encryption"),r),s(e("./sign-eip7702-authorization"),r);var i=e("./utils");Object.defineProperty(r,"concatSig",{enumerable:!0,get:function(){return i.concatSig}}),Object.defineProperty(r,"normalize",{enumerable:!0,get:function(){return i.normalize}})}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/eth-sig-util/dist/index.js"}],[1721,{"./utils":1724,"@ethereumjs/util":1691},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.extractPublicKey=r.recoverPersonalSignature=r.personalSign=void 0;const n=e("@ethereumjs/util"),s=e("./utils");function i(e,t){const r=(0,n.hashPersonalMessage)((0,s.legacyToBuffer)(e));return(0,s.recoverPublicKey)(r,t)}r.personalSign=function({privateKey:e,data:t}){if((0,s.isNullish)(t))throw new Error("Missing data parameter");if((0,s.isNullish)(e))throw new Error("Missing privateKey parameter");const r=(0,s.legacyToBuffer)(t),i=(0,n.hashPersonalMessage)(r),a=(0,n.ecsign)(i,e);return(0,s.concatSig)((0,n.toBuffer)(a.v),a.r,a.s)},r.recoverPersonalSignature=function({data:e,signature:t}){if((0,s.isNullish)(e))throw new Error("Missing data parameter");if((0,s.isNullish)(t))throw new Error("Missing signature parameter");const r=i(e,t),a=(0,n.publicToAddress)(r);return(0,n.bufferToHex)(a)},r.extractPublicKey=function({data:e,signature:t}){if((0,s.isNullish)(e))throw new Error("Missing data parameter");if((0,s.isNullish)(t))throw new Error("Missing signature parameter");return`0x${i(e,t).toString("hex")}`}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/eth-sig-util/dist/personal-sign.js"}],[1722,{"./utils":1724,"@ethereumjs/rlp":421,"@ethereumjs/util":1691,"@metamask/utils":2874,buffer:3998,"ethereum-cryptography/keccak":4224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashEIP7702Authorization=r.recoverEIP7702Authorization=r.signEIP7702Authorization=void 0;const n=e("@ethereumjs/rlp"),s=e("@ethereumjs/util"),i=e("@metamask/utils"),a=e("ethereum-cryptography/keccak"),o=e("./utils");function c(e){l(e);const r=(0,n.encode)(e),s=t.concat([t.from("05","hex"),r]);return t.from((0,a.keccak256)(s))}function l(e){if((0,o.isNullish)(e))throw new Error("Missing authorization parameter");const[t,r,n]=e;if((0,o.isNullish)(t))throw new Error("Missing chainId parameter");if((0,o.isNullish)(r))throw new Error("Missing contractAddress parameter");if((0,o.isNullish)(n))throw new Error("Missing nonce parameter")}r.signEIP7702Authorization=function({privateKey:e,authorization:t}){if(l(t),(0,o.isNullish)(e))throw new Error("Missing privateKey parameter");const r=c(t),{r:n,s:i,v:a}=(0,s.ecsign)(r,e),u=(0,s.toBuffer)(a);return(0,o.concatSig)(u,n,i)},r.recoverEIP7702Authorization=function({signature:e,authorization:t}){if(l(t),(0,o.isNullish)(e))throw new Error("Missing signature parameter");const r=c(t),n=(0,o.recoverPublicKey)(r,e),a=(0,s.publicToAddress)(n);return(0,i.bytesToHex)(a)},r.hashEIP7702Authorization=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/eth-sig-util/dist/sign-eip7702-authorization.js"}],[1723,{"./utils":1724,"@ethereumjs/util":1691,"@metamask/abi-utils":1701,"@metamask/abi-utils/dist/parsers":1710,"@metamask/abi-utils/dist/utils":1718,"@metamask/utils":2874,"ethereum-cryptography/keccak":4224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.recoverTypedSignature=r.signTypedData=r.typedSignatureHash=r.TypedDataUtils=r.TYPED_MESSAGE_SCHEMA=r.SignTypedDataVersion=void 0;const n=e("@ethereumjs/util"),s=e("@metamask/abi-utils"),i=e("@metamask/abi-utils/dist/parsers"),a=e("@metamask/abi-utils/dist/utils"),o=e("@metamask/utils"),c=e("ethereum-cryptography/keccak"),l=e("./utils");var u;function d(e,t){if(!Object.keys(u).includes(e))throw new Error(`Invalid version: '${e}'`);if(t&&!t.includes(e))throw new Error(`SignTypedDataVersion not allowed: '${e}'. Allowed versions are: ${t.join(", ")}`)}function h(e,t){(0,o.assert)(null!==t,`Unable to encode value: Invalid number. Expected a valid number value, but received "${t}".`);const r=BigInt(t),n=(0,i.getLength)(e),s=BigInt(2)**BigInt(n)-BigInt(1);return(0,o.assert)(r>=-s&&r<=s,`Unable to encode value: Number "${t}" is out of range for type "${e}".`),r}function p(e){let t=BigInt(0);for(let r=0;r<e.length;r++){const n=BigInt(e.charCodeAt(r)-48);t*=BigInt(10),t+=n>=49?n-BigInt(49)+BigInt(10):n>=17?n-BigInt(17)+BigInt(10):n}return(0,a.padStart)((0,o.bigIntToBytes)(t),20)}function m(e,t,r,i,l){if(d(l,[u.V3,u.V4]),e[r]!==undefined)return["bytes32",l===u.V4&&null==i?"0x0000000000000000000000000000000000000000000000000000000000000000":(0,n.arrToBufArr)((0,c.keccak256)(g(r,i,e,l)))];if("function"===r)throw new Error('Unsupported or invalid type: "function"');if(i===undefined)throw new Error(`missing value for field ${t} of type ${r}`);if("address"===r){if("number"==typeof i)return["address",(0,a.padStart)((0,o.numberToBytes)(i),20)];if((0,o.isStrictHexString)(i))return["address",(0,o.add0x)(i)];if("string"==typeof i)return["address",p(i).subarray(0,20)]}if("bool"===r)return["bool",Boolean(i)];if("bytes"===r)return"number"==typeof i?i=(0,o.numberToBytes)(i):(0,o.isStrictHexString)(i)||"0x"===i?i=(0,o.hexToBytes)(i):"string"==typeof i&&(i=(0,o.stringToBytes)(i)),["bytes32",(0,n.arrToBufArr)((0,c.keccak256)(i))];if(r.startsWith("bytes")&&"bytes"!==r&&!r.includes("["))return"number"==typeof i?i<0?["bytes32",new Uint8Array(32)]:["bytes32",(0,o.bigIntToBytes)(BigInt(i))]:(0,o.isStrictHexString)(i)?["bytes32",(0,o.hexToBytes)(i)]:["bytes32",i];if(r.startsWith("int")&&!r.includes("[")){const e=h(r,i);return e>=BigInt(0)?["uint256",e]:["int256",e]}if("string"===r)return i="number"==typeof i?(0,o.numberToBytes)(i):(0,o.stringToBytes)(null!=i?i:""),["bytes32",(0,n.arrToBufArr)((0,c.keccak256)(i))];if(r.endsWith("]")){if(l===u.V3)throw new Error("Arrays are unimplemented in encodeData; use V4 extension");const a=r.slice(0,r.lastIndexOf("[")),o=i.map((r=>m(e,t,a,r,l)));return["bytes32",(0,n.arrToBufArr)((0,c.keccak256)((0,s.encode)(o.map((([e])=>e)),o.map((([,e])=>e)))))]}return[r,i]}function g(e,t,r,i){d(i,[u.V3,u.V4]);const a=["bytes32"],o=[v(e,r)];for(const n of r[e]){if(i===u.V3&&t[n.name]===undefined)continue;const[e,s]=m(r,n.name,n.type,t[n.name],i);a.push(e),o.push(s)}return(0,n.arrToBufArr)((0,s.encode)(a,o))}function f(e,t){let r="";const n=y(e,t);n.delete(e);const s=[e,...Array.from(n).sort()];for(const e of s){if(!t[e])throw new Error(`No type definition specified: ${e}`);r+=`${e}(${t[e].map((({name:e,type:t})=>`${t} ${e}`)).join(",")})`}return r}function y(e,t,r=new Set){if("string"!=typeof e)throw new Error(`Invalid findTypeDependencies input ${JSON.stringify(e)}`);const n=e.match(/^\w*/u);if([e]=n,r.has(e)||t[e]===undefined)return r;r.add(e);for(const n of t[e])y(n.type,t,r);return r}function b(e,t,r,s){d(s,[u.V3,u.V4]);const i=g(e,t,r,s),a=(0,c.keccak256)(i);return(0,n.arrToBufArr)(a)}function v(e,t){const r=(0,o.stringToBytes)(f(e,t));return(0,n.arrToBufArr)((0,c.keccak256)(r))}function w(e){const t={};for(const n in r.TYPED_MESSAGE_SCHEMA.properties)e[n]&&(t[n]=e[n]);return"types"in t&&(t.types=Object.assign({EIP712Domain:[]},t.types)),t}function k(e,t){d(t,[u.V3,u.V4]);const r=w(e),{domain:n}=r;return b("EIP712Domain",n,{EIP712Domain:r.types.EIP712Domain},t)}function C(e,t){if((0,i.isArrayType)(e)&&Array.isArray(t)){const[r]=(0,i.getArrayType)(e);return t.map((e=>C(r,e)))}if("address"===e){if((0,o.isStrictHexString)(t))return(0,a.padStart)((0,o.hexToBytes)(t).subarray(0,20),20);if(t instanceof Uint8Array)return(0,a.padStart)(t.subarray(0,20),20)}if("bool"===e)return Boolean(t);if(e.startsWith("bytes")&&"bytes"!==e){const r=(0,i.getByteLength)(e);if("number"==typeof t)return t<0?new Uint8Array:(0,o.numberToBytes)(t).subarray(0,r);if((0,o.isStrictHexString)(t))return(0,o.hexToBytes)(t).subarray(0,r);if(t instanceof Uint8Array)return t.subarray(0,r)}if(e.startsWith("uint")&&"number"==typeof t)return Math.abs(t);if(e.startsWith("int")&&"number"==typeof t){const r=(0,i.getLength)(e);return BigInt.asIntN(r,BigInt(t))}return t}function T(e,t){return t.map((t=>{if("string"==typeof t||"number"==typeof t||"bigint"==typeof t){const r=h(e,t);if(r>=BigInt(0))return(0,a.padStart)((0,o.bigIntToBytes)(r),32);const n=(0,i.getLength)(e),s=BigInt.asIntN(n,r);return(0,o.signedBigIntToBytes)(s,32)}return t}))}function _(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!("length"in e)||!e.length)throw t;const r=e.map((({name:e,type:t,value:r})=>{if("address[]"===t)return{name:e,type:"bytes32[]",value:(n=r,n.map((e=>"number"==typeof e?(0,a.padStart)((0,o.numberToBytes)(e),32):(0,o.isStrictHexString)(e)?(0,a.padStart)((0,o.hexToBytes)(e).subarray(0,32),32):e instanceof Uint8Array?(0,a.padStart)(e.subarray(0,32),32):e)))};var n;if(t.startsWith("int")&&(0,i.isArrayType)(t)){const[n,s]=(0,i.getArrayType)(t);return{name:e,type:`bytes32[${null!=s?s:""}]`,value:T(n,r)}}return{name:e,type:t,value:C(t,r)}})),u=r.map((e=>"bytes"!==e.type?e.value:(0,l.legacyToBuffer)(e.value))),d=r.map((e=>{if("function"===e.type)throw new Error('Unsupported or invalid type: "function"');return e.type})),h=e.map((e=>{if(!e.name)throw t;return`${e.type} ${e.name}`}));return(0,n.arrToBufArr)((0,c.keccak256)((0,s.encodePacked)(["bytes32","bytes32"],[(0,c.keccak256)((0,s.encodePacked)(["string[]"],[h],!0)),(0,c.keccak256)((0,s.encodePacked)(d,u,!0))])))}!function(e){e.V1="V1",e.V3="V3",e.V4="V4"}(u=r.SignTypedDataVersion||(r.SignTypedDataVersion={})),r.TYPED_MESSAGE_SCHEMA={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},r.TypedDataUtils={encodeData:g,encodeType:f,findTypeDependencies:y,hashStruct:b,hashType:v,sanitizeData:w,eip712Hash:function(e,t){d(t,[u.V3,u.V4]);const r=w(e),s=[(0,o.hexToBytes)("1901")];return s.push(k(e,t)),"EIP712Domain"!==r.primaryType&&s.push(b(r.primaryType,r.message,r.types,t)),(0,n.arrToBufArr)((0,c.keccak256)((0,o.concatBytes)(s)))},eip712DomainHash:k},r.typedSignatureHash=function(e){const t=_(e);return(0,o.bytesToHex)(t)},r.signTypedData=function({privateKey:e,data:t,version:s}){if(d(s),(0,l.isNullish)(t))throw new Error("Missing data parameter");if((0,l.isNullish)(e))throw new Error("Missing private key parameter");const i=s===u.V1?_(t):r.TypedDataUtils.eip712Hash(t,s),a=(0,n.ecsign)(i,e);return(0,l.concatSig)((0,n.arrToBufArr)((0,o.bigIntToBytes)(a.v)),a.r,a.s)},r.recoverTypedSignature=function({data:e,signature:t,version:s}){if(d(s),(0,l.isNullish)(e))throw new Error("Missing data parameter");if((0,l.isNullish)(t))throw new Error("Missing signature parameter");const i=s===u.V1?_(e):r.TypedDataUtils.eip712Hash(e,s),a=(0,l.recoverPublicKey)(i,t),c=(0,n.publicToAddress)(a);return(0,o.bytesToHex)(c)}}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/eth-sig-util/dist/sign-typed-data.js"}],[1724,{"@ethereumjs/util":1691,"@metamask/utils":2874,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=r.recoverPublicKey=r.concatSig=r.legacyToBuffer=r.isNullish=r.padWithZeroes=void 0;const n=e("@ethereumjs/util"),s=e("@metamask/utils");function i(e,t){if(""!==e&&!/^[a-f0-9]+$/iu.test(e))throw new Error(`Expected an unprefixed hex string. Received: ${e}`);if(t<0)throw new Error(`Expected a non-negative integer target length. Received: ${t}`);return String.prototype.padStart.call(e,t,"0")}function a(e){return null===e||e===undefined}r.padWithZeroes=i,r.isNullish=a,r.legacyToBuffer=function(e){return"string"!=typeof e||(0,n.isHexString)(e)?(0,n.toBuffer)(e):t.from(e)},r.concatSig=function(e,t,r){const a=(0,n.fromSigned)(t),o=(0,n.fromSigned)(r),c=(0,n.bufferToInt)(e),l=i((0,n.toUnsigned)(a).toString("hex"),64),u=i((0,n.toUnsigned)(o).toString("hex"),64),d=(0,s.remove0x)((0,s.numberToHex)(c));return(0,s.add0x)(l.concat(u,d))},r.recoverPublicKey=function(e,t){const r=(0,n.fromRpcSig)(t);return(0,n.ecrecover)(e,r.v,r.r,r.s)},r.normalize=function(e){if(a(e))return undefined;if("number"==typeof e){if(e<0)return"0x";const t=(0,s.numberToBytes)(e);e=(0,s.bytesToHex)(t)}if("string"!=typeof e){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return(0,s.add0x)(e.toLowerCase())}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-snap-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/eth-sig-util/dist/utils.js"}],[1725,{"./index.cjs":1728,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.JsonRpcRequestStruct=void 0;const n=e("@metamask/superstruct"),s=e("@metamask/utils"),i=e("./index.cjs");r.JsonRpcRequestStruct=(0,i.object)({jsonrpc:(0,n.literal)("2.0"),id:(0,n.union)([(0,n.string)(),(0,n.number)(),(0,n.literal)(null)]),method:(0,n.string)(),params:(0,i.exactOptional)((0,n.union)([(0,n.array)(s.JsonStruct),(0,n.record)((0,n.string)(),s.JsonStruct)]))})}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/JsonRpcRequest.cjs"}],[1726,{"bitcoin-address-validation":3903},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isBtcMainnetAddress=function(e){return(0,n.validate)(e,n.Network.mainnet)},r.isBtcTestnetAddress=function(e){return(0,n.validate)(e,n.Network.testnet)};const n=e("bitcoin-address-validation")}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/btc/address.cjs"}],[1727,{"./address.cjs":1726},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./address.cjs"),r)}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/btc/index.cjs"}],[1728,{"./JsonRpcRequest.cjs":1725,"./btc/index.cjs":1727,"./scopes.cjs":1729,"./superstruct.cjs":1730,"./types.cjs":1731,"./typing.cjs":1732},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./btc/index.cjs"),r),s(e("./types.cjs"),r),s(e("./typing.cjs"),r),s(e("./scopes.cjs"),r),s(e("./superstruct.cjs"),r),s(e("./JsonRpcRequest.cjs"),r)}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/index.cjs"}],[1729,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ETH_SCOPE_EOA=void 0,r.isScopeEqual=i,r.isScopeEqualToAny=function(e,t){return t.some((t=>i(e,t)))};const n=e("@metamask/utils");r.ETH_SCOPE_EOA=`${n.KnownCaipNamespace.Eip155}:0`;const s=`${n.KnownCaipNamespace.Eip155}:`;function i(e,t){const n=e===r.ETH_SCOPE_EOA,i=t===r.ETH_SCOPE_EOA;return n?t.startsWith(s):i?e.startsWith(s):e===t}}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/scopes.cjs"}],[173,{"ethereumjs-util":4251},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getContractProxyAddress=async function(e,t){const r=(await Promise.all(s.map((r=>t.request({method:"eth_getStorageAt",params:[e,r,"latest"]}))))).find((e=>(0,n.stripHexPrefix)(e)!==i));return r&&(0,n.addHexPrefix)(r.slice(26))};var n=e("ethereumjs-util");const s=["0x7050c9e0f4ca769c69bd3a8ef740bc37934f8e2c036e5a723fd8ee048ed3f8c3","0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc"],i="0".padEnd(64,"0")}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/proxy.ts"}],[1730,{"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.object=function(e){return(0,n.object)(e)},r.exactOptional=function(e){return new n.Struct({...e,validator:(t,r)=>!s(r)||e.validator(t,r),refiner:(t,r)=>!s(r)||e.refiner(t,r)})},r.strictMask=function(e,t,r){return(0,n.assert)(e,t,r),e},r.selectiveUnion=function(e){return new n.Struct({type:"union",schema:null,*entries(t,r){yield*e(t).entries(t,r)},*refiner(t,r){yield*e(t).refiner(t,r)},coercer:(t,r)=>e(t).coercer(t,r),validator:(t,r)=>e(t).validator(t,r)})};const n=e("@metamask/superstruct");function s(e){return e.path[e.path.length-1]in e.branch[e.branch.length-2]}}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/superstruct.cjs"}],[1731,{"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.StringNumberStruct=r.UrlStruct=r.AccountIdStruct=r.UuidStruct=void 0;const n=e("@metamask/superstruct"),s=e("@metamask/utils");r.UuidStruct=(0,s.definePattern)("UuidV4",/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/iu),r.AccountIdStruct=r.UuidStruct,r.UrlStruct=(0,n.define)("Url",(e=>{try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch{return!1}})),r.StringNumberStruct=(0,s.definePattern)("StringNumber",/^\d+(\.\d+)?$/u)}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/types.cjs"}],[1732,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.expectTrue=function(){}}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-utils",file:"node_modules/@metamask/eth-snap-keyring/node_modules/@metamask/keyring-utils/dist/typing.cjs"}],[1733,{"./nil.js":1736,"./parse.js":1737,"./stringify.js":1741,"./v1.js":1742,"./v3.js":1743,"./v4.js":1745,"./v5.js":1746,"./validate.js":1747,"./version.js":1748},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return c.default}});var n=h(e("./v1.js")),s=h(e("./v3.js")),i=h(e("./v4.js")),a=h(e("./v5.js")),o=h(e("./nil.js")),c=h(e("./version.js")),l=h(e("./validate.js")),u=h(e("./stringify.js")),d=h(e("./parse.js"));function h(e){return e&&e.__esModule?e:{default:e}}}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/index.js"}],[1734,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e){return 14+(e+64>>>9<<4)+1}function s(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function i(e,t,r,n,i,a){return s((o=s(s(t,e),s(n,a)))<<(c=i)|o>>>32-c,r);var o,c}function a(e,t,r,n,s,a,o){return i(t&r|~t&n,e,t,s,a,o)}function o(e,t,r,n,s,a,o){return i(t&n|r&~n,e,t,s,a,o)}function c(e,t,r,n,s,a,o){return i(t^r^n,e,t,s,a,o)}function l(e,t,r,n,s,a,o){return i(r^(t|~n),e,t,s,a,o)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){const t=[],r=32*e.length,n="0123456789abcdef";for(let s=0;s<r;s+=8){const r=e[s>>5]>>>s%32&255,i=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let r=1732584193,i=-271733879,u=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const n=r,h=i,p=u,m=d;r=a(r,i,u,d,e[t],7,-680876936),d=a(d,r,i,u,e[t+1],12,-389564586),u=a(u,d,r,i,e[t+2],17,606105819),i=a(i,u,d,r,e[t+3],22,-1044525330),r=a(r,i,u,d,e[t+4],7,-176418897),d=a(d,r,i,u,e[t+5],12,1200080426),u=a(u,d,r,i,e[t+6],17,-1473231341),i=a(i,u,d,r,e[t+7],22,-45705983),r=a(r,i,u,d,e[t+8],7,1770035416),d=a(d,r,i,u,e[t+9],12,-1958414417),u=a(u,d,r,i,e[t+10],17,-42063),i=a(i,u,d,r,e[t+11],22,-1990404162),r=a(r,i,u,d,e[t+12],7,1804603682),d=a(d,r,i,u,e[t+13],12,-40341101),u=a(u,d,r,i,e[t+14],17,-1502002290),i=a(i,u,d,r,e[t+15],22,1236535329),r=o(r,i,u,d,e[t+1],5,-165796510),d=o(d,r,i,u,e[t+6],9,-1069501632),u=o(u,d,r,i,e[t+11],14,643717713),i=o(i,u,d,r,e[t],20,-373897302),r=o(r,i,u,d,e[t+5],5,-701558691),d=o(d,r,i,u,e[t+10],9,38016083),u=o(u,d,r,i,e[t+15],14,-660478335),i=o(i,u,d,r,e[t+4],20,-405537848),r=o(r,i,u,d,e[t+9],5,568446438),d=o(d,r,i,u,e[t+14],9,-1019803690),u=o(u,d,r,i,e[t+3],14,-187363961),i=o(i,u,d,r,e[t+8],20,1163531501),r=o(r,i,u,d,e[t+13],5,-1444681467),d=o(d,r,i,u,e[t+2],9,-51403784),u=o(u,d,r,i,e[t+7],14,1735328473),i=o(i,u,d,r,e[t+12],20,-1926607734),r=c(r,i,u,d,e[t+5],4,-378558),d=c(d,r,i,u,e[t+8],11,-2022574463),u=c(u,d,r,i,e[t+11],16,1839030562),i=c(i,u,d,r,e[t+14],23,-35309556),r=c(r,i,u,d,e[t+1],4,-1530992060),d=c(d,r,i,u,e[t+4],11,1272893353),u=c(u,d,r,i,e[t+7],16,-155497632),i=c(i,u,d,r,e[t+10],23,-1094730640),r=c(r,i,u,d,e[t+13],4,681279174),d=c(d,r,i,u,e[t],11,-358537222),u=c(u,d,r,i,e[t+3],16,-722521979),i=c(i,u,d,r,e[t+6],23,76029189),r=c(r,i,u,d,e[t+9],4,-640364487),d=c(d,r,i,u,e[t+12],11,-421815835),u=c(u,d,r,i,e[t+15],16,530742520),i=c(i,u,d,r,e[t+2],23,-995338651),r=l(r,i,u,d,e[t],6,-198630844),d=l(d,r,i,u,e[t+7],10,1126891415),u=l(u,d,r,i,e[t+14],15,-1416354905),i=l(i,u,d,r,e[t+5],21,-57434055),r=l(r,i,u,d,e[t+12],6,1700485571),d=l(d,r,i,u,e[t+3],10,-1894986606),u=l(u,d,r,i,e[t+10],15,-1051523),i=l(i,u,d,r,e[t+1],21,-2054922799),r=l(r,i,u,d,e[t+8],6,1873313359),d=l(d,r,i,u,e[t+15],10,-30611744),u=l(u,d,r,i,e[t+6],15,-1560198380),i=l(i,u,d,r,e[t+13],21,1309151649),r=l(r,i,u,d,e[t+4],6,-145523070),d=l(d,r,i,u,e[t+11],10,-1120210379),u=l(u,d,r,i,e[t+2],15,718787259),i=l(i,u,d,r,e[t+9],21,-343485551),r=s(r,n),i=s(i,h),u=s(u,p),d=s(d,m)}return[r,i,u,d]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};r.default=u}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/md5-browser.js"}],[1735,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};r.default=n}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/native-browser.js"}],[1736,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="00000000-0000-0000-0000-000000000000"}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/nil.js"}],[1737,{"./validate.js":1747},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var i=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/parse.js"}],[1738,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/regex.js"}],[1739,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){let n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)};const s=new Uint8Array(16)}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/rng-browser.js"}],[174,{"@ethersproject/abi":476,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTransactionDataWithSourcify=async function(e,t,r){var o,c;const l=await async function(e,t){var r;const n=await async function(e,t){const r=parseInt(t,16),n=await fetch(`https://sourcify.dev/server/files/any/${r}/${e}`);if(!n.ok)throw new Error("Failed to fetch Sourcify files");return n.json()}(e,t),s=null===(r=n.files)||void 0===r?void 0:r.find((e=>e.name.includes("metadata.json")));if(!s)throw new Error("Metadata not found");return JSON.parse(s.content)}(t,r);s("Retrieved Sourcify metadata",{contractAddress:t,chainId:r,metadata:l});const{abi:u}=l.output,d=new n.Interface(u),h=e.slice(0,10);let p;try{p=d.getFunction(h)}catch(e){}if(!p)return s("Failed to find function in ABI",h,u),undefined;const{name:m,inputs:g}=p,f=a(m,g),y=null===(o=l.output.userdoc)||void 0===o?void 0:o.methods[f],b=null===(c=l.output.devdoc)||void 0===c?void 0:c.methods[f],v=(null==y?void 0:y.notice)??(null==b?void 0:b.details);s("Extracted NatSpec",{signature:f,userDoc:y,devDoc:b});const w=d.decodeFunctionData(h,e),k=g.map(((e,t)=>i(e,t,w,y,b)));return{name:m,description:v,params:k}};var n=e("@ethersproject/abi");const s=(0,e("@metamask/utils").createProjectLogger)("sourcify");function i(e,t,r,n,s){var a,o;const{name:c,type:l,components:u}=e,d=(null==n||null===(a=n.params)||void 0===a?void 0:a[c])??(null==s||null===(o=s.params)||void 0===o?void 0:o[c]),h=r[t];let p=null==u?void 0:u.map(((e,t)=>i(e,t,h,{},{})));if(l.endsWith("[]")){const t=l.slice(0,-2);p=h.map(((r,n)=>{const s=`Item ${n+1}`;return i({...e,name:s,type:t},n,h,{},{})}))}return{name:c,description:d,type:l,value:h,children:p}}function a(e,t){return`${e??""}(${t.map((e=>{var t;return null!==(t=e.components)&&void 0!==t&&t.length?`${a(undefined,e.components)}${e.type.endsWith("[]")?"[]":""}`:e.type})).join(",")})`}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/sourcify.ts"}],[1740,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function s(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const i=e.length/4+2,a=Math.ceil(i/16),o=new Array(a);for(let t=0;t<a;++t){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];o[t]=r}o[a-1][14]=8*(e.length-1)/Math.pow(2,32),o[a-1][14]=Math.floor(o[a-1][14]),o[a-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<a;++e){const i=new Uint32Array(80);for(let t=0;t<16;++t)i[t]=o[e][t];for(let e=16;e<80;++e)i[e]=s(i[e-3]^i[e-8]^i[e-14]^i[e-16],1);let a=r[0],c=r[1],l=r[2],u=r[3],d=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),o=s(a,5)+n(r,c,l,u)+d+t[r]+i[e]>>>0;d=u,u=l,l=s(c,30)>>>0,c=a,a=o}r[0]=r[0]+a>>>0,r[1]=r[1]+c>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+d>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/sha1-browser.js"}],[1741,{"./validate.js":1747},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.unsafeStringify=a;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function a(e,t=0){return i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]}var o=function(e,t=0){const r=a(e,t);if(!(0,s.default)(r))throw TypeError("Stringified UUID is invalid");return r};r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/stringify.js"}],[1742,{"./rng.js":1739,"./stringify.js":1741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./rng.js"))&&n.__esModule?n:{default:n},i=e("./stringify.js");let a,o,c=0,l=0;var u=function(e,t,r){let n=t&&r||0;const u=t||new Array(16);let d=(e=e||{}).node||a,h=e.clockseq!==undefined?e.clockseq:o;if(null==d||null==h){const t=e.random||(e.rng||s.default)();null==d&&(d=a=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=o=16383&(t[6]<<8|t[7]))}let p=e.msecs!==undefined?e.msecs:Date.now(),m=e.nsecs!==undefined?e.nsecs:l+1;const g=p-c+(m-l)/1e4;if(g<0&&e.clockseq===undefined&&(h=h+1&16383),(g<0||p>c)&&e.nsecs===undefined&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=p,l=m,o=h,p+=122192928e5;const f=(1e4*(268435455&p)+m)%4294967296;u[n++]=f>>>24&255,u[n++]=f>>>16&255,u[n++]=f>>>8&255,u[n++]=255&f;const y=p/4294967296*1e4&268435455;u[n++]=y>>>8&255,u[n++]=255&y,u[n++]=y>>>24&15|16,u[n++]=y>>>16&255,u[n++]=h>>>8|128,u[n++]=255&h;for(let e=0;e<6;++e)u[n+e]=d[e];return t||(0,i.unsafeStringify)(u)};r.default=u}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v1.js"}],[1743,{"./md5.js":1734,"./v35.js":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./v35.js")),s=i(e("./md5.js"));function i(e){return e&&e.__esModule?e:{default:e}}var a=(0,n.default)("v3",48,s.default);r.default=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v3.js"}],[1744,{"./parse.js":1737,"./stringify.js":1741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.URL=r.DNS=void 0,r.default=function(e,t,r){function n(e,n,a,o){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,i.default)(n)),16!==(null===(c=n)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+e.length);if(l.set(n),l.set(e,n.length),l=r(l),l[6]=15&l[6]|t,l[8]=63&l[8]|128,a){o=o||0;for(let e=0;e<16;++e)a[o+e]=l[e];return a}return(0,s.unsafeStringify)(l)}try{n.name=e}catch(e){}return n.DNS=a,n.URL=o,n};var n,s=e("./stringify.js"),i=(n=e("./parse.js"))&&n.__esModule?n:{default:n};const a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=a;const o="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v35.js"}],[1745,{"./native.js":1735,"./rng.js":1739,"./stringify.js":1741},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./native.js")),s=a(e("./rng.js")),i=e("./stringify.js");function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();const a=(e=e||{}).random||(e.rng||s.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return(0,i.unsafeStringify)(a)};r.default=o}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v4.js"}],[1746,{"./sha1.js":1740,"./v35.js":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./v35.js")),s=i(e("./sha1.js"));function i(e){return e&&e.__esModule?e:{default:e}}var a=(0,n.default)("v5",80,s.default);r.default=a}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/v5.js"}],[1747,{"./regex.js":1738},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./regex.js"))&&n.__esModule?n:{default:n};var i=function(e){return"string"==typeof e&&s.default.test(e)};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/validate.js"}],[1748,{"./validate.js":1747},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var i=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};r.default=i}}},{package:"@metamask/eth-snap-keyring>uuid",file:"node_modules/@metamask/eth-snap-keyring/node_modules/uuid/dist/version.js"}],[175,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.UNISWAP_ROUTER_COMMANDS=void 0;r.UNISWAP_ROUTER_COMMANDS={0:{name:"V3_SWAP_EXACT_IN",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of input tokens for the trade",name:"amountIn"},{type:"uint256",description:"The minimum amount of output tokens the user wants",name:"amountOutMin"},{type:"bytes",description:"The UniswapV3 encoded path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},1:{name:"V3_SWAP_EXACT_OUT",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of output tokens to receive",name:"amountOut"},{type:"uint256",description:"The maximum number of input tokens that should be spent",name:"amountInMax"},{type:"bytes",description:"The UniswapV3 encoded path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},2:{name:"PERMIT2_TRANSFER_FROM",params:[{type:"address",description:"The token to fetch from Permit2",name:"token"},{type:"address",description:"The recipient of the tokens fetched",name:"recipient"},{type:"uint256",description:"The amount of token to fetch",name:"amount"}]},3:{name:"PERMIT2_PERMIT_BATCH",params:[{type:"bytes",description:"A PermitBatch struct outlining all of the Permit2 permits to execute.",name:"batch"},{type:"bytes",description:"The signature to provide to Permit2",name:"data"}]},4:{name:"SWEEP",params:[{type:"address",description:"The ERC20 token to sweep (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the sweep",name:"recipient"},{type:"uint256",description:"The minimum required tokens to receive from the sweep",name:"amountMin"}]},5:{name:"TRANSFER",params:[{type:"address",description:"The ERC20 token to transfer (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"The amount to transfer",name:"value"}]},6:{name:"PAY_PORTION",params:[{type:"address",description:"The ERC20 token to transfer (or Constants.ETH for ETH)",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"In basis points, the percentage of the contracts balance to transfer",name:"bips"}]},8:{name:"V2_SWAP_EXACT_IN",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of input tokens for the trade",name:"amountIn"},{type:"uint256",description:"The minimum amount of output tokens the user wants",name:"amountOutMin"},{type:"address[]",description:"The UniswapV2 token path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},9:{name:"V2_SWAP_EXACT_OUT",params:[{type:"address",description:"The recipient of the output of the trade",name:"recipient"},{type:"uint256",description:"The amount of output tokens to receive",name:"amountOut"},{type:"uint256",description:"The maximum number of input tokens that should be spent",name:"amountInMax"},{type:"address[]",description:"The UniswapV2 token path to trade along",name:"path"},{type:"bool",description:"A flag for whether the input tokens should come from the msg.sender (through Permit2) or whether the funds are already in the UniversalRouter",name:"payerIsUser"}]},10:{name:"PERMIT2_PERMIT",params:[{type:"bytes",description:"A PermitSingle struct outlining the Permit2 permit to execute",name:"permitSingle"},{type:"bytes",description:"The signature to provide to Permit2",name:"signature"}]},11:{name:"WRAP_ETH",params:[{type:"address",description:"The recipient of the WETH",name:"recipient"},{type:"uint256",description:"The amount of ETH to wrap",name:"amountMin"}]},12:{name:"UNWRAP_WETH",params:[{type:"address",description:"The recipient of the ETH",name:"recipient"},{type:"uint256",description:"The minimum required ETH to receive from the unwrapping",name:"amountMin"}]},13:{name:"PERMIT2_TRANSFER_FROM_BATCH",params:[{type:"bytes",description:"An array of AllowanceTransferDetails structs that each describe a Permit2 transfer to perform",name:"batchDetails"}]},16:{name:"SEAPORT",params:[{type:"uint256",description:"The ETH value to forward to the Seaport contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Seaport contract",name:"data"}]},17:{name:"LOOKS_RARE_721",params:[{type:"uint256",description:"The ETH value to forward to the LooksRare contract",name:"value"},{type:"bytes",description:"The calldata to use to call the LooksRare contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},18:{name:"NFTX",params:[{type:"uint256",description:"The ETH value to forward to the NFTX contract",name:"value"},{type:"bytes",description:"The calldata to use to call the NFTX contract",name:"data"}]},19:{name:"CRYPTOPUNKS",params:[{type:"uint256",description:"The PunkID to purchase",name:"punkId"},{type:"address",description:"The recipient for the cryptopunk",name:"recipient"},{type:"uint256",description:"The ETH value to forward to the Cryptopunks contract",name:"value"}]},20:{name:"LOOKS_RARE_1155",params:[{type:"uint256",description:"The ETH value to forward to the LooksRare contract",name:"value"},{type:"bytes",description:"The calldata to use to call the LooksRare contract",name:"data"},{type:"address",description:"The recipient of the ERC1155",name:"recipient"},{type:"address",description:"The ERC1155 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The amount of the ERC1155 to transfer",name:"amount"}]},21:{name:"OWNER_CHECK_721",params:[{type:"address",description:"The required owner of the ERC721",name:"owner"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},22:{name:"OWNER_CHECK_1155",params:[{type:"address",description:"The required owner of the ERC1155",name:"owner"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The minimum required amount of the ERC1155",name:"minBalance"}]},23:{name:"SWEEP_ERC721",params:[{type:"address",description:"The ERC721 token address to transfer",name:"token"},{type:"address",description:"The recipient of the transfer",name:"recipient"},{type:"uint256",description:"The token ID to transfer",name:"id"}]},24:{name:"X2Y2_721",params:[{type:"uint256",description:"The ETH value to forward to the X2Y2 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the X2Y2 contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},25:{name:"SUDOSWAP",params:[{type:"uint256",description:"The ETH value to forward to the Sudoswap contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Sudoswap contract",name:"data"}]},26:{name:"NFT20",params:[{type:"uint256",description:"The ETH value to forward to the NFT20 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the NFT20 contract",name:"data"}]},27:{name:"X2Y2_1155",params:[{type:"uint256",description:"The ETH value to forward to the X2Y2 contract",name:"value"},{type:"bytes",description:"The calldata to use to call the X2Y2 contract",name:"data"},{type:"address",description:"The recipient of the ERC1155",name:"recipient"},{type:"address",description:"The ERC1155 token address",name:"token"},{type:"uint256",description:"The ID of the ERC1155",name:"id"},{type:"uint256",description:"The amount of the ERC1155 to transfer",name:"amount"}]},28:{name:"FOUNDATION",params:[{type:"uint256",description:"The ETH value to forward to the Foundation contract",name:"value"},{type:"bytes",description:"The calldata to use to call the Foundation contract",name:"data"},{type:"address",description:"The recipient of the ERC721",name:"recipient"},{type:"address",description:"The ERC721 token address",name:"token"},{type:"uint256",description:"The ID of the ERC721",name:"id"}]},29:{name:"SWEEP_ERC1155",params:[{type:"address",description:"The ERC1155 token address to sweep",name:"token"},{type:"address",description:"The recipient of the sweep",name:"recipient"},{type:"uint256",description:"The token ID to sweep",name:"id"},{type:"uint256",description:"The minimum required tokens to receive from the sweep",name:"amount"}]}}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/uniswap-commands.ts"}],[1753,{"./onekey-keyring.cjs":1754,"./trezor-connect-bridge.cjs":1755,"./trezor-keyring.cjs":1756},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./trezor-keyring.cjs"),r),s(e("./onekey-keyring.cjs"),r),s(e("./trezor-connect-bridge.cjs"),r)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/index.cjs"}],[1754,{"./trezor-keyring.cjs":1756},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.OneKeyKeyring=void 0;const n=e("./trezor-keyring.cjs"),s="OneKey Hardware";class i extends n.TrezorKeyring{constructor(){super(...arguments),this.type=s}}r.OneKeyKeyring=i,i.type=s}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/onekey-keyring.cjs"}],[1755,{"@trezor/connect-web":3193},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorConnectBridge=void 0;const a=i(e("@trezor/connect-web"));r.TrezorConnectBridge=class{constructor(){this.trezorConnectInitiated=!1}async init(e){a.default.on(a.DEVICE_EVENT,(e=>{var t;e.type===a.DEVICE.CONNECT&&(this.model=null===(t=e.payload.features)||void 0===t?void 0:t.model)})),this.trezorConnectInitiated||(await a.default.init(e),this.trezorConnectInitiated=!0)}async dispose(){return a.default.dispose(),Promise.resolve()}getPublicKey(e){return a.default.getPublicKey(e)}ethereumSignTransaction(e){return a.default.ethereumSignTransaction(e)}ethereumSignMessage(e){return a.default.ethereumSignMessage(e)}ethereumSignTypedData(e){return a.default.ethereumSignTypedData(e)}}}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-connect-bridge.cjs"}],[1756,{"@ethereumjs/tx":434,"@ethereumjs/util":449,"@metamask/eth-sig-util":1778,"@metamask/utils":2874,"@trezor/connect-plugin-ethereum":1798,buffer:3998,hdkey:4556},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n,s,i,a,o,c,l=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.TrezorKeyring=r.TREZOR_CONNECT_MANIFEST=void 0;const d=e("@ethereumjs/tx"),h=e("@ethereumjs/util"),p=e("@metamask/eth-sig-util"),m=e("@metamask/utils"),g=e("@trezor/connect-plugin-ethereum"),f=u(e("hdkey")),y="m/44'/60'/0'/0",b={[y]:!0,"m/44'/60'/0'":!0,"m/44'/1'/0'/0":!0},v="Trezor Hardware",w=1e3;async function k(e){return new Promise((t=>setTimeout(t,e)))}function C(e){return"function"==typeof e.getChainId}r.TREZOR_CONNECT_MANIFEST={email:"support@metamask.io",appUrl:"https://metamask.io"};class T{constructor({bridge:e}){if(n.add(this),this.type=v,this.accounts=[],this.hdk=new f.default,this.hdPath=y,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},!e)throw new Error("Bridge is a required dependency for the keyring");this.bridge=e}getModel(){return this.bridge.model}async init(){return this.bridge.init({manifest:r.TREZOR_CONNECT_MANIFEST,lazyLoad:!0})}async destroy(){return this.bridge.dispose()}async serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts.slice(),page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}async deserialize(e){var t,r,n,s;return this.hdPath=null!==(t=e.hdPath)&&void 0!==t?t:y,this.accounts=null!==(r=e.accounts)&&void 0!==r?r:[],this.page=null!==(n=e.page)&&void 0!==n?n:0,this.perPage=null!==(s=e.perPage)&&void 0!==s?s:5,Promise.resolve()}isUnlocked(){var e;return Boolean(null===(e=this.hdk)||void 0===e?void 0:e.publicKey)}async unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise(((e,r)=>{this.bridge.getPublicKey({path:this.hdPath,coin:"ETH"}).then((n=>{var s;n.success?(this.hdk.publicKey=t.from(n.payload.publicKey,"hex"),this.hdk.chainCode=t.from(n.payload.chainCode,"hex"),e("just unlocked")):r(new Error((null===(s=n.payload)||void 0===s?void 0:s.error)||"Unknown error"))})).catch((e=>{r(new Error((null==e?void 0:e.toString())||"Unknown error"))}))}))}setAccountToUnlock(e){this.unlockedAccount=parseInt(String(e),10)}async addAccounts(e){return new Promise(((t,r)=>{this.unlock().then((r=>{const s=this.unlockedAccount,i=s+e,a=[];for(let e=s;e<i;e++){const t=l(this,n,"m",o).call(this,"m",e);this.accounts.includes(t)||(this.accounts=[...this.accounts,t],a.push(t)),this.page=0}t(a)})).catch((e=>{r(e)}))}))}async getFirstPage(){return this.page=0,l(this,n,"m",s).call(this,1)}async getNextPage(){return l(this,n,"m",s).call(this,1)}async getPreviousPage(){return l(this,n,"m",s).call(this,-1)}async getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}async signTransaction(e,r){return C(r)?l(this,n,"m",i).call(this,e,r.getChainId(),r,(e=>(r.v=t.from(e.v,"hex"),r.r=t.from(e.r,"hex"),r.s=t.from(e.s,"hex"),r))):l(this,n,"m",i).call(this,e,Number(r.common.chainId()),r,(e=>{const t=r.toJSON();return t.type=r.type,t.v=(0,m.add0x)(e.v),t.r=(0,m.add0x)(e.r),t.s=(0,m.add0x)(e.s),d.TransactionFactory.fromTxData(t,{common:r.common,freeze:Object.isFrozen(r)})}))}async signMessage(e,t){return this.signPersonalMessage(e,t)}async signPersonalMessage(e,t){return new Promise(((r,s)=>{this.unlock().then((i=>{setTimeout((()=>{this.bridge.ethereumSignMessage({path:l(this,n,"m",c).call(this,e),message:(0,m.remove0x)(t),hex:!0}).then((t=>{var n;if(t.success){t.payload.address!==(0,m.getChecksumAddress)(e)&&s(new Error("signature doesnt match the right address"));const n=`0x${t.payload.signature}`;r(n)}else s(new Error((null===(n=t.payload)||void 0===n?void 0:n.error)||"Unknown error"))})).catch((e=>{s(new Error((null==e?void 0:e.toString())||"Unknown error"))}))}),"just unlocked"===i?w:0)})).catch((e=>{s(new Error((null==e?void 0:e.toString())||"Unknown error"))}))}))}async signTypedData(e,t,{version:r}){var s,i;const a=(0,g.transformTypedData)(t,r===p.SignTypedDataVersion.V4),{types:o,message:u={},domain:d={},primaryType:h,domain_separator_hash:f,message_hash:y}=a,b=await this.unlock();await k("just unlocked"===b?w:0);const v=await this.bridge.ethereumSignTypedData({path:l(this,n,"m",c).call(this,e),data:{types:Object.assign(Object.assign({},o),{EIP712Domain:null!==(s=o.EIP712Domain)&&void 0!==s?s:[]}),message:u,domain:d,primaryType:h},metamask_v4_compat:!0,domain_separator_hash:f,message_hash:null!=y?y:""});if(v.success){if((0,m.getChecksumAddress)(e)!==v.payload.address)throw new Error("signature doesnt match the right address");return v.payload.signature}throw new Error((null===(i=v.payload)||void 0===i?void 0:i.error)||"Unknown error")}forgetDevice(){this.accounts=[],this.hdk=new f.default,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!b[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new f.default,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}}r.TrezorKeyring=T,n=new WeakSet,s=async function(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise(((e,t)=>{this.unlock().then((t=>{const r=(this.page-1)*this.perPage,s=r+this.perPage,i=[];for(let e=r;e<s;e++){const t=l(this,n,"m",o).call(this,"m",e);i.push({address:t,balance:null,index:e}),this.paths[(0,m.getChecksumAddress)(t)]=e}e(i)})).catch((e=>{t(e)}))}))},i=async function(e,r,s,i){var o,u,d,h;let p;p=C(s)?{to:l(this,n,"m",a).call(this,s.to),value:l(this,n,"m",a).call(this,s.value),data:l(this,n,"m",a).call(this,s.data),chainId:r,nonce:l(this,n,"m",a).call(this,s.nonce),gasLimit:l(this,n,"m",a).call(this,s.gasLimit),gasPrice:l(this,n,"m",a).call(this,s.gasPrice)}:Object.assign(Object.assign({},s.toJSON()),{chainId:r,to:l(this,n,"m",a).call(this,t.from(null!==(u=null===(o=s.to)||void 0===o?void 0:o.bytes)&&void 0!==u?u:[]))});try{const t=await this.unlock();await k("just unlocked"===t?w:0);const r=await this.bridge.ethereumSignTransaction({path:l(this,n,"m",c).call(this,e),transaction:p});if(r.success){const t=i(r.payload),n=(0,m.getChecksumAddress)((0,m.add0x)(t.getSenderAddress().toString("hex")));if(n!==(0,m.getChecksumAddress)(e))throw new Error("signature doesn't match the right address");return t}throw new Error((null===(d=r.payload)||void 0===d?void 0:d.error)||"Unknown error")}catch(e){throw new Error(null!==(h=null==e?void 0:e.toString())&&void 0!==h?h:"Unknown error")}},a=function(e){return(0,m.bytesToHex)(e)},o=function(e,t){const r=this.hdk.derive(`${e}/${t}`),n=(0,m.bytesToHex)((0,h.publicToAddress)(r.publicKey,!0));return(0,h.toChecksumAddress)(n)},c=function(e){const t=(0,m.getChecksumAddress)(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===l(this,n,"m",o).call(this,"m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`},T.type=v}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring",file:"node_modules/@metamask/eth-trezor-keyring/dist/trezor-keyring.cjs"}],[1757,{"./errors":1758,"./packer":1761,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeSingle=r.decode=r.encodePacked=r.encodeSingle=r.encode=void 0;const n=e("@metamask/utils"),s=e("./errors"),i=e("./packer");r.encode=(e,t,r,n)=>{try{return(0,i.pack)({types:e,values:t,packed:r,tight:n})}catch(e){if(e instanceof s.ParserError)throw new s.ParserError(`Unable to encode value: ${e.message}`,e);throw new s.ParserError(`An unexpected error occurred: ${(0,s.getErrorMessage)(e)}`,e)}};r.encodeSingle=(e,t)=>(0,r.encode)([e],[t]);r.encodePacked=(e,t,n)=>(0,r.encode)(e,t,!0,n);r.decode=(e,t)=>{const r=(0,n.createBytes)(t);try{return(0,i.unpack)(e,r)}catch(e){if(e instanceof s.ParserError)throw new s.ParserError(`Unable to decode value: ${e.message}`,e);throw new s.ParserError(`An unexpected error occurred: ${(0,s.getErrorMessage)(e)}`,e)}};r.decodeSingle=(e,t)=>{const i=(0,r.decode)([e],t);return(0,n.assert)(1===i.length,new s.ParserError("Decoded value array has unexpected length.")),i[0]}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/abi.js"}],[1758,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ParserError=r.getErrorStack=r.getErrorMessage=void 0;const n=e("@metamask/utils");r.getErrorMessage=e=>"string"==typeof e?e:e instanceof Error||(0,n.isObject)(e)&&(0,n.hasProperty)(e,"message")&&"string"==typeof e.message?e.message:"Unknown error.";r.getErrorStack=e=>e instanceof Error?e.stack:undefined;class s extends Error{constructor(e,t){super(e),this.name="ParserError";const n=(0,r.getErrorStack)(t);n&&(this.stack=n)}}r.ParserError=s}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/errors.js"}],[1759,{"./abi":1757,"./errors":1758,"./types":1774},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./abi"),r),s(e("./errors"),r),s(e("./types"),r)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/index.js"}],[176,{"../../../../../shared/constants/network":5658,"./uniswap-commands":175,"@ethersproject/abi":476,"ethereumjs-util":4251},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.UNISWAP_UNIVERSAL_ROUTER_ADDRESSES=void 0,r.decodeUniswapRouterTransactionData=function({transactionData:e,contractAddress:t,chainId:r}){const i=l[r];if(null==i||!i.map((e=>e.toLowerCase())).includes(t.toLowerCase()))return undefined;const d=new n.Interface(u);let h;try{h=d.parseTransaction({data:e})}catch(e){return undefined}const p=h.args.commands,m=h.args.inputs;return p.slice(2).match(/.{1,2}/gu).map(((e,t)=>function(e,t){const r=parseInt(e,16),i=31&r,l=a.UNISWAP_ROUTER_COMMANDS[String(i)];if(!l)return undefined;const u=l.params.map((e=>e.type)),d=n.Interface.getAbiCoder().decode(u,t),{name:h}=l,p=l.params.map(((e,t)=>{const{name:r,type:n,description:i}=e,a=d[t];return{name:r,type:n,value:"path"===r?function(e){const t=[];let r=(0,s.stripHexPrefix)(e),n={},i=!0;for(;r.length;){if(i){const e=(0,s.addHexPrefix)(r.slice(0,o));n.firstAddress?(n.secondAddress=e,t.push(n),n={firstAddress:e}):n.firstAddress=e,r=r.slice(o)}else n.tickSpacing=parseInt(r.slice(0,c),16),r=r.slice(c);i=!i}return t}(a):a,description:i}}));return{name:h,params:p}}(e,m[t]))).filter((e=>e!==undefined))};var n=e("@ethersproject/abi"),s=e("ethereumjs-util"),i=e("../../../../../shared/constants/network"),a=e("./uniswap-commands");const o=40,c=6,l=r.UNISWAP_UNIVERSAL_ROUTER_ADDRESSES={[i.CHAIN_IDS.ARBITRUM]:["0x4C60051384bd2d3C01bfc845Cf5F4b44bcbE9de5","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x5E325eDA8064b456f4781070C0738d849c824258"],[i.CHAIN_IDS.AVALANCHE]:["0x82635AF6146972cD6601161c4472ffe97237D292","0x4Dae2f939ACf50408e13d58534Ff8c2776d45265"],[i.CHAIN_IDS.BASE]:["0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"],[i.CHAIN_IDS.BSC]:["0x5Dc88340E1c5c6366864Ee415d6034cadd1A9897","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0x4Dae2f939ACf50408e13d58534Ff8c2776d45265"],[i.CHAIN_IDS.MAINNET]:["0xEf1c6E67703c7BD7107eed8303Fbe6EC2554BF6B","0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"],[i.CHAIN_IDS.OPTIMISM]:["0xb555edF5dcF85f42cEeF1f3630a52A108E55A654","0xeC8B0F7Ffe3ae75d7FfAb09429e3675bb63503e4","0xCb1355ff08Ab38bBCE60111F1bb2B784bE25D7e8"],[i.CHAIN_IDS.POLYGON]:["0x4C60051384bd2d3C01bfc845Cf5F4b44bcbE9de5","0x643770E279d5D0733F21d6DC03A8efbABf3255B4","0xec7BE89e9d109e7e3Fec59c222CF297125FEFda2"],[i.CHAIN_IDS.SEPOLIA]:["0x3fC91A3afd70395Cd496C647d5a6CC9D4B2b7FAD"]},u=[{constant:!0,inputs:[{name:"commands",type:"bytes"},{name:"inputs",type:"bytes[]"},{name:"deadline",type:"uint256"}],name:"execute",type:"function"},{constant:!0,inputs:[{name:"commands",type:"bytes"},{name:"inputs",type:"bytes[]"}],name:"execute",type:"function"}]}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/uniswap.ts"}],[1760,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.iterate=void 0;const n=e("@metamask/utils");r.iterate=function*(e,t=32){for(let r=0;r<e.length;r+=t){const s=e=>{(0,n.assert)(e>=0,"Cannot skip a negative number of bytes."),(0,n.assert)(e%t==0,"Length must be a multiple of the size."),r+=e},i=e.subarray(r);yield{skip:s,value:i}}return{skip:()=>undefined,value:new Uint8Array}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/iterator.js"}],[1761,{"./errors":1758,"./iterator":1760,"./parsers":1768,"./utils":1776,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.unpack=r.pack=r.isDynamicParser=r.getParser=void 0;const n=e("@metamask/utils"),s=e("./errors"),i=e("./iterator"),a=e("./parsers"),o=e("./utils");r.getParser=e=>{const t={address:a.address,array:a.array,bool:a.bool,bytes:a.bytes,fixedBytes:a.fixedBytes,function:a.fn,number:a.number,string:a.string,tuple:a.tuple},r=t[e];if(r)return r;const n=Object.values(t).find((t=>t.isType(e)));if(n)return n;throw new s.ParserError(`The type "${e}" is not supported.`)};r.isDynamicParser=(e,t)=>{const{isDynamic:r}=e;return"function"==typeof r?r(t):r};r.pack=({types:e,values:t,packed:i=!1,tight:a=!1,arrayPacked:c=!1,byteArray:l=new Uint8Array})=>{(0,n.assert)(e.length===t.length,new s.ParserError(`The number of types (${e.length}) does not match the number of values (${t.length}).`));const{staticBuffer:u,dynamicBuffer:d,pointers:h}=e.reduce((({staticBuffer:e,dynamicBuffer:s,pointers:o},l,u)=>{const d=(0,r.getParser)(l),h=t[u];if(i||c||!(0,r.isDynamicParser)(d,l))return{staticBuffer:d.encode({buffer:e,value:h,type:l,packed:i,tight:a}),dynamicBuffer:s,pointers:o};return{staticBuffer:(0,n.concatBytes)([e,new Uint8Array(32)]),dynamicBuffer:d.encode({buffer:s,value:h,type:l,packed:i,tight:a}),pointers:[...o,{position:e.length,pointer:s.length}]}}),{staticBuffer:new Uint8Array,dynamicBuffer:new Uint8Array,pointers:[]});(0,n.assert)(!i&&!c||0===d.length,new s.ParserError("Invalid pack state."));const p=u.length,m=h.reduce(((e,{pointer:t,position:r})=>{const s=(0,o.padStart)((0,n.numberToBytes)(p+t));return(0,o.set)(e,s,r)}),u);return(0,n.concatBytes)([l,m,d])};r.unpack=(e,t)=>{const a=(0,i.iterate)(t);return e.map((e=>{const{value:{value:i,skip:o},done:c}=a.next();(0,n.assert)(!c,new s.ParserError(`The encoded value is invalid for the provided types. Reached end of buffer while attempting to parse "${e}".`));const l=(0,r.getParser)(e);if((0,r.isDynamicParser)(l,e)){const r=(0,n.bytesToNumber)(i.subarray(0,32)),s=t.subarray(r);return l.decode({type:e,value:s,skip:o})}return l.decode({type:e,value:i,skip:o})}))}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/packer.js"}],[1762,{"../errors":1758,"../utils":1776,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.address=r.getAddress=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../utils");r.getAddress=e=>{const t=(0,n.createBytes)(e);return(0,n.assert)(t.length<=20,new s.ParserError(`Invalid address value. Expected address to be 20 bytes long, but received ${t.length} bytes.`)),(0,i.padStart)(t,20)},r.address={isDynamic:!1,isType:e=>"address"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:s}){const a=(0,r.getAddress)(t);if(s)return(0,n.concatBytes)([e,a]);const o=(0,i.padStart)(a);return(0,n.concatBytes)([e,o])},decode:({value:e})=>(0,n.add0x)((0,n.bytesToHex)(e.slice(12,32)))}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/address.js"}],[1763,{"../errors":1758,"../packer":1761,"../utils":1776,"./fixed-bytes":1766,"./tuple":1772,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.array=r.getTupleType=r.getArrayType=r.isArrayType=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../packer"),a=e("../utils"),o=e("./fixed-bytes"),c=e("./tuple"),l=/^(?<type>.*)\[(?<length>\d*?)\]$/u;r.isArrayType=e=>l.test(e);r.getArrayType=e=>{const t=e.match(l);return(0,n.assert)(t?.groups?.type,new s.ParserError(`Invalid array type. Expected an array type, but received "${e}".`)),[t.groups.type,t.groups.length?parseInt(t.groups.length,10):undefined]};r.getTupleType=(e,t)=>`(${new Array(t).fill(e).join(",")})`,r.array={isDynamic(e){const[t,n]=(0,r.getArrayType)(e);return n===undefined||(0,i.isDynamicParser)((0,i.getParser)(t),t)},isType:e=>(0,r.isArrayType)(e),getByteLength(e){(0,n.assert)((0,r.isArrayType)(e),new s.ParserError(`Expected an array type, but received "${e}".`));const[t,a]=(0,r.getArrayType)(e);return(0,i.isDynamicParser)(this,e)||a===undefined?32:c.tuple.getByteLength((0,r.getTupleType)(t,a))},encode({type:e,buffer:t,value:l,packed:u,tight:d}){const[h,p]=(0,r.getArrayType)(e);if((0,n.assert)(!u||!(0,r.isArrayType)(h),new s.ParserError("Cannot pack nested arrays.")),u&&(0,i.isDynamicParser)((0,i.getParser)(h),h))return(0,i.pack)({types:new Array(l.length).fill(h),values:l,byteArray:t,packed:u,arrayPacked:!0,tight:d});if(p)return(0,n.assert)(p===l.length,new s.ParserError(`Array length does not match type length. Expected a length of ${p}, but received ${l.length}.`)),c.tuple.encode({type:(0,r.getTupleType)(h,p),buffer:t,value:l,packed:o.fixedBytes.isType(h)&&d,tight:d});if(u)return(0,i.pack)({types:new Array(l.length).fill(h),values:l,byteArray:t,packed:o.fixedBytes.isType(h)&&d,arrayPacked:!0,tight:d});const m=(0,a.padStart)((0,n.numberToBytes)(l.length));return(0,i.pack)({types:new Array(l.length).fill(h),values:l,byteArray:(0,n.concatBytes)([t,m]),packed:u,tight:d})},decode({type:e,value:t,...a}){const[o,l]=(0,r.getArrayType)(e);if(l){const e=c.tuple.decode({type:(0,r.getTupleType)(o,l),value:t,...a});return(0,n.assert)(e.length===l,new s.ParserError(`Array length does not match type length. Expected a length of ${l}, but received ${e.length}.`)),e}const u=(0,n.bytesToNumber)(t.subarray(0,32));return(0,i.unpack)(new Array(u).fill(o),t.subarray(32))}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/array.js"}],[1764,{"../errors":1758,"./number":1769,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.bool=r.getBooleanValue=void 0;const n=e("@metamask/superstruct"),s=e("@metamask/utils"),i=e("../errors"),a=e("./number"),o=(0,n.coerce)((0,n.boolean)(),(0,n.union)([(0,n.literal)("true"),(0,n.literal)("false")]),(e=>"true"===e));r.getBooleanValue=e=>{try{return(0,n.create)(e,o)?BigInt(1):BigInt(0)}catch{throw new i.ParserError(`Invalid boolean value. Expected a boolean literal, or the string "true" or "false", but received "${e}".`)}},r.bool={isDynamic:!1,isType:e=>"bool"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:n,tight:i}){const o=(0,r.getBooleanValue)(t);return n?(0,s.concatBytes)([e,(0,s.bigIntToBytes)(o)]):a.number.encode({type:"uint256",buffer:e,value:o,packed:n,tight:i})},decode:e=>a.number.decode({...e,type:"uint256"})===BigInt(1)}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/bool.js"}],[1765,{"../utils":1776,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.bytes=void 0;const n=e("@metamask/utils"),s=e("../utils");r.bytes={isDynamic:!0,isType:e=>"bytes"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:r}){const i=(0,n.createBytes)(t);if(r)return(0,n.concatBytes)([e,i]);const a=32*Math.ceil(i.byteLength/32);return(0,n.concatBytes)([e,(0,s.padStart)((0,n.numberToBytes)(i.byteLength)),(0,s.padEnd)(i,a)])},decode({value:e}){const t=e.subarray(0,32),r=(0,n.bytesToNumber)(t);return e.slice(32,32+r)}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/bytes.js"}],[1766,{"../errors":1758,"../utils":1776,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.fixedBytes=r.getByteLength=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../utils"),a=/^bytes([0-9]{1,2})$/u;r.getByteLength=e=>{const t=e.match(a)?.[1];(0,n.assert)(t,`Invalid byte length. Expected a number between 1 and 32, but received "${e}".`);const r=Number(t);return(0,n.assert)(r>0&&r<=32,new s.ParserError(`Invalid byte length. Expected a number between 1 and 32, but received "${e}".`)),r},r.fixedBytes={isDynamic:!1,isType:e=>a.test(e),getByteLength:()=>32,encode({type:e,buffer:t,value:a,packed:o}){const c=(0,r.getByteLength)(e),l=(0,n.createBytes)(a);return(0,n.assert)(l.length<=c,new s.ParserError(`Expected a value of length ${c}, but received a value of length ${l.length}.`)),o?(0,n.concatBytes)([t,(0,i.padEnd)(l,c)]):(0,n.concatBytes)([t,(0,i.padEnd)(l)])},decode({type:e,value:t}){const n=(0,r.getByteLength)(e);return t.slice(0,n)}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/fixed-bytes.js"}],[1767,{"../errors":1758,"./fixed-bytes":1766,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.fn=r.getFunction=void 0;const n=e("@metamask/superstruct"),s=e("@metamask/utils"),i=e("../errors"),a=e("./fixed-bytes"),o=(0,n.coerce)((0,n.object)({address:s.StrictHexStruct,selector:s.StrictHexStruct}),(0,n.union)([s.StrictHexStruct,(0,n.instance)(Uint8Array)]),(e=>{const t=(0,s.createBytes)(e);return(0,s.assert)(24===t.length,new i.ParserError(`Invalid Solidity function. Expected function to be 24 bytes long, but received ${t.length} bytes.`)),{address:(0,s.bytesToHex)(t.subarray(0,20)),selector:(0,s.bytesToHex)(t.subarray(20,24))}}));r.getFunction=e=>{const t=(0,n.create)(e,o);return(0,s.concatBytes)([(0,s.hexToBytes)(t.address),(0,s.hexToBytes)(t.selector)])},r.fn={isDynamic:!1,isType:e=>"function"===e,getByteLength:()=>32,encode({buffer:e,value:t,packed:n,tight:s}){const i=(0,r.getFunction)(t);return a.fixedBytes.encode({type:"bytes24",buffer:e,value:i,packed:n,tight:s})},decode:({value:e})=>({address:(0,s.bytesToHex)(e.slice(0,20)),selector:(0,s.bytesToHex)(e.slice(20,24))})}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/function.js"}],[1768,{"./address":1762,"./array":1763,"./bool":1764,"./bytes":1765,"./fixed-bytes":1766,"./function":1767,"./number":1769,"./parser":1770,"./string":1771,"./tuple":1772},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./address"),r),s(e("./array"),r),s(e("./bool"),r),s(e("./bytes"),r),s(e("./fixed-bytes"),r),s(e("./function"),r),s(e("./number"),r),s(e("./parser"),r),s(e("./string"),r),s(e("./tuple"),r)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/index.js"}],[1769,{"../errors":1758,"../utils":1776,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.number=r.getBigInt=r.assertNumberLength=r.getLength=r.isSigned=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../utils"),a=/^u?int(?<length>[0-9]*)?$/u;r.isSigned=e=>!e.startsWith("u");r.getLength=e=>{if("int"===e||"uint"===e)return 256;const t=e.match(a);(0,n.assert)(t?.groups?.length,new s.ParserError(`Invalid number type. Expected a number type, but received "${e}".`));const r=parseInt(t.groups.length,10);return(0,n.assert)(r>=8&&r<=256,new s.ParserError(`Invalid number length. Expected a number between 8 and 256, but received "${e}".`)),(0,n.assert)(r%8==0,new s.ParserError(`Invalid number length. Expected a multiple of 8, but received "${e}".`)),r};r.assertNumberLength=(e,t)=>{const i=(0,r.getLength)(t),a=BigInt(2)**BigInt(i-((0,r.isSigned)(t)?1:0))-BigInt(1);(0,r.isSigned)(t)?(0,n.assert)(e>=-(a+BigInt(1))&&e<=a,new s.ParserError(`Number "${e}" is out of range for type "${t}".`)):(0,n.assert)(e<=a,new s.ParserError(`Number "${e}" is out of range for type "${t}".`))};r.getBigInt=e=>{try{return(0,n.createBigInt)(e)}catch{throw new s.ParserError(`Invalid number. Expected a valid number value, but received "${e}".`)}},r.number={isDynamic:!1,isType:e=>a.test(e),getByteLength:()=>32,encode({type:e,buffer:t,value:s,packed:a}){const o=(0,r.getBigInt)(s);if((0,r.assertNumberLength)(o,e),(0,r.isSigned)(e)){if(a){const s=(0,r.getLength)(e)/8;return(0,n.concatBytes)([t,(0,n.signedBigIntToBytes)(o,s)])}return(0,n.concatBytes)([t,(0,i.padStart)((0,n.signedBigIntToBytes)(o,32))])}if(a){const s=(0,r.getLength)(e)/8;return(0,n.concatBytes)([t,(0,i.padStart)((0,n.bigIntToBytes)(o),s)])}return(0,n.concatBytes)([t,(0,i.padStart)((0,n.bigIntToBytes)(o))])},decode({type:e,value:t}){const s=t.subarray(0,32);if((0,r.isSigned)(e)){const t=(0,n.bytesToSignedBigInt)(s);return(0,r.assertNumberLength)(t,e),t}const i=(0,n.bytesToBigInt)(s);return(0,r.assertNumberLength)(i,e),i}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/number.js"}],[177,{"../../../../../shared/types/transaction-decode":5737,"./four-byte":172,"./proxy":173,"./sourcify":174,"./uniswap":176,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTransactionData=async function({transactionData:e,contractAddress:t,chainId:r,provider:n}){l("Decoding transaction data",{transactionData:e,contractAddress:t,chainId:r});const d=(0,i.decodeUniswapRouterTransactionData)({transactionData:e,contractAddress:t,chainId:r});if(d)return l("Decoded with Uniswap commands",d),{data:u(d),source:s.DecodedTransactionDataSource.Uniswap};const h=await(0,o.getContractProxyAddress)(t,n);h&&l("Retrieved proxy implementation address",h);const p=h??t,m=(0,a.decodeTransactionDataWithSourcify)(e,p,r),g=(0,c.decodeTransactionDataWithFourByte)(e),[f,y]=await Promise.allSettled([m,g]);if("fulfilled"===f.status&&f.value)return l("Decoded data with Sourcify",f.value),{data:u([f.value]),source:s.DecodedTransactionDataSource.Sourcify};if(l("Failed to decode data with Sourcify",f),"fulfilled"===y.status&&y.value)return l("Decoded data with 4Byte",y.value),{data:u([y.value]),source:s.DecodedTransactionDataSource.FourByte};return l("Failed to decode data with 4Byte",y),undefined};var n=e("@metamask/utils"),s=e("../../../../../shared/types/transaction-decode"),i=e("./uniswap"),a=e("./sourcify"),o=e("./proxy"),c=e("./four-byte");const l=(0,n.createProjectLogger)("transaction-decode");function u(e){return e.map((e=>function(e){return{...e,params:e.params.map((e=>d(e)))}}(e)))}function d(e){var t;return{...e,value:h(e.value),children:null===(t=e.children)||void 0===t?void 0:t.map((e=>d(e)))}}function h(e){const t=e._hex;return t?parseInt(t,16):e}}}},{package:"$root$",file:"app/scripts/lib/transaction/decode/util.ts"}],[1770,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/parser.js"}],[1771,{"./bytes":1765,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.string=void 0;const n=e("@metamask/utils"),s=e("./bytes");r.string={isDynamic:!0,isType:e=>"string"===e,getByteLength:()=>32,encode:({buffer:e,value:t,packed:r,tight:i})=>s.bytes.encode({type:"bytes",buffer:e,value:(0,n.stringToBytes)(t),packed:r,tight:i}),decode:e=>(0,n.bytesToString)(s.bytes.decode(e))}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/string.js"}],[1772,{"../errors":1758,"../packer":1761,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.tuple=r.getTupleElements=void 0;const n=e("@metamask/utils"),s=e("../errors"),i=e("../packer"),a=/^\((.+)\)$/u;r.getTupleElements=e=>{(0,n.assert)(e.startsWith("(")&&e.endsWith(")"),new s.ParserError(`Invalid tuple type. Expected tuple type, but received "${e}".`));const t=[];let r="",i=0;for(let n=1;n<e.length-1;n++){const s=e[n];","===s&&0===i?(t.push(r.trim()),r=""):(r+=s,"("===s?i+=1:")"===s&&(i-=1))}return r.trim()&&t.push(r.trim()),t},r.tuple={isDynamic:e=>(0,r.getTupleElements)(e).some((e=>{const t=(0,i.getParser)(e);return(0,i.isDynamicParser)(t,e)})),isType:e=>(e=>a.test(e))(e),getByteLength(e){if((0,i.isDynamicParser)(this,e))return 32;return(0,r.getTupleElements)(e).reduce(((e,t)=>e+(0,i.getParser)(t).getByteLength(t)),0)},encode({type:e,buffer:t,value:n,packed:s,tight:a}){const o=(0,r.getTupleElements)(e);return(0,i.pack)({types:o,values:n,byteArray:t,packed:s,tight:a})},decode({type:e,value:t,skip:n}){const s=(0,r.getTupleElements)(e);return n(this.getByteLength(e)-32),(0,i.unpack)(s,t)}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/parsers/tuple.js"}],[1773,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/types/abi.js"}],[1774,{"./abi":1773},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./abi"),r)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/types/index.js"}],[1775,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.padEnd=r.padStart=r.set=void 0;const n=e("@metamask/utils");r.set=(e,t,r)=>(0,n.concatBytes)([e.subarray(0,r),t,e.subarray(r+t.length)]);r.padStart=(e,t=32)=>{const r=new Uint8Array(Math.max(t-e.length,0)).fill(0);return(0,n.concatBytes)([r,e])};r.padEnd=(e,t=32)=>{const r=new Uint8Array(Math.max(t-e.length,0)).fill(0);return(0,n.concatBytes)([e,r])}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/utils/buffer.js"}],[1776,{"./buffer":1775},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./buffer"),r)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@metamask/abi-utils",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/abi-utils/dist/utils/index.js"}],[1777,{"./utils":1782,"@scure/base":2951,buffer:3998,tweetnacl:5540},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(r,"__esModule",{value:!0}),r.getEncryptionPublicKey=r.decryptSafely=r.decrypt=r.encryptSafely=r.encrypt=void 0;const a=e("@scure/base"),o=i(e("tweetnacl")),c=e("./utils");function l({publicKey:e,data:t,version:r}){if((0,c.isNullish)(e))throw new Error("Missing publicKey parameter");if((0,c.isNullish)(t))throw new Error("Missing data parameter");if((0,c.isNullish)(r))throw new Error("Missing version parameter");if("x25519-xsalsa20-poly1305"===r){if("string"!=typeof t)throw new Error("Message data must be given as a string");const r=o.box.keyPair();let n;try{n=a.base64.decode(e)}catch(e){throw new Error("Bad public key")}const s=a.utf8.decode(t),i=o.randomBytes(o.box.nonceLength),c=o.box(s,i,n,r.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:a.base64.encode(i),ephemPublicKey:a.base64.encode(r.publicKey),ciphertext:a.base64.encode(c)}}throw new Error("Encryption type/version not supported")}function u({encryptedData:e,privateKey:r}){if((0,c.isNullish)(e))throw new Error("Missing encryptedData parameter");if((0,c.isNullish)(r))throw new Error("Missing privateKey parameter");if("x25519-xsalsa20-poly1305"===e.version){const n=t.from(r,"hex"),s=o.box.keyPair.fromSecretKey(n).secretKey,i=a.base64.decode(e.nonce),c=a.base64.decode(e.ciphertext),l=a.base64.decode(e.ephemPublicKey),u=o.box.open(c,i,l,s);try{if(!u)throw new Error;const e=a.utf8.encode(u);if(!e)throw new Error;return e}catch(e){if(e&&"string"==typeof e.message&&e.message.length)throw new Error(`Decryption failed: ${e.message}`);throw new Error("Decryption failed.")}}throw new Error("Encryption type/version not supported.")}r.encrypt=l,r.encryptSafely=function({publicKey:e,data:r,version:n}){if((0,c.isNullish)(e))throw new Error("Missing publicKey parameter");if((0,c.isNullish)(r))throw new Error("Missing data parameter");if((0,c.isNullish)(n))throw new Error("Missing version parameter");if("object"==typeof r&&r&&"toJSON"in r)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");const s={data:r,padding:""},i=t.byteLength(JSON.stringify(s),"utf-8")%2048;let a=0;return i>0&&(a=2048-i-16),s.padding="0".repeat(a),l({publicKey:e,data:JSON.stringify(s),version:n})},r.decrypt=u,r.decryptSafely=function({encryptedData:e,privateKey:t}){if((0,c.isNullish)(e))throw new Error("Missing encryptedData parameter");if((0,c.isNullish)(t))throw new Error("Missing privateKey parameter");return JSON.parse(u({encryptedData:e,privateKey:t})).data},r.getEncryptionPublicKey=function(e){const r=t.from(e,"hex"),n=o.box.keyPair.fromSecretKey(r).publicKey;return a.base64.encode(n)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/dist/encryption.js"}],[1778,{"./encryption":1777,"./personal-sign":1779,"./sign-eip7702-authorization":1780,"./sign-typed-data":1781,"./utils":1782},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=r.concatSig=void 0,s(e("./personal-sign"),r),s(e("./sign-typed-data"),r),s(e("./encryption"),r),s(e("./sign-eip7702-authorization"),r);var i=e("./utils");Object.defineProperty(r,"concatSig",{enumerable:!0,get:function(){return i.concatSig}}),Object.defineProperty(r,"normalize",{enumerable:!0,get:function(){return i.normalize}})}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/dist/index.js"}],[1779,{"./utils":1782,"@ethereumjs/util":1790},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.extractPublicKey=r.recoverPersonalSignature=r.personalSign=void 0;const n=e("@ethereumjs/util"),s=e("./utils");function i(e,t){const r=(0,n.hashPersonalMessage)((0,s.legacyToBuffer)(e));return(0,s.recoverPublicKey)(r,t)}r.personalSign=function({privateKey:e,data:t}){if((0,s.isNullish)(t))throw new Error("Missing data parameter");if((0,s.isNullish)(e))throw new Error("Missing privateKey parameter");const r=(0,s.legacyToBuffer)(t),i=(0,n.hashPersonalMessage)(r),a=(0,n.ecsign)(i,e);return(0,s.concatSig)((0,n.toBuffer)(a.v),a.r,a.s)},r.recoverPersonalSignature=function({data:e,signature:t}){if((0,s.isNullish)(e))throw new Error("Missing data parameter");if((0,s.isNullish)(t))throw new Error("Missing signature parameter");const r=i(e,t),a=(0,n.publicToAddress)(r);return(0,n.bufferToHex)(a)},r.extractPublicKey=function({data:e,signature:t}){if((0,s.isNullish)(e))throw new Error("Missing data parameter");if((0,s.isNullish)(t))throw new Error("Missing signature parameter");return`0x${i(e,t).toString("hex")}`}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/dist/personal-sign.js"}],[178,{"../ppom/ppom-util":132,"@metamask/eth-json-rpc-middleware":1478,"@metamask/rpc-errors":2484,"@metamask/transaction-controller":2829},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getCallsStatus=function(e,t){const r=e.call("TransactionController:getState").transactions.filter((e=>e.batchId===t));if(null==r||!r.length)throw n.rpcErrors.invalidInput("No matching calls found");const a=r[0],{chainId:o,txReceipt:l}=a,u=function(e){const{hash:t,status:r}=e;if(r===s.TransactionStatus.confirmed)return i.GetCallsStatusCode.CONFIRMED;if(r===s.TransactionStatus.failed)return t?i.GetCallsStatusCode.REVERTED:i.GetCallsStatusCode.FAILED_OFFCHAIN;if(r===s.TransactionStatus.dropped)return i.GetCallsStatusCode.REVERTED;return i.GetCallsStatusCode.PENDING}(a),d=l,h=(null==d?void 0:d.logs)??[],p=d&&[{blockHash:d.blockHash,blockNumber:d.blockNumber,gasUsed:d.gasUsed,logs:h.map((e=>({address:e.address,data:e.data,topics:e.topics}))),status:d.status,transactionHash:d.transactionHash}];return{version:c,id:t,chainId:o,status:u,receipts:p}},r.getCapabilities=async function(e,t){return{}},r.processSendCalls=async function(e,t,r,s){const{addTransactionBatch:i,getDisabledAccountUpgradeChains:c,validateSecurity:l}=e,{calls:u,from:d}=r,{networkClientId:h,origin:p}=s,m=u.map((e=>({params:e}))),g=t.call("NetworkController:getNetworkClientById",h).configuration.chainId,f=c();!function(e,t,r){(function(e){const{version:t}=e;if(t!==o)throw n.rpcErrors.invalidInput(`Version not supported: Got ${t}, expected ${o}`)})(e),function(e,t){const{chainId:r}=e;if(r&&r.toLowerCase()!==t.toLowerCase())throw n.rpcErrors.invalidInput(`Chain ID must match the dApp selected network: Got ${r}, expected ${t}`)}(e,t),function(e){const{calls:t,capabilities:r}=e,s=Object.keys(r??{}).filter((e=>!0!==(null==r?void 0:r[e].optional))),i=t.flatMap((e=>Object.keys(e.capabilities??{}).filter((t=>{var r;return!0!==(null===(r=e.capabilities)||void 0===r?void 0:r[t].optional)})))),a=[...s,...i];if(null!=a&&a.length)throw n.rpcErrors.invalidInput(`Unsupported non-optional capabilities: ${a.join(", ")}`)}(e),function(e,t,r){const{from:s}=e,i=t.includes(r);if(i)throw n.rpcErrors.methodNotSupported(`EIP-5792 is not supported for this chain and account - Chain ID: ${r}, Account: ${s}`)}(e,r,t)}(r,g,f);const y=(0,a.generateSecurityAlertId)(),b=l.bind(null,y),{batchId:v}=await i({from:d,networkClientId:h,origin:p,securityAlertId:y,transactions:m,validateSecurity:b});return{id:v}};var n=e("@metamask/rpc-errors"),s=e("@metamask/transaction-controller"),i=e("@metamask/eth-json-rpc-middleware"),a=e("../ppom/ppom-util");const o="1.0",c="1.0"}}},{package:"$root$",file:"app/scripts/lib/transaction/eip5792.ts"}],[1780,{"./utils":1782,"@ethereumjs/rlp":421,"@ethereumjs/util":1790,"@metamask/utils":2874,buffer:3998,"ethereum-cryptography/keccak":4224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashEIP7702Authorization=r.recoverEIP7702Authorization=r.signEIP7702Authorization=void 0;const n=e("@ethereumjs/rlp"),s=e("@ethereumjs/util"),i=e("@metamask/utils"),a=e("ethereum-cryptography/keccak"),o=e("./utils");function c(e){l(e);const r=(0,n.encode)(e),s=t.concat([t.from("05","hex"),r]);return t.from((0,a.keccak256)(s))}function l(e){if((0,o.isNullish)(e))throw new Error("Missing authorization parameter");const[t,r,n]=e;if((0,o.isNullish)(t))throw new Error("Missing chainId parameter");if((0,o.isNullish)(r))throw new Error("Missing contractAddress parameter");if((0,o.isNullish)(n))throw new Error("Missing nonce parameter")}r.signEIP7702Authorization=function({privateKey:e,authorization:t}){if(l(t),(0,o.isNullish)(e))throw new Error("Missing privateKey parameter");const r=c(t),{r:n,s:i,v:a}=(0,s.ecsign)(r,e),u=(0,s.toBuffer)(a);return(0,o.concatSig)(u,n,i)},r.recoverEIP7702Authorization=function({signature:e,authorization:t}){if(l(t),(0,o.isNullish)(e))throw new Error("Missing signature parameter");const r=c(t),n=(0,o.recoverPublicKey)(r,e),a=(0,s.publicToAddress)(n);return(0,i.bytesToHex)(a)},r.hashEIP7702Authorization=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/dist/sign-eip7702-authorization.js"}],[1781,{"./utils":1782,"@ethereumjs/util":1790,"@metamask/abi-utils":1759,"@metamask/abi-utils/dist/parsers":1768,"@metamask/abi-utils/dist/utils":1776,"@metamask/utils":2874,"ethereum-cryptography/keccak":4224},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.recoverTypedSignature=r.signTypedData=r.typedSignatureHash=r.TypedDataUtils=r.TYPED_MESSAGE_SCHEMA=r.SignTypedDataVersion=void 0;const n=e("@ethereumjs/util"),s=e("@metamask/abi-utils"),i=e("@metamask/abi-utils/dist/parsers"),a=e("@metamask/abi-utils/dist/utils"),o=e("@metamask/utils"),c=e("ethereum-cryptography/keccak"),l=e("./utils");var u;function d(e,t){if(!Object.keys(u).includes(e))throw new Error(`Invalid version: '${e}'`);if(t&&!t.includes(e))throw new Error(`SignTypedDataVersion not allowed: '${e}'. Allowed versions are: ${t.join(", ")}`)}function h(e,t){(0,o.assert)(null!==t,`Unable to encode value: Invalid number. Expected a valid number value, but received "${t}".`);const r=BigInt(t),n=(0,i.getLength)(e),s=BigInt(2)**BigInt(n)-BigInt(1);return(0,o.assert)(r>=-s&&r<=s,`Unable to encode value: Number "${t}" is out of range for type "${e}".`),r}function p(e){let t=BigInt(0);for(let r=0;r<e.length;r++){const n=BigInt(e.charCodeAt(r)-48);t*=BigInt(10),t+=n>=49?n-BigInt(49)+BigInt(10):n>=17?n-BigInt(17)+BigInt(10):n}return(0,a.padStart)((0,o.bigIntToBytes)(t),20)}function m(e,t,r,i,l){if(d(l,[u.V3,u.V4]),e[r]!==undefined)return["bytes32",l===u.V4&&null==i?"0x0000000000000000000000000000000000000000000000000000000000000000":(0,n.arrToBufArr)((0,c.keccak256)(g(r,i,e,l)))];if("function"===r)throw new Error('Unsupported or invalid type: "function"');if(i===undefined)throw new Error(`missing value for field ${t} of type ${r}`);if("address"===r){if("number"==typeof i)return["address",(0,a.padStart)((0,o.numberToBytes)(i),20)];if((0,o.isStrictHexString)(i))return["address",(0,o.add0x)(i)];if("string"==typeof i)return["address",p(i).subarray(0,20)]}if("bool"===r)return["bool",Boolean(i)];if("bytes"===r)return"number"==typeof i?i=(0,o.numberToBytes)(i):(0,o.isStrictHexString)(i)||"0x"===i?i=(0,o.hexToBytes)(i):"string"==typeof i&&(i=(0,o.stringToBytes)(i)),["bytes32",(0,n.arrToBufArr)((0,c.keccak256)(i))];if(r.startsWith("bytes")&&"bytes"!==r&&!r.includes("["))return"number"==typeof i?i<0?["bytes32",new Uint8Array(32)]:["bytes32",(0,o.bigIntToBytes)(BigInt(i))]:(0,o.isStrictHexString)(i)?["bytes32",(0,o.hexToBytes)(i)]:["bytes32",i];if(r.startsWith("int")&&!r.includes("[")){const e=h(r,i);return e>=BigInt(0)?["uint256",e]:["int256",e]}if("string"===r)return i="number"==typeof i?(0,o.numberToBytes)(i):(0,o.stringToBytes)(null!=i?i:""),["bytes32",(0,n.arrToBufArr)((0,c.keccak256)(i))];if(r.endsWith("]")){if(l===u.V3)throw new Error("Arrays are unimplemented in encodeData; use V4 extension");const a=r.slice(0,r.lastIndexOf("[")),o=i.map((r=>m(e,t,a,r,l)));return["bytes32",(0,n.arrToBufArr)((0,c.keccak256)((0,s.encode)(o.map((([e])=>e)),o.map((([,e])=>e)))))]}return[r,i]}function g(e,t,r,i){d(i,[u.V3,u.V4]);const a=["bytes32"],o=[v(e,r)];for(const n of r[e]){if(i===u.V3&&t[n.name]===undefined)continue;const[e,s]=m(r,n.name,n.type,t[n.name],i);a.push(e),o.push(s)}return(0,n.arrToBufArr)((0,s.encode)(a,o))}function f(e,t){let r="";const n=y(e,t);n.delete(e);const s=[e,...Array.from(n).sort()];for(const e of s){if(!t[e])throw new Error(`No type definition specified: ${e}`);r+=`${e}(${t[e].map((({name:e,type:t})=>`${t} ${e}`)).join(",")})`}return r}function y(e,t,r=new Set){if("string"!=typeof e)throw new Error(`Invalid findTypeDependencies input ${JSON.stringify(e)}`);const n=e.match(/^\w*/u);if([e]=n,r.has(e)||t[e]===undefined)return r;r.add(e);for(const n of t[e])y(n.type,t,r);return r}function b(e,t,r,s){d(s,[u.V3,u.V4]);const i=g(e,t,r,s),a=(0,c.keccak256)(i);return(0,n.arrToBufArr)(a)}function v(e,t){const r=(0,o.stringToBytes)(f(e,t));return(0,n.arrToBufArr)((0,c.keccak256)(r))}function w(e){const t={};for(const n in r.TYPED_MESSAGE_SCHEMA.properties)e[n]&&(t[n]=e[n]);return"types"in t&&(t.types=Object.assign({EIP712Domain:[]},t.types)),t}function k(e,t){d(t,[u.V3,u.V4]);const r=w(e),{domain:n}=r;return b("EIP712Domain",n,{EIP712Domain:r.types.EIP712Domain},t)}function C(e,t){if((0,i.isArrayType)(e)&&Array.isArray(t)){const[r]=(0,i.getArrayType)(e);return t.map((e=>C(r,e)))}if("address"===e){if((0,o.isStrictHexString)(t))return(0,a.padStart)((0,o.hexToBytes)(t).subarray(0,20),20);if(t instanceof Uint8Array)return(0,a.padStart)(t.subarray(0,20),20)}if("bool"===e)return Boolean(t);if(e.startsWith("bytes")&&"bytes"!==e){const r=(0,i.getByteLength)(e);if("number"==typeof t)return t<0?new Uint8Array:(0,o.numberToBytes)(t).subarray(0,r);if((0,o.isStrictHexString)(t))return(0,o.hexToBytes)(t).subarray(0,r);if(t instanceof Uint8Array)return t.subarray(0,r)}if(e.startsWith("uint")&&"number"==typeof t)return Math.abs(t);if(e.startsWith("int")&&"number"==typeof t){const r=(0,i.getLength)(e);return BigInt.asIntN(r,BigInt(t))}return t}function T(e,t){return t.map((t=>{if("string"==typeof t||"number"==typeof t||"bigint"==typeof t){const r=h(e,t);if(r>=BigInt(0))return(0,a.padStart)((0,o.bigIntToBytes)(r),32);const n=(0,i.getLength)(e),s=BigInt.asIntN(n,r);return(0,o.signedBigIntToBytes)(s,32)}return t}))}function _(e){const t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!("length"in e)||!e.length)throw t;const r=e.map((({name:e,type:t,value:r})=>{if("address[]"===t)return{name:e,type:"bytes32[]",value:(n=r,n.map((e=>"number"==typeof e?(0,a.padStart)((0,o.numberToBytes)(e),32):(0,o.isStrictHexString)(e)?(0,a.padStart)((0,o.hexToBytes)(e).subarray(0,32),32):e instanceof Uint8Array?(0,a.padStart)(e.subarray(0,32),32):e)))};var n;if(t.startsWith("int")&&(0,i.isArrayType)(t)){const[n,s]=(0,i.getArrayType)(t);return{name:e,type:`bytes32[${null!=s?s:""}]`,value:T(n,r)}}return{name:e,type:t,value:C(t,r)}})),u=r.map((e=>"bytes"!==e.type?e.value:(0,l.legacyToBuffer)(e.value))),d=r.map((e=>{if("function"===e.type)throw new Error('Unsupported or invalid type: "function"');return e.type})),h=e.map((e=>{if(!e.name)throw t;return`${e.type} ${e.name}`}));return(0,n.arrToBufArr)((0,c.keccak256)((0,s.encodePacked)(["bytes32","bytes32"],[(0,c.keccak256)((0,s.encodePacked)(["string[]"],[h],!0)),(0,c.keccak256)((0,s.encodePacked)(d,u,!0))])))}!function(e){e.V1="V1",e.V3="V3",e.V4="V4"}(u=r.SignTypedDataVersion||(r.SignTypedDataVersion={})),r.TYPED_MESSAGE_SCHEMA={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},r.TypedDataUtils={encodeData:g,encodeType:f,findTypeDependencies:y,hashStruct:b,hashType:v,sanitizeData:w,eip712Hash:function(e,t){d(t,[u.V3,u.V4]);const r=w(e),s=[(0,o.hexToBytes)("1901")];return s.push(k(e,t)),"EIP712Domain"!==r.primaryType&&s.push(b(r.primaryType,r.message,r.types,t)),(0,n.arrToBufArr)((0,c.keccak256)((0,o.concatBytes)(s)))},eip712DomainHash:k},r.typedSignatureHash=function(e){const t=_(e);return(0,o.bytesToHex)(t)},r.signTypedData=function({privateKey:e,data:t,version:s}){if(d(s),(0,l.isNullish)(t))throw new Error("Missing data parameter");if((0,l.isNullish)(e))throw new Error("Missing private key parameter");const i=s===u.V1?_(t):r.TypedDataUtils.eip712Hash(t,s),a=(0,n.ecsign)(i,e);return(0,l.concatSig)((0,n.arrToBufArr)((0,o.bigIntToBytes)(a.v)),a.r,a.s)},r.recoverTypedSignature=function({data:e,signature:t,version:s}){if(d(s),(0,l.isNullish)(e))throw new Error("Missing data parameter");if((0,l.isNullish)(t))throw new Error("Missing signature parameter");const i=s===u.V1?_(e):r.TypedDataUtils.eip712Hash(e,s),a=(0,l.recoverPublicKey)(i,t),c=(0,n.publicToAddress)(a);return(0,o.bytesToHex)(c)}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/dist/sign-typed-data.js"}],[1782,{"@ethereumjs/util":1790,"@metamask/utils":2874,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.normalize=r.recoverPublicKey=r.concatSig=r.legacyToBuffer=r.isNullish=r.padWithZeroes=void 0;const n=e("@ethereumjs/util"),s=e("@metamask/utils");function i(e,t){if(""!==e&&!/^[a-f0-9]+$/iu.test(e))throw new Error(`Expected an unprefixed hex string. Received: ${e}`);if(t<0)throw new Error(`Expected a non-negative integer target length. Received: ${t}`);return String.prototype.padStart.call(e,t,"0")}function a(e){return null===e||e===undefined}r.padWithZeroes=i,r.isNullish=a,r.legacyToBuffer=function(e){return"string"!=typeof e||(0,n.isHexString)(e)?(0,n.toBuffer)(e):t.from(e)},r.concatSig=function(e,t,r){const a=(0,n.fromSigned)(t),o=(0,n.fromSigned)(r),c=(0,n.bufferToInt)(e),l=i((0,n.toUnsigned)(a).toString("hex"),64),u=i((0,n.toUnsigned)(o).toString("hex"),64),d=(0,s.remove0x)((0,s.numberToHex)(c));return(0,s.add0x)(l.concat(u,d))},r.recoverPublicKey=function(e,t){const r=(0,n.fromRpcSig)(t);return(0,n.ecrecover)(e,r.v,r.r,r.s)},r.normalize=function(e){if(a(e))return undefined;if("number"==typeof e){if(e<0)return"0x";const t=(0,s.numberToBytes)(e);e=(0,s.bytesToHex)(t)}if("string"!=typeof e){let t="eth-sig-util.normalize() requires hex string or integer input.";throw t+=` received ${typeof e}: ${e}`,new Error(t)}return(0,s.add0x)(e.toLowerCase())}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/dist/utils.js"}],[1783,{"./bytes":1786,"./constants":1787,"./helpers":1789,"./internal":1791,"@ethereumjs/rlp":421,buffer:3998,"ethereum-cryptography/keccak":4224,"ethereum-cryptography/secp256k1":4241,"ethereum-cryptography/utils":4243},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.accountBodyToRLP=r.accountBodyToSlim=r.accountBodyFromSlim=r.isZeroAddress=r.zeroAddress=r.importPublic=r.privateToAddress=r.privateToPublic=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isValidAddress=r.Account=void 0;const n=e("@ethereumjs/rlp"),s=e("ethereum-cryptography/keccak"),i=e("ethereum-cryptography/secp256k1"),a=e("ethereum-cryptography/utils"),o=e("./bytes"),c=e("./constants"),l=e("./helpers"),u=e("./internal"),d=BigInt(0);class h{constructor(e=d,t=d,r=c.KECCAK256_RLP,n=c.KECCAK256_NULL){this.nonce=e,this.balance=t,this.storageRoot=r,this.codeHash=n,this._validate()}static fromAccountData(e){const{nonce:t,balance:r,storageRoot:n,codeHash:s}=e;return new h(t!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(t)):undefined,r!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(r)):undefined,n!==undefined?(0,o.toBuffer)(n):undefined,s!==undefined?(0,o.toBuffer)(s):undefined)}static fromRlpSerializedAccount(e){const t=(0,o.arrToBufArr)(n.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(t))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(t)}static fromValuesArray(e){const[t,r,n,s]=e;return new h((0,o.bufferToBigInt)(t),(0,o.bufferToBigInt)(r),n,s)}_validate(){if(this.nonce<d)throw new Error("nonce must be greater than zero");if(this.balance<d)throw new Error("balance must be greater than zero");if(32!==this.storageRoot.length)throw new Error("storageRoot must have a length of 32");if(32!==this.codeHash.length)throw new Error("codeHash must have a length of 32")}raw(){return[(0,o.bigIntToUnpaddedBuffer)(this.nonce),(0,o.bigIntToUnpaddedBuffer)(this.balance),this.storageRoot,this.codeHash]}serialize(){return t.from(n.RLP.encode((0,o.bufArrToArr)(this.raw())))}isContract(){return!this.codeHash.equals(c.KECCAK256_NULL)}isEmpty(){return this.balance===d&&this.nonce===d&&this.codeHash.equals(c.KECCAK256_NULL)}}r.Account=h;r.isValidAddress=function(e){try{(0,l.assertIsString)(e)}catch(e){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};r.toChecksumAddress=function(e,r){(0,l.assertIsHexString)(e);const n=(0,u.stripHexPrefix)(e).toLowerCase();let i="";if(r!==undefined){i=(0,o.bufferToBigInt)((0,o.toBuffer)(r)).toString()+"0x"}const c=t.from(i+n,"utf8"),d=(0,a.bytesToHex)((0,s.keccak256)(c));let h="0x";for(let e=0;e<n.length;e++)parseInt(d[e],16)>=8?h+=n[e].toUpperCase():h+=n[e];return h};r.isValidChecksumAddress=function(e,t){return(0,r.isValidAddress)(e)&&(0,r.toChecksumAddress)(e,t)===e};r.generateAddress=function(e,r){return(0,l.assertIsBuffer)(e),(0,l.assertIsBuffer)(r),(0,o.bufferToBigInt)(r)===BigInt(0)?t.from((0,s.keccak256)(n.RLP.encode((0,o.bufArrToArr)([e,null])))).slice(-20):t.from((0,s.keccak256)(n.RLP.encode((0,o.bufArrToArr)([e,r])))).slice(-20)};r.generateAddress2=function(e,r,n){if((0,l.assertIsBuffer)(e),(0,l.assertIsBuffer)(r),(0,l.assertIsBuffer)(n),20!==e.length)throw new Error("Expected from to be of length 20");if(32!==r.length)throw new Error("Expected salt to be of length 32");const i=(0,s.keccak256)(t.concat([t.from("ff","hex"),e,r,(0,s.keccak256)(n)]));return(0,o.toBuffer)(i).slice(-20)};r.isValidPrivate=function(e){return i.secp256k1.utils.isValidPrivateKey(e)};r.isValidPublic=function(e,r=!1){if((0,l.assertIsBuffer)(e),64===e.length)try{return i.secp256k1.ProjectivePoint.fromHex(t.concat([t.from([4]),e])),!0}catch(e){return!1}if(!r)return!1;try{return i.secp256k1.ProjectivePoint.fromHex(e),!0}catch(e){return!1}};r.pubToAddress=function(e,r=!1){if((0,l.assertIsBuffer)(e),r&&64!==e.length&&(e=t.from(i.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),64!==e.length)throw new Error("Expected pubKey to be of length 64");return t.from((0,s.keccak256)(e)).slice(-20)},r.publicToAddress=r.pubToAddress;r.privateToPublic=function(e){return(0,l.assertIsBuffer)(e),t.from(i.secp256k1.ProjectivePoint.fromPrivateKey(e).toRawBytes(!1).slice(1))};r.privateToAddress=function(e){return(0,r.publicToAddress)((0,r.privateToPublic)(e))};r.importPublic=function(e){return(0,l.assertIsBuffer)(e),64!==e.length&&(e=t.from(i.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),e};r.zeroAddress=function(){const e=(0,o.zeros)(20);return(0,o.bufferToHex)(e)};function p(e){const[t,r,n,s]=e;return[t,r,0===(0,o.arrToBufArr)(n).length?c.KECCAK256_RLP:n,0===(0,o.arrToBufArr)(s).length?c.KECCAK256_NULL:s]}r.isZeroAddress=function(e){try{(0,l.assertIsString)(e)}catch(e){return!1}return(0,r.zeroAddress)()===e},r.accountBodyFromSlim=p;const m=new Uint8Array(0);r.accountBodyToSlim=function(e){const[t,r,n,s]=e;return[t,r,(0,o.arrToBufArr)(n).equals(c.KECCAK256_RLP)?m:n,(0,o.arrToBufArr)(s).equals(c.KECCAK256_NULL)?m:s]},r.accountBodyToRLP=function(e,t=!0){const r=t?p(e):e;return(0,o.arrToBufArr)(n.RLP.encode(r))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/account.js"}],[1784,{"./account":1783,"./bytes":1786,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Address=void 0;const n=e("./account"),s=e("./bytes");class i{constructor(e){if(20!==e.length)throw new Error("Invalid address length");this.buf=e}static zero(){return new i((0,s.zeros)(20))}static fromString(e){if(!(0,n.isValidAddress)(e))throw new Error("Invalid address");return new i((0,s.toBuffer)(e))}static fromPublicKey(e){if(!t.isBuffer(e))throw new Error("Public key should be Buffer");const r=(0,n.pubToAddress)(e);return new i(r)}static fromPrivateKey(e){if(!t.isBuffer(e))throw new Error("Private key should be Buffer");const r=(0,n.privateToAddress)(e);return new i(r)}static generate(e,t){if("bigint"!=typeof t)throw new Error("Expected nonce to be a bigint");return new i((0,n.generateAddress)(e.buf,(0,s.bigIntToBuffer)(t)))}static generate2(e,r,s){if(!t.isBuffer(r))throw new Error("Expected salt to be a Buffer");if(!t.isBuffer(s))throw new Error("Expected initCode to be a Buffer");return new i((0,n.generateAddress2)(e.buf,r,s))}equals(e){return this.buf.equals(e.buf)}isZero(){return this.equals(i.zero())}isPrecompileOrSystemAddress(){const e=(0,s.bufferToBigInt)(this.buf),t=BigInt(0),r=BigInt("0xffff");return e>=t&&e<=r}toString(){return"0x"+this.buf.toString("hex")}toBuffer(){return t.from(this.buf)}}r.Address=i}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/address.js"}],[1785,{events:4323},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncEventEmitter=void 0;const n=e("events");class s extends n.EventEmitter{emit(e,...t){let[r,n]=t;const s=this;let i=s._events[e]??[];return n===undefined&&"function"==typeof r&&(n=r,r=undefined),"newListener"!==e&&"removeListener"!==e||(r={event:r,fn:n},n=undefined),i=Array.isArray(i)?i:[i],async function(e,t,r){let n;for await(const s of t)try{s.length<2?s.call(e,r):await new Promise(((t,n)=>{s.call(e,r,(e=>{e?n(e):t()}))}))}catch(e){n=e}if(n)throw n}(s,i.slice(),r).then(n).catch(n),s.listenerCount(e)>0}once(e,t){const r=this;let n;if("function"!=typeof t)throw new TypeError("listener must be a function");return n=t.length>=2?function(s,i){r.removeListener(e,n),t(s,i)}:function(s){r.removeListener(e,n),t(s,n)},r.on(e,n),r}first(e,t){let r=this._events[e]??[];if("function"!=typeof t)throw new TypeError("listener must be a function");return Array.isArray(r)||(this._events[e]=r=[r]),r.unshift(t),this}before(e,t,r){return this.beforeOrAfter(e,t,r)}after(e,t,r){return this.beforeOrAfter(e,t,r,"after")}beforeOrAfter(e,t,r,n){let s,i,a=this._events[e]??[];const o="after"===n?1:0;if("function"!=typeof r)throw new TypeError("listener must be a function");if("function"!=typeof t)throw new TypeError("target must be a function");for(Array.isArray(a)||(this._events[e]=a=[a]),i=a.length,s=a.length;s--;)if(a[s]===t){i=s+o;break}return a.splice(i,0,r),this}on(e,t){return super.on(e,t)}addListener(e,t){return super.addListener(e,t)}prependListener(e,t){return super.prependListener(e,t)}prependOnceListener(e,t){return super.prependOnceListener(e,t)}removeAllListeners(e){return super.removeAllListeners(e)}removeListener(e,t){return super.removeListener(e,t)}eventNames(){return super.eventNames()}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}getMaxListeners(){return super.getMaxListeners()}setMaxListeners(e){return super.setMaxListeners(e)}}r.AsyncEventEmitter=s}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/asyncEventEmitter.js"}],[1786,{"./helpers":1789,"./internal":1791,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.intToUnpaddedBuffer=r.bigIntToUnpaddedBuffer=r.bigIntToHex=r.bufArrToArr=r.arrToBufArr=r.validateNoLeadingZeroes=r.baToJSON=r.toUtf8=r.short=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToInt=r.bigIntToBuffer=r.bufferToBigInt=r.bufferToHex=r.toBuffer=r.unpadHexString=r.unpadArray=r.unpadBuffer=r.setLengthRight=r.setLengthLeft=r.zeros=r.intToBuffer=r.intToHex=void 0;const n=e("./helpers"),s=e("./internal");r.intToHex=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};r.intToBuffer=function(e){const n=(0,r.intToHex)(e);return t.from((0,s.padToEven)(n.slice(2)),"hex")};r.zeros=function(e){return t.allocUnsafe(e).fill(0)};const i=function(e,t,n){const s=(0,r.zeros)(t);return n?e.length<t?(e.copy(s),s):e.slice(0,t):e.length<t?(e.copy(s,t-e.length),s):e.slice(-t)};r.setLengthLeft=function(e,t){return(0,n.assertIsBuffer)(e),i(e,t,!1)};r.setLengthRight=function(e,t){return(0,n.assertIsBuffer)(e),i(e,t,!0)};const a=function(e){let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e};r.unpadBuffer=function(e){return(0,n.assertIsBuffer)(e),a(e)};r.unpadArray=function(e){return(0,n.assertIsArray)(e),a(e)};r.unpadHexString=function(e){return(0,n.assertIsHexString)(e),e=(0,s.stripHexPrefix)(e),"0x"+a(e)};r.toBuffer=function(e){if(null===e||e===undefined)return t.allocUnsafe(0);if(t.isBuffer(e))return t.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return t.from(e);if("string"==typeof e){if(!(0,s.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return t.from((0,s.padToEven)((0,s.stripHexPrefix)(e)),"hex")}if("number"==typeof e)return(0,r.intToBuffer)(e);if("bigint"==typeof e){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let r=e.toString(16);return r.length%2&&(r="0"+r),t.from(r,"hex")}if(e.toArray)return t.from(e.toArray());if(e.toBuffer)return t.from(e.toBuffer());throw new Error("invalid type")};function o(e){const t=(0,r.bufferToHex)(e);return"0x"===t?BigInt(0):BigInt(t)}function c(e){return(0,r.toBuffer)("0x"+e.toString(16))}r.bufferToHex=function(e){return"0x"+(e=(0,r.toBuffer)(e)).toString("hex")},r.bufferToBigInt=o,r.bigIntToBuffer=c;r.bufferToInt=function(e){const t=Number(o(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};r.fromSigned=function(e){return BigInt.asIntN(256,o(e))};r.toUnsigned=function(e){return c(BigInt.asUintN(256,e))};r.addHexPrefix=function(e){return"string"!=typeof e||(0,s.isHexPrefixed)(e)?e:"0x"+e},r.short=function(e,r=50){const n=t.isBuffer(e)?e.toString("hex"):e;return n.length<=r?n:n.slice(0,r)+""};r.toUtf8=function(e){if((e=(0,s.stripHexPrefix)(e)).length%2!=0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return t.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};r.baToJSON=function(e){if(t.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){const t=[];for(let n=0;n<e.length;n++)t.push((0,r.baToJSON)(e[n]));return t}};r.validateNoLeadingZeroes=function(e){for(const[t,r]of Object.entries(e))if(r!==undefined&&r.length>0&&0===r[0])throw new Error(`${t} cannot have leading zeroes, received: ${r.toString("hex")}`)},r.arrToBufArr=function e(r){return Array.isArray(r)?r.map((t=>e(t))):t.from(r)},r.bufArrToArr=function e(t){return Array.isArray(t)?t.map((t=>e(t))):Uint8Array.from(t??[])};r.bigIntToHex=e=>"0x"+e.toString(16),r.bigIntToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)(c(e))},r.intToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)((0,r.intToBuffer)(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/bytes.js"}],[1787,{buffer:3998,"ethereum-cryptography/secp256k1":4241},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_WITHDRAWALS_PER_PAYLOAD=r.RLP_EMPTY_STRING=r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.SECP256K1_ORDER_DIV_2=r.SECP256K1_ORDER=r.MAX_INTEGER_BIGINT=r.MAX_INTEGER=r.MAX_UINT64=void 0;const n=e("buffer"),s=e("ethereum-cryptography/secp256k1");r.MAX_UINT64=BigInt("0xffffffffffffffff"),r.MAX_INTEGER=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),r.MAX_INTEGER_BIGINT=BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),r.SECP256K1_ORDER=s.secp256k1.CURVE.n,r.SECP256K1_ORDER_DIV_2=s.secp256k1.CURVE.n/BigInt(2),r.TWO_POW256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=n.Buffer.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=n.Buffer.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=n.Buffer.from(r.KECCAK256_RLP_S,"hex"),r.RLP_EMPTY_STRING=n.Buffer.from([128]),r.MAX_WITHDRAWALS_PER_PAYLOAD=16}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/constants.js"}],[1788,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.compactBytesToNibbles=r.bytesToNibbles=r.nibblesToCompactBytes=r.nibblesToBytes=r.hasTerminator=void 0;r.hasTerminator=e=>e.length>0&&16===e[e.length-1];r.nibblesToBytes=(e,t)=>{for(let r=0,n=0;n<e.length;r+=1,n+=2)t[r]=e[n]<<4|e[n+1]};r.nibblesToCompactBytes=e=>{let t=0;(0,r.hasTerminator)(e)&&(t=1,e=e.subarray(0,e.length-1));const n=new Uint8Array(e.length/2+1);return n[0]=t<<5,1&~e.length||(n[0]|=16,n[0]|=e[0],e=e.subarray(1)),(0,r.nibblesToBytes)(e,n.subarray(1)),n};r.bytesToNibbles=e=>{const t=2*e.length+1,r=new Uint8Array(t);for(let t=0;t<e.length;t++){const n=e[t];r[2*t]=n/16,r[2*t+1]=n%16}return r[t-1]=16,r};r.compactBytesToNibbles=e=>{if(0===e.length)return e;let t=(0,r.bytesToNibbles)(e);t[0]<2&&(t=t.subarray(0,t.length-1));const n=2-(1&t[0]);return t.subarray(n)}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/encoding.js"}],[1789,{"../../../../../../../../../is-buffer/index.js":4581,"./internal":1791},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.assertIsString=r.assertIsArray=r.assertIsBuffer=r.assertIsHexString=void 0;const n=e("./internal");r.assertIsHexString=function(e){if(!(0,n.isHexString)(e)){throw new Error(`This method only supports 0x-prefixed hex strings but input was: ${e}`)}};r.assertIsBuffer=function(e){if(!t.isBuffer(e)){throw new Error(`This method only supports Buffer but input was: ${e}`)}};r.assertIsArray=function(e){if(!Array.isArray(e)){throw new Error(`This method only supports number arrays but input was: ${e}`)}};r.assertIsString=function(e){if("string"!=typeof e){throw new Error(`This method only supports strings but input was: ${e}`)}}}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/helpers.js"}],[179,{"../../../../shared/constants/app":5643,"../../../../shared/constants/gas":5649,"../../../../shared/constants/metametrics":5654,"../../../../shared/constants/transaction":5673,"../../../../shared/lib/confirmation.utils":5684,"../../../../shared/lib/transactions-controller-utils":5698,"../../../../shared/modules/conversion.utils":5710,"../../../../shared/modules/metametrics":5718,"../../../../shared/modules/transaction.utils":5732,"../../../../ui/helpers/utils/metrics":6723,"../snap-keyring/metrics":161,"@metamask/rpc-errors":2484,"@metamask/transaction-controller":2829,"bignumber.js":3902,"ethereumjs-util":4251},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleTransactionSubmitted=r.handleTransactionRejected=r.handleTransactionFailed=r.handleTransactionDropped=r.handleTransactionConfirmed=r.handleTransactionApproved=r.handleTransactionAdded=r.handlePostTransactionBalanceUpdate=r.createTransactionEventFragmentWithTxId=r.METRICS_STATUS_FAILED=void 0;var n=e("bignumber.js"),s=e("ethereumjs-util"),i=e("@metamask/transaction-controller"),a=e("@metamask/rpc-errors"),o=e("../../../../shared/constants/app"),c=e("../../../../shared/constants/gas"),l=e("../../../../shared/constants/metametrics"),u=e("../../../../shared/constants/transaction"),d=e("../../../../shared/lib/transactions-controller-utils"),h=e("../../../../shared/modules/conversion.utils"),p=e("../../../../shared/modules/metametrics"),m=e("../../../../shared/modules/transaction.utils"),g=e("../../../../ui/helpers/utils/metrics"),f=e("../snap-keyring/metrics"),y=e("../../../../shared/lib/confirmation.utils");const b=r.METRICS_STATUS_FAILED="failed on-chain";r.handleTransactionAdded=async(e,t)=>{if(!t.transactionMeta)return;const{properties:r,sensitiveProperties:n}=await C({transactionEventPayload:t,transactionMetricsRequest:e});v({eventName:u.TransactionMetaMetricsEvent.added,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:r,sensitiveProperties:n}})};r.handleTransactionApproved=async(e,t)=>{t.transactionMeta&&await w({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionFailed=async(e,t)=>{if(!t.transactionMeta)return;const r={};t.error&&(r.error=t.error),await w({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:r,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionConfirmed=async(e,t)=>{if(0===Object.keys(t).length)return;const r={},n={...t},{txReceipt:s}=n;r.gas_used=null==s?void 0:s.gasUsed,r.block_number=(null==s?void 0:s.blockNumber)&&(0,h.hexToDecimal)(s.blockNumber);const{submittedTime:i,blockTimestamp:a}=n;i&&(r.completion_time=function(e){return Math.round((Date.now()-e)/1e3).toString()}(i)),i&&a&&(r.completion_time_onchain=function(e,t){const r=2,n=Number((0,h.hexToDecimal)(t))-e/1e3;return(Math.round(n*10**r)/10**r).toString()}(i,a)),"0x0"===(null==s?void 0:s.status)&&(r.status=b),await w({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:r,transactionEventPayload:{actionId:n.actionId,transactionMeta:n},transactionMetricsRequest:e})};r.handleTransactionDropped=async(e,t)=>{if(!t.transactionMeta)return;await w({eventName:u.TransactionMetaMetricsEvent.finalized,extraParams:{dropped:!0},transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionRejected=async(e,t)=>{t.transactionMeta&&await w({eventName:u.TransactionMetaMetricsEvent.rejected,transactionEventPayload:t,transactionMetricsRequest:e})};r.handleTransactionSubmitted=async(e,t)=>{if(!t.transactionMeta)return;const{properties:r,sensitiveProperties:n}=await C({transactionEventPayload:t,transactionMetricsRequest:e});v({eventName:u.TransactionMetaMetricsEvent.submitted,transactionEventPayload:t,transactionMetricsRequest:e,payload:{properties:r,sensitiveProperties:n}})};r.createTransactionEventFragmentWithTxId=async(e,{transactionId:t,actionId:r})=>{const n={...e.getTransaction(t),actionId:r},{properties:s,sensitiveProperties:i}=await C({transactionEventPayload:{transactionMeta:n},transactionMetricsRequest:e});v({eventName:u.TransactionMetaMetricsEvent.approved,transactionEventPayload:{actionId:n.actionId,transactionMeta:n},transactionMetricsRequest:e,payload:{properties:s,sensitiveProperties:i}})};function v({eventName:e,transactionEventPayload:{transactionMeta:t,actionId:r},transactionMetricsRequest:n,payload:s}){if(function(e,t,r){const n=k(t,r.id);return void 0!==e(n)}(n.getEventFragmentById,e,t)&&e!==u.TransactionMetaMetricsEvent.submitted)return;const i=k(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.added:n.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.added,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:n.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.approved,failureEvent:u.TransactionMetaMetricsEvent.rejected,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.submitted:n.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,initialEvent:u.TransactionMetaMetricsEvent.submitted,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0});break;case u.TransactionMetaMetricsEvent.finalized:n.createEventFragment({category:l.MetaMetricsEventCategory.Transactions,successEvent:u.TransactionMetaMetricsEvent.finalized,properties:s.properties,sensitiveProperties:s.sensitiveProperties,actionId:r,uniqueIdentifier:i,persist:!0})}}async function w({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,extraParams:n={}}){const{properties:s,sensitiveProperties:i}=await C({transactionEventPayload:t,transactionMetricsRequest:r,extraParams:n});v({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,payload:{properties:s,sensitiveProperties:i}}),function({eventName:e,transactionEventPayload:{transactionMeta:t},transactionMetricsRequest:r,payload:n}){const s=k(e,t.id);switch(e){case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.rejected:case u.TransactionMetaMetricsEvent.finalized:r.updateEventFragment(s,{properties:n.properties,sensitiveProperties:n.sensitiveProperties})}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r,payload:{properties:s,sensitiveProperties:i}}),function({eventName:e,transactionMetricsRequest:t,transactionEventPayload:{transactionMeta:r}}){const n=k(e,r.id);switch(e){case u.TransactionMetaMetricsEvent.approved:case u.TransactionMetaMetricsEvent.finalized:t.finalizeEventFragment(n);break;case u.TransactionMetaMetricsEvent.rejected:t.finalizeEventFragment(n,{abandoned:!0})}}({eventName:e,transactionEventPayload:t,transactionMetricsRequest:r})}function k(e,t){return`transaction-${e===u.TransactionMetaMetricsEvent.finalized||e===u.TransactionMetaMetricsEvent.submitted?"submitted":"added"}-${t}`}async function C({transactionEventPayload:{transactionMeta:e},transactionMetricsRequest:t,extraParams:r={}}){var b;const{type:v,time:w,status:k,chainId:C,origin:T,txParams:{gasPrice:_,gas:S,maxFeePerGas:E,maxPriorityFeePerGas:A,estimateSuggested:M,estimateUsed:P},defaultGasEstimates:I,originalType:x,replacedById:N,customTokenAmount:B,dappProposedTokenAmount:R,currentTokenBalance:O,originalApprovalAmount:j,finalApprovalAmount:D,securityProviderResponse:L,simulationFails:U,id:F,userFeeLevel:$}=e,K=T===o.ORIGIN_METAMASK?"user":"dapp",q="dappSuggested"===$?"dapp_proposed":$,{assetType:H,tokenStandard:z}=await(0,m.determineTransactionAssetType)(e,t.provider,t.getTokenStandardAndDetails);let V;if(e.txParams.data){const r=await t.getMethodData(e.txParams.data);V=null==r?void 0:r.name}const Z={};if((0,m.isEIP1559Transaction)(e)?(Z.max_fee_per_gas=E,Z.max_priority_fee_per_gas=A):(Z.gas_price=_,Z.default_estimate=l.MetaMetricsEventTransactionEstimateType.DefaultEstimate),I){var G,W;const{estimateType:r}=I;if(r){var J,Q;Z.default_estimate=r===c.PriorityLevels.dAppSuggested?l.MetaMetricsEventTransactionEstimateType.DappProposed:r;let n=null===(J=e.defaultGasEstimates)||void 0===J?void 0:J.maxFeePerGas,s=null===(Q=e.defaultGasEstimates)||void 0===Q?void 0:Q.maxPriorityFeePerGas;if([c.GasRecommendations.low,c.GasRecommendations.medium,c.GasRecommendations.high].includes(r)){var Y,X;const{gasFeeEstimates:e}=await t.getEIP1559GasFeeEstimates();var ee,te;if(null!=e&&null!==(Y=e[r])&&void 0!==Y&&Y.suggestedMaxFeePerGas)n=null===(ee=e[r])||void 0===ee?void 0:ee.suggestedMaxFeePerGas,Z.default_max_fee_per_gas=n;if(null!=e&&null!==(X=e[r])&&void 0!==X&&X.suggestedMaxPriorityFeePerGas)s=null===(te=e[r])||void 0===te?void 0:te.suggestedMaxPriorityFeePerGas,Z.default_max_priority_fee_per_gas=s}}null!==(G=e.defaultGasEstimates)&&void 0!==G&&G.gas&&(Z.default_gas=e.defaultGasEstimates.gas),null!==(W=e.defaultGasEstimates)&&void 0!==W&&W.gasPrice&&(Z.default_gas_price=e.defaultGasEstimates.gasPrice)}M&&(Z.estimate_suggested=M),P&&(Z.estimate_used=P),null!=r&&r.gas_used&&(Z.gas_used=r.gas_used);const re=function(e){const t={};for(const r in e)(0,s.isHexString)(e[r])?t[r]=(0,h.hexWEIToDecGWEI)(e[r]):t[r]=e[r];return t}(Z);let ne="0";e.txParams.maxFeePerGas&&(ne="2");const se=v&&[i.TransactionType.contractInteraction,i.TransactionType.tokenMethodApprove,i.TransactionType.tokenMethodIncreaseAllowance,i.TransactionType.tokenMethodSafeTransferFrom,i.TransactionType.tokenMethodSetApprovalForAll,i.TransactionType.tokenMethodTransfer,i.TransactionType.tokenMethodTransferFrom,i.TransactionType.swap,i.TransactionType.swapAndSend,i.TransactionType.swapApproval].includes(v),ie="Approve";let ae,oe,ce,le,ue,de,he=i.TransactionType.simpleSend;if(v===i.TransactionType.swapAndSend)he=i.TransactionType.swapAndSend;else if(v===i.TransactionType.cancel)he=i.TransactionType.cancel;else if(v===i.TransactionType.retry&&x)he=x;else if(v===i.TransactionType.deployContract)he=i.TransactionType.deployContract;else if(se){var pe,me;he=i.TransactionType.contractInteraction,oe=V,ue=null===(pe=e.txParams)||void 0===pe?void 0:pe.to,de=null===(me=e.txParams)||void 0===me||null===(me=me.data)||void 0===me?void 0:me.slice(0,10),oe===ie&&z===u.TokenStandard.ERC20&&("0"===R||"0"===B?ae=u.TransactionApprovalAmountType.revoke:B&&B!==R?ae=u.TransactionApprovalAmountType.custom:R&&(ae=u.TransactionApprovalAmountType.dappProposed),ce=function(e,t,r){if(e===u.TransactionApprovalAmountType.custom&&t&&r)return`${new n.BigNumber(t,10).div(r,10).times(100).round(2)}`;return null}(ae,j,D),le=function(e,t,r){if((e===u.TransactionApprovalAmountType.custom||e===u.TransactionApprovalAmountType.dappProposed)&&t&&r)return`${new n.BigNumber(t,16).div(r,10).times(100).round(2)}`;return null}(ae,R,O))}const ge=t.getTransaction(N),fe={RETRY:i.TransactionType.retry,CANCEL:i.TransactionType.cancel,SAME_NONCE:"other"};let ye;null!=r&&r.dropped&&(ye=fe.SAME_NONCE,(null==ge?void 0:ge.type)===i.TransactionType.cancel?ye=fe.CANCEL:(null==ge?void 0:ge.type)===i.TransactionType.retry&&(ye=fe.RETRY));const be=[];let ve=null;1===(null==L?void 0:L.flagAsDangerous)?be.push(l.MetaMetricsEventUiCustomization.FlaggedAsMalicious):2===(null==L?void 0:L.flagAsDangerous)&&be.push(l.MetaMetricsEventUiCustomization.FlaggedAsSafetyUnknown);const we=(0,g.getBlockaidMetricsProps)(e);(null==we||null===(b=we.ui_customizations)||void 0===b?void 0:b.length)>0&&be.push(...we.ui_customizations),U&&be.push(l.MetaMetricsEventUiCustomization.GasEstimationFailed);(0,y.shouldUseRedesignForTransactions)({transactionMetadataType:e.type})&&(be.push(l.MetaMetricsEventUiCustomization.RedesignedConfirmation),ve=t.getIsConfirmationAdvancedDetailsOpen());const ke=(0,p.getSmartTransactionMetricsProperties)(t,e),Ce=(0,g.getSwapAndSendMetricsProps)(e);let Te={chain_id:C,referrer:T,source:K,status:k,network:`${parseInt(C,16)}`,eip_1559_version:ne,gas_edit_type:"none",gas_edit_attempted:"none",gas_estimation_failed:Boolean(U),account_type:await t.getAccountType(t.getSelectedAddress()),device_model:await t.getDeviceModel(t.getSelectedAddress()),asset_type:H,token_standard:z,transaction_type:he,transaction_speed_up:v===i.TransactionType.retry,transaction_internal_id:F,gas_fee_selected:q,...we,ui_customizations:be.length>0?be:null,transaction_advanced_view:ve,transaction_contract_method:oe?[oe]:[],...ke,...Ce};const _e=await(0,f.getSnapAndHardwareInfoForMetrics)(t.getAccountType,t.getDeviceModel,t.getHardwareTypeForMetric,t.snapAndHardwareMessenger);Object.assign(Te,_e),oe===ie&&(Te={...Te,transaction_approval_amount_type:ae});let Se={transaction_envelope_type:(0,m.isEIP1559Transaction)(e)?d.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:d.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:w,gas_limit:S,transaction_replaced:ye,transaction_contract_address:ue?[ue]:[],transaction_contract_method_4byte:de,...r,...re};return oe===ie&&(Se={...Se,transaction_approval_amount_vs_balance_ratio:le,transaction_approval_amount_vs_proposed_ratio:ce}),await async function(e,t,r,n){const s=origin&&origin!==o.ORIGIN_METAMASK,{delegationAddress:c,nestedTransactions:l,txParams:u}=e,{authorizationList:d}=u,h=Boolean(null==l?void 0:l.length),p=Boolean(null==d?void 0:d.length);s&&(r.api_method=h?o.MESSAGE_TYPE.WALLET_SEND_CALLS:o.MESSAGE_TYPE.ETH_SEND_TRANSACTION);h&&(r.batch_transaction_count=null==l?void 0:l.length,r.batch_transaction_method="eip7702",r.transaction_contract_method=await async function(e,t){const r=e.filter((e=>e.type===i.TransactionType.contractInteraction&&e.data)).map((e=>e.data)),n=await Promise.all(r.map((e=>t(e))));return n.map((e=>null==e?void 0:e.name)).filter((e=>null==e?void 0:e.length))}(l??[],t),n.transaction_contract_address=null==l?void 0:l.filter((e=>{var t;return e.type===i.TransactionType.contractInteraction&&(null===(t=e.to)||void 0===t?void 0:t.length)})).map((e=>e.to)));if(e.status===i.TransactionStatus.rejected){const{error:t}=e;r.eip7702_upgrade_rejection=p&&t.code===a.errorCodes.rpc.methodNotSupported}r.eip7702_upgrade_transaction=p,n.account_eip7702_upgraded=c}(e,t.getMethodData,Te,Se),{properties:Te,sensitiveProperties:Se}}r.handlePostTransactionBalanceUpdate=async({getParticipateInMetrics:e,trackEvent:t},{transactionMeta:r,approvalTransactionMeta:s})=>{var i;if(e()&&r.swapMetaData)if("0x0"===(null===(i=r.txReceipt)||void 0===i?void 0:i.status))t({event:"Swap Failed",sensitiveProperties:{...r.swapMetaData},category:l.MetaMetricsEventCategory.Swaps});else{var a;const e=(0,d.getSwapsTokensReceivedFromTxMeta)(r.destinationTokenSymbol,r,r.destinationTokenAddress,r.txParams.from,r.destinationTokenDecimals,s,r.chainId),i=e?`${new n.BigNumber(e,10).div(r.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,o=null!==(a=r.txReceipt)&&void 0!==a&&a.gasUsed&&r.swapMetaData.estimated_gas?`${new n.BigNumber(r.txReceipt.gasUsed,16).div(r.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,c=function(e,t){var r,s;let i="0x0";null!=t&&t.txReceipt&&(i=(0,d.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice));const a=(0,d.calcGasTotal)(null===(r=e.txReceipt)||void 0===r?void 0:r.gasUsed,null===(s=e.txReceipt)||void 0===s?void 0:s.effectiveGasPrice),o=new n.BigNumber(a,16).plus(i,16).toString(16);return{approvalGasCostInEth:Number((0,h.hexWEIToDecETH)(i)),tradeGasCostInEth:Number((0,h.hexWEIToDecETH)(a)),tradeAndApprovalGasCostInEth:Number((0,h.hexWEIToDecETH)(o))}}(r,s);t({event:l.MetaMetricsEventName.SwapCompleted,category:l.MetaMetricsEventCategory.Swaps,sensitiveProperties:{...r.swapMetaData,token_to_amount_received:e,quote_vs_executionRatio:i,estimated_vs_used_gasRatio:o,approval_gas_cost_in_eth:c.approvalGasCostInEth,trade_gas_cost_in_eth:c.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:c.tradeAndApprovalGasCostInEth,token_to_amount:r.swapMetaData.token_to_amount.toString(10)}})}}}}},{package:"$root$",file:"app/scripts/lib/transaction/metrics.ts"}],[1790,{"./account":1783,"./address":1784,"./asyncEventEmitter":1785,"./bytes":1786,"./constants":1787,"./encoding":1788,"./internal":1791,"./lock":1792,"./provider":1793,"./signature":1794,"./types":1795,"./units":1796,"./withdrawal":1797},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.toAscii=r.stripHexPrefix=r.padToEven=r.isHexString=r.isHexPrefixed=r.getKeys=r.getBinarySize=r.fromUtf8=r.fromAscii=r.arrayContainsArray=void 0,s(e("./constants"),r),s(e("./units"),r),s(e("./account"),r),s(e("./address"),r),s(e("./withdrawal"),r),s(e("./signature"),r),s(e("./bytes"),r),s(e("./types"),r),s(e("./encoding"),r),s(e("./asyncEventEmitter"),r);var i=e("./internal");Object.defineProperty(r,"arrayContainsArray",{enumerable:!0,get:function(){return i.arrayContainsArray}}),Object.defineProperty(r,"fromAscii",{enumerable:!0,get:function(){return i.fromAscii}}),Object.defineProperty(r,"fromUtf8",{enumerable:!0,get:function(){return i.fromUtf8}}),Object.defineProperty(r,"getBinarySize",{enumerable:!0,get:function(){return i.getBinarySize}}),Object.defineProperty(r,"getKeys",{enumerable:!0,get:function(){return i.getKeys}}),Object.defineProperty(r,"isHexPrefixed",{enumerable:!0,get:function(){return i.isHexPrefixed}}),Object.defineProperty(r,"isHexString",{enumerable:!0,get:function(){return i.isHexString}}),Object.defineProperty(r,"padToEven",{enumerable:!0,get:function(){return i.padToEven}}),Object.defineProperty(r,"stripHexPrefix",{enumerable:!0,get:function(){return i.stripHexPrefix}}),Object.defineProperty(r,"toAscii",{enumerable:!0,get:function(){return i.toAscii}}),s(e("./lock"),r),s(e("./provider"),r)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/index.js"}],[1791,{buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(e){(function(){function t(e){if("string"!=typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type "+typeof e);return"0"===e[0]&&"x"===e[1]}Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,r.isHexPrefixed=t;function n(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received "+typeof t);return t.length%2&&(t=`0${t}`),t}r.stripHexPrefix=e=>{if("string"!=typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received "+typeof e);return t(e)?e.slice(2):e},r.padToEven=n,r.getBinarySize=function(t){if("string"!=typeof t)throw new Error("[getBinarySize] method requires input type 'string', received "+typeof t);return e.byteLength(t,"utf8")},r.arrayContainsArray=function(e,t,r){if(!0!==Array.isArray(e))throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(!0!==Array.isArray(t))throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[!0===r?"some":"every"]((t=>e.indexOf(t)>=0))},r.toAscii=function(e){let t="",r=0;const n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){const n=parseInt(e.substr(r,2),16);t+=String.fromCharCode(n)}return t},r.fromUtf8=function(t){return`0x${n(e.from(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")}`},r.fromAscii=function(e){let t="";for(let r=0;r<e.length;r++){const n=e.charCodeAt(r).toString(16);t+=n.length<2?`0${n}`:n}return`0x${t}`},r.getKeys=function(e,t,r){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got "+typeof e);if("string"!=typeof t)throw new Error("[getKeys] method expects input 'key' to be type 'string', got "+typeof e);const n=[];for(let s=0;s<e.length;s++){let i=e[s][t];if(!0!==r||i){if("string"!=typeof i)throw new Error("invalid abi - expected type 'string', received "+typeof i)}else i="";n.push(i)}return n},r.isHexString=function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&!(void 0!==t&&t>0&&e.length!==2+2*t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/internal.js"}],[1792,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Lock=void 0;r.Lock=class{constructor(){this.permits=1,this.promiseResolverQueue=[]}async acquire(){return this.permits>0?(this.permits-=1,Promise.resolve(!0)):new Promise((e=>this.promiseResolverQueue.push(e)))}release(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)console.warn("Lock.permits should never be > 0 when there is someone waiting.");else if(1===this.permits&&this.promiseResolverQueue.length>0){this.permits-=1;const e=this.promiseResolverQueue.shift();e&&e(!0)}}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/lock.js"}],[1793,{"micro-ftch":4834},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getProvider=r.fetchFromProvider=void 0;const n=e("micro-ftch");r.fetchFromProvider=async(e,t)=>(await(0,n.default)(e,{headers:{"content-type":"application/json"},type:"json",data:{method:t.method,params:t.params,jsonrpc:"2.0",id:1}})).result;r.getProvider=e=>{if("string"==typeof e)return e;if(e?.connection?.url!==undefined)return e.connection.url;throw new Error("Must provide valid provider URL or Web3Provider")}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/provider.js"}],[1794,{"./bytes":1786,"./constants":1787,"./helpers":1789,buffer:3998,"ethereum-cryptography/keccak":4224,"ethereum-cryptography/secp256k1":4241},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toCompactSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;const n=e("ethereum-cryptography/keccak"),s=e("ethereum-cryptography/secp256k1"),i=e("./bytes"),a=e("./constants"),o=e("./helpers");function c(e,t){return e===BigInt(0)||e===BigInt(1)?e:t===undefined?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}function l(e){return e===BigInt(0)||e===BigInt(1)}r.ecsign=function(e,r,n){const i=s.secp256k1.sign(e,r),a=i.toCompactRawBytes();return{r:t.from(a.slice(0,32)),s:t.from(a.slice(32,64)),v:n===undefined?BigInt(i.recovery+27):BigInt(i.recovery+35)+BigInt(n)*BigInt(2)}};r.ecrecover=function(e,r,n,a,o){const u=t.concat([(0,i.setLengthLeft)(n,32),(0,i.setLengthLeft)(a,32)],64),d=c(r,o);if(!l(d))throw new Error("Invalid signature v value");const h=s.secp256k1.Signature.fromCompact(u).addRecoveryBit(Number(d)).recoverPublicKey(e);return t.from(h.toRawBytes(!1).slice(1))};r.toRpcSig=function(e,r,n,s){if(!l(c(e,s)))throw new Error("Invalid signature v value");return(0,i.bufferToHex)(t.concat([(0,i.setLengthLeft)(r,32),(0,i.setLengthLeft)(n,32),(0,i.toBuffer)(e)]))};r.toCompactSig=function(e,r,n,s){if(!l(c(e,s)))throw new Error("Invalid signature v value");let a=n;return(e>BigInt(28)&&e%BigInt(2)===BigInt(1)||e===BigInt(1)||e===BigInt(28))&&(a=t.from(n),a[0]|=128),(0,i.bufferToHex)(t.concat([(0,i.setLengthLeft)(r,32),(0,i.setLengthLeft)(a,32)]))};r.fromRpcSig=function(e){const t=(0,i.toBuffer)(e);let r,n,s;if(t.length>=65)r=t.slice(0,32),n=t.slice(32,64),s=(0,i.bufferToBigInt)(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");r=t.slice(0,32),n=t.slice(32,64),s=BigInt((0,i.bufferToInt)(t.slice(32,33))>>7),n[0]&=127}return s<27&&(s+=BigInt(27)),{v:s,r:r,s:n}};r.isValidSignature=function(e,t,r,n=!0,s){if(32!==t.length||32!==r.length)return!1;if(!l(c(e,s)))return!1;const o=(0,i.bufferToBigInt)(t),u=(0,i.bufferToBigInt)(r);return!(o===BigInt(0)||o>=a.SECP256K1_ORDER||u===BigInt(0)||u>=a.SECP256K1_ORDER)&&!(n&&u>=a.SECP256K1_ORDER_DIV_2)};r.hashPersonalMessage=function(e){(0,o.assertIsBuffer)(e);const r=t.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return t.from((0,n.keccak256)(t.concat([r,e])))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/signature.js"}],[1795,{"./bytes":1786,"./internal":1791},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toType=r.TypeOutput=void 0;const n=e("./bytes"),s=e("./internal");var i;!function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(i=r.TypeOutput||(r.TypeOutput={})),r.toType=function(e,t){if(null===e)return null;if(e===undefined)return undefined;if("string"==typeof e&&!(0,s.isHexString)(e))throw new Error(`A string must be provided with a 0x-prefix, given: ${e}`);if("number"==typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const r=(0,n.toBuffer)(e);switch(t){case i.Buffer:return r;case i.BigInt:return(0,n.bufferToBigInt)(r);case i.Number:{const e=(0,n.bufferToBigInt)(r);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case i.PrefixedHexString:return(0,n.bufferToHex)(r);default:throw new Error("unknown outputType")}}}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/types.js"}],[1796,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.GWEI_TO_WEI=void 0,r.GWEI_TO_WEI=BigInt(1e9)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/units.js"}],[1797,{"./address":1784,"./bytes":1786,"./types":1795,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Withdrawal=void 0;const n=e("./address"),s=e("./bytes"),i=e("./types");class a{constructor(e,t,r,n){this.index=e,this.validatorIndex=t,this.address=r,this.amount=n}static fromWithdrawalData(e){const{index:t,validatorIndex:r,address:s,amount:o}=e,c=(0,i.toType)(t,i.TypeOutput.BigInt),l=(0,i.toType)(r,i.TypeOutput.BigInt),u=new n.Address((0,i.toType)(s,i.TypeOutput.Buffer)),d=(0,i.toType)(o,i.TypeOutput.BigInt);return new a(c,l,u,d)}static fromValuesArray(e){if(4!==e.length)throw Error(`Invalid withdrawalArray length expected=4 actual=${e.length}`);const[t,r,n,s]=e;return a.fromWithdrawalData({index:t,validatorIndex:r,address:n,amount:s})}static toBufferArray(e){const{index:r,validatorIndex:s,address:a,amount:o}=e,c=(0,i.toType)(r,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(r,i.TypeOutput.Buffer),l=(0,i.toType)(s,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(s,i.TypeOutput.Buffer);let u;u=a instanceof n.Address?a.buf:(0,i.toType)(a,i.TypeOutput.Buffer);return[c,l,u,(0,i.toType)(o,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(o,i.TypeOutput.Buffer)]}raw(){return a.toBufferArray(this)}toValue(){return{index:this.index,validatorIndex:this.validatorIndex,address:this.address.buf,amount:this.amount}}toJSON(){return{index:(0,s.bigIntToHex)(this.index),validatorIndex:(0,s.bigIntToHex)(this.validatorIndex),address:"0x"+this.address.buf.toString("hex"),amount:(0,s.bigIntToHex)(this.amount)}}}r.Withdrawal=a}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-trezor-keyring>@metamask/eth-sig-util>@ethereumjs/util",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@metamask/eth-sig-util/node_modules/@ethereumjs/util/dist/withdrawal.js"}],[1798,{"@metamask/eth-sig-util":1778,tslib:5539},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.transformTypedData=void 0;const n=e("tslib").__importStar(e("@metamask/eth-sig-util"));function s(e){switch(Object.prototype.toString.call(e)){case"[object Object]":{const t=Object.keys(e).map((t=>[t,s(e[t])]));return Object.fromEntries(t)}case"[object Array]":return e.map((e=>s(e)));case"[object BigInt]":return e.toString();default:return e}}r.transformTypedData=(e,t)=>{if(!t)throw new Error("Trezor: Only version 4 of typed data signing is supported");const r=n.SignTypedDataVersion.V4,{types:i,primaryType:a,domain:o,message:c}=n.TypedDataUtils.sanitizeData(e),l=n.TypedDataUtils.hashStruct("EIP712Domain",s(o),i,r).toString("hex");let u=null;return"EIP712Domain"!==a&&(u=n.TypedDataUtils.hashStruct(a,s(c),i,r).toString("hex")),Object.assign({domain_separator_hash:l,message_hash:u},e)},r.default=r.transformTypedData}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-plugin-ethereum",file:"node_modules/@metamask/eth-trezor-keyring/node_modules/@trezor/connect-plugin-ethereum/lib/index.js"}],[18,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getMultichainAssetsControllerMessenger=function(e){return e.getRestricted({name:"MultichainAssetsController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved","AccountsController:accountAssetListUpdated"],allowedActions:["PermissionController:getPermissions","SnapController:handleRequest","SnapController:getAll","AccountsController:listMultichainAccounts"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-assets-controller-messenger.ts"}],[180,{"../../../../shared/constants/app":5643,"../../../../shared/constants/smartTransactions":5667,"../../../../shared/modules/conversion.utils":5710,"../../../../shared/modules/transaction.utils":5732,"@metamask/smart-transactions-controller/dist/types":2558,"@metamask/transaction-controller":2829,loglevel:4787},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.submitSmartTransactionHook=void 0;var n,s=e("@metamask/smart-transactions-controller/dist/types"),i=e("@metamask/transaction-controller"),a=(n=e("loglevel"))&&n.__esModule?n:{default:n},o=e("../../../../shared/modules/conversion.utils"),c=e("../../../../shared/constants/smartTransactions"),l=e("../../../../shared/modules/transaction.utils"),u=e("../../../../shared/constants/app");function d(e,t,r){h(e,t),t.set(e,r)}function h(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p(e,t){return e.get(g(e,t))}function m(e,t,r){return e.set(g(e,t),r),r}function g(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var f=new WeakMap,y=new WeakMap,b=new WeakMap,v=new WeakMap,w=new WeakMap,k=new WeakMap,C=new WeakMap,T=new WeakMap,_=new WeakMap,S=new WeakMap,E=new WeakMap,A=new WeakMap,M=new WeakMap,P=new WeakSet;class I{constructor(e){!function(e,t){h(e,t),t.add(e)}(this,P),d(this,f,void 0),d(this,y,void 0),d(this,b,void 0),d(this,v,void 0),d(this,w,void 0),d(this,k,void 0),d(this,C,void 0),d(this,T,void 0),d(this,_,void 0),d(this,S,void 0),d(this,E,void 0),d(this,A,void 0),d(this,M,void 0);const{transactionMeta:t,signedTransactionInHex:r,smartTransactionsController:n,transactionController:s,isSmartTransaction:a,controllerMessenger:o,featureFlags:c}=e;m(y,this,""),m(f,this,!1),m(S,this,t),m(E,this,r),m(T,this,n),m(_,this,s),m(C,this,a),m(v,this,o),m(w,this,c),m(k,this,t.origin!==u.ORIGIN_METAMASK),m(b,this,t.chainId),m(A,this,t.txParams),m(M,this,t.type!==i.TransactionType.bridge)}async submit(){var e;const t=!(null===(e=p(S,this))||void 0===e||!e.type)&&[i.TransactionType.swapAndSend,i.TransactionType.swapApproval,i.TransactionType.bridgeApproval].includes(p(S,this).type),r={transactionHash:undefined};if(!p(C,this)||t||(0,l.isLegacyTransaction)(p(S,this)))return r;if(p(M,this)){const{id:e}=await p(v,this).call("ApprovalController:startFlow");m(y,this,e)}let n;try{n=await p(T,this).getFees({...p(A,this),chainId:p(b,this)},undefined)}catch(e){return a.default.error("Error in smart transaction publish hook, falling back to regular transaction submission",e),g(P,this,x).call(this),r}try{var s;const e=await g(P,this,j).call(this,{getFeesResponse:n}),t=null==e?void 0:e.uuid;if(!t)throw new Error("No smart transaction UUID");const r=null===(s=p(w,this))||void 0===s||null===(s=s.smartTransactions)||void 0===s?void 0:s.extensionReturnTxHashAsap;let i;if(p(M,this)&&(g(P,this,N).call(this,{uuid:t}),g(P,this,R).call(this,{uuid:t})),i=r&&null!=e&&e.txHash?e.txHash:await g(P,this,O).call(this,{uuid:t}),null===i)throw new Error("Transaction does not have a transaction hash, there was a problem");return{transactionHash:i}}catch(e){throw a.default.error("Error in smart transaction publish hook",e),g(P,this,x).call(this),e}}}function x(){p(M,this)&&!p(f,this)&&(m(f,this,!0),p(v,this).call("ApprovalController:endFlow",{id:p(y,this)}))}function N({uuid:e}){const t=()=>{g(P,this,x).call(this)};p(v,this).call("ApprovalController:addRequest",{id:p(y,this),origin:origin,type:u.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage,requestState:{smartTransaction:{status:s.SmartTransactionStatuses.PENDING,creationTime:Date.now(),uuid:e},isDapp:p(k,this),txId:p(S,this).id}},!0).then(t,t)}async function B({smartTransaction:e}){return await p(v,this).call("ApprovalController:updateRequestState",{id:p(y,this),requestState:{smartTransaction:e,isDapp:p(k,this),txId:p(S,this).id}})}async function R({uuid:e}){p(v,this).subscribe("SmartTransactionsController:smartTransaction",(async t=>{if(t.uuid===e){const{status:e}=t;if(!e||e===s.SmartTransactionStatuses.PENDING)return;p(f,this)||await g(P,this,B).call(this,{smartTransaction:t})}}))}function O({uuid:e}){return new Promise((t=>{p(v,this).subscribe("SmartTransactionsController:smartTransaction",(async r=>{if(r.uuid===e){const{status:e,statusMetadata:n}=r;if(!e||e===s.SmartTransactionStatuses.PENDING)return;a.default.debug("Smart Transaction: ",r),null!=n&&n.minedHash?(a.default.debug("Smart Transaction - Received tx hash: ",null==n?void 0:n.minedHash),t(n.minedHash)):t(null)}}))}))}async function j({getFeesResponse:e}){let t;var r;p(E,this)?t=[p(E,this)]:t=await g(P,this,L).call(this,(null===(r=e.tradeTxFees)||void 0===r?void 0:r.fees)??[],!1);return await p(T,this).submitSignedTransactions({signedTransactions:t,signedCanceledTransactions:[],txParams:p(A,this),transactionMeta:p(S,this)})}function D(e,t){const r={...p(A,this),maxFeePerGas:`0x${(0,o.decimalToHex)(e.maxFeePerGas)}`,maxPriorityFeePerGas:`0x${(0,o.decimalToHex)(e.maxPriorityFeePerGas)}`,gas:t?`0x${(0,o.decimalToHex)(c.CANCEL_GAS_LIMIT_DEC)}`:p(A,this).gas};return t&&(r.to=r.from,r.data="0x"),r}async function L(e,t){const r=e.map((e=>g(P,this,D).call(this,e,t))).map((e=>({...e,chainId:e.chainId||p(b,this)})));return await p(_,this).approveTransactionsWithSameNonce(r,{hasNonce:!0})}r.submitSmartTransactionHook=e=>new I(e).submit()}}},{package:"$root$",file:"app/scripts/lib/transaction/smart-transactions.ts"}],[181,{"../../../../shared/constants/security-provider":5665,"../../../../shared/lib/trace":5696,"../ppom/ppom-util":132,"@metamask/keyring-api":1873,"ethereumjs-util":4251},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.addDappTransaction=async function(e){const{dappRequest:t,transactionParams:r}=e,{id:n,method:s,origin:i}=t,{securityAlertResponse:a,traceContext:l}=t;0;const u={actionId:n,method:s,origin:i,requireApproval:!0,securityAlertResponse:a};(0,o.endTrace)({name:o.TraceName.Middleware,id:n});const{waitForHash:d}=await c({...e,transactionOptions:{...u,traceContext:l}}),h=await d();return(0,o.endTrace)({name:o.TraceName.Transaction,id:n}),h},r.addTransaction=async function(e){await async function(e){const{chainId:t,ppomController:r,securityAlertsEnabled:n,transactionOptions:s,transactionParams:o,updateSecurityAlertResponse:c,internalAccounts:l}=e,{type:u}=s,d=a.SECURITY_PROVIDER_EXCLUDED_TRANSACTION_TYPES.includes(u);if(!n||d)return;if(l.some((({address:e})=>{var t;return e.toLowerCase()===(null===(t=o.to)||void 0===t?void 0:t.toLowerCase())})))return;try{const{from:n,to:l,value:u,data:d}=o,{actionId:h,origin:p}=s,m={method:"eth_sendTransaction",id:h??"",origin:p??"",params:[{from:n,to:l??"",value:u??"",data:d??""}],jsonrpc:"2.0"},g=(0,i.generateSecurityAlertId)();(0,i.validateRequestWithPPOM)({ppomController:r,request:m,securityAlertId:g,chainId:t,updateSecurityAlertResponse:c});const f={...a.LOADING_SECURITY_ALERT_RESPONSE,securityAlertId:g};e.transactionOptions.securityAlertResponse=f}catch(e){(0,i.handlePPOMError)(e,"Error validating JSON RPC using PPOM: ")}}(e);const{transactionMeta:t,waitForHash:r}=await c(e);if(!e.waitForSubmit)return r().catch((()=>{})),t;const n=await r();return function(e,t){return t.state.transactions.find((t=>t.hash===e))}(n,e.transactionController)};var n=e("@metamask/keyring-api"),s=e("ethereumjs-util"),i=e("../ppom/ppom-util"),a=e("../../../../shared/constants/security-provider"),o=e("../../../../shared/lib/trace");async function c(e){const{selectedAccount:t}=e;return t.type===n.EthAccountType.Erc4337?async function(e){var t;const{networkClientId:r,transactionController:n,transactionOptions:i,transactionParams:a,userOperationController:o}=e,{maxFeePerGas:c,maxPriorityFeePerGas:u}=a,{origin:d,requireApproval:h,type:p}=i,m={...a,maxFeePerGas:(0,s.addHexPrefix)(c),maxPriorityFeePerGas:(0,s.addHexPrefix)(u)},g=null==i||null===(t=i.swaps)||void 0===t?void 0:t.meta;null!=g&&g.type&&delete g.type;const f={networkClientId:r,origin:d,requireApproval:h,swaps:g,type:p},y=await o.addUserOperationFromTransaction(m,f);o.startPollingByNetworkClientId(r);return{transactionMeta:l(y.id,n),waitForHash:y.transactionHash}}(e):async function(e){const{transactionController:t,transactionOptions:r,transactionParams:n,networkClientId:s}=e,{result:i,transactionMeta:a}=await t.addTransaction(n,{...r,networkClientId:s});return{transactionMeta:a,waitForHash:()=>i}}(e)}function l(e,t){return t.state.transactions.find((t=>t.id===e))}}}},{package:"$root$",file:"app/scripts/lib/transaction/util.ts"}],[182,{"../../../../shared/constants/app":5643,"../../../../shared/constants/verification":5675,"../../../../shared/modules/selectors/networks":5727,"@ethersproject/hash":505,"@ethersproject/wallet":572,"@metamask/rpc-errors":2484,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createTxVerificationMiddleware=function(e,t=o.TRUSTED_SIGNERS){return function(r,u,d,h){if(r.method!==c.MESSAGE_TYPE.ETH_SEND_TRANSACTION||!Array.isArray(r.params)||!function(e){return(0,a.isObject)(e[0])&&"string"==typeof e[0].data&&"string"==typeof e[0].from&&"string"==typeof e[0].to&&"string"==typeof e[0].value&&(!(0,a.hasProperty)(e[0],"chainId")||"string"==typeof e[0].chainId&&e[0].chainId.startsWith("0x"))}(r.params))return d();const p=r.params[0],m="string"==typeof p.chainId?p.chainId.toLowerCase():(0,l.getCurrentChainId)({metamask:e.state}),g=(0,o.getExperience)(p.to.toLowerCase(),m);if(!g||!o.EXPERIENCES_TO_VERIFY.includes(g))return d();const f=`0x${p.data.slice(-o.TX_SIG_LEN)}`,y=(0,s.verifyMessage)(function(e){const t={to:(0,n.hashMessage)(e.to.toLowerCase()),from:(0,n.hashMessage)(e.from.toLowerCase()),data:(0,n.hashMessage)(e.data.toLowerCase().slice(0,e.data.length-o.TX_SIG_LEN)),value:(0,n.hashMessage)(e.value.toLowerCase())};return(0,n.hashMessage)(JSON.stringify(t))}(p),f);return y!==t[g]?h(i.rpcErrors.invalidParams("Invalid transaction signature.")):d()}};var n=e("@ethersproject/hash"),s=e("@ethersproject/wallet"),i=e("@metamask/rpc-errors"),a=e("@metamask/utils"),o=e("../../../../shared/constants/verification"),c=e("../../../../shared/constants/app"),l=e("../../../../shared/modules/selectors/networks")}}},{package:"$root$",file:"app/scripts/lib/tx-verification/tx-verification-middleware.ts"}],[184,{"../../development/build/constants":361,"../../shared/constants/app":5643,"../../shared/constants/hardware-wallets":5650,"../../shared/constants/keyring":5651,"../../shared/constants/logs":5653,"../../shared/constants/metametrics":5654,"../../shared/constants/methods-tags":5655,"../../shared/constants/network":5658,"../../shared/constants/permissions":5662,"../../shared/constants/smartTransactions":5667,"../../shared/constants/swaps":5669,"../../shared/constants/time":5671,"../../shared/constants/tokens":5672,"../../shared/constants/transaction":5673,"../../shared/constants/urls":5674,"../../shared/lib/fetch-with-cache":5686,"../../shared/lib/metamask-controller-utils":5689,"../../shared/lib/storage-helpers":5692,"../../shared/lib/token-util":5695,"../../shared/lib/trace":5696,"../../shared/lib/transactions-controller-utils":5698,"../../shared/modules/caip-stream":5708,"../../shared/modules/mv3.utils":5719,"../../shared/modules/network.utils":5720,"../../shared/modules/selectors":5726,"../../shared/modules/selectors/networks":5727,"../../shared/modules/string-utils":5730,"../../shared/modules/transaction.utils":5732,"../../shared/notifications":5733,"../../shared/types/bridge":5735,"../../shared/types/bridge-status":5734,"./constants/stream":8,"./controller-init/confirmations/ppom-controller-init":9,"./controller-init/confirmations/transaction-controller-init":10,"./controller-init/identity/authentication-controller-init":11,"./controller-init/identity/user-storage-controller-init":12,"./controller-init/multichain":33,"./controller-init/snaps":41,"./controller-init/utils":48,"./controllers/account-order":49,"./controllers/account-tracker-controller":50,"./controllers/alert-controller":51,"./controllers/app-metadata":52,"./controllers/app-state-controller":53,"./controllers/bridge-status/bridge-status-controller":54,"./controllers/bridge-status/constants":55,"./controllers/bridge/bridge-controller":58,"./controllers/bridge/constants":59,"./controllers/decrypt-message":60,"./controllers/encryption-public-key":61,"./controllers/metametrics-controller":62,"./controllers/metametrics-data-deletion/metametrics-data-deletion":63,"./controllers/network-order":64,"./controllers/onboarding":65,"./controllers/permissions":69,"./controllers/preferences-controller":72,"./controllers/push-notifications":75,"./controllers/swaps":76,"./detect-multiple-instances":79,"./lib/AccountIdentitiesPetnamesBridge":90,"./lib/AddressBookPetnamesBridge":91,"./lib/ComposableObservableStore":92,"./lib/PatchStore":93,"./lib/SnapsNameProvider":94,"./lib/WeakRefObjectMap":95,"./lib/approval/utils":96,"./lib/backup":97,"./lib/bridge-status/metrics":99,"./lib/createDupeReqFilterStream":100,"./lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware":101,"./lib/createLoggerMiddleware":102,"./lib/createMainFrameOriginMiddleware":103,"./lib/createMetaRPCHandler":104,"./lib/createMetamaskMiddleware":105,"./lib/createOnboardingMiddleware":106,"./lib/createOriginMiddleware":107,"./lib/createOriginThrottlingMiddleware":108,"./lib/createRPCMethodTrackingMiddleware":109,"./lib/createTabIdMiddleware":111,"./lib/createTracingMiddleware":112,"./lib/encryptor-factory":113,"./lib/hardware-keyring-builder-factory":121,"./lib/multichain/address":125,"./lib/offscreen-bridge/lattice-offscreen-keyring":127,"./lib/offscreen-bridge/ledger-offscreen-bridge":128,"./lib/offscreen-bridge/trezor-offscreen-bridge":129,"./lib/ppom/ppom-middleware":131,"./lib/ppom/ppom-util":132,"./lib/rpc-method-middleware":152,"./lib/rpc-method-middleware/handlers/wallet-createSession":147,"./lib/segment":154,"./lib/signature/util":158,"./lib/snap-keyring":159,"./lib/snap-keyring/keyring-snaps-permissions":160,"./lib/state-utils":166,"./lib/stream-utils":171,"./lib/transaction/decode/util":177,"./lib/transaction/eip5792":178,"./lib/transaction/metrics":179,"./lib/transaction/util":181,"./lib/tx-verification/tx-verification-middleware":182,"./lib/util":183,"./services/data-deletion-service":356,"./translate":358,"@ethersproject/abi":476,"@metamask/accounts-controller":1236,"@metamask/address-book-controller":1247,"@metamask/announcement-controller":1249,"@metamask/approval-controller":1252,"@metamask/assets-controllers":1282,"@metamask/base-controller":1332,"@metamask/controller-utils":1360,"@metamask/ens-controller":1388,"@metamask/eth-json-rpc-filters":1443,"@metamask/eth-json-rpc-filters/subscriptionManager":1445,"@metamask/eth-json-rpc-middleware":1478,"@metamask/eth-ledger-bridge-keyring":1538,"@metamask/eth-sig-util":1589,"@metamask/eth-trezor-keyring":1753,"@metamask/gas-fee-controller":1818,"@metamask/json-rpc-engine":1827,"@metamask/json-rpc-middleware-stream":1831,"@metamask/keyring-api":1873,"@metamask/keyring-controller":1880,"@metamask/logging-controller":1952,"@metamask/metamask-airgapped-keyring":1967,"@metamask/metamask-eth-abis":2018,"@metamask/multichain":2075,"@metamask/name-controller":2093,"@metamask/network-controller":2105,"@metamask/notification-services-controller/notification-services":2280,"@metamask/notification-services-controller/push-services":2294,"@metamask/notification-services-controller/push-services/web":2300,"@metamask/obs-store":2315,"@metamask/obs-store/dist/asStream":2314,"@metamask/permission-controller":2322,"@metamask/permission-log-controller":2331,"@metamask/phishing-controller":2334,"@metamask/queued-request-controller":2446,"@metamask/remote-feature-flag-controller":2477,"@metamask/rpc-errors":2484,"@metamask/scure-bip39/dist/wordlists/english":2488,"@metamask/selected-network-controller":2500,"@metamask/signature-controller":2507,"@metamask/smart-transactions-controller":2557,"@metamask/smart-transactions-controller/dist/types":2558,"@metamask/snaps-rpc-methods":2630,"@metamask/snaps-utils":2777,"@metamask/transaction-controller":2829,"@metamask/user-operation-controller":2856,"@metamask/utils":2874,"@sentry/browser":3008,"await-semaphore":3841,buffer:3998,"eth-chainlist":4199,"eth-lattice-keyring":4204,events:4323,lodash:4779,loglevel:4787,nanoid:4883,"readable-stream":5198},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ONE_KEY_VIA_TREZOR_MINOR_VERSION=r.METAMASK_CONTROLLER_EVENTS=void 0;var n=Xt(e("events")),s=e("readable-stream"),i=e("@metamask/assets-controllers"),a=e("@metamask/json-rpc-engine"),o=e("@metamask/json-rpc-middleware-stream"),c=e("@metamask/obs-store"),l=e("@metamask/obs-store/dist/asStream"),u=e("@metamask/eth-json-rpc-middleware"),d=e("lodash"),h=e("@metamask/keyring-controller"),p=Xt(e("@metamask/eth-json-rpc-filters")),m=Xt(e("@metamask/eth-json-rpc-filters/subscriptionManager")),g=e("@metamask/rpc-errors"),f=e("await-semaphore"),y=Xt(e("loglevel")),b=e("@metamask/eth-trezor-keyring"),v=e("@metamask/eth-ledger-bridge-keyring"),w=Xt(e("eth-lattice-keyring")),k=e("eth-chainlist"),C=e("@metamask/metamask-airgapped-keyring"),T=e("nanoid"),_=e("@sentry/browser"),S=e("@metamask/address-book-controller"),E=e("@metamask/approval-controller"),A=e("@metamask/base-controller"),M=e("@metamask/ens-controller"),P=e("@metamask/phishing-controller"),I=e("@metamask/announcement-controller"),x=e("@metamask/network-controller"),N=e("@metamask/gas-fee-controller"),B=e("@metamask/permission-controller"),R=Xt(e("@metamask/smart-transactions-controller")),O=e("@metamask/smart-transactions-controller/dist/types"),j=e("@metamask/selected-network-controller"),D=e("@metamask/logging-controller"),L=e("@metamask/permission-log-controller"),U=e("@metamask/snaps-rpc-methods"),F=e("@metamask/controller-utils"),$=e("@metamask/accounts-controller"),K=e("@metamask/remote-feature-flag-controller"),q=e("@metamask/signature-controller"),H=e("@metamask/scure-bip39/dist/wordlists/english"),z=e("@metamask/name-controller"),V=e("@metamask/queued-request-controller"),Z=e("@metamask/user-operation-controller"),G=e("@metamask/transaction-controller"),W=e("@metamask/snaps-utils"),J=e("@ethersproject/abi"),Q=e("@metamask/metamask-eth-abis"),Y=e("@metamask/keyring-api"),X=e("@metamask/utils"),ee=e("@metamask/eth-sig-util"),te=e("@metamask/notification-services-controller/notification-services"),re=e("@metamask/notification-services-controller/push-services"),ne=e("@metamask/notification-services-controller/push-services/web"),se=e("@metamask/multichain"),ie=e("../../shared/constants/methods-tags"),ae=e("../../shared/constants/transaction"),oe=e("../../shared/constants/swaps"),ce=e("../../shared/constants/network"),le=e("../../shared/constants/smartTransactions"),ue=e("../../shared/constants/hardware-wallets"),de=e("../../shared/constants/keyring"),he=e("../../shared/constants/permissions"),pe=e("../../shared/notifications"),me=e("../../shared/constants/time"),ge=e("../../shared/constants/app"),fe=e("../../shared/constants/metametrics"),ye=e("../../shared/constants/logs"),be=e("../../shared/lib/storage-helpers"),ve=e("../../shared/lib/token-util"),we=e("../../shared/modules/string-utils"),ke=e("../../shared/modules/transaction.utils"),Ce=e("../../shared/constants/tokens"),Te=e("../../shared/lib/metamask-controller-utils"),_e=e("../../shared/modules/mv3.utils"),Se=e("../../shared/modules/network.utils"),Ee=e("../../shared/modules/selectors"),Ae=(e("../../shared/modules/caip-stream"),e("../../shared/constants/urls")),Me=e("../../shared/lib/transactions-controller-utils"),Pe=e("../../shared/modules/selectors/networks"),Ie=e("../../shared/lib/trace"),xe=e("../../shared/types/bridge-status"),Ne=e("../../development/build/constants"),Be=Xt(e("../../shared/lib/fetch-with-cache")),Re=e("../../shared/types/bridge"),Oe=e("./lib/transaction/metrics"),je=e("./lib/snap-keyring/keyring-snaps-permissions"),De=e("./lib/SnapsNameProvider"),Le=e("./lib/AddressBookPetnamesBridge"),Ue=e("./lib/AccountIdentitiesPetnamesBridge"),Fe=e("./lib/ppom/ppom-middleware"),$e=e("./detect-multiple-instances"),Ke=Xt(e("./lib/ComposableObservableStore")),qe=Xt(e("./controllers/account-tracker-controller")),He=Xt(e("./lib/createDupeReqFilterStream")),ze=Xt(e("./lib/createLoggerMiddleware")),Ve=e("./lib/rpc-method-middleware"),Ze=Xt(e("./lib/createOriginMiddleware")),Ge=Xt(e("./lib/createMainFrameOriginMiddleware")),We=Xt(e("./lib/createTabIdMiddleware")),Je=e("./controllers/network-order"),Qe=e("./controllers/account-order"),Ye=Xt(e("./lib/createOnboardingMiddleware")),Xe=e("./lib/stream-utils"),et=e("./controllers/preferences-controller"),tt=e("./controllers/app-state-controller"),rt=e("./controllers/alert-controller"),nt=Xt(e("./controllers/onboarding")),st=Xt(e("./lib/backup")),it=Xt(e("./controllers/decrypt-message")),at=Xt(e("./controllers/swaps")),ot=Xt(e("./controllers/metametrics-controller")),ct=e("./lib/segment"),lt=Xt(e("./lib/createMetaRPCHandler")),ut=e("./lib/util"),dt=Xt(e("./lib/createMetamaskMiddleware")),ht=e("./lib/hardware-keyring-builder-factory"),pt=Xt(e("./controllers/encryption-public-key")),mt=Xt(e("./controllers/app-metadata")),gt=e("./controllers/permissions"),ft=e("./controllers/metametrics-data-deletion/metametrics-data-deletion"),yt=e("./services/data-deletion-service"),bt=Xt(e("./lib/createRPCMethodTrackingMiddleware")),vt=e("./translate"),wt=e("./lib/offscreen-bridge/trezor-offscreen-bridge"),kt=e("./lib/offscreen-bridge/ledger-offscreen-bridge"),Ct=e("./lib/snap-keyring"),Tt=e("./lib/encryptor-factory"),_t=e("./lib/transaction/util"),St=e("./lib/signature/util"),Et=e("./lib/offscreen-bridge/lattice-offscreen-keyring"),At=e("./lib/WeakRefObjectMap"),Mt=e("./constants/stream"),Pt=e("./lib/tx-verification/tx-verification-middleware"),It=e("./lib/ppom/ppom-util"),xt=Xt(e("./lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware")),Nt=e("./lib/multichain/address"),Bt=e("./lib/transaction/decode/util"),Rt=Xt(e("./controllers/bridge/bridge-controller")),Ot=e("./controllers/bridge/constants"),jt=e("./controllers/push-notifications"),Dt=Xt(e("./lib/createTracingMiddleware")),Lt=Xt(e("./lib/createOriginThrottlingMiddleware")),Ut=e("./lib/PatchStore"),Ft=e("./lib/state-utils"),$t=(e("./lib/rpc-method-middleware/handlers/wallet-createSession"),Xt(e("./controllers/bridge-status/bridge-status-controller"))),Kt=e("./controllers/bridge-status/constants"),qt=e("./lib/approval/utils"),Ht=e("./lib/bridge-status/metrics"),zt=e("./controller-init/multichain"),Vt=e("./controller-init/confirmations/transaction-controller-init"),Zt=e("./controller-init/confirmations/ppom-controller-init"),Gt=e("./controller-init/utils"),Wt=e("./controller-init/snaps"),Jt=e("./controller-init/identity/authentication-controller-init"),Qt=e("./controller-init/identity/user-storage-controller-init"),Yt=e("./lib/transaction/eip5792");function Xt(e){return e&&e.__esModule?e:{default:e}}function er(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function tr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rr(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}r.METAMASK_CONTROLLER_EVENTS={UPDATE_BADGE:"updateBadge",DECRYPT_MESSAGE_MANAGER_UPDATE_BADGE:"DecryptMessageManager:updateBadge",ENCRYPTION_PUBLIC_KEY_MANAGER_UPDATE_BADGE:"EncryptionPublicKeyManager:updateBadge",APPROVAL_STATE_CHANGE:"ApprovalController:stateChange",APP_STATE_UNLOCK_CHANGE:"AppStateController:unlockChange",QUEUED_REQUEST_STATE_CHANGE:"QueuedRequestController:stateChange",METAMASK_NOTIFICATIONS_LIST_UPDATED:"NotificationServicesController:notificationsListUpdated",METAMASK_NOTIFICATIONS_MARK_AS_READ:"NotificationServicesController:markNotificationsAsRead"};const nr="eip-1193",sr="caip-multichain",ir=r.ONE_KEY_VIA_TREZOR_MINOR_VERSION=99,ar={[Ne.ENVIRONMENT.DEVELOPMENT]:K.EnvironmentType.Development,[Ne.ENVIRONMENT.RELEASE_CANDIDATE]:K.EnvironmentType.ReleaseCandidate,[Ne.ENVIRONMENT.PRODUCTION]:K.EnvironmentType.Production},or={flask:K.DistributionType.Flask,main:K.DistributionType.Main,beta:K.DistributionType.Beta};var cr=new WeakSet;class lr extends n.default{constructor(e){var t;super(),er(this,cr),tr(this,"_trackSnapExportUsage",(0,d.wrap)((0,d.memoize)((()=>(0,d.throttle)(((e,t,r,n)=>{var s;return this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.SnapExportUsed,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,export:t,snap_category:null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category,success:r,origin:n}})}),60*me.SECOND)),((e,t,r,n)=>`${e}${t}${n}`)),((e,...t)=>e(...t)(...t)))),tr(this,"handleWatchAssetRequest",(({asset:e,type:t,origin:r,networkClientId:n})=>{switch(t){case F.ERC20:return this.tokensController.watchAsset({asset:e,type:t,networkClientId:n});case F.ERC721:case F.ERC1155:return this.nftController.watchNft(e,t,r);default:throw new Error(`Asset type ${t} not supported`)}})),tr(this,"removePermissionsFor",(e=>{try{this.permissionController.revokePermissions(e)}catch(e){if(!(e instanceof B.PermissionsRequestNotFoundError))throw e}})),tr(this,"updateCaveat",((e,t,r,n)=>{try{this.controllerMessenger.call("PermissionController:updateCaveat",e,t,r,n)}catch(e){if(!(e instanceof B.PermissionsRequestNotFoundError))throw e}})),tr(this,"updateNetworksList",(e=>{try{this.networkOrderController.updateNetworksList(e)}catch(e){throw y.default.error(e.message),e}})),tr(this,"updateAccountsList",(e=>{try{this.accountOrderController.updateAccountsList(e)}catch(e){throw y.default.error(e.message),e}})),tr(this,"updateHiddenAccountsList",(e=>{try{this.accountOrderController.updateHiddenAccountsList(e)}catch(e){throw y.default.error(e.message),e}})),tr(this,"rejectPermissionsRequest",(e=>{try{this.permissionController.rejectPermissionsRequest(e)}catch(e){if(!(e instanceof B.PermissionsRequestNotFoundError))throw e}})),tr(this,"acceptPermissionsRequest",(e=>{try{this.permissionController.acceptPermissionsRequest(e)}catch(e){if(!(e instanceof B.PermissionsRequestNotFoundError))throw e}})),tr(this,"resolvePendingApproval",(async(e,t,r)=>{try{await this.approvalController.accept(e,t,r)}catch(e){if(!(e instanceof E.ApprovalRequestNotFoundError))throw e}})),tr(this,"rejectPendingApproval",((e,t)=>{try{this.approvalController.reject(e,new g.JsonRpcError(t.code,t.message,t.data))}catch(e){if(!(e instanceof E.ApprovalRequestNotFoundError))throw e}}));const{isFirstMetaMaskControllerSetup:r}=e;this.defaultMaxListeners=20,this.sendUpdate=(0,d.debounce)(this.privateSendUpdate.bind(this),200*me.MILLISECOND),this.opts=e,this.extension=e.browser,this.platform=e.platform,this.notificationManager=e.notificationManager;const n=e.initState||{},s="12.15.2";this.recordFirstTimeInfo(n),this.featureFlags=e.featureFlags,this.activeControllerConnections=0,this.offscreenPromise=e.offscreenPromise??Promise.resolve(),this.getRequestAccountTabIds=e.getRequestAccountTabIds,this.getOpenMetamaskTabsIds=e.getOpenMetamaskTabsIds,this.initializeChainlist(),this.controllerMessenger=new A.Messenger,this.loggingController=new D.LoggingController({messenger:this.controllerMessenger.getRestricted({name:"LoggingController",allowedActions:[],allowedEvents:[]}),state:n.LoggingController}),this.localStoreApiWrapper=e.persistanceManager,this.currentMigrationVersion=e.currentMigrationVersion,this.store=new Ke.default({state:n,controllerMessenger:this.controllerMessenger,persist:!0}),this.connections={},this.createVaultMutex=new f.Mutex,this.extension.runtime.onInstalled.addListener((e=>{"update"===e.reason&&this.loggingController.add({type:D.LogType.GenericLog,data:{event:ye.LOG_EVENT.VERSION_UPDATE,previousVersion:e.previousVersion,version:s}})})),this.appMetadataController=new mt.default({state:n.AppMetadataController,messenger:this.controllerMessenger.getRestricted({name:"AppMetadataController",allowedActions:[],allowedEvents:[]}),currentMigrationVersion:this.currentMigrationVersion,currentAppVersion:s});const a=()=>{this.encryptionPublicKeyController.clearUnapproved(),this.decryptMessageController.clearUnapproved(),this.signatureController.clearUnapproved(),this.approvalController.clear(g.providerErrors.userRejectedRequest())};this.approvalController=new E.ApprovalController({messenger:this.controllerMessenger.getRestricted({name:"ApprovalController"}),showApprovalRequest:e.showUserConfirmation,typesExcludedFromRateLimiting:[F.ApprovalType.PersonalSign,F.ApprovalType.EthSignTypedData,F.ApprovalType.Transaction,F.ApprovalType.WatchAsset,F.ApprovalType.EthGetEncryptionPublicKey,F.ApprovalType.EthDecrypt,ge.SMART_TRANSACTION_CONFIRMATION_TYPES.showSmartTransactionStatusPage]}),this.queuedRequestController=new V.QueuedRequestController({messenger:this.controllerMessenger.getRestricted({name:"QueuedRequestController",allowedActions:["NetworkController:getState","NetworkController:setActiveNetwork","SelectedNetworkController:getNetworkClientIdForDomain"],allowedEvents:["SelectedNetworkController:stateChange"]}),shouldRequestSwitchNetwork:({method:e})=>ie.methodsRequiringNetworkSwitch.includes(e),canRequestSwitchNetworkWithoutApproval:({method:e})=>ie.methodsThatCanSwitchNetworkWithoutApproval.includes(e),clearPendingConfirmations:a,showApprovalRequest:()=>{this.approvalController.getTotalApprovalCount()>0&&e.showUserConfirmation()}});const o=this.controllerMessenger.getRestricted({name:"NetworkController"});let c=n.NetworkController;if(!c){c=(0,x.getDefaultNetworkControllerState)();const e=c.networkConfigurationsByChainId;let t;e[ce.CHAIN_IDS.MAINNET].name=ce.MAINNET_DISPLAY_NAME,delete e[ce.CHAIN_IDS.GOERLI],delete e[ce.CHAIN_IDS.LINEA_GOERLI],e[ce.CHAIN_IDS.MEGAETH_TESTNET]=(0,d.cloneDeep)(ce.DEFAULT_CUSTOM_TESTNET_MAP[ce.CHAIN_IDS.MEGAETH_TESTNET]),Object.values(e).forEach((e=>{const t=e.rpcEndpoints[0].networkClientId;(0,X.hasProperty)(F.BlockExplorerUrl,t)&&(e.blockExplorerUrls=[F.BlockExplorerUrl[t]]),e.defaultBlockExplorerUrlIndex=0})),t=e[ce.CHAIN_IDS.MAINNET],c.selectedNetworkClientId=t.rpcEndpoints[t.defaultRpcEndpointIndex].networkClientId}this.networkController=new x.NetworkController({messenger:o,state:c,infuraProjectId:e.infuraProjectId}),this.networkController.initializeProvider(),this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker,this.deprecatedNetworkVersions={};const l=this.controllerMessenger.getRestricted({name:"AccountsController",allowedEvents:["SnapController:stateChange","KeyringController:accountRemoved","KeyringController:stateChange","SnapKeyring:accountAssetListUpdated","SnapKeyring:accountBalancesUpdated","SnapKeyring:accountTransactionsUpdated","MultichainNetworkController:networkDidChange"],allowedActions:["KeyringController:getAccounts","KeyringController:getKeyringsByType","KeyringController:getKeyringForAccount"]});this.accountsController=new $.AccountsController({messenger:l,state:n.AccountsController});const u=this.controllerMessenger.getRestricted({name:"PreferencesController",allowedActions:["AccountsController:setSelectedAccount","AccountsController:getSelectedAccount","AccountsController:getAccountByAddress","AccountsController:setAccountName","NetworkController:getState"],allowedEvents:["AccountsController:stateChange"]});this.preferencesController=new et.PreferencesController({state:{currentLocale:e.initLangCode??"",...n.PreferencesController},messenger:u});const p=this.controllerMessenger.getRestricted({name:"TokenListController",allowedActions:["NetworkController:getNetworkClientById"],allowedEvents:["NetworkController:stateChange"]});this.tokenListController=new i.TokenListController({chainId:rr(cr,this,pr).call(this,{metamask:this.networkController.state}),preventPollingOnNetworkRestart:!rr(cr,this,hr).call(this,this.preferencesController.state),messenger:p,state:n.TokenListController});const m=this.controllerMessenger.getRestricted({name:"AssetsContractController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getSelectedNetworkClient","NetworkController:getState"],allowedEvents:["PreferencesController:stateChange","NetworkController:networkDidChange"]});this.assetsContractController=new i.AssetsContractController({messenger:m,chainId:rr(cr,this,pr).call(this)});const k=this.controllerMessenger.getRestricted({name:"TokensController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","AccountsController:getSelectedAccount","AccountsController:getAccount"],allowedEvents:["NetworkController:networkDidChange","AccountsController:selectedEvmAccountChange","PreferencesController:stateChange","TokenListController:stateChange","NetworkController:stateChange"]});this.tokensController=new i.TokensController({state:n.TokensController,provider:this.provider,messenger:k,chainId:rr(cr,this,pr).call(this)});const T=this.controllerMessenger.getRestricted({name:"NftController",allowedEvents:["PreferencesController:stateChange","NetworkController:networkDidChange","AccountsController:selectedEvmAccountChange"],allowedActions:[`${this.approvalController.name}:addRequest`,`${this.networkController.name}:getNetworkClientById`,"AccountsController:getSelectedAccount","AccountsController:getAccount","AssetsContractController:getERC721AssetName","AssetsContractController:getERC721AssetSymbol","AssetsContractController:getERC721TokenURI","AssetsContractController:getERC721OwnerOf","AssetsContractController:getERC1155BalanceOf","AssetsContractController:getERC1155TokenURI"]});this.nftController=new i.NftController({state:n.NftController,messenger:T,chainId:rr(cr,this,pr).call(this),onNftAdded:({address:e,symbol:t,tokenId:r,standard:n,source:s})=>this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.NftAdded,category:fe.MetaMetricsEventCategory.Wallet,sensitiveProperties:{token_contract_address:e,token_symbol:t,token_id:r,token_standard:n,asset_type:ae.AssetType.NFT,source:s}})});const U=this.controllerMessenger.getRestricted({name:"NftDetectionController",allowedEvents:["NetworkController:stateChange","PreferencesController:stateChange"],allowedActions:["ApprovalController:addRequest","NetworkController:getState","NetworkController:getNetworkClientById","AccountsController:getSelectedAccount"]});this.nftDetectionController=new i.NftDetectionController({messenger:U,chainId:rr(cr,this,pr).call(this),getOpenSeaApiKey:()=>this.nftController.openSeaApiKey,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),addNft:this.nftController.addNft.bind(this.nftController),getNftState:()=>this.nftController.state,disabled:!this.preferencesController.state.useNftDetection});const H=this.controllerMessenger.getRestricted({name:"MetaMetricsController",allowedActions:["PreferencesController:getState","NetworkController:getState","NetworkController:getNetworkClientById"],allowedEvents:["PreferencesController:stateChange","NetworkController:networkDidChange"]});this.metaMetricsController=new ot.default({state:n.MetaMetricsController,messenger:H,segment:ct.segment,version:"12.15.2",environment:"production",extension:this.extension,captureException:_.captureException}),this.on("update",(e=>{this.metaMetricsController.handleMetaMaskStateUpdate(e)}));const W=new yt.DataDeletionService,J=this.controllerMessenger.getRestricted({name:"MetaMetricsDataDeletionController",allowedActions:["MetaMetricsController:getState"],allowedEvents:[]});this.metaMetricsDataDeletionController=new ft.MetaMetricsDataDeletionController({dataDeletionService:W,messenger:J,state:n.metaMetricsDataDeletionController});const Q=this.controllerMessenger.getRestricted({name:"GasFeeController",allowedActions:["NetworkController:getEIP1559Compatibility","NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:["NetworkController:stateChange"]}),Y=oe.GAS_API_BASE_URL;this.gasFeeController=new N.GasFeeController({state:n.GasFeeController,interval:1e4,messenger:Q,clientId:oe.SWAPS_CLIENT_ID,getProvider:()=>this.networkController.getProviderAndBlockTracker().provider,onNetworkDidChange:e=>{o.subscribe("NetworkController:networkDidChange",(()=>e(this.networkController.state)))},getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),legacyAPIEndpoint:`${Y}/networks/<chain_id>/gasPrices`,EIP1559APIEndpoint:`${Y}/networks/<chain_id>/suggestedGasFees`,getCurrentNetworkLegacyGasAPICompatibility:()=>rr(cr,this,pr).call(this)===ce.CHAIN_IDS.BSC,getChainId:()=>rr(cr,this,pr).call(this)}),this.appStateController=new tt.AppStateController({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),state:n.AppStateController,onInactiveTimeout:()=>this.setLocked(),messenger:this.controllerMessenger.getRestricted({name:"AppStateController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,"PreferencesController:getState"],allowedEvents:["KeyringController:qrKeyringStateChange","PreferencesController:stateChange"]}),extension:this.extension});const ee=this.controllerMessenger.getRestricted({name:"CurrencyRateController",allowedActions:[`${this.networkController.name}:getNetworkClientById`]});this.currencyRateController=new i.CurrencyRateController({includeUsdRate:!0,messenger:ee,state:n.CurrencyController});const se=this.currencyRateController.fetchMultiExchangeRate.bind(this.currencyRateController);this.currencyRateController.fetchMultiExchangeRate=(...e)=>this.preferencesController.state.useCurrencyRateCheck?se(...e):{conversionRate:null,usdConversionRate:null};const ue=this.controllerMessenger.getRestricted({name:"TokenBalancesController",allowedActions:["NetworkController:getState","NetworkController:getNetworkClientById","TokensController:getState","PreferencesController:getState","AccountsController:getSelectedAccount"],allowedEvents:["PreferencesController:stateChange","TokensController:stateChange","NetworkController:stateChange"]});this.tokenBalancesController=new i.TokenBalancesController({messenger:ue,state:n.TokenBalancesController,interval:3e4});const de=this.controllerMessenger.getRestricted({name:"PhishingController"});this.phishingController=new P.PhishingController({messenger:de,state:n.PhishingController,hotlistRefreshInterval:undefined,stalelistRefreshInterval:undefined});const be=this.controllerMessenger.getRestricted({name:"AnnouncementController"});this.announcementController=new I.AnnouncementController({messenger:be,allAnnouncements:pe.UI_NOTIFICATIONS,state:n.AnnouncementController});const ve=this.controllerMessenger.getRestricted({name:"NetworkOrderController",allowedEvents:["NetworkController:stateChange"]});this.networkOrderController=new Je.NetworkOrderController({messenger:ve,state:n.NetworkOrderController});const we=this.controllerMessenger.getRestricted({name:"AccountOrderController"});this.accountOrderController=new Qe.AccountOrderController({messenger:we,state:n.AccountOrderController});const ke=this.controllerMessenger.getRestricted({name:"RatesController"});this.multichainRatesController=new i.RatesController({state:n.MultichainRatesController,messenger:ke,includeUsdRate:!0,fetchMultiExchangeRate:i.fetchMultiExchangeRate});const Ce=this.controllerMessenger.getRestricted({name:"TokenRatesController",allowedActions:["TokensController:getState","NetworkController:getNetworkClientById","NetworkController:getState","AccountsController:getAccount","AccountsController:getSelectedAccount"],allowedEvents:["NetworkController:stateChange","AccountsController:selectedEvmAccountChange","PreferencesController:stateChange","TokensController:stateChange"]});this.tokenRatesController=new i.TokenRatesController({state:n.TokenRatesController,messenger:Ce,tokenPricesService:new i.CodefiTokenPricesServiceV2,disabled:!this.preferencesController.state.useCurrencyRateCheck}),this.controllerMessenger.subscribe("PreferencesController:stateChange",(0,ut.previousValueComparator)(((e,t)=>{const{useCurrencyRateCheck:r}=e,{useCurrencyRateCheck:n}=t;n&&!r?this.tokenRatesController.enable():!n&&r&&this.tokenRatesController.disable()}),this.preferencesController.state)),this.ensController=new M.EnsController({messenger:this.controllerMessenger.getRestricted({name:"EnsController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:[]}),onNetworkDidChange:o.subscribe.bind(o,"NetworkController:networkDidChange")});const Te=this.controllerMessenger.getRestricted({name:"OnboardingController",allowedActions:[],allowedEvents:[]});this.onboardingController=new nt.default({messenger:Te,state:n.OnboardingController});let Se=[(0,h.keyringBuilderFactory)(C.MetaMaskKeyring)];const Ae=null===(t=this.opts.overrides)||void 0===t?void 0:t.keyrings;if(!1===_e.isManifestV3){const e=[(null==Ae?void 0:Ae.lattice)||w.default,C.MetaMaskKeyring],t=[{keyring:(null==Ae?void 0:Ae.trezor)||b.TrezorKeyring,bridge:(null==Ae?void 0:Ae.trezorBridge)||b.TrezorConnectBridge},{keyring:(null==Ae?void 0:Ae.ledger)||v.LedgerKeyring,bridge:(null==Ae?void 0:Ae.ledgerBridge)||v.LedgerIframeBridge}];Se=e.map((e=>(0,h.keyringBuilderFactory)(e))),t.forEach((e=>Se.push((0,ht.hardwareKeyringBuilderFactory)(e.keyring,e.bridge))))}else Se.push((0,ht.hardwareKeyringBuilderFactory)(b.TrezorKeyring,(null==Ae?void 0:Ae.trezorBridge)||wt.TrezorOffscreenBridge),(0,ht.hardwareKeyringBuilderFactory)(v.LedgerKeyring,(null==Ae?void 0:Ae.ledgerBridge)||kt.LedgerOffscreenBridge),(0,h.keyringBuilderFactory)(Et.LatticeKeyringOffscreen));const Me=this.controllerMessenger.getRestricted({name:"SnapKeyring",allowedActions:["ApprovalController:addRequest","ApprovalController:acceptRequest","ApprovalController:rejectRequest","ApprovalController:startFlow","ApprovalController:endFlow","ApprovalController:showSuccess","ApprovalController:showError","PhishingController:test","PhishingController:maybeUpdateState","KeyringController:getAccounts","AccountsController:setSelectedAccount","AccountsController:getAccountByAddress","AccountsController:setAccountName","AccountsController:listMultichainAccounts","SnapController:handleRequest","SnapController:get","PreferencesController:getState"]}),xe=async()=>{await this.keyringController.persistAllKeyrings(),await this.accountsController.updateAccounts()};Se.push((0,Ct.snapKeyringBuilder)(Me,{persistKeyringHelper:()=>xe(),removeAccountHelper:e=>this.removeAccount(e),trackEvent:(...e)=>this.metaMetricsController.trackEvent(...e)}));const Ne=this.controllerMessenger.getRestricted({name:"KeyringController"});this.keyringController=new h.KeyringController({cacheEncryptionKey:!0,keyringBuilders:Se,state:n.KeyringController,encryptor:e.encryptor||(0,Tt.encryptorFactory)(6e5),messenger:Ne}),this.controllerMessenger.subscribe("KeyringController:unlock",(()=>this._onUnlock())),this.controllerMessenger.subscribe("KeyringController:lock",(()=>this._onLock())),this.controllerMessenger.subscribe("KeyringController:stateChange",(e=>{this._onKeyringControllerUpdate(e)})),this.permissionController=new B.PermissionController({messenger:this.controllerMessenger.getRestricted({name:"PermissionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:hasRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,"SnapController:getPermitted","SnapController:install","SubjectMetadataController:getSubjectMetadata"]}),state:n.PermissionController,caveatSpecifications:(0,gt.getCaveatSpecifications)({listAccounts:this.accountsController.listAccounts.bind(this.accountsController),findNetworkClientIdByChainId:this.networkController.findNetworkClientIdByChainId.bind(this.networkController)}),permissionSpecifications:{...(0,gt.getPermissionSpecifications)(),...this.getSnapPermissionSpecifications()},unrestrictedMethods:gt.unrestrictedMethods}),this.selectedNetworkController=new j.SelectedNetworkController({messenger:this.controllerMessenger.getRestricted({name:"SelectedNetworkController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState","NetworkController:getSelectedNetworkClient","PermissionController:hasPermissions","PermissionController:getSubjectNames"],allowedEvents:["NetworkController:stateChange","PermissionController:stateChange"]}),state:n.SelectedNetworkController,useRequestQueuePreference:!0,onPreferencesStateChange:()=>{},domainProxyMap:new At.WeakRefObjectMap}),this.permissionLogController=new L.PermissionLogController({messenger:this.controllerMessenger.getRestricted({name:"PermissionLogController"}),restrictedMethods:new Set(Object.keys(he.RestrictedMethods)),state:n.PermissionLogController}),this.subjectMetadataController=new B.SubjectMetadataController({messenger:this.controllerMessenger.getRestricted({name:"SubjectMetadataController",allowedActions:[`${this.permissionController.name}:hasPermissions`]}),state:n.SubjectMetadataController,subjectCacheLimit:100});const Be=this.controllerMessenger.getRestricted({name:"NotificationServicesPushController",allowedActions:["AuthenticationController:getBearerToken"],allowedEvents:[]});this.notificationServicesPushController=new re.Controller({messenger:Be,state:n.NotificationServicesPushController,env:{apiKey:"AIzaSyAA6MJdRkQ00zNh_moTLwxCSxcg3vznbBM",authDomain:"notifications-faf39.firebaseapp.com",storageBucket:"notifications-faf39.appspot.com",projectId:"notifications-faf39",messagingSenderId:"824598429541",appId:"1:824598429541:web:3016d3c90f1f19a6beab8c",measurementId:"G-1FGDTTCWX5",vapidKey:"BBbjhCfHvwIqRsUrBvpfx0viLJIzWHp-beyw8-I124jeZlhNGDOegS_0_I029fFb2stzRuaNkCdTAf9F3I2m3wc"},config:{isPushFeatureEnabled:_e.isManifestV3,platform:"extension",pushService:{createRegToken:ne.createRegToken,deleteRegToken:ne.deleteRegToken,subscribeToPushNotifications:(0,ne.createSubscribeToPushNotifications)({messenger:Be,onReceivedHandler:jt.onPushNotificationReceived,onClickHandler:jt.onPushNotificationClicked})}}}),Be.subscribe("NotificationServicesPushController:onNewNotifications",(e=>{this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.PushNotifications,event:fe.MetaMetricsEventName.PushNotificationReceived,properties:{notification_id:e.id,notification_type:e.type,chain_id:null==e?void 0:e.chain_id}})})),Be.subscribe("NotificationServicesPushController:pushNotificationClicked",(e=>{this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.PushNotifications,event:fe.MetaMetricsEventName.PushNotificationClicked,properties:{notification_id:e.id,notification_type:e.type,chain_id:null==e?void 0:e.chain_id}})}));const Re=this.controllerMessenger.getRestricted({name:"NotificationServicesController",allowedActions:["KeyringController:getAccounts","KeyringController:getState","AuthenticationController:getBearerToken","AuthenticationController:isSignedIn","AuthenticationController:performSignIn","UserStorageController:getStorageKey","UserStorageController:performGetStorage","UserStorageController:performSetStorage","NotificationServicesPushController:enablePushNotifications","NotificationServicesPushController:disablePushNotifications","NotificationServicesPushController:subscribeToPushNotifications","NotificationServicesPushController:updateTriggerPushNotifications"],allowedEvents:["KeyringController:stateChange","KeyringController:lock","KeyringController:unlock","NotificationServicesPushController:onNewNotifications","NotificationServicesPushController:stateChange"]});this.notificationServicesController=new te.Controller({messenger:Re,state:n.NotificationServicesController,env:{isPushIntegrated:_e.isManifestV3,featureAnnouncements:{platform:"extension",spaceId:"jdkgyfmyd9sw",accessToken:"mAYNB_k65snv4AXW4o8ksZN8BwWDQF9702HKV7yBDZI"}}}),this.accountTrackerController=new qe.default({state:{accounts:{}},messenger:this.controllerMessenger.getRestricted({name:"AccountTrackerController",allowedActions:["AccountsController:getSelectedAccount","NetworkController:getState","NetworkController:getNetworkClientById","OnboardingController:getState","PreferencesController:getState"],allowedEvents:["AccountsController:selectedEvmAccountChange","OnboardingController:stateChange","KeyringController:accountRemoved"]}),provider:this.provider,blockTracker:this.blockTracker,getNetworkIdentifier:e=>{const{type:t,rpcUrl:r}=e??(0,Pe.getProviderConfig)({metamask:this.networkController.state});return t===ce.NETWORK_TYPES.RPC?r:t}}),this.on("controllerConnectionChanged",(e=>{const{completedOnboarding:t}=this.onboardingController.state;e>0&&t?this.triggerNetworkrequests():this.stopNetworkRequests()})),this.controllerMessenger.subscribe(`${this.onboardingController.name}:stateChange`,(0,ut.previousValueComparator)((async(e,t)=>{const{completedOnboarding:r}=e,{completedOnboarding:n}=t;if(!r&&n){const{address:e}=this.accountsController.getSelectedAccount();await this._addAccountsWithBalance(),this.postOnboardingInitialization(),this.triggerNetworkrequests(),await this.tokenDetectionController.detectTokens({selectedAddress:e})}}),this.onboardingController.state));const Oe=this.controllerMessenger.getRestricted({name:"TokenDetectionController",allowedActions:["AccountsController:getAccount","AccountsController:getSelectedAccount","KeyringController:getState","NetworkController:getNetworkClientById","NetworkController:getNetworkConfigurationByNetworkClientId","NetworkController:getState","PreferencesController:getState","TokenListController:getState","TokensController:getState","TokensController:addDetectedTokens"],allowedEvents:["AccountsController:selectedEvmAccountChange","KeyringController:lock","KeyringController:unlock","NetworkController:networkDidChange","PreferencesController:stateChange","TokenListController:stateChange"]});this.tokenDetectionController=new i.TokenDetectionController({messenger:Oe,getBalancesInSingleCall:this.assetsContractController.getBalancesInSingleCall.bind(this.assetsContractController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),useAccountsAPI:!0,platform:"extension"});const je=this.controllerMessenger.getRestricted({name:"AddressBookController",allowedActions:[],allowedEvents:[]});this.addressBookController=new S.AddressBookController({messenger:je,state:n.AddressBookController}),this.alertController=new rt.AlertController({state:n.AlertController,messenger:this.controllerMessenger.getRestricted({name:"AlertController",allowedEvents:["AccountsController:selectedAccountChange"],allowedActions:["AccountsController:getSelectedAccount"]})}),this.backup=new st.default({preferencesController:this.preferencesController,addressBookController:this.addressBookController,accountsController:this.accountsController,networkController:this.networkController,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.snapAndHardwareMetricsParams={getSelectedAccount:this.accountsController.getSelectedAccount.bind(this.accountsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]})},this._addBridgeStatusControllerListeners(),this.decryptMessageController=new it.default({getState:this.getState.bind(this),messenger:this.controllerMessenger.getRestricted({name:"DecryptMessageController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`,`${this.keyringController.name}:decryptMessage`],allowedEvents:["DecryptMessageManager:stateChange","DecryptMessageManager:unapprovedMessage"]}),managerMessenger:this.controllerMessenger.getRestricted({name:"DecryptMessageManager"}),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.encryptionPublicKeyController=new pt.default({messenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`],allowedEvents:["EncryptionPublicKeyManager:stateChange","EncryptionPublicKeyManager:unapprovedMessage"]}),managerMessenger:this.controllerMessenger.getRestricted({name:"EncryptionPublicKeyManager"}),getEncryptionPublicKey:this.keyringController.getEncryptionPublicKey.bind(this.keyringController),getAccountKeyringType:this.keyringController.getAccountKeyringType.bind(this.keyringController),getState:this.getState.bind(this),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.signatureController=new q.SignatureController({messenger:this.controllerMessenger.getRestricted({name:"SignatureController",allowedActions:[`${this.accountsController.name}:getState`,`${this.approvalController.name}:addRequest`,`${this.keyringController.name}:signMessage`,`${this.keyringController.name}:signPersonalMessage`,`${this.keyringController.name}:signTypedMessage`,`${this.loggingController.name}:add`,`${this.networkController.name}:getNetworkClientById`]}),trace:Ie.trace,decodingApiUrl:"https://signature-insights.api.cx.metamask.io/v1",isDecodeSignatureRequestEnabled:()=>this.preferencesController.state.useTransactionSimulations}),this.signatureController.hub.on("cancelWithReason",(({metadata:e,reason:t})=>{this.metaMetricsController.trackEvent({event:t,category:fe.MetaMetricsEventCategory.Transactions,properties:{action:"Sign Request",type:e.type}})}));const Fe=this.controllerMessenger.getRestricted({name:"SwapsController",allowedActions:["NetworkController:getState","NetworkController:getNetworkClientById","TokenRatesController:getState"],allowedEvents:[]});this.swapsController=new at.default({messenger:Fe,getBufferedGasLimit:async(e,t)=>{const{gas:r,simulationFails:n}=await this.txController.estimateGasBuffered(e.txParams,t,rr(cr,this,mr).call(this));return{gasLimit:r,simulationFails:n}},getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getLayer1GasFee:(...e)=>this.txController.getLayer1GasFee(...e),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},n.SwapsController);const He=this.controllerMessenger.getRestricted({name:Ot.BRIDGE_CONTROLLER_NAME,allowedActions:["AccountsController:getSelectedMultichainAccount","SnapController:handleRequest","NetworkController:getSelectedNetworkClient","NetworkController:findNetworkClientIdByChainId"],allowedEvents:[]});this.bridgeController=new Rt.default({messenger:He,getLayer1GasFee:(...e)=>this.txController.getLayer1GasFee(...e)});const ze=this.controllerMessenger.getRestricted({name:Kt.BRIDGE_STATUS_CONTROLLER_NAME,allowedActions:["AccountsController:getSelectedMultichainAccount","NetworkController:getNetworkClientById","NetworkController:findNetworkClientIdByChainId","NetworkController:getState","TransactionController:getState"],allowedEvents:[]});this.bridgeStatusController=new $t.default({messenger:ze,state:n.BridgeStatusController});const Ve=this.controllerMessenger.getRestricted({name:"SmartTransactionsController",allowedActions:["NetworkController:getNetworkClientById","NetworkController:getState"],allowedEvents:["NetworkController:stateChange"]});this.smartTransactionsController=new R.default({supportedChainIds:(0,le.getAllowedSmartTransactionsChainIds)(),clientId:O.ClientId.Extension,getNonceLock:e=>this.txController.getNonceLock(e,rr(cr,this,mr).call(this)),confirmExternalTransaction:(...e)=>this.txController.confirmExternalTransaction(...e),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),state:n.SmartTransactionsController,messenger:Ve,getTransactions:(...e)=>this.txController.getTransactions(...e),updateTransaction:(...e)=>this.txController.updateTransaction(...e),getFeatureFlags:()=>{const e=this._getMetaMaskState();return(0,Ee.getFeatureFlagsByChainId)(e)},getMetaMetricsProps:async()=>{const e=this.accountsController.getSelectedAccount().address;return{accountHardwareType:await this.getHardwareTypeForMetric(e),accountType:await this.getAccountType(e),deviceModel:await this.getDeviceModel(e)}}});const Ze=()=>this.preferencesController.state.useExternalNameSources;this.nameController=new z.NameController({messenger:this.controllerMessenger.getRestricted({name:"NameController",allowedActions:[]}),providers:[new z.ENSNameProvider({reverseLookup:this.ensController.reverseResolveAddress.bind(this.ensController)}),new z.EtherscanNameProvider({isEnabled:Ze}),new z.TokenNameProvider({isEnabled:Ze}),new z.LensNameProvider({isEnabled:Ze}),new De.SnapsNameProvider({messenger:this.controllerMessenger.getRestricted({name:"SnapsNameProvider",allowedActions:["SnapController:getAll","SnapController:get","SnapController:handleRequest","PermissionController:getState"]})})],state:n.NameController});const Ge=this.controllerMessenger.getRestricted({name:"PetnamesBridge",allowedEvents:["NameController:stateChange","AccountsController:stateChange","AddressBookController:stateChange"],allowedActions:["AccountsController:listAccounts"]});new Le.AddressBookPetnamesBridge({addressBookController:this.addressBookController,nameController:this.nameController,messenger:Ge}).init(),new Ue.AccountIdentitiesPetnamesBridge({nameController:this.nameController,messenger:Ge}).init(),this.userOperationController=new Z.UserOperationController({entrypoint:null,getGasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),messenger:this.controllerMessenger.getRestricted({name:"UserOperationController",allowedActions:["ApprovalController:addRequest","NetworkController:getNetworkClientById","KeyringController:prepareUserOperation","KeyringController:patchUserOperation","KeyringController:signUserOperation"]}),state:n.UserOperationController}),this.userOperationController.hub.on("user-operation-added",this._onUserOperationAdded.bind(this)),this.userOperationController.hub.on("transaction-updated",this._onUserOperationTransactionUpdated.bind(this)),o.subscribe("NetworkController:networkDidChange",(()=>{this.accountTrackerController.updateAccounts()})),o.subscribe("NetworkController:networkWillChange",a.bind(this)),this.controllerMessenger.subscribe("PreferencesController:stateChange",(0,ut.previousValueComparator)(((e,t)=>{const{useExternalServices:r}=e,{useExternalServices:n}=t;n&&!r?(this.remoteFeatureFlagController.enable(),this.remoteFeatureFlagController.updateRemoteFeatureFlags()):!n&&r&&this.remoteFeatureFlagController.disable()}),this.preferencesController.state)),this.remoteFeatureFlagController=new K.RemoteFeatureFlagController({messenger:this.controllerMessenger.getRestricted({name:"RemoteFeatureFlagController",allowedActions:[],allowedEvents:[]}),fetchInterval:9e5,disabled:!this.preferencesController.state.useExternalServices,getMetaMetricsId:()=>this.metaMetricsController.getMetaMetricsId(),clientConfigApiService:new K.ClientConfigApiService({fetch:globalThis.fetch.bind(globalThis),config:{client:K.ClientType.Extension,distribution:this._getConfigForRemoteFeatureFlagRequest().distribution,environment:this._getConfigForRemoteFeatureFlagRequest().environment}})});const We=[this.networkController,this.preferencesController,this.gasFeeController,this.onboardingController,this.keyringController,this.smartTransactionsController],Ye={ExecutionService:Wt.ExecutionServiceInit,RateLimitController:Wt.RateLimitControllerInit,SnapsRegistry:Wt.SnapsRegistryInit,SnapController:Wt.SnapControllerInit,SnapInsightsController:Wt.SnapInsightsControllerInit,SnapInterfaceController:Wt.SnapInterfaceControllerInit,CronjobController:Wt.CronjobControllerInit,PPOMController:Zt.PPOMControllerInit,TransactionController:Vt.TransactionControllerInit,MultichainNetworkController:zt.MultichainNetworkControllerInit,AuthenticationController:Jt.AuthenticationControllerInit,UserStorageController:Qt.UserStorageControllerInit},{controllerApi:Xe,controllerMemState:lt,controllerPersistedState:bt,controllersByName:vt}=rr(cr,this,gr).call(this,{existingControllers:We,initFunctions:Ye,initState:n});this.controllerApi=Xe,this.controllerMemState=lt,this.controllerPersistedState=bt,this.controllersByName=vt,this.cronjobController=vt.CronjobController,this.rateLimitController=vt.RateLimitController,this.snapController=vt.SnapController,this.snapInsightsController=vt.SnapInsightsController,this.snapInterfaceController=vt.SnapInterfaceController,this.snapsRegistry=vt.SnapsRegistry,this.ppomController=vt.PPOMController,this.txController=vt.TransactionController,this.multichainNetworkController=vt.MultichainNetworkController,this.authenticationController=vt.AuthenticationController,this.userStorageController=vt.UserStorageController,this.controllerMessenger.subscribe("TransactionController:transactionStatusUpdated",(({transactionMeta:e})=>{this._onFinishedTransaction(e)})),this.metamaskMiddleware=(0,dt.default)({static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${s}`},version:s,getAccounts:({origin:e})=>{if(e===ge.ORIGIN_METAMASK){const e=this.accountsController.getSelectedAccount().address;return e?[e]:[]}return this.isUnlocked()?this.getPermittedAccounts(e):[]},processTransaction:(e,t)=>(0,_t.addDappTransaction)(this.getAddTransactionRequest({transactionParams:e,dappRequest:t})),processTypedMessage:(...e)=>(0,St.addTypedMessage)({signatureController:this.signatureController,signatureParams:e}),processTypedMessageV3:(...e)=>(0,St.addTypedMessage)({signatureController:this.signatureController,signatureParams:e}),processTypedMessageV4:(...e)=>(0,St.addTypedMessage)({signatureController:this.signatureController,signatureParams:e}),processPersonalMessage:(...e)=>(0,St.addPersonalMessage)({signatureController:this.signatureController,signatureParams:e}),processEncryptionPublicKey:this.encryptionPublicKeyController.newRequestEncryptionPublicKey.bind(this.encryptionPublicKeyController),processDecryptMessage:this.decryptMessageController.newRequestDecryptMessage.bind(this.decryptMessageController),getPendingNonce:this.getPendingNonce.bind(this),getPendingTransactionByHash:e=>this.txController.state.transactions.find((t=>t.hash===e&&t.status===G.TransactionStatus.submitted)),processSendCalls:Yt.processSendCalls.bind(null,{addTransactionBatch:this.txController.addTransactionBatch.bind(this.txController),getDisabledAccountUpgradeChains:this.preferencesController.getDisabledAccountUpgradeChains.bind(this.preferencesController),validateSecurity:(e,t,r)=>(0,It.validateRequestWithPPOM)({chainId:r,ppomController:this.ppomController,request:t,securityAlertId:e,updateSecurityAlertResponse:this.updateSecurityAlertResponse.bind(this)})},this.controllerMessenger),getCallsStatus:Yt.getCallsStatus.bind(null,this.controllerMessenger),getCapabilities:Yt.getCapabilities.bind(null,{isAtomicBatchSupported:this.txController.isAtomicBatchSupported.bind(this.txController),getDisabledAccountUpgradeChains:this.preferencesController.getDisabledAccountUpgradeChains.bind(this.preferencesController)})}),this.on("update",(e=>this._onStateUpdate(e)));const Mt={AccountTracker:this.accountTrackerController,TokenRatesController:this.tokenRatesController,DecryptMessageController:this.decryptMessageController,EncryptionPublicKeyController:this.encryptionPublicKeyController,SignatureController:this.signatureController,SwapsController:this.swapsController,BridgeController:this.bridgeController,BridgeStatusController:this.bridgeStatusController,EnsController:this.ensController,ApprovalController:this.approvalController};this.store.updateStructure({AccountsController:this.accountsController,AppStateController:this.appStateController,AppMetadataController:this.appMetadataController,KeyringController:this.keyringController,PreferencesController:this.preferencesController,MetaMetricsController:this.metaMetricsController,MetaMetricsDataDeletionController:this.metaMetricsDataDeletionController,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,MultichainNetworkController:this.multichainNetworkController,NetworkController:this.networkController,AlertController:this.alertController,OnboardingController:this.onboardingController,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,TokenBalancesController:this.tokenBalancesController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,PhishingController:this.phishingController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,MultichainRatesController:this.multichainRatesController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,NotificationServicesController:this.notificationServicesController,NotificationServicesPushController:this.notificationServicesPushController,RemoteFeatureFlagController:this.remoteFeatureFlagController,...Mt,...bt}),this.memStore=new Ke.default({config:{AccountsController:this.accountsController,AppStateController:this.appStateController,AppMetadataController:this.appMetadataController,MultichainNetworkController:this.multichainNetworkController,NetworkController:this.networkController,KeyringController:this.keyringController,PreferencesController:this.preferencesController,MetaMetricsController:this.metaMetricsController,MetaMetricsDataDeletionController:this.metaMetricsDataDeletionController,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,AlertController:this.alertController,OnboardingController:this.onboardingController,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController,SubjectMetadataController:this.subjectMetadataController,AnnouncementController:this.announcementController,NetworkOrderController:this.networkOrderController,AccountOrderController:this.accountOrderController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,TokenBalancesController:this.tokenBalancesController,SmartTransactionsController:this.smartTransactionsController,NftController:this.nftController,SelectedNetworkController:this.selectedNetworkController,LoggingController:this.loggingController,MultichainRatesController:this.multichainRatesController,SnapController:this.snapController,CronjobController:this.cronjobController,SnapsRegistry:this.snapsRegistry,SnapInterfaceController:this.snapInterfaceController,SnapInsightsController:this.snapInsightsController,NameController:this.nameController,UserOperationController:this.userOperationController,AuthenticationController:this.authenticationController,UserStorageController:this.userStorageController,NotificationServicesController:this.notificationServicesController,QueuedRequestController:this.queuedRequestController,NotificationServicesPushController:this.notificationServicesPushController,RemoteFeatureFlagController:this.remoteFeatureFlagController,...Mt,...lt},controllerMessenger:this.controllerMessenger});const Pt=[this.accountTrackerController.resetState.bind(this.accountTrackerController),this.decryptMessageController.resetState.bind(this.decryptMessageController),this.encryptionPublicKeyController.resetState.bind(this.encryptionPublicKeyController),this.signatureController.resetState.bind(this.signatureController),this.swapsController.resetState.bind(this.swapsController),this.bridgeController.resetState.bind(this.bridgeController),this.ensController.resetState.bind(this.ensController),this.approvalController.clear.bind(this.approvalController)];_e.isManifestV3?!0===r&&(this.resetStates(Pt),this.extension.storage.session.set({isFirstMetaMaskControllerSetup:!1})):this.resetStates(Pt);!this.isUnlocked()&&this.onboardingController.state.completedOnboarding,this._startUISync(),this.extension.runtime.getPlatformInfo().then((({os:e})=>{this.appStateController.setBrowserEnvironment(e,this.extension.runtime.getBrowserInfo===undefined?"chrome":"firefox")})),this.setupControllerEventSubscriptions(),this.setupMultichainDataAndSubscriptions(),this.publicConfigStore=this.createPublicConfigStore(),this.extension.runtime.onMessageExternal.addListener($e.onMessageReceived),(0,$e.checkForMultipleVersionsRunning)(),this.onboardingController.state.completedOnboarding&&this.postOnboardingInitialization()}getInfuraFeatureFlags(){(0,Be.default)({url:"https://swap.api.cx.metamask.io/featureFlags",cacheRefreshTime:20*me.MINUTE}).then(this.onFeatureFlagResponseReceived).catch((e=>{y.default.warn("Feature flag endpoint is unreachable",e)}))}onFeatureFlagResponseReceived(e){const{multiChainAssets:t={}}=e,{pollInterval:r}=t;r>0&&this.tokenBalancesController.setIntervalLength(r*me.SECOND)}postOnboardingInitialization(){const{usePhishDetect:e}=this.preferencesController.state;this.networkController.lookupNetwork(),e&&this.phishingController.maybeUpdateState()}triggerNetworkrequests(){this.txController.stopIncomingTransactionPolling(),this.txController.startIncomingTransactionPolling([rr(cr,this,pr).call(this)]),this.tokenDetectionController.enable(),this.getInfuraFeatureFlags()}stopNetworkRequests(){this.txController.stopIncomingTransactionPolling(),this.tokenDetectionController.disable()}resetStates(e){e.forEach((e=>{try{e()}catch(e){console.error(e)}}))}async getSnapKeyring(){let[e]=this.keyringController.getKeyringsByType(de.KeyringType.snap);return e||(await this.keyringController.addNewKeyring(de.KeyringType.snap),[e]=this.keyringController.getKeyringsByType(de.KeyringType.snap)),e}trackInsightSnapView(e){this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.InsightSnapViewed,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e}})}_getSnapMetadata(e){var t;return null===(t=this.snapsRegistry.state.database)||void 0===t||null===(t=t.verifiedSnaps)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.metadata}async handleSnapRequest(e){try{const t=await this.controllerMessenger.call("SnapController:handleRequest",e);return this._trackSnapExportUsage(e.snapId,e.handler,!0,e.origin),t}catch(t){throw this._trackSnapExportUsage(e.snapId,e.handler,!1,e.origin),t}}getLocale(){const{currentLocale:e}=this.preferencesController.state;return e}getPreferences(){const{preferences:e,securityAlertsEnabled:t,useCurrencyRateCheck:r,useTransactionSimulations:n,useTokenDetection:s,useMultiAccountBalanceChecker:i,openSeaEnabled:a,useNftDetection:o}=this.preferencesController.state;return{privacyMode:e.privacyMode,securityAlertsEnabled:t,useCurrencyRateCheck:r,useTransactionSimulations:n,useTokenDetection:s,useMultiAccountBalanceChecker:i,openSeaEnabled:a,useNftDetection:o}}getSnapPermissionSpecifications(){return{...(0,U.buildSnapEndowmentSpecifications)(Object.keys(he.ExcludedSnapEndowments)),...(0,U.buildSnapRestrictedMethodSpecifications)(Object.keys(he.ExcludedSnapPermissions),{getPreferences:()=>{const e=this.getLocale(),t=this.currencyRateController.state.currentCurrency,{privacyMode:r,securityAlertsEnabled:n,useCurrencyRateCheck:s,useTransactionSimulations:i,useTokenDetection:a,useMultiAccountBalanceChecker:o,openSeaEnabled:c,useNftDetection:l}=this.getPreferences();return{locale:e,currency:t,hideBalances:r,useSecurityAlerts:n,useExternalPricingData:s,simulateOnChainActions:i,useTokenDetection:a,batchCheckBalances:o,displayNftMedia:c,useNftDetection:l}},clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState"),getMnemonic:async e=>{if(!e)return this.getPrimaryKeyringMnemonic();try{const{type:t,mnemonic:r}=await this.controllerMessenger.call("KeyringController:withKeyring",{id:e},(async({keyring:e})=>({type:e.type,mnemonic:e.mnemonic})));if(t!==h.KeyringTypes.hd||!r)throw new Error(`Entropy source with ID "${e}" not found.`);return r}catch{throw new Error(`Entropy source with ID "${e}" not found.`)}},getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),handleSnapRpcRequest:this.handleSnapRequest.bind(this),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState"),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),showNativeNotification:(e,t)=>this.controllerMessenger.call("RateLimitController:call",e,"showNativeNotification",e,t.message),showInAppNotification:(e,t)=>{const{message:r,title:n,footerLink:s}=t,i={interfaceId:t.content,message:r,title:n,footerLink:s};return this.controllerMessenger.call("RateLimitController:call",e,"showInAppNotification",e,i)},updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState"),maybeUpdatePhishingList:()=>{const{usePhishDetect:e}=this.preferencesController.state;e&&this.controllerMessenger.call("PhishingController:maybeUpdateState")},isOnPhishingList:e=>{const{usePhishDetect:t}=this.preferencesController.state;return!!t&&this.controllerMessenger.call("PhishingController:testOrigin",e).result},createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface"),getInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:getInterface"),getClientCryptography:()=>({}),getSnapKeyring:this.getSnapKeyring.bind(this)})}}setupControllerEventSubscriptions(){let e;this.controllerMessenger.subscribe("PreferencesController:stateChange",(0,ut.previousValueComparator)((async(e,t)=>{var r;const{currentLocale:n}=t,s=rr(cr,this,pr).call(this);await(0,vt.updateCurrentLocale)(n),null!==(r=t.incomingTransactionsPreferences)&&void 0!==r&&r[s]?(this.txController.stopIncomingTransactionPolling(),this.txController.startIncomingTransactionPolling([rr(cr,this,pr).call(this)])):this.txController.stopIncomingTransactionPolling(),rr(cr,this,dr).call(this,t,e)}),this.preferencesController.state)),this.controllerMessenger.subscribe(`${this.accountsController.name}:selectedAccountChange`,(async t=>{t.address&&t.address!==e&&(e=t.address,await this._onAccountChange(t.address))})),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,(async(e,t)=>{const r=(0,gt.diffMap)(e,t);for(const[e,t]of r.entries())this._notifyAccountsChange(e,t)}),gt.getPermittedAccountsByOrigin),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,(async(e,t)=>{const r=(0,gt.diffMap)(e,t);for(const[e,t]of r.entries()){const r=this.selectedNetworkController.getNetworkClientIdForDomain(e),{chainId:n}=this.networkController.getNetworkConfigurationByNetworkClientId(r);if(t.length>0&&!t.includes(n)){const r=this.networkController.findNetworkClientIdByChainId(t[0]);this.networkController.setActiveNetwork(r),this.selectedNetworkController.setNetworkClientIdForDomain(e,r)}}}),gt.getPermittedChainsByOrigin),this.controllerMessenger.subscribe("NetworkController:networkRemoved",(({chainId:e})=>{const t=(0,X.toCaipChainId)("eip155",(0,X.hexToBigInt)(e).toString(10));this.removeAllScopePermissions(t)})),this.controllerMessenger.subscribe("NetworkController:networkDidChange",(async()=>{await this.txController.stopIncomingTransactionPolling(),await this.txController.updateIncomingTransactions([rr(cr,this,pr).call(this)]),await this.txController.startIncomingTransactionPolling([rr(cr,this,pr).call(this)])})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallStarted`,((e,t,r)=>{var n;const s=null===(n=this._getSnapMetadata(e))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:r?fe.MetaMetricsEventName.SnapUpdateStarted:fe.MetaMetricsEventName.SnapInstallStarted,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:s}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstallFailed`,((e,t,r,n)=>{var s;const i=n.includes("User rejected the request."),a=r?fe.MetaMetricsEventName.SnapUpdateFailed:fe.MetaMetricsEventName.SnapInstallFailed,o=r?fe.MetaMetricsEventName.SnapUpdateRejected:fe.MetaMetricsEventName.SnapInstallRejected,c=null===(s=this._getSnapMetadata(e))||void 0===s?void 0:s.category;this.metaMetricsController.trackEvent({event:i?o:a,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:e,origin:t,snap_category:c}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapInstalled`,((e,t,r)=>{var n;if(r)return;const s=e.id,i=null===(n=this._getSnapMetadata(s))||void 0===n?void 0:n.category;this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.SnapInstalled,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:s,version:e.version,origin:t,snap_category:i}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUpdated`,((e,t,r,n)=>{var s;if(n)return;const i=e.id,a=null===(s=this._getSnapMetadata(i))||void 0===s?void 0:s.category;this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.SnapUpdated,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:i,old_version:t,new_version:e.version,origin:r,snap_category:a}})})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapTerminated`,(e=>{const t=Object.values(this.approvalController.state.pendingApprovals).filter((t=>t.origin===e.id&&t.type.startsWith(he.RestrictedMethods.snap_dialog)));for(const e of t)this.approvalController.reject(e.id,new Error("Snap was terminated."))})),this.controllerMessenger.subscribe(`${this.snapController.name}:snapUninstalled`,(e=>{var t;const r=this.notificationServicesController.getNotificationsByType(te.TRIGGER_TYPES.SNAP).filter((t=>t.data.origin===e.id)).map((e=>e.id));this.notificationServicesController.deleteNotificationsById(r);const n=e.id,s=null===(t=this._getSnapMetadata(n))||void 0===t?void 0:t.category;this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.SnapUninstalled,category:fe.MetaMetricsEventCategory.Snaps,properties:{snap_id:n,version:e.version,snap_category:s}})}))}setupMultichainDataAndSubscriptions(){(0,Y.isEvmAccountType)(this.accountsController.getSelectedMultichainAccount().type)||this.multichainRatesController.start(),this.controllerMessenger.subscribe("AccountsController:selectedAccountChange",(e=>{(0,Y.isEvmAccountType)(e.type)?this.multichainRatesController.stop():this.multichainRatesController.start()})),this.controllerMessenger.subscribe("CurrencyRateController:stateChange",(({currentCurrency:e})=>{e!==this.multichainRatesController.state.fiatCurrency&&this.multichainRatesController.setFiatCurrency(e)}))}addMultichainApiEthSubscriptionMiddleware({scope:e,origin:t,tabId:r}){const n=this.multichainSubscriptionManager.subscribe({scope:e,origin:t,tabId:r});this.multichainMiddlewareManager.addMiddleware({scope:e,origin:t,tabId:r,middleware:n.middleware})}removeMultichainApiEthSubscriptionMiddleware({scope:e,origin:t}){this.multichainMiddlewareManager.removeMiddlewareByScopeAndOrigin(e,t),this.multichainSubscriptionManager.unsubscribeByScopeAndOrigin(e,t)}createPublicConfigStore(){const e=new c.ObservableStore,t=async({isUnlocked:e})=>{const{chainId:t,networkVersion:r,isConnected:n}=await this.getProviderNetworkState();return{isUnlocked:e,chainId:t,networkVersion:n?r:"loading"}},r=async r=>{var n;(null===(n=r.networksMetadata[r.selectedNetworkClientId])||void 0===n?void 0:n.status)===ce.NetworkStatus.Available&&e.putState(await t(r))};return this.on("update",r),r(this.getState()),e}async getProviderState(e){const t=await this.getProviderNetworkState(e),r={};return{isUnlocked:!0,accounts:this.getPermittedAccounts(e),...r,...t}}async getProviderNetworkState(e=j.METAMASK_DOMAIN){const t=this.controllerMessenger.call("SelectedNetworkController:getNetworkClientIdForDomain",e),r=this.controllerMessenger.call("NetworkController:getNetworkClientById",t),{chainId:n}=r.configuration,{completedOnboarding:s}=this.onboardingController.state;let i=this.deprecatedNetworkVersions[t];if(i===undefined&&s){try{const e=await r.provider.request({method:"net_version"});i=(0,Se.convertNetworkId)(e)}catch(e){console.error(e),i=null}this.deprecatedNetworkVersions[t]=i}const a=this.networkController.state.networksMetadata[t];return{chainId:n,networkVersion:i??"loading",isConnected:(null==a?void 0:a.status)===ce.NetworkStatus.Available}}getState(){const{vault:e}=this.keyringController.state,t=Boolean(e),r=this.memStore.getFlatState();return{isInitialized:t,...(0,Ft.sanitizeUIState)(r)}}getApi(){const{accountsController:e,addressBookController:t,alertController:r,appStateController:n,keyringController:s,nftController:i,nftDetectionController:a,currencyRateController:o,tokenBalancesController:c,tokenDetectionController:l,ensController:u,tokenListController:d,gasFeeController:h,metaMetricsController:p,networkController:m,announcementController:g,onboardingController:f,permissionController:y,preferencesController:b,tokensController:v,smartTransactionsController:w,txController:k,assetsContractController:C,backup:T,approvalController:_,phishingController:S,tokenRatesController:E,accountTrackerController:A,authenticationController:M,userStorageController:P,notificationServicesController:I,notificationServicesPushController:x}=this;return{getState:this.getState.bind(this),setCurrentCurrency:o.setCurrentCurrency.bind(o),setUseBlockie:b.setUseBlockie.bind(b),setUsePhishDetect:b.setUsePhishDetect.bind(b),setUseMultiAccountBalanceChecker:b.setUseMultiAccountBalanceChecker.bind(b),setUseSafeChainsListValidation:b.setUseSafeChainsListValidation.bind(b),setUseTokenDetection:b.setUseTokenDetection.bind(b),setUseNftDetection:b.setUseNftDetection.bind(b),setUse4ByteResolution:b.setUse4ByteResolution.bind(b),setUseCurrencyRateCheck:b.setUseCurrencyRateCheck.bind(b),setOpenSeaEnabled:b.setOpenSeaEnabled.bind(b),getProviderConfig:()=>(0,Pe.getProviderConfig)({metamask:this.networkController.state}),grantPermissionsIncremental:this.permissionController.grantPermissionsIncremental.bind(this.permissionController),grantPermissions:this.permissionController.grantPermissions.bind(this.permissionController),setSecurityAlertsEnabled:b.setSecurityAlertsEnabled.bind(b),setAddSnapAccountEnabled:b.setAddSnapAccountEnabled.bind(b),setUseExternalNameSources:b.setUseExternalNameSources.bind(b),setUseTransactionSimulations:b.setUseTransactionSimulations.bind(b),setIpfsGateway:b.setIpfsGateway.bind(b),setIsIpfsGatewayEnabled:b.setIsIpfsGatewayEnabled.bind(b),setUseAddressBarEnsResolution:b.setUseAddressBarEnsResolution.bind(b),setParticipateInMetaMetrics:p.setParticipateInMetaMetrics.bind(p),setDataCollectionForMarketing:p.setDataCollectionForMarketing.bind(p),setMarketingCampaignCookieId:p.setMarketingCampaignCookieId.bind(p),setCurrentLocale:b.setCurrentLocale.bind(b),setIncomingTransactionsPreferences:b.setIncomingTransactionsPreferences.bind(b),setServiceWorkerKeepAlivePreference:b.setServiceWorkerKeepAlivePreference.bind(b),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:this.getRequestAccountTabIds,getOpenMetamaskTabsIds:this.getOpenMetamaskTabsIds,markNotificationPopupAsAutomaticallyClosed:()=>this.notificationManager.markAsAutomaticallyClosed(),getCode:this.getCode.bind(this),addNewAccount:this.addNewAccount.bind(this),getSeedPhrase:this.getSeedPhrase.bind(this),resetAccount:this.resetAccount.bind(this),removeAccount:this.removeAccount.bind(this),importAccountWithStrategy:this.importAccountWithStrategy.bind(this),getNextAvailableAccountName:e.getNextAvailableAccountName.bind(e),getAccountsBySnapId:e=>(0,Ct.getAccountsBySnapId)(this,e),connectHardware:this.connectHardware.bind(this),forgetDevice:this.forgetDevice.bind(this),checkHardwareStatus:this.checkHardwareStatus.bind(this),unlockHardwareWalletAccount:this.unlockHardwareWalletAccount.bind(this),attemptLedgerTransportCreation:this.attemptLedgerTransportCreation.bind(this),submitQRHardwareCryptoHDKey:s.submitQRCryptoHDKey.bind(s),submitQRHardwareCryptoAccount:s.submitQRCryptoAccount.bind(s),cancelSyncQRHardware:s.cancelQRSynchronization.bind(s),submitQRHardwareSignature:s.submitQRSignature.bind(s),cancelQRHardwareSignRequest:s.cancelQRSignRequest.bind(s),submitPassword:this.submitPassword.bind(this),verifyPassword:this.verifyPassword.bind(this),setActiveNetwork:async e=>await this.multichainNetworkController.setActiveNetwork(e),setActiveNetworkConfigurationId:e=>{this.networkController.setActiveNetwork(e)},setNetworkClientIdForDomain:(e,t)=>this.selectedNetworkController.setNetworkClientIdForDomain(e,t),rollbackToPreviousProvider:m.rollbackToPreviousProvider.bind(m),addNetwork:this.networkController.addNetwork.bind(this.networkController),updateNetwork:this.networkController.updateNetwork.bind(this.networkController),removeNetwork:this.networkController.removeNetwork.bind(this.networkController),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getNetworkConfigurationByNetworkClientId:this.networkController.getNetworkConfigurationByNetworkClientId.bind(this.networkController),setSelectedAddress:e=>{const t=this.accountsController.getAccountByAddress(e);if(!t)throw new Error(`No account found for address: ${e}`);this.accountsController.setSelectedAccount(t.id)},toggleExternalServices:this.toggleExternalServices.bind(this),addToken:v.addToken.bind(v),updateTokenType:v.updateTokenType.bind(v),setFeatureFlag:b.setFeatureFlag.bind(b),setPreference:b.setPreference.bind(b),addKnownMethodData:b.addKnownMethodData.bind(b),setDismissSeedBackUpReminder:b.setDismissSeedBackUpReminder.bind(b),setOverrideContentSecurityPolicyHeader:b.setOverrideContentSecurityPolicyHeader.bind(b),setAdvancedGasFee:b.setAdvancedGasFee.bind(b),setTheme:b.setTheme.bind(b),disableAccountUpgradeForChain:b.disableAccountUpgradeForChain.bind(b),setSnapsAddSnapAccountModalDismissed:b.setSnapsAddSnapAccountModalDismissed.bind(b),setSelectedInternalAccount:e=>{this.accountsController.getAccount(e)&&this.accountsController.setSelectedAccount(e)},setAccountName:e.setAccountName.bind(e),setAccountLabel:(e,t)=>{const r=this.accountsController.getAccountByAddress(e);if(r===undefined)throw new Error(`No account found for address: ${e}`);this.accountsController.setAccountName(r.id,t)},getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTokenSymbol:this.getTokenSymbol.bind(this),addNft:i.addNft.bind(i),addNftVerifyOwnership:i.addNftVerifyOwnership.bind(i),removeAndIgnoreNft:i.removeAndIgnoreNft.bind(i),removeNft:i.removeNft.bind(i),checkAndUpdateAllNftsOwnershipStatus:i.checkAndUpdateAllNftsOwnershipStatus.bind(i),checkAndUpdateSingleNftOwnershipStatus:i.checkAndUpdateSingleNftOwnershipStatus.bind(i),getNFTContractInfo:i.getNFTContractInfo.bind(i),isNftOwner:i.isNftOwner.bind(i),setAddressBook:t.set.bind(t),removeFromAddressBook:t.delete.bind(t),setLastActiveTime:n.setLastActiveTime.bind(n),setCurrentExtensionPopupId:n.setCurrentExtensionPopupId.bind(n),setDefaultHomeActiveTabName:n.setDefaultHomeActiveTabName.bind(n),setConnectedStatusPopoverHasBeenShown:n.setConnectedStatusPopoverHasBeenShown.bind(n),setRecoveryPhraseReminderHasBeenShown:n.setRecoveryPhraseReminderHasBeenShown.bind(n),setRecoveryPhraseReminderLastShown:n.setRecoveryPhraseReminderLastShown.bind(n),setTermsOfUseLastAgreed:n.setTermsOfUseLastAgreed.bind(n),setSurveyLinkLastClickedOrClosed:n.setSurveyLinkLastClickedOrClosed.bind(n),setOnboardingDate:n.setOnboardingDate.bind(n),setLastViewedUserSurvey:n.setLastViewedUserSurvey.bind(n),setRampCardClosed:n.setRampCardClosed.bind(n),setNewPrivacyPolicyToastClickedOrClosed:n.setNewPrivacyPolicyToastClickedOrClosed.bind(n),setNewPrivacyPolicyToastShownDate:n.setNewPrivacyPolicyToastShownDate.bind(n),setSnapsInstallPrivacyWarningShownStatus:n.setSnapsInstallPrivacyWarningShownStatus.bind(n),setOutdatedBrowserWarningLastShown:n.setOutdatedBrowserWarningLastShown.bind(n),setShowTestnetMessageInDropdown:n.setShowTestnetMessageInDropdown.bind(n),setShowBetaHeader:n.setShowBetaHeader.bind(n),setShowPermissionsTour:n.setShowPermissionsTour.bind(n),setShowAccountBanner:n.setShowAccountBanner.bind(n),setShowNetworkBanner:n.setShowNetworkBanner.bind(n),updateNftDropDownState:n.updateNftDropDownState.bind(n),setSwitchedNetworkDetails:n.setSwitchedNetworkDetails.bind(n),clearSwitchedNetworkDetails:n.clearSwitchedNetworkDetails.bind(n),setSwitchedNetworkNeverShowMessage:n.setSwitchedNetworkNeverShowMessage.bind(n),getLastInteractedConfirmationInfo:n.getLastInteractedConfirmationInfo.bind(n),setLastInteractedConfirmationInfo:n.setLastInteractedConfirmationInfo.bind(n),updateSlides:n.updateSlides.bind(n),removeSlide:n.removeSlide.bind(n),tryReverseResolveAddress:u.reverseResolveAddress.bind(u),setLocked:this.setLocked.bind(this),createNewVaultAndKeychain:this.createNewVaultAndKeychain.bind(this),createNewVaultAndRestore:this.createNewVaultAndRestore.bind(this),exportAccount:this.exportAccount.bind(this),updateTransaction:k.updateTransaction.bind(k),approveTransactionsWithSameNonce:k.approveTransactionsWithSameNonce.bind(k),createCancelTransaction:this.createCancelTransaction.bind(this),createSpeedUpTransaction:this.createSpeedUpTransaction.bind(this),estimateGas:this.estimateGas.bind(this),estimateGasFee:k.estimateGasFee.bind(k),getNextNonce:this.getNextNonce.bind(this),addTransaction:(e,t)=>(0,_t.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!1})),addTransactionAndWaitForPublish:(e,t)=>(0,_t.addTransaction)(this.getAddTransactionRequest({transactionParams:e,transactionOptions:t,waitForSubmit:!0})),createTransactionEventFragment:Oe.createTransactionEventFragmentWithTxId.bind(null,this.getTransactionMetricsRequest()),decryptMessage:this.decryptMessageController.decryptMessage.bind(this.decryptMessageController),decryptMessageInline:this.decryptMessageController.decryptMessageInline.bind(this.decryptMessageController),cancelDecryptMessage:this.decryptMessageController.cancelDecryptMessage.bind(this.decryptMessageController),encryptionPublicKey:this.encryptionPublicKeyController.encryptionPublicKey.bind(this.encryptionPublicKeyController),cancelEncryptionPublicKey:this.encryptionPublicKeyController.cancelEncryptionPublicKey.bind(this.encryptionPublicKeyController),setSeedPhraseBackedUp:f.setSeedPhraseBackedUp.bind(f),completeOnboarding:f.completeOnboarding.bind(f),setFirstTimeFlowType:f.setFirstTimeFlowType.bind(f),setAlertEnabledness:r.setAlertEnabledness.bind(r),setUnconnectedAccountAlertShown:r.setUnconnectedAccountAlertShown.bind(r),setWeb3ShimUsageAlertDismissed:r.setWeb3ShimUsageAlertDismissed.bind(r),removePermissionsFor:this.removePermissionsFor,approvePermissionsRequest:this.acceptPermissionsRequest,rejectPermissionsRequest:this.rejectPermissionsRequest,...(0,gt.getPermissionBackgroundApiMethods)({permissionController:y,approvalController:_}),disableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disable"),enableSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:enable"),updateSnap:(e,t)=>(this.controllerMessenger.call("SnapController:install",e,t),null),removeSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:remove"),handleSnapRequest:this.handleSnapRequest.bind(this),revokeDynamicSnapPermissions:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:revokeDynamicPermissions"),disconnectOriginFromSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:disconnectOrigin"),updateNetworksList:this.updateNetworksList.bind(this),updateAccountsList:this.updateAccountsList.bind(this),updateHiddenAccountsList:this.updateHiddenAccountsList.bind(this),getPhishingResult:async e=>(await S.maybeUpdateState(),S.test(e)),deleteInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:deleteInterface"),updateInterfaceState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterfaceState"),fetchAndSetQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:fetchAndSetQuotes"),setSelectedQuoteAggId:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSelectedQuoteAggId"),resetSwapsState:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:resetSwapsState"),setSwapsTokens:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTokens"),clearSwapsQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:clearSwapsQuotes"),setApproveTxId:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setApproveTxId"),setTradeTxId:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setTradeTxId"),setSwapsTxGasPrice:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxGasPrice"),setSwapsTxGasLimit:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxGasLimit"),setSwapsTxMaxFeePerGas:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxMaxFeePerGas"),setSwapsTxMaxFeePriorityPerGas:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsTxMaxFeePriorityPerGas"),safeRefetchQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:safeRefetchQuotes"),stopPollingForQuotes:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:stopPollingForQuotes"),setBackgroundSwapRouteState:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setBackgroundSwapRouteState"),resetPostFetchState:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:resetPostFetchState"),setSwapsErrorKey:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsErrorKey"),setInitialGasEstimate:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setInitialGasEstimate"),setCustomApproveTxData:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setCustomApproveTxData"),setSwapsLiveness:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsLiveness"),setSwapsFeatureFlags:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsFeatureFlags"),setSwapsUserFeeLevel:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsUserFeeLevel"),setSwapsQuotesPollingLimitEnabled:this.controllerMessenger.call.bind(this.controllerMessenger,"SwapsController:setSwapsQuotesPollingLimitEnabled"),[Re.BridgeBackgroundAction.SET_FEATURE_FLAGS]:this.controllerMessenger.call.bind(this.controllerMessenger,`${Ot.BRIDGE_CONTROLLER_NAME}:${Re.BridgeBackgroundAction.SET_FEATURE_FLAGS}`),[Re.BridgeBackgroundAction.RESET_STATE]:this.controllerMessenger.call.bind(this.controllerMessenger,`${Ot.BRIDGE_CONTROLLER_NAME}:${Re.BridgeBackgroundAction.RESET_STATE}`),[Re.BridgeBackgroundAction.GET_BRIDGE_ERC20_ALLOWANCE]:this.controllerMessenger.call.bind(this.controllerMessenger,`${Ot.BRIDGE_CONTROLLER_NAME}:${Re.BridgeBackgroundAction.GET_BRIDGE_ERC20_ALLOWANCE}`),[Re.BridgeUserAction.UPDATE_QUOTE_PARAMS]:this.controllerMessenger.call.bind(this.controllerMessenger,`${Ot.BRIDGE_CONTROLLER_NAME}:${Re.BridgeUserAction.UPDATE_QUOTE_PARAMS}`),[xe.BridgeStatusAction.START_POLLING_FOR_BRIDGE_TX_STATUS]:this.controllerMessenger.call.bind(this.controllerMessenger,`${Kt.BRIDGE_STATUS_CONTROLLER_NAME}:${xe.BridgeStatusAction.START_POLLING_FOR_BRIDGE_TX_STATUS}`),fetchSmartTransactionFees:w.getFees.bind(w),clearSmartTransactionFees:w.clearFees.bind(w),submitSignedTransactions:w.submitSignedTransactions.bind(w),cancelSmartTransaction:w.cancelSmartTransaction.bind(w),fetchSmartTransactionsLiveness:w.fetchLiveness.bind(w),updateSmartTransaction:w.updateSmartTransaction.bind(w),setStatusRefreshInterval:w.setStatusRefreshInterval.bind(w),trackMetaMetricsEvent:p.trackEvent.bind(p),trackMetaMetricsPage:p.trackPage.bind(p),createEventFragment:p.createEventFragment.bind(p),updateEventFragment:p.updateEventFragment.bind(p),finalizeEventFragment:p.finalizeEventFragment.bind(p),trackInsightSnapView:this.trackInsightSnapView.bind(this),rejectAllPendingApprovals:this.rejectAllPendingApprovals.bind(this),rejectPendingApproval:this.rejectPendingApproval,requestUserApproval:_.addAndShowApprovalRequest.bind(_),resolvePendingApproval:this.resolvePendingApproval,resetViewedNotifications:g.resetViewed.bind(g),updateViewedNotifications:g.updateViewed.bind(g),currencyRateStartPolling:o.startPolling.bind(o),currencyRateStopPollingByPollingToken:o.stopPollingByPollingToken.bind(o),tokenRatesStartPolling:E.startPolling.bind(E),tokenRatesStopPollingByPollingToken:E.stopPollingByPollingToken.bind(E),accountTrackerStartPolling:A.startPollingByNetworkClientId.bind(A),accountTrackerStopPollingByPollingToken:A.stopPollingByPollingToken.bind(A),tokenDetectionStartPolling:l.startPolling.bind(l),tokenDetectionStopPollingByPollingToken:l.stopPollingByPollingToken.bind(l),tokenListStartPolling:d.startPolling.bind(d),tokenListStopPollingByPollingToken:d.stopPollingByPollingToken.bind(d),tokenBalancesStartPolling:c.startPolling.bind(c),tokenBalancesStopPollingByPollingToken:c.stopPollingByPollingToken.bind(c),gasFeeStartPolling:h.startPolling.bind(h),gasFeeStopPollingByPollingToken:h.stopPollingByPollingToken.bind(h),getGasFeeTimeEstimate:h.getTimeEstimate.bind(h),addPollingTokenToAppState:n.addPollingToken.bind(n),removePollingTokenFromAppState:n.removePollingToken.bind(n),updateThrottledOriginState:n.updateThrottledOriginState.bind(n),backupUserData:T.backupUserData.bind(T),restoreUserData:T.restoreUserData.bind(T),detectTokens:l.detectTokens.bind(l),detectNfts:a.detectNfts.bind(a),addDetectedTokens:v.addDetectedTokens.bind(v),addImportedTokens:v.addTokens.bind(v),ignoreTokens:v.ignoreTokens.bind(v),getBalancesInSingleCall:C.getBalancesInSingleCall.bind(C),performSignIn:M.performSignIn.bind(M),performSignOut:M.performSignOut.bind(M),enableProfileSyncing:P.enableProfileSyncing.bind(P),disableProfileSyncing:P.disableProfileSyncing.bind(P),syncInternalAccountsWithUserStorage:P.syncInternalAccountsWithUserStorage.bind(P),deleteAccountSyncingDataFromUserStorage:P.performDeleteStorageAllFeatureEntries.bind(P),checkAccountsPresence:I.checkAccountsPresence.bind(I),createOnChainTriggers:I.createOnChainTriggers.bind(I),deleteOnChainTriggersByAccount:I.deleteOnChainTriggersByAccount.bind(I),updateOnChainTriggersByAccount:I.updateOnChainTriggersByAccount.bind(I),fetchAndUpdateMetamaskNotifications:I.fetchAndUpdateMetamaskNotifications.bind(I),deleteNotificationsById:I.deleteNotificationsById.bind(I),getNotificationsByType:I.getNotificationsByType.bind(I),markMetamaskNotificationsAsRead:I.markMetamaskNotificationsAsRead.bind(I),setFeatureAnnouncementsEnabled:I.setFeatureAnnouncementsEnabled.bind(I),enablePushNotifications:x.enablePushNotifications.bind(x),disablePushNotifications:x.disablePushNotifications.bind(x),updateTriggerPushNotifications:x.updateTriggerPushNotifications.bind(x),enableMetamaskNotifications:I.enableMetamaskNotifications.bind(I),disableMetamaskNotifications:I.disableNotificationServices.bind(I),throwTestError:this.throwTestError.bind(this),updateProposedNames:this.nameController.updateProposedNames.bind(this.nameController),setName:this.nameController.setName.bind(this.nameController),decodeTransactionData:e=>(0,Bt.decodeTransactionData)({...e,provider:this.provider}),createMetaMetricsDataDeletionTask:this.metaMetricsDataDeletionController.createMetaMetricsDataDeletionTask.bind(this.metaMetricsDataDeletionController),updateDataDeletionTaskStatus:this.metaMetricsDataDeletionController.updateDataDeletionTaskStatus.bind(this.metaMetricsDataDeletionController),endTrace:Ie.endTrace}}rejectOriginPendingApprovals(e){(0,qt.rejectOriginApprovals)({approvalController:this.approvalController,deleteInterface:e=>this.controllerMessenger.call("SnapInterfaceController:deleteInterface",e),origin:e})}async exportAccount(e,t){return await this.verifyPassword(t),this.keyringController.exportAccount(t,e)}async getTokenStandardAndDetails(e,t,r){var n,s;const{tokenList:i}=this.tokenListController.state,{tokens:a}=this.tokensController.state,o={...Ce.STATIC_MAINNET_TOKEN_LIST[null==e?void 0:e.toLowerCase()]||{},...i[e.toLowerCase()]||{},...a.find((({address:t})=>(0,we.isEqualCaseInsensitive)(t,e)))||{}},c=(0,we.isEqualCaseInsensitive)(o.standard,ae.TokenStandard.ERC20)||!0===o.erc20,l=!(r||(0,we.isEqualCaseInsensitive)(o.standard,ae.TokenStandard.ERC1155)||(0,we.isEqualCaseInsensitive)(o.standard,ae.TokenStandard.ERC721)||o.erc721),u=o.decimals!==undefined&&o.symbol;let d;if(c||l&&u)try{const r=t?await(0,ve.fetchTokenBalance)(e,t,this.provider):undefined;d={address:e,balance:r,standard:ae.TokenStandard.ERC20,decimals:o.decimals,symbol:o.symbol}}catch(e){y.default.warn(`Failed to get token balance. Error: ${e}`)}if(d===undefined)try{d=await this.assetsContractController.getTokenStandardAndDetails(e,t,r)}catch(e){y.default.warn(`Failed to get token standard and details. Error: ${e}`)}if(d){if((0,we.isEqualCaseInsensitive)(d.standard,ae.TokenStandard.ERC1155))try{const n=await(0,ve.fetchERC1155Balance)(e,t,r,this.provider),s=null!=n&&n._hex?parseInt(n._hex,16).toString():null;d={...d,balance:s}}catch(e){y.default.warn("Failed to get token balance. Error:",e)}}return{...d,decimals:null===(n=d)||void 0===n||null===(n=n.decimals)||void 0===n?void 0:n.toString(10),balance:null===(s=d)||void 0===s||null===(s=s.balance)||void 0===s?void 0:s.toString(10)}}async getTokenSymbol(e){try{const t=await this.assetsContractController.getTokenStandardAndDetails(e);return null==t?void 0:t.symbol}catch(e){return null}}async createNewVaultAndKeychain(e){const t=await this.createVaultMutex.acquire();try{return await this.keyringController.createNewVaultAndKeychain(e)}finally{t()}}async createNewVaultAndRestore(e,r){const n=await this.createVaultMutex.acquire();try{const{completedOnboarding:n}=this.onboardingController.state,s=t.from(r);this.permissionController.clearState(),this.snapController.clearState(),this.accountTrackerController.clearAccounts(),this.txController.clearUnapprovedTransactions(),n&&this.tokenDetectionController.enable(),await this.keyringController.createNewVaultAndRestore(e,this._convertMnemonicToWordlistIndices(s)),n&&(await this._addAccountsWithBalance(),rr(cr,this,ur).call(this,{name:ue.HardwareDeviceNames.ledger},(async e=>this.setLedgerTransportPreference(e))))}finally{n()}}async _addAccountsWithBalance(e){try{const n=rr(cr,this,pr).call(this),s=e?{id:e}:{type:h.KeyringTypes.hd},i=await this.keyringController.withKeyring(s,(async({keyring:e})=>await e.getAccounts()));let a=i[i.length-1];for(let e=i.length;;e++){if("0x0"===await this.getBalance(a,this.provider)){var t,r;await this.tokenDetectionController.detectTokens({chainIds:[n],selectedAddress:a});const s=null===(t=this.tokensController.state.allTokens)||void 0===t||null===(t=t[n])||void 0===t?void 0:t[a],i=null===(r=this.tokensController.state.allDetectedTokens)||void 0===r||null===(r=r[n])||void 0===r?void 0:r[a];if(0===((null==s?void 0:s.length)??0)&&0===((null==i?void 0:i.length)??0)){1!==e&&await this.removeAccount(a);break}}a=await this.keyringController.withKeyring(s,(async({keyring:e})=>{const[t]=await e.addAccounts(1);return t}))}}catch(e){y.default.warn(`Failed to add accounts with balance. Error: ${e}`)}finally{await this.userStorageController.setIsAccountSyncingReadyToBeDispatched(!0)}}_convertMnemonicToWordlistIndices(e){const t=e.toString().split(" ").map((e=>H.wordlist.indexOf(e)));return new Uint8Array(new Uint16Array(t).buffer)}_convertEnglishWordlistIndicesToCodepoints(e){return t.from(Array.from(new Uint16Array(e.buffer)).map((e=>H.wordlist[e])).join(" "))}async getBalance(e,t){const r=this.accountTrackerController.state.accounts[e];if(r&&r.balance)return r.balance;try{return await t.request({method:"eth_getBalance",params:[e,"latest"]})||"0x0"}catch(e){throw y.default.error(e),e}}async submitPassword(e){const{completedOnboarding:t}=this.onboardingController.state;await this.offscreenPromise,await this.keyringController.submitPassword(e);try{await this.blockTracker.checkForLatestBlock()}catch(e){y.default.error("Error while unlocking extension.",e)}await this.accountsController.updateAccounts(),t&&rr(cr,this,ur).call(this,{name:ue.HardwareDeviceNames.ledger},(async e=>this.setLedgerTransportPreference(e)))}async _loginUser(e){try{await this.submitPassword(e),await this.accountTrackerController.updateAccountsAllActiveNetworks()}finally{this._startUISync()}}_startUISync(){this.emit("startUISync"),this.startUISync=!0,this.memStore.subscribe(this.sendUpdate.bind(this))}async submitEncryptionKey(){try{const{loginToken:e,loginSalt:t}=await this.extension.storage.session.get(["loginToken","loginSalt"]);if(e&&t){const{vault:r}=this.keyringController.state;if(JSON.parse(r).salt!==t)return console.warn("submitEncryptionKey: Stored salt and vault salt do not match"),void await this.clearLoginArtifacts();await this.keyringController.submitEncryptionKey(e,t)}}catch(e){throw await this.clearLoginArtifacts(),e}}async clearLoginArtifacts(){await this.extension.storage.session.remove(["loginToken","loginSalt"])}async verifyPassword(e){await this.keyringController.verifyPassword(e)}getPrimaryKeyringMnemonic(){const[e]=this.keyringController.getKeyringsByType(de.KeyringType.hdKeyTree);if(!e.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return e.mnemonic}async attemptLedgerTransportCreation(){return await rr(cr,this,ur).call(this,{name:ue.HardwareDeviceNames.ledger},(async e=>e.attemptMakeApp()))}async connectHardware(e,t,r){return rr(cr,this,ur).call(this,{name:e,hdPath:r},(async r=>{e===ue.HardwareDeviceNames.ledger&&await this.setLedgerTransportPreference(r);let n=[];switch(t){case-1:n=await r.getPreviousPage();break;case 1:n=await r.getNextPage();break;default:n=await r.getFirstPage()}const s=await this.keyringController.getAccounts(),i=[...new Set(s.concat(n.map((e=>e.address.toLowerCase()))))];return this.accountTrackerController.syncWithAddresses(i),n}))}async checkHardwareStatus(e,t){return rr(cr,this,ur).call(this,{name:e,hdPath:t},(async e=>e.isUnlocked()))}async getHardwareTypeForMetric(e){return await this.keyringController.withKeyring({address:e},(({keyring:e})=>{const{type:t,bridge:r}=e;return(null==r?void 0:r.minorVersion)===ir?ue.HardwareKeyringType.oneKey:ue.HardwareKeyringType[t]}))}async forgetDevice(e){return rr(cr,this,ur).call(this,{name:e},(async e=>{for(const t of e.accounts)this._onAccountRemoved(t);return e.forgetDevice(),!0}))}async getAccountType(e){switch(await this.keyringController.getAccountKeyringType(e)){case de.KeyringType.trezor:case de.KeyringType.oneKey:case de.KeyringType.lattice:case de.KeyringType.qr:case de.KeyringType.ledger:return"hardware";case de.KeyringType.imported:return"imported";case de.KeyringType.snap:return"snap";default:return"MetaMask"}}async getDeviceModel(e){return this.keyringController.withKeyring({address:e},(async({keyring:e})=>{switch(e.type){case de.KeyringType.trezor:case de.KeyringType.oneKey:return e.getModel();case de.KeyringType.qr:return e.getName();case de.KeyringType.ledger:return ue.HardwareDeviceNames.ledger;case de.KeyringType.lattice:return ue.HardwareDeviceNames.lattice;default:return undefined}}))}getAccountLabel(e,t,r){return`${e[0].toUpperCase()}${e.slice(1)} ${parseInt(t,10)+1} ${r||""}`.trim()}async unlockHardwareWalletAccount(e,t,r,n){const{address:s,label:i}=await rr(cr,this,ur).call(this,{name:t,hdPath:r},(async r=>{r.setAccountToUnlock(e);const[s]=await r.addAccounts(1);return{address:(0,ee.normalize)(s),label:this.getAccountLabel(t===ue.HardwareDeviceNames.qr?r.getName():t,e,n)}}));this.preferencesController.setAccountLabel(s,i),this.preferencesController.setSelectedAddress(s);const a=this.accountsController.getAccountByAddress(s);this.accountsController.setAccountName(a.id,i);const o=this.accountsController.listAccounts(),{identities:c}=this.preferencesController.state;return{unlockedAccount:s,identities:c,accounts:o}}async addNewAccount(e,t){const r=await this.keyringController.getAccounts(),n=t?{id:t}:{type:h.KeyringTypes.hd},s=await this.keyringController.withKeyring(n,(async({keyring:t})=>{if(t.type!==h.KeyringTypes.hd)throw new Error("Cannot add account to non-HD keyring");const r=await t.getAccounts();if(e&&e!==r.length){if(e>r.length)throw new Error("Account out of sequence");const t=r[e];if(!t)throw new Error(`Can't find account at index ${e}`);return t}const[n]=await t.addAccounts(1);return n}));return r.includes(s)||this.preferencesController.setSelectedAddress(s),s}async getSeedPhrase(e,t){return this._convertEnglishWordlistIndicesToCodepoints(await this.keyringController.exportSeedPhrase(e))}async resetAccount(){const e=this.accountsController.getSelectedAccount().address,t=rr(cr,this,pr).call(this);return this.txController.wipeTransactions({address:e,chainId:t}),this.smartTransactionsController.wipeSmartTransactions({address:e,ignoreNetwork:!1}),this.bridgeStatusController.wipeBridgeStatus({address:e,ignoreNetwork:!1}),this.networkController.resetConnection(),e}captureKeyringTypesWithMissingIdentities(e=[],t=[]){const r=t.filter((t=>!e.some((e=>e.address.toLowerCase()===t.toLowerCase())))).map((e=>this.keyringController.getAccountKeyringType(e))),n=e.length,s=Object.keys(this.accountTrackerController.state.accounts||{}).length;(0,_.captureException)(new Error(`Attempt to get permission specifications failed because their were ${t.length} accounts, but ${n} identities, and the ${r} keyrings included accounts with missing identities. Meanwhile, there are ${s} accounts in the account tracker.`))}sortAccountsByLastSelected(e){const t=this.accountsController.listAccounts();return e.sort(((r,n)=>{const s=t.find((e=>e.address.toLowerCase()===r.toLowerCase())),i=t.find((e=>e.address.toLowerCase()===n.toLowerCase()));if(!s)throw this.captureKeyringTypesWithMissingIdentities(t,e),new Error(`Missing identity for address: "${r}".`);if(!i)throw this.captureKeyringTypesWithMissingIdentities(t,e),new Error(`Missing identity for address: "${n}".`);return s.metadata.lastSelected===i.metadata.lastSelected?0:s.metadata.lastSelected===undefined?1:i.metadata.lastSelected===undefined?-1:i.metadata.lastSelected-s.metadata.lastSelected}))}getPermittedAccounts(e,{ignoreLock:t}={}){let r;try{r=this.permissionController.getCaveat(e,se.Caip25EndowmentPermissionName,se.Caip25CaveatType)}catch(e){if(e instanceof B.PermissionDoesNotExistError)return[];throw e}if(!this.isUnlocked()&&!t)return[];const n=(0,se.getEthAccounts)(r.value);return this.sortAccountsByLastSelected(n)}removeAllScopePermissions(e){this.permissionController.updatePermissionsByCaveat(se.Caip25CaveatType,(t=>se.Caip25CaveatMutators[se.Caip25CaveatType].removeScope(t,e)))}removeAllAccountPermissions(e){this.permissionController.updatePermissionsByCaveat(se.Caip25CaveatType,(t=>se.Caip25CaveatMutators[se.Caip25CaveatType].removeAccount(t,e)))}async removeAccount(e){return this._onAccountRemoved(e),await this.keyringController.removeAccount(e),e}async importAccountWithStrategy(e,t){const r=await this.keyringController.importAccountWithStrategy(e,t);this.preferencesController.setSelectedAddress(r)}async requestPermissionApproval(e,t,r={}){const n=(0,T.nanoid)();return this.approvalController.addAndShowApprovalRequest({id:n,origin:e,requestData:{metadata:{id:n,origin:e},permissions:t,...r},type:B.MethodNames.RequestPermissions})}async requestApprovalPermittedChainsPermission(e,t){const r=(0,se.setPermittedEthChainIds)({requiredScopes:{},optionalScopes:{},isMultichainOrigin:!1},[t]);await this.permissionController.requestPermissionsIncremental({origin:e},{[se.Caip25EndowmentPermissionName]:{caveats:[{type:se.Caip25CaveatType,value:r}]}})}async requestPermittedChainsPermissionIncremental({origin:e,chainId:t,autoApprove:r}){if((0,W.isSnapId)(e))throw new Error(`Cannot request permittedChains permission for Snaps with origin "${e}"`);const n=(0,se.setPermittedEthChainIds)({requiredScopes:{},optionalScopes:{},isMultichainOrigin:!1},[t]);r?await this.permissionController.grantPermissionsIncremental({subject:{origin:e},approvedPermissions:{[se.Caip25EndowmentPermissionName]:{caveats:[{type:se.Caip25CaveatType,value:n}]}}}):await this.permissionController.requestPermissionsIncremental({origin:e},{[se.Caip25EndowmentPermissionName]:{caveats:[{type:se.Caip25CaveatType,value:n}]}})}getCaip25PermissionFromLegacyPermissions(e,t={}){var r,n;const s=(0,d.pick)(t,[he.RestrictedMethods.eth_accounts,gt.PermissionNames.permittedChains]);s[he.RestrictedMethods.eth_accounts]||(s[he.RestrictedMethods.eth_accounts]={}),s[gt.PermissionNames.permittedChains]||(s[gt.PermissionNames.permittedChains]={}),(0,W.isSnapId)(e)&&delete s[gt.PermissionNames.permittedChains];const i=(null===(r=s[he.RestrictedMethods.eth_accounts])||void 0===r||null===(r=r.caveats)||void 0===r||null===(r=r.find((e=>e.type===he.CaveatTypes.restrictReturnedAccounts)))||void 0===r?void 0:r.value)??[],a=(null===(n=s[gt.PermissionNames.permittedChains])||void 0===n||null===(n=n.caveats)||void 0===n||null===(n=n.find((e=>e.type===he.CaveatTypes.restrictNetworkSwitching)))||void 0===n?void 0:n.value)??[],o=(0,se.setPermittedEthChainIds)({requiredScopes:{},optionalScopes:{"wallet:eip155":{accounts:[]}},isMultichainOrigin:!1},(0,W.isSnapId)(e)?[]:a),c=(0,se.setEthAccounts)(o,i);return{[se.Caip25EndowmentPermissionName]:{caveats:[{type:se.Caip25CaveatType,value:c}]}}}getAddTransactionRequest({transactionParams:e,transactionOptions:t,dappRequest:r,...n}){var s;return{internalAccounts:this.accountsController.listAccounts(),dappRequest:r,networkClientId:(null==r?void 0:r.networkClientId)??(null==t?void 0:t.networkClientId)??rr(cr,this,mr).call(this),selectedAccount:this.accountsController.getAccountByAddress(e.from),transactionController:this.txController,transactionOptions:t,transactionParams:e,userOperationController:this.userOperationController,chainId:rr(cr,this,pr).call(this),ppomController:this.ppomController,securityAlertsEnabled:null===(s=this.preferencesController.state)||void 0===s?void 0:s.securityAlertsEnabled,updateSecurityAlertResponse:this.updateSecurityAlertResponse.bind(this),...n}}async getCurrentAccountEIP1559Compatibility(){return!0}async createCancelTransaction(e,t,r){await this.txController.stopTransaction(e,t,r);return this.getState()}async createSpeedUpTransaction(e,t,r){await this.txController.speedUpTransaction(e,t,r);return this.getState()}async estimateGas(e){return new Promise(((t,r)=>{this.provider.request({method:"eth_estimateGas",params:[e]}).then((e=>t(e.toString(16)))).catch((e=>r(e)))}))}async updateSecurityAlertResponse(e,t,r){await(0,It.updateSecurityAlertResponse)({appStateController:this.appStateController,method:e,securityAlertId:t,securityAlertResponse:r,signatureController:this.signatureController,transactionController:this.txController})}markPasswordForgotten(){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate()}unMarkPasswordForgotten(){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate()}setupUntrustedCommunicationEip1193({connectionStream:e,sender:t,subjectType:r}){if(t.url&&this.onboardingController.state.completedOnboarding&&this.preferencesController.state.usePhishDetect){const{hostname:r}=new URL(t.url);this.phishingController.maybeUpdateState();const n=this.phishingController.test(t.url);if(null!=n&&n.result)return this.sendPhishingWarning(e,r),void this.metaMetricsController.trackEvent({event:fe.MetaMetricsEventName.PhishingPageDisplayed,category:fe.MetaMetricsEventCategory.Phishing,properties:{url:r}})}let n;n=r||(t.id&&t.id!==this.extension.runtime.id?B.SubjectType.Extension:B.SubjectType.Website);const s=(0,Xe.setupMultiplex)(e);this.setupProviderConnectionEip1193(s.createStream("metamask-provider"),t,n),t.url&&this.setupPublicConfig(s.createStream("publicConfig"))}setupUntrustedCommunicationCaip({connectionStream:e,sender:t,subjectType:r}){}setupTrustedCommunication(e,t){const r=(0,Xe.setupMultiplex)(e);this.setupControllerConnection(r.createStream("controller")),this.setupProviderConnectionEip1193(r.createStream("provider"),t,B.SubjectType.Internal)}setupPhishingCommunication({connectionStream:e}){const{usePhishDetect:t}=this.preferencesController.state;if(!t)return;const r=(0,Xe.setupMultiplex)(e).createStream("metamask-phishing-safelist");r.on("data",(0,lt.default)({safelistPhishingDomain:this.safelistPhishingDomain.bind(this),backToSafetyPhishingWarning:this.backToSafetyPhishingWarning.bind(this)},r))}setUpCookieHandlerCommunication({connectionStream:e}){const{metaMetricsId:t,dataCollectionForMarketing:r,participateInMetaMetrics:n}=this.metaMetricsController.state;if(t&&r&&n){const t=(0,Xe.setupMultiplex)(e).createStream(Mt.METAMASK_COOKIE_HANDLER);t.on("data",(0,lt.default)({getCookieFromMarketingPage:this.getCookieFromMarketingPage.bind(this)},t))}}getCookieFromMarketingPage(e){const{ga_client_id:t}=e;this.metaMetricsController.setMarketingCampaignCookieId(t)}sendPhishingWarning(e,t){(0,Xe.setupMultiplex)(e).createStream("phishing").write({hostname:t})}setupControllerConnection(e){const t=new Ut.PatchStore(this.memStore);let r=!1;const n=()=>{if(!(0,Xe.isStreamWritable)(e)||!r)return;const n=t.flushPendingPatches();e.write({jsonrpc:"2.0",method:"sendUpdate",params:[n]})},i={...this.getApi(),...this.controllerApi,startPatches:()=>{r=!0,n()},getStatePatches:()=>t.flushPendingPatches()};this.on("update",n),this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",(0,lt.default)(i,e));const a=()=>{(0,Xe.isStreamWritable)(e)&&e.write({jsonrpc:"2.0",method:"startUISync"})};this.startUISync?a():this.once("startUISync",a);const o=()=>{e.mmFinished||(this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.mmFinished=!0,this.removeListener("update",n),t.destroy())};e.mmFinished=!1,(0,s.finished)(e,o),e.once("close",o),e.once("end",o)}setupProviderConnectionEip1193(e,t,r){let n,i;n=r===B.SubjectType.Internal?ge.ORIGIN_METAMASK:r===B.SubjectType.Snap?t.snapId:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:B.SubjectType.Extension}),t.tab&&t.tab.id&&(i=t.tab.id);let a=n;t.tab&&t.tab.url&&(a=new URL(t.tab.url).origin);const c=this.setupProviderEngineEip1193({origin:n,sender:t,subjectType:r,tabId:i,mainFrameOrigin:a}),l=(0,He.default)(),u=(0,o.createEngineStream)({engine:c}),d=this.addConnection(n,{tabId:i,apiType:nr,engine:c});(0,s.pipeline)(e,l,u,e,(e=>{var t;c.destroy(),d&&this.removeConnection(n,d),!e||null!==(t=e.message)&&void 0!==t&&t.match("Premature close")||y.default.error(e)})),r!==B.SubjectType.Internal&&this._notifyChainChangeForConnection({engine:c},n)}setupProviderConnectionCaip(e,t,r){}setupProviderEngineEip1193({origin:e,subjectType:t,sender:r,tabId:n,mainFrameOrigin:s}){const i=new a.JsonRpcEngine;i.push((0,Ze.default)({origin:e})),s&&i.push((0,Ge.default)({mainFrameOrigin:s})),i.push((0,j.createSelectedNetworkMiddleware)(this.controllerMessenger));{const e=(0,V.createQueuedRequestMiddleware)({enqueueRequest:this.queuedRequestController.enqueueRequest.bind(this.queuedRequestController),shouldEnqueueRequest:e=>ie.methodsThatShouldBeEnqueued.includes(e.method),useRequestQueue:()=>!0});i.push(e)}const o=this.selectedNetworkController.getProviderAndBlockTracker(e),c=(0,p.default)(o),l=(0,m.default)(o);return l.events.on("notification",(e=>i.emit("notification",e))),n&&i.push((0,We.default)({tabId:n})),i.push((0,ze.default)({origin:e})),i.push(this.permissionLogController.createMiddleware()),e===Ae.BaseUrl.Portfolio&&i.push((0,Pt.createTxVerificationMiddleware)(this.networkController)),i.push((0,Dt.default)()),i.push((0,Lt.default)({getThrottledOriginState:this.appStateController.getThrottledOriginState.bind(this.appStateController),updateThrottledOriginState:this.appStateController.updateThrottledOriginState.bind(this.appStateController)})),i.push((0,Fe.createPPOMMiddleware)(this.ppomController,this.preferencesController,this.networkController,this.appStateController,this.accountsController,this.updateSecurityAlertResponse.bind(this))),i.push((0,bt.default)({getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),appStateController:this.appStateController,metaMetricsController:this.metaMetricsController})),i.push((0,Ve.createUnsupportedMethodMiddleware)()),i.push((0,Ve.createEthAccountsMethodMiddleware)({getAccounts:this.getPermittedAccounts.bind(this,e)})),t!==B.SubjectType.Internal&&i.push(this.permissionController.createPermissionMiddleware({origin:e})),t===B.SubjectType.Website&&i.push((0,Ye.default)({location:r.url,registerOnboarding:this.onboardingController.registerOnboarding})),i.push((0,xt.default)({messenger:this.controllerMessenger.getRestricted({name:"EvmMethodsToNonEvmAccountFilterMessenger",allowedActions:["AccountsController:getSelectedAccount"]})})),i.push((0,Ve.createEip1193MethodMiddleware)({subjectType:t,addSubjectMetadata:this.subjectMetadataController.addSubjectMetadata.bind(this.subjectMetadataController),metamaskState:this.getState(),getProviderState:this.getProviderState.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),handleWatchAssetRequest:this.handleWatchAssetRequest.bind(this),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),sendMetrics:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAccounts:this.getPermittedAccounts.bind(this,e),getCaip25PermissionFromLegacyPermissionsForOrigin:this.getCaip25PermissionFromLegacyPermissions.bind(this,e),getPermissionsForOrigin:this.permissionController.getPermissions.bind(this.permissionController,e),requestPermittedChainsPermissionIncrementalForOrigin:t=>this.requestPermittedChainsPermissionIncremental({...t,origin:e}),requestPermissionsForOrigin:t=>this.permissionController.requestPermissions({origin:e},t),revokePermissionsForOrigin:t=>{try{this.permissionController.revokePermissions({[e]:t})}catch(e){console.log(e)}},getCaveat:({target:t,caveatType:r})=>{try{return this.permissionController.getCaveat(e,t,r)}catch(e){if(!(e instanceof B.PermissionDoesNotExistError))throw e}return undefined},setActiveNetwork:async t=>{await this.networkController.setActiveNetwork(t),this.permissionController.hasPermission(e,se.Caip25EndowmentPermissionName)&&this.selectedNetworkController.setNetworkClientIdForDomain(e,t)},addNetwork:this.networkController.addNetwork.bind(this.networkController),updateNetwork:this.networkController.updateNetwork.bind(this.networkController),getNetworkConfigurationByChainId:this.networkController.getNetworkConfigurationByChainId.bind(this.networkController),setTokenNetworkFilter:e=>{const{tokenNetworkFilter:t}=this.preferencesController.getPreferences();e&&1===Object.keys(t).length&&this.preferencesController.setPreference("tokenNetworkFilter",{[e]:!0})},getCurrentChainIdForDomain:e=>{const t=this.selectedNetworkController.getNetworkClientIdForDomain(e),{chainId:r}=this.networkController.getNetworkConfigurationByNetworkClientId(t);return r},getWeb3ShimUsageState:this.alertController.getWeb3ShimUsageState.bind(this.alertController),setWeb3ShimUsageRecorded:this.alertController.setWeb3ShimUsageRecorded.bind(this.alertController),updateCaveat:this.permissionController.updateCaveat.bind(this.permissionController,e),hasApprovalRequestsForOrigin:()=>this.approvalController.has({origin:e}),rejectApprovalRequestsForOrigin:()=>this.rejectOriginPendingApprovals(e)})),i.push((0,U.createSnapsMethodMiddleware)(t===B.SubjectType.Snap,{clearSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:clearSnapState",e),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),getSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getPermitted",e),requestPermissions:async t=>await this.permissionController.requestPermissions({origin:e},t),getPermissions:this.permissionController.getPermissions.bind(this.permissionController,e),getSnapFile:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getFile",e),getSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getSnapState",e),updateSnapState:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:updateSnapState",e),installSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:install",e),invokeSnap:this.permissionController.executeRestrictedMethod.bind(this.permissionController,e,he.RestrictedMethods.wallet_snap),getIsLocked:()=>!this.appStateController.isUnlocked(),getInterfaceState:(...t)=>this.controllerMessenger.call("SnapInterfaceController:getInterface",e,...t).state,getInterfaceContext:(...t)=>this.controllerMessenger.call("SnapInterfaceController:getInterface",e,...t).context,createInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:createInterface",e),updateInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:updateInterface",e),resolveInterface:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapInterfaceController:resolveInterface",e),getSnap:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:get"),getAllSnaps:this.controllerMessenger.call.bind(this.controllerMessenger,"SnapController:getAll"),getCurrencyRate:e=>{const t=this.multichainRatesController.state.rates[e],{fiatCurrency:r}=this.multichainRatesController.state;return t?{...t,currency:r}:undefined},getEntropySources:()=>{const e=this.controllerMessenger.call("KeyringController:getState");return e.keyrings.map(((t,r)=>t.type===h.KeyringTypes.hd?{id:e.keyringsMetadata[r].id,name:e.keyringsMetadata[r].name,type:"mnemonic",primary:0===r}:null)).filter(Boolean)},hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),scheduleBackgroundEvent:t=>this.controllerMessenger.call("CronjobController:scheduleBackgroundEvent",{...t,snapId:e}),cancelBackgroundEvent:this.controllerMessenger.call.bind(this.controllerMessenger,"CronjobController:cancelBackgroundEvent",e),getBackgroundEvents:this.controllerMessenger.call.bind(this.controllerMessenger,"CronjobController:getBackgroundEvents",e),getNetworkConfigurationByChainId:this.controllerMessenger.call.bind(this.controllerMessenger,"NetworkController:getNetworkConfigurationByChainId"),getNetworkClientById:this.controllerMessenger.call.bind(this.controllerMessenger,"NetworkController:getNetworkClientById"),handleSnapRpcRequest:t=>this.handleSnapRequest({...t,origin:e}),getAllowedKeyringMethods:(0,je.keyringSnapPermissionsBuilder)(this.subjectMetadataController,e)})),i.push(c),i.push(l.middleware),i.push(this.metamaskMiddleware),i.push((0,u.providerAsMiddleware)(o.provider)),i}setupProviderEngineCaip({origin:e,sender:t,subjectType:r,tabId:n}){return null}setupPublicConfig(e){const t=(0,l.storeAsStream)(this.publicConfigStore);(0,s.pipeline)(t,e,(e=>{var r;t.destroy(),!e||null!==(r=e.message)&&void 0!==r&&r.match("Premature close")||y.default.error(e)}))}addConnection(e,{tabId:t,apiType:r,engine:n}){if(e===ge.ORIGIN_METAMASK)return null;this.connections[e]||(this.connections[e]={});const s=(0,T.nanoid)();return this.connections[e][s]={tabId:t,apiType:r,engine:n},s}removeConnection(e,t){const r=this.connections[e];r&&(delete r[t],0===Object.keys(r).length&&delete this.connections[e])}removeAllConnections(e){const t=this.connections[e];t&&Object.keys(t).forEach((t=>{this.removeConnection(e,t)}))}notifyConnections(e,t,r){const n=this.connections[e];n&&Object.values(n).forEach((e=>{r&&e.apiType!==r||e.engine&&e.engine.emit("notification",t)}))}notifyAllConnections(e,t){const r="function"==typeof e?t=>e(t):()=>e;Object.keys(this.connections).forEach((e=>{Object.values(this.connections[e]).forEach((async n=>{if(!t||n.apiType===t)try{this.notifyConnection(n,await r(e))}catch(e){console.error(e)}}))}))}notifyConnection(e,t){try{e.engine&&e.engine.emit("notification",t)}catch(e){console.error(e)}}async _onKeyringControllerUpdate(e){const{keyrings:t}=e,r=t.reduce(((e,{accounts:t})=>e.concat(t)),[]).filter(Nt.isEthAddress);r.length&&this.accountTrackerController.syncWithAddresses(r)}_onUnlock(){this.unMarkPasswordForgotten(),this.emit("unlock")}_onLock(){this.emit("lock")}_onStateUpdate(e){this.isClientOpenAndUnlocked=e.isUnlocked&&this._isClientOpen,this._notifyChainChange()}_onAccountRemoved(e){this.removeAllAccountPermissions(e)}privateSendUpdate(){this.emit("update",this.getState())}isUnlocked(){return this.keyringController.state.isUnlocked}getExternalPendingTransactions(e){return this.smartTransactionsController.getTransactions({addressFrom:e,status:"pending"})}async initializeChainlist(){const e=`cachedFetch:${ce.CHAIN_SPEC_URL}`,{cachedResponse:t}=await(0,be.getStorageItem)(e)||{};t||await(0,be.setStorageItem)(e,{cachedResponse:(0,k.rawChainData)(),cachedTime:0})}async getPendingNonce(e,t){const{nonceDetails:r,releaseLock:n}=await this.txController.getNonceLock(e,t),s=r.params.highestSuggested;return n(),s}async getNextNonce(e,t){const r=await this.txController.getNonceLock(e,t);return r.releaseLock(),r.nextNonce}throwTestError(e){setTimeout((()=>{const t=new Error(e);throw t.name="TestError",t}))}_addBridgeStatusControllerListeners(){this.controllerMessenger.subscribe("BridgeStatusController:bridgeTransactionComplete",(e=>(0,Ht.handleBridgeTransactionComplete)(e,{backgroundState:this.getState(),trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}))),this.controllerMessenger.subscribe("BridgeStatusController:bridgeTransactionFailed",(e=>(0,Ht.handleBridgeTransactionFailed)(e,{backgroundState:this.getState(),trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}))),this.controllerMessenger.subscribe("TransactionController:transactionFailed",(e=>{e.transactionMeta.type===G.TransactionType.bridge&&(0,Ht.handleTransactionFailedTypeBridge)(e,{backgroundState:this.getState(),trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)})}))}getTransactionMetricsRequest(){return{...{createEventFragment:this.metaMetricsController.createEventFragment.bind(this.metaMetricsController),finalizeEventFragment:this.metaMetricsController.finalizeEventFragment.bind(this.metaMetricsController),getEventFragmentById:this.metaMetricsController.getEventFragmentById.bind(this.metaMetricsController),getParticipateInMetrics:()=>this.metaMetricsController.state.participateInMetaMetrics,trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),updateEventFragment:this.metaMetricsController.updateEventFragment.bind(this.metaMetricsController),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getHardwareTypeForMetric:this.getHardwareTypeForMetric.bind(this),getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getSelectedAddress:()=>this.accountsController.getSelectedAccount().address,getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),getTransaction:e=>this.txController.state.transactions.find((t=>t.id===e)),getIsSmartTransaction:()=>(0,Ee.getIsSmartTransaction)(this._getMetaMaskState()),getSmartTransactionByMinedTxHash:e=>this.smartTransactionsController.getSmartTransactionByMinedTxHash(e),getMethodData:e=>{if(!e)return null;const{knownMethodData:t,use4ByteResolution:r}=this.preferencesController.state,n=(0,ut.addHexPrefix)(e);return(0,ut.getMethodDataName)(t,r,n,this.preferencesController.addKnownMethodData.bind(this.preferencesController),this.provider)},getIsConfirmationAdvancedDetailsOpen:()=>this.preferencesController.state.preferences.showConfirmationAdvancedDetails},snapAndHardwareMessenger:this.controllerMessenger.getRestricted({name:"SnapAndHardwareMessenger",allowedActions:["KeyringController:getKeyringForAccount","SnapController:get","AccountsController:getSelectedAccount"]}),provider:this.provider}}toggleExternalServices(e){this.preferencesController.toggleExternalServices(e),this.tokenListController.updatePreventPollingOnNetworkRestart(!e),e?(this.tokenDetectionController.enable(),this.gasFeeController.enableNonRPCGasFeeApis()):(this.tokenDetectionController.disable(),this.gasFeeController.disableNonRPCGasFeeApis())}async setLedgerTransportPreference(e){const t=window.navigator.hid?ue.LedgerTransportTypes.webhid:ue.LedgerTransportTypes.u2f;return null!=e&&e.updateTransportMethod?e.updateTransportMethod(t).catch((e=>{throw e})):undefined}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){const t="12.15.2";e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e}onClientClosed(){try{this.gasFeeController.stopAllPolling(),this.currencyRateController.stopAllPolling(),this.tokenRatesController.stopAllPolling(),this.tokenDetectionController.stopAllPolling(),this.tokenListController.stopAllPolling(),this.tokenBalancesController.stopAllPolling(),this.appStateController.clearPollingTokens(),this.accountTrackerController.stopAllPolling()}catch(e){console.error(e)}}onEnvironmentTypeClosed(e){const t=ge.POLLING_TOKEN_ENVIRONMENT_TYPES[e];this.appStateController.state[t].forEach((e=>{this.gasFeeController.stopPollingByPollingToken(e),this.currencyRateController.stopPollingByPollingToken(e),this.tokenRatesController.stopPollingByPollingToken(e),this.tokenDetectionController.stopPollingByPollingToken(e),this.tokenListController.stopPollingByPollingToken(e),this.tokenBalancesController.stopPollingByPollingToken(e),this.accountTrackerController.stopPollingByPollingToken(e),this.appStateController.removePollingToken(e,t)}))}safelistPhishingDomain(e){return this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.Phishing,event:fe.MetaMetricsEventName.ProceedAnywayClicked,properties:{url:e,referrer:{url:e}}}),this.phishingController.bypass(e)}async backToSafetyPhishingWarning(){this.metaMetricsController.trackEvent({category:fe.MetaMetricsEventCategory.Navigation,event:fe.MetaMetricsEventName.PortfolioLinkClicked,properties:{location:"phishing_page",text:"Back to safety"}}),await this.platform.switchToAnotherURL(undefined,"https://portfolio.metamask.io/?metamaskEntry=phishing_page_portfolio_button")}setLocked(){return this.keyringController.setLocked()}rejectAllPendingApprovals(){(0,qt.rejectAllApprovals)({approvalController:this.approvalController,deleteInterface:e=>this.controllerMessenger.call("SnapInterfaceController:deleteInterface",e)})}async getCode(e,t){const{provider:r}=this.networkController.getNetworkClientById(t);return await r.request({method:"eth_getCode",params:[e]})}async _onAccountChange(e){const t=(0,gt.getPermittedAccountsByOrigin)(this.permissionController.state);for(const[r,n]of t.entries())n.includes(e)&&this._notifyAccountsChange(r,n);await this.txController.updateIncomingTransactions([rr(cr,this,pr).call(this)])}_notifyAccountsChange(e,t){this.notifyConnections(e,{method:gt.NOTIFICATION_NAMES.accountsChanged,params:t.length<2?t:this.getPermittedAccounts(e)},nr),this.permissionLogController.updateAccountsHistory(e,t)}async _notifyAuthorizationChange(e,t){this.notifyConnections(e,{method:gt.NOTIFICATION_NAMES.sessionChanged,params:{sessionScopes:(0,se.getSessionScopes)(t)}},sr)}async _notifyChainChange(){this.notifyAllConnections((async e=>({method:gt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState(e)})),nr)}async _notifyChainChangeForConnection(e,t){this.notifyConnection(e,{method:gt.NOTIFICATION_NAMES.chainChanged,params:await this.getProviderNetworkState(t)})}async _onFinishedTransaction(e){[G.TransactionStatus.confirmed,G.TransactionStatus.failed].includes(e.status)&&(await this._createTransactionNotifcation(e),await this._updateNFTOwnership(e),this._trackTransactionFailure(e),await this.tokenBalancesController.updateBalancesByChainId({chainId:e.chainId}))}async _createTransactionNotifcation(e){const{chainId:t}=e;let r={};if(t){var n,s;const e=null===(n=this.networkController.state.networkConfigurationsByChainId)||void 0===n?void 0:n[t];r={blockExplorerUrl:null==e||null===(s=e.blockExplorerUrls)||void 0===s?void 0:s[null==e?void 0:e.defaultBlockExplorerUrlIndex]}}try{await this.platform.showTransactionNotification(e,r)}catch(e){y.default.error("Failed to create transaction notification",e)}}async _updateNFTOwnership(e){const{type:t,txParams:r,chainId:n,txReceipt:s}=e,i=this.accountsController.getSelectedAccount().address,{allNfts:a}=this.nftController.state,o=null==s?void 0:s.logs,c=t===G.TransactionType.contractInteraction&&o,l=(t===G.TransactionType.tokenMethodTransferFrom||t===G.TransactionType.tokenMethodSafeTransferFrom)&&r!==undefined;if(c||l)if(l){var u;const{data:e,to:t,from:s}=r,i=(0,ke.parseStandardTokenTransactionData)(e),o=(0,ve.getTokenIdParam)(i)??(0,Te.getTokenValueParam)(i),c=null==a||null===(u=a[s])||void 0===u||null===(u=u[n])||void 0===u?void 0:u.find((({address:e,tokenId:r})=>(0,we.isEqualCaseInsensitive)(e,t)&&r===o));c&&this.nftController.checkAndUpdateSingleNftOwnershipStatus(c,!1,{userAddress:s})}else{const e=o.map((e=>{const t=e.topics&&e.topics[0]===Me.TRANSFER_SINFLE_LOG_TOPIC_HASH,r=e.topics&&e.topics[0]===Me.TOKEN_TRANSFER_LOG_TOPIC_HASH;let n;return t&&(n=e.topics&&e.topics[3]&&e.topics[3].match(null==i?void 0:i.slice(2))),r&&(n=e.topics&&e.topics[2]&&e.topics[2].match(null==i?void 0:i.slice(2))),{isERC1155NftTransfer:t,isERC721NftTransfer:r,isTransferToSelectedAddress:n,...e}}));if(0!==e.length){const t=[];e.forEach((e=>{if(e.isTransferToSelectedAddress&&(e.isERC1155NftTransfer||e.isERC721NftTransfer)){let r;r=e.isERC1155NftTransfer?new J.Interface(Q.abiERC1155):new J.Interface(Q.abiERC721);try{const n=r.parseLog({data:e.data,topics:e.topics});t.push({contract:e.address,...n})}catch(e){}}}));const r=[],s=[];t.forEach((e=>{var t;const o=(0,ve.getTokenIdParam)(e),c=null==a||null===(t=a[i])||void 0===t||null===(t=t[n])||void 0===t?void 0:t.find((({address:t,tokenId:r})=>(0,we.isEqualCaseInsensitive)(t,e.contract)&&r===o));c?r.push(c):s.push({tokenId:o,...e})}));const o=r.map((async e=>this.nftController.checkAndUpdateSingleNftOwnershipStatus(e,!1,{selectedAddress:i})));await Promise.allSettled(o);const c=s.map((async e=>this.nftController.addNft(e.contract,e.tokenId)));await Promise.allSettled(c)}}}_trackTransactionFailure(e){var t;const{txReceipt:r}=e,n=this.getState();r&&"0x0"===r.status&&this.metaMetricsController.trackEvent({event:"Tx Status Update: On-Chain Failure",category:fe.MetaMetricsEventCategory.Background,properties:{action:"Transactions",errorMessage:null===(t=e.simulationFails)||void 0===t?void 0:t.reason,numberOfTokens:n.tokens.length,numberOfAccounts:Object.keys(n.accounts).length}},{matomoEvent:!0})}_onUserOperationAdded(e){const t=this.txController.state.transactions.find((t=>t.id===e.id));t&&(t.type===G.TransactionType.swap?this.controllerMessenger.publish("TransactionController:transactionNewSwap",{transactionMeta:t}):t.type===G.TransactionType.swapApproval&&this.controllerMessenger.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:t}))}_onUserOperationTransactionUpdated(e){const t={...e,txParams:{...e.txParams,from:this.accountsController.getSelectedAccount().address}};this.txController.state.transactions.some((e=>e.id===t.id))||this.txController.update((e=>{e.transactions.push(t)})),this.txController.updateTransaction(t,"Generated from user operation"),this.controllerMessenger.publish("TransactionController:transactionStatusUpdated",{transactionMeta:t})}_getMetaMaskState(){return{metamask:this.getState()}}_getConfigForRemoteFeatureFlagRequest(){return{distribution:or.main||K.DistributionType.Main,environment:ar.production||K.EnvironmentType.Development}}}async function ur(e,t){var r,n,s,i;const a=null===(r=this.opts.overrides)||void 0===r?void 0:r.keyrings;let o=null;switch(e.name){case ue.HardwareDeviceNames.trezor:case ue.HardwareDeviceNames.oneKey:o=(null==a||null===(n=a.trezor)||void 0===n?void 0:n.type)||b.TrezorKeyring.type;break;case ue.HardwareDeviceNames.ledger:o=(null==a||null===(s=a.ledger)||void 0===s?void 0:s.type)||v.LedgerKeyring.type;break;case ue.HardwareDeviceNames.qr:o=C.MetaMaskKeyring.type;break;case ue.HardwareDeviceNames.lattice:o=(null==a||null===(i=a.lattice)||void 0===i?void 0:i.type)||w.default.type;break;default:throw new Error("MetamaskController:#withKeyringForDevice - Unknown device")}return this.keyringController.withKeyring({type:o},(async({keyring:r})=>{if(e.hdPath&&r.setHdPath&&r.setHdPath(e.hdPath),e.name===ue.HardwareDeviceNames.lattice&&(r.appName="MetaMask"),e.name===ue.HardwareDeviceNames.trezor||e.name===ue.HardwareDeviceNames.oneKey){const e=r.getModel();this.appStateController.setTrezorModel(e)}return r.network=(0,Pe.getProviderConfig)({metamask:this.networkController.state}).type,await t(r)}),{createIfMissing:!0})}function dr(e,t){const r=rr(cr,this,hr).call(this,t),n=rr(cr,this,hr).call(this,e);r!==n&&this.tokenListController.updatePreventPollingOnNetworkRestart(!n)}function hr(e){const{useTokenDetection:t,useTransactionSimulations:r,preferences:n}=e??{},{petnamesEnabled:s}=n??{};return t||s||r}function pr(){const e=rr(cr,this,mr).call(this);return this.networkController.getNetworkClientById(e).configuration.chainId}function mr(){return this.networkController.state.selectedNetworkClientId}function gr({existingControllers:e,initFunctions:t,initState:r}){const n={getFlatState:this.getState.bind(this),getGlobalChainId:rr(cr,this,pr).bind(this),getPermittedAccounts:this.getPermittedAccounts.bind(this),getProvider:()=>this.provider,getStateUI:this._getMetaMaskState.bind(this),getTransactionMetricsRequest:this.getTransactionMetricsRequest.bind(this),offscreenPromise:this.offscreenPromise,persistedState:r,removeAllConnections:this.removeAllConnections.bind(this),setupUntrustedCommunicationEip1193:this.setupUntrustedCommunicationEip1193.bind(this),showNotification:this.platform._showNotification,getMetaMetricsId:this.metaMetricsController.getMetaMetricsId.bind(this.metaMetricsController),trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)};return(0,Gt.initControllers)({baseControllerMessenger:this.controllerMessenger,existingControllers:e,initFunctions:t,initRequest:n})}r.default=lr}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$",file:"app/scripts/metamask-controller.js"}],[185,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:2,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=2;try{"etherscan"===t.data.config.provider.type&&(t.data.config.provider.type="rpc",t.data.config.provider.rpcTarget="https://rpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/002.js"}],[186,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:3,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=3;try{"https://rawtestrpc.metamask.io/"===t.data.config.provider.rpcTarget&&(t.data.config.provider.rpcTarget="https://testrpc.metamask.io/")}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/003.js"}],[187,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:4,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=4;try{if("rpc"!==t.data.config.provider.type)return Promise.resolve(t);switch(t.data.config.provider.rpcTarget){case"https://testrpc.metamask.io/":t.data.config.provider={type:"testnet"};break;case"https://rpc.metamask.io/":t.data.config.provider={type:"mainnet"}}}catch(e){}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/004.js"}],[188,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:5,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=5;try{const e=function(e){const{config:t}=e,r={...e,KeyringController:{vault:e.vault,selectedAccount:t.selectedAccount,walletNicknames:e.walletNicknames}};return delete r.vault,delete r.walletNicknames,delete r.config.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #5${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/005.js"}],[189,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:6,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=6;try{const e=function(e){const t=e.KeyringController,r={...e,PreferencesController:{selectedAddress:t.selectedAccount}};return delete r.KeyringController.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #6${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/006.js"}],[19,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getMultichainAssetsRatesControllerMessenger=function(e){return e.getRestricted({name:"MultichainAssetsRatesController",allowedEvents:["AccountsController:accountAdded","KeyringController:lock","KeyringController:unlock","CurrencyRateController:stateChange","MultichainAssetsController:stateChange"],allowedActions:["AccountsController:listMultichainAccounts","SnapController:handleRequest","CurrencyRateController:getState","MultichainAssetsController:getState"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-assets-rates-controller-messenger.ts"}],[190,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:7,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=7;try{const e=function(e){const t={...e,TransactionManager:{transactions:e.transactions||[],gasMultiplier:e.gasMultiplier||1}};return delete t.transactions,delete t.gasMultiplier,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #7${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/007.js"}],[191,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:8,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=8;try{const e=function(e){const t={...e,NoticeController:{noticesList:e.noticesList||[]}};return delete t.noticesList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #8${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/008.js"}],[192,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:9,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=9;try{const e=function(e){const t=(0,n.merge)({},e,{CurrencyController:{currentCurrency:e.currentFiat||e.fiatCurrency||"USD",conversionRate:e.conversionRate,conversionDate:e.conversionDate}});return delete t.currentFiat,delete t.fiatCurrency,delete t.conversionRate,delete t.conversionDate,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #9${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/009.js"}],[1922,{"@metamask/keyring-snap-client":1926},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s,i,a,o,c=this&&this.__classPrivateFieldSet||function(e,t,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r},l=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};Object.defineProperty(r,"__esModule",{value:!0}),r.KeyringInternalSnapClient=void 0;const u=e("@metamask/keyring-snap-client");class d{constructor(e,t,r,o){n.set(this,void 0),s.set(this,void 0),i.set(this,void 0),a.set(this,void 0),c(this,i,e,"f"),c(this,n,t,"f"),c(this,s,r,"f"),c(this,a,o,"f")}async send(e){return l(this,i,"f").call("SnapController:handleRequest",{snapId:l(this,n,"f"),origin:l(this,s,"f"),handler:l(this,a,"f"),request:e})}}n=new WeakMap,s=new WeakMap,i=new WeakMap,a=new WeakMap;class h extends u.KeyringClient{constructor({messenger:e,snapId:t="undefined",origin:r="metamask",handler:n="onKeyringRequest"}){super(new d(e,t,r,n)),o.set(this,void 0),c(this,o,e,"f")}withSnapId(e){return new h({messenger:l(this,o,"f"),snapId:e})}}r.KeyringInternalSnapClient=h,o=new WeakMap}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-internal-snap-client",file:"node_modules/@metamask/keyring-internal-snap-client/dist/KeyringInternalSnapClient.cjs"}],[1923,{"./KeyringInternalSnapClient.cjs":1922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./KeyringInternalSnapClient.cjs"),r)}}},{package:"@metamask/eth-snap-keyring>@metamask/keyring-internal-snap-client",file:"node_modules/@metamask/keyring-internal-snap-client/dist/index.cjs"}],[193,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:10,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=10;try{const e=function(e){const t=(0,n.merge)({},e,{ShapeShiftController:{shapeShiftTxList:e.shapeShiftTxList||[]}});return delete t.shapeShiftTxList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #10${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/010.js"}],[194,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:11,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=11;try{const e=function(e){const t=e;return delete t.TOSHash,delete t.isDisclaimerConfirmed,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #11${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/011.js"}],[195,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:12,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=12;try{const e=function(e){const t=e;return t.NoticeController.noticesList.forEach((e=>{e.read&&(e.body="")})),t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #12${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/012.js"}],[196,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:13,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=13;try{const e=function(e){const t=e,{config:r}=t;r&&r.provider&&"testnet"===r.provider.type&&(t.config.provider.type="ropsten");return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #13${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/013.js"}],[1960,{"@metamask/base-controller":1332,events:4323,uuid:5587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AbstractMessageManager=void 0;const n=e("@metamask/base-controller"),s=e("events"),i=e("uuid"),a={unapprovedMessages:{persist:!1,anonymous:!1},unapprovedMessagesCount:{persist:!1,anonymous:!1}};class o extends n.BaseController{constructor({additionalFinishStatuses:e,messenger:t,name:r,securityProviderRequest:n,state:i={}}){super({messenger:t,metadata:a,name:r,state:{unapprovedMessages:{},unapprovedMessagesCount:0,...i}}),this.internalEvents=new s.EventEmitter,this.messages=[],this.securityProviderRequest=n,this.additionalFinishStatuses=e??[]}addRequestToMessageParams(e,t){const r={...e};return t&&(r.requestId=t.id,r.origin=t.origin),r}createUnapprovedMessage(e,t,r){return{id:(0,i.v1)(),messageParams:e,securityAlertResponse:r?.securityAlertResponse,status:"unapproved",time:Date.now(),type:t}}saveMessageList(e=!0){this.update((e=>{e.unapprovedMessages=this.getUnapprovedMessages(),e.unapprovedMessagesCount=this.getUnapprovedMessagesCount()})),e&&this.messagingSystem.publish(`${this.name}:updateBadge`)}setMessageStatus(e,t){const r=this.getMessage(e);if(!r)throw new Error(`${this.name}: Message not found for id: ${e}.`);const n={...r,status:t};this.updateMessage(n),this.internalEvents.emit(`${e}:${t}`,n),("rejected"===t||"signed"===t||"errored"===t||this.additionalFinishStatuses.includes(t))&&this.internalEvents.emit(`${e}:finished`,n)}updateMessage(e,t=!0){const r=this.messages.findIndex((t=>e.id===t.id));-1!==r&&(this.messages[r]=e),this.saveMessageList(t)}async securityCheck(e){if(this.securityProviderRequest){const t=await this.securityProviderRequest(e,e.type);return{...e,securityProviderResponse:t}}return e}clearUnapprovedMessages(){this.update((e=>{e.unapprovedMessages={},e.unapprovedMessagesCount=0}))}getUnapprovedMessagesCount(){return Object.keys(this.getUnapprovedMessages()).length}getUnapprovedMessages(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}async addMessage(e){const t=await this.securityCheck(e);this.messages.push(t),this.saveMessageList()}getMessage(e){return this.messages.find((t=>t.id===e))}getAllMessages(){return this.messages}approveMessage(e){return this.setMessageStatusApproved(e.metamaskId),this.prepMessageForSigning(e)}setMessageStatusApproved(e){this.setMessageStatus(e,"approved")}setMessageStatusInProgress(e){this.setMessageStatus(e,"inProgress")}setMessageStatusSigned(e,t){this.setMessageStatusAndResult(e,t,"signed")}setMessageStatusAndResult(e,t,r){this.setResult(e,t),this.setMessageStatus(e,r)}setResult(e,t){const r=this.getMessage(e);r&&this.updateMessage({...r,rawSig:t},!1)}setMetadata(e,t){const r=this.getMessage(e);if(!r)throw new Error(`${this.name}: Message not found for id: ${e}.`);this.updateMessage({...r,metadata:t},!1)}rejectMessage(e){this.setMessageStatus(e,"rejected")}async waitForFinishStatus(e,t){const{metamaskId:r,...n}=e;return new Promise(((e,s)=>{this.internalEvents.once(`${r}:finished`,(r=>{switch(r.status){case"signed":return e(r.rawSig);case"rejected":return s(new Error(`MetaMask ${t} Signature: User denied message signature.`));case"errored":return s(new Error(`MetaMask ${t} Signature: ${r.error}`));default:return s(new Error(`MetaMask ${t} Signature: Unknown problem: ${JSON.stringify(n)}`))}}))}))}}r.AbstractMessageManager=o,r.default=o}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/AbstractMessageManager.cjs"}],[1961,{"./AbstractMessageManager.cjs":1960,"./utils.cjs":1965,"@metamask/controller-utils":1360},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DecryptMessageManager=void 0;const n=e("@metamask/controller-utils"),s=e("./AbstractMessageManager.cjs"),i=e("./utils.cjs"),a="DecryptMessageManager";class o extends s.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:r,state:n}){super({additionalFinishStatuses:e,messenger:t,name:a,securityProviderRequest:r,state:n})}async addUnapprovedMessageAsync(e,t){(0,i.validateDecryptedMessageData)(e);const r=await this.addUnapprovedMessage(e,t);return new Promise(((t,n)=>{this.internalEvents.once(`${r}:finished`,(r=>{switch(r.status){case"decrypted":return t(r.rawSig);case"rejected":return n(new Error("MetaMask DecryptMessage: User denied message decryption."));case"errored":return n(new Error("MetaMask DecryptMessage: This message cannot be decrypted."));default:return n(new Error(`MetaMask DecryptMessage: Unknown problem: ${JSON.stringify(e)}`))}}))}))}async addUnapprovedMessage(e,t){const r=this.addRequestToMessageParams(e,t);e.data=(0,i.normalizeMessageData)(e.data);const s=this.createUnapprovedMessage(r,n.ApprovalType.EthDecrypt,t),o=s.id;return await this.addMessage(s),this.messagingSystem.publish(`${a}:unapprovedMessage`,{...r,metamaskId:o}),o}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve(e)}}r.DecryptMessageManager=o}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/DecryptMessageManager.cjs"}],[1962,{"./AbstractMessageManager.cjs":1960,"./utils.cjs":1965,"@metamask/controller-utils":1360},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.EncryptionPublicKeyManager=void 0;const n=e("@metamask/controller-utils"),s=e("./AbstractMessageManager.cjs"),i=e("./utils.cjs");class a extends s.AbstractMessageManager{constructor({additionalFinishStatuses:e,messenger:t,securityProviderRequest:r,state:n}){super({additionalFinishStatuses:e,messenger:t,name:"EncryptionPublicKeyManager",securityProviderRequest:r,state:n})}async addUnapprovedMessageAsync(e,t){(0,i.validateEncryptionPublicKeyMessageData)(e);const r=await this.addUnapprovedMessage(e,t);return new Promise(((t,n)=>{this.internalEvents.once(`${r}:finished`,(r=>{switch(r.status){case"received":return t(r.rawSig);case"rejected":return n(new Error("MetaMask EncryptionPublicKey: User denied message EncryptionPublicKey."));default:return n(new Error(`MetaMask EncryptionPublicKey: Unknown problem: ${JSON.stringify(e)}`))}}))}))}async addUnapprovedMessage(e,t){const r=this.addRequestToMessageParams(e,t),s=this.createUnapprovedMessage(r,n.ApprovalType.EthGetEncryptionPublicKey,t),i=s.id;return await this.addMessage(s),this.messagingSystem.publish(`${this.name}:unapprovedMessage`,{...r,metamaskId:i}),i}prepMessageForSigning(e){return delete e.metamaskId,Promise.resolve({from:e.data})}}r.EncryptionPublicKeyManager=a,r.default=a}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/EncryptionPublicKeyManager.cjs"}],[1963,{"./AbstractMessageManager.cjs":1960,"./DecryptMessageManager.cjs":1961,"./EncryptionPublicKeyManager.cjs":1962,"./types.cjs":1964},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./AbstractMessageManager.cjs"),r),s(e("./EncryptionPublicKeyManager.cjs"),r),s(e("./DecryptMessageManager.cjs"),r),s(e("./types.cjs"),r)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/index.cjs"}],[1964,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0})}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/types.cjs"}],[1965,{"@metamask/controller-utils":1360,"@metamask/utils":2874,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.validateDecryptedMessageData=r.validateEncryptionPublicKeyMessageData=r.normalizeMessageData=void 0;const n=e("@metamask/controller-utils"),s=e("@metamask/utils"),i=/^[0-9A-Fa-f]+$/gu;function a(e,t){if(!e||"string"!=typeof e||!(0,n.isValidHexAddress)(e))throw new Error(`Invalid "${t}" address: ${e} must be a valid string.`)}r.normalizeMessageData=function(e){try{const t=(0,s.remove0x)(e);if(t.match(i))return(0,s.add0x)(t)}catch(e){}return(0,s.bytesToHex)(t.from(e,"utf8"))},r.validateEncryptionPublicKeyMessageData=function(e){const{from:t}=e;a(t,"from")},r.validateDecryptedMessageData=function(e){const{from:t}=e;a(t,"from")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/message-manager",file:"node_modules/@metamask/message-manager/dist/utils.cjs"}],[1966,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={snapId:"npm:@metamask/message-signing-snap",manifest:{version:"0.6.0",description:"Provides public key and message signing used for signing in with MetaMask",proposedName:"Sign in with MetaMask",repository:{type:"git",url:"https://github.com/MetaMask/message-signing-snap.git"},source:{shasum:"MVxPWtAZ1Sdw63kwfZswKlYQ6dddnr7vvbj4V7j/Fc4=",location:{npm:{filePath:"dist/bundle.js",iconPath:"images/icon.svg",packageName:"@metamask/message-signing-snap",registry:"https://registry.npmjs.org/"}}},initialConnections:{"https://portfolio.metamask.io":{},"https://portfolio-builds.metafi-dev.codefi.network":{},"https://docs.metamask.io":{},"https://developer.metamask.io":{}},initialPermissions:{snap_getEntropy:{},"endowment:rpc":{dapps:!0,snaps:!1}},manifestVersion:"0.1"},files:[{path:"images/icon.svg",value:'<svg width="500" height="500" viewBox="0 0 500 500" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect width="500" height="500" fill="black"/>\n<g filter="url(#filter0_f_8_91)">\n<path d="M249.444 373.519C249.444 373.519 364.118 343.192 364.118 257.188L378.333 248.251L364.118 239.314L378.333 230.378L364.118 221.441V203.568V185.695V149.948V114.202L301.639 132.596C267.566 142.628 231.323 142.628 197.25 132.596L134.771 114.202V149.948V167.821V185.695V203.568V221.441L120.556 230.378L134.771 239.314L120.556 248.251L134.771 257.188C134.771 343.192 249.444 373.519 249.444 373.519Z" fill="#F1CA77"/>\n</g>\n<path d="M249.445 406.215C249.445 406.215 364.118 348.879 364.118 262.874L378.333 253.937L364.118 245.001L378.333 236.064L364.118 227.127V209.254V191.381V155.634V119.888L249.445 162.179L134.771 119.888V155.634V173.508V191.381V209.254V227.127L120.556 236.064L134.771 245.001L120.556 253.937L134.771 262.874C134.771 348.879 249.445 406.215 249.445 406.215Z" fill="#233447"/>\n<path d="M249.445 399.107C249.445 399.107 364.118 348.879 364.118 262.874L378.333 253.937L364.118 245.001L378.333 236.064L364.118 227.127V209.254V191.381V155.634V119.888L249.445 162.179L134.771 119.888V155.634V173.508V191.381V209.254V227.127L120.556 236.064L134.771 245.001L120.556 253.937L134.771 262.874C134.771 348.879 249.445 399.107 249.445 399.107Z" fill="#123AF0"/>\n<path d="M249.445 392C249.445 392 364.118 348.879 364.118 262.874L378.333 253.937L364.118 245.001L378.333 236.064L364.118 227.127V209.254V191.381V155.634V119.888L249.445 162.179L134.771 119.888V155.634V173.508V191.381V209.254V227.127L120.556 236.064L134.771 245.001L120.556 253.937L134.771 262.874C134.771 348.879 249.445 392 249.445 392Z" fill="#CD6116"/>\n<path d="M249.445 382.049C249.445 382.049 364.118 348.879 364.118 262.874L378.333 253.937L364.118 245.001L378.333 236.064L364.118 227.127V209.254V191.381V155.634V119.888L249.445 162.179L134.771 119.888V155.634V173.508V191.381V209.254V227.127L120.556 236.064L134.771 245.001L120.556 253.937L134.771 262.874C134.771 348.879 249.445 382.049 249.445 382.049Z" fill="#E4751F"/>\n<path d="M249.445 370.676C249.445 370.676 364.118 348.879 364.118 262.874L378.333 253.937L364.118 245.001L378.333 236.064L364.118 227.127V209.254V191.381V155.634V119.888L249.445 162.179L134.771 119.888V155.634V173.508V191.381V209.254V227.127L120.556 236.064L134.771 245.001L120.556 253.937L134.771 262.874C134.771 348.879 249.445 370.676 249.445 370.676Z" fill="#F6851B"/>\n<path d="M249.445 352.196C249.445 352.196 364.118 348.879 364.118 262.874L378.333 253.937L364.118 245.001L378.333 236.064L364.118 227.127V209.254V191.381V155.634V119.888C290.105 147.184 208.784 147.184 134.771 119.888V155.634V173.508V191.381V209.254V227.127L120.556 236.064L134.771 245.001L120.556 253.937L134.771 262.874C134.771 348.879 249.445 352.196 249.445 352.196Z" fill="url(#paint0_linear_8_91)"/>\n<defs>\n<filter id="filter0_f_8_91" x="94.9674" y="88.6133" width="308.954" height="310.494" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"/>\n<feGaussianBlur stdDeviation="12.7941" result="effect1_foregroundBlur_8_91"/>\n</filter>\n<linearGradient id="paint0_linear_8_91" x1="144.012" y1="132.09" x2="425.482" y2="446.967" gradientUnits="userSpaceOnUse">\n<stop stop-color="#F1CA77"/>\n<stop offset="1" stop-color="#F6851B"/>\n</linearGradient>\n</defs>\n</svg>\n'},{path:"dist/bundle.js",value:'(()=>{var e={463:e=>{e.exports=a,a.default=a,a.stable=u,a.stableStringify=u;var t="[...]",n="[Circular]",r=[],s=[];function i(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function a(e,t,n,a){var o;void 0===a&&(a=i()),c(e,"",0,[],void 0,0,a);try{o=0===s.length?JSON.stringify(e,t,n):JSON.stringify(e,h(t),n)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==r.length;){var d=r.pop();4===d.length?Object.defineProperty(d[0],d[1],d[3]):d[0][d[1]]=d[2]}}return o}function o(e,t,n,i){var a=Object.getOwnPropertyDescriptor(i,n);void 0!==a.get?a.configurable?(Object.defineProperty(i,n,{value:e}),r.push([i,n,t,a])):s.push([t,n,e]):(i[n]=e,r.push([i,n,t]))}function c(e,r,s,i,a,d,u){var l;if(d+=1,"object"==typeof e&&null!==e){for(l=0;l<i.length;l++)if(i[l]===e)return void o(n,e,r,a);if(void 0!==u.depthLimit&&d>u.depthLimit)return void o(t,e,r,a);if(void 0!==u.edgesLimit&&s+1>u.edgesLimit)return void o(t,e,r,a);if(i.push(e),Array.isArray(e))for(l=0;l<e.length;l++)c(e[l],l,l,i,e,d,u);else{var h=Object.keys(e);for(l=0;l<h.length;l++){var f=h[l];c(e[f],f,l,i,e,d,u)}}i.pop()}}function d(e,t){return e<t?-1:e>t?1:0}function u(e,t,n,a){void 0===a&&(a=i());var o,c=l(e,"",0,[],void 0,0,a)||e;try{o=0===s.length?JSON.stringify(c,t,n):JSON.stringify(c,h(t),n)}catch(e){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==r.length;){var d=r.pop();4===d.length?Object.defineProperty(d[0],d[1],d[3]):d[0][d[1]]=d[2]}}return o}function l(e,s,i,a,c,u,h){var f;if(u+=1,"object"==typeof e&&null!==e){for(f=0;f<a.length;f++)if(a[f]===e)return void o(n,e,s,c);try{if("function"==typeof e.toJSON)return}catch(e){return}if(void 0!==h.depthLimit&&u>h.depthLimit)return void o(t,e,s,c);if(void 0!==h.edgesLimit&&i+1>h.edgesLimit)return void o(t,e,s,c);if(a.push(e),Array.isArray(e))for(f=0;f<e.length;f++)l(e[f],f,f,a,e,u,h);else{var p={},m=Object.keys(e).sort(d);for(f=0;f<m.length;f++){var g=m[f];l(e[g],g,f,a,e,u,h),p[g]=e[g]}if(void 0===c)return p;r.push([c,s,e]),c[s]=p}a.pop()}}function h(e){return e=void 0!==e?e:function(e,t){return t},function(t,n){if(s.length>0)for(var r=0;r<s.length;r++){var i=s[r];if(i[1]===t&&i[0]===n){n=i[2],s.splice(r,1);break}}return e.call(this,t,n)}}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{onRpcRequest:()=>Fs});var e={};function t(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)}n.r(e),n.d(e,{aK:()=>hr,e8:()=>Gn,DO:()=>Jn,dJ:()=>fr,OG:()=>pr,My:()=>Xn,Ph:()=>sr,lX:()=>ir,Id:()=>dr,fg:()=>yr,qj:()=>cr,aT:()=>rr,r4:()=>lr,aY:()=>Wn,x:()=>_r,lq:()=>ar,z:()=>or,zW:()=>Qn,Q5:()=>wr});const s=(e,t)=>Object.hasOwnProperty.call(e,t);var i;!function(e){e[e.Null=4]="Null",e[e.Comma=1]="Comma",e[e.Wrapper=1]="Wrapper",e[e.True=4]="True",e[e.False=5]="False",e[e.Quote=1]="Quote",e[e.Colon=1]="Colon",e[e.Date=24]="Date"}(i=i||(i={}));var a=n(463);class o extends TypeError{constructor(e,t){let n;const{message:r,explanation:s,...i}=e,{path:a}=e,o=0===a.length?r:`At path: ${a.join(".")} -- ${r}`;super(s??o),null!=s&&(this.cause=o),Object.assign(this,i),this.name=this.constructor.name,this.failures=()=>n??(n=[e,...t()])}}function c(e){return"object"==typeof e&&null!==e}function d(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function u(e,t,n,r){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:s,branch:i}=t,{type:a}=n,{refinement:o,message:c=`Expected a value of type \\`${a}\\`${o?` with refinement \\`${o}\\``:""}, but received: \\`${d(r)}\\``}=e;return{value:r,type:a,refinement:o,key:s[s.length-1],path:s,branch:i,...e,message:c}}function*l(e,t,n,r){(function(e){return c(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const s of e){const e=u(s,t,n,r);e&&(yield e)}}function*h(e,t,n={}){const{path:r=[],branch:s=[e],coerce:i=!1,mask:a=!1}=n,o={path:r,branch:s};if(i&&(e=t.coercer(e,o),a&&"type"!==t.type&&c(t.schema)&&c(e)&&!Array.isArray(e)))for(const n in e)void 0===t.schema[n]&&delete e[n];let d="valid";for(const r of t.validator(e,o))r.explanation=n.message,d="not_valid",yield[r,void 0];for(let[u,l,f]of t.entries(e,o)){const t=h(l,f,{path:void 0===u?r:[...r,u],branch:void 0===u?s:[...s,l],coerce:i,mask:a,message:n.message});for(const n of t)n[0]?(d=null===n[0].refinement||void 0===n[0].refinement?"not_valid":"not_refined",yield[n[0],void 0]):i&&(l=n[1],void 0===u?e=l:e instanceof Map?e.set(u,l):e instanceof Set?e.add(l):c(e)&&(void 0!==l||u in e)&&(e[u]=l))}if("not_valid"!==d)for(const r of t.refiner(e,o))r.explanation=n.message,d="not_refined",yield[r,void 0];"valid"===d&&(yield[void 0,e])}class f{constructor(e){const{type:t,schema:n,validator:r,refiner:s,coercer:i=e=>e,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=i,this.validator=r?(e,t)=>l(r(e,t),t,this,e):()=>[],this.refiner=s?(e,t)=>l(s(e,t),t,this,e):()=>[]}assert(e,t){return p(e,this,t)}create(e,t){return m(e,this,t)}is(e){return g(e,this)}mask(e,t){return function(e,t,n){const r=y(e,t,{coerce:!0,mask:!0,message:n});if(r[0])throw r[0];return r[1]}(e,this,t)}validate(e,t={}){return y(e,this,t)}}function p(e,t,n){const r=y(e,t,{message:n});if(r[0])throw r[0]}function m(e,t,n){const r=y(e,t,{coerce:!0,message:n});if(r[0])throw r[0];return r[1]}function g(e,t){return!y(e,t)[0]}function y(e,t,n={}){const r=h(e,t,n),s=function(e){const{done:t,value:n}=e.next();return t?void 0:n}(r);if(s[0]){return[new o(s[0],(function*(){for(const e of r)e[0]&&(yield e[0])})),void 0]}return[void 0,s[1]]}function v(e,t){return new f({type:e,schema:null,validator:t})}function w(e){let t;return new f({type:"lazy",schema:null,*entries(n,r){t??(t=e()),yield*t.entries(n,r)},validator:(n,r)=>(t??(t=e()),t.validator(n,r)),coercer:(n,r)=>(t??(t=e()),t.coercer(n,r)),refiner:(n,r)=>(t??(t=e()),t.refiner(n,r))})}function _(e){return new f({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[n,r]of t.entries())yield[n,r,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${d(e)}`})}function b(e){const t=d(e),n=typeof e;return new f({type:"literal",schema:"string"===n||"number"===n||"boolean"===n?e:null,validator:n=>n===e||`Expected the literal \\`${t}\\`, but received: ${d(n)}`})}function x(){return v("never",(()=>!1))}function E(){return v("number",(e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${d(e)}`))}function k(e){const t=e?Object.keys(e):[],n=x();return new f({type:"object",schema:e??null,*entries(r){if(e&&c(r)){const s=new Set(Object.keys(r));for(const n of t)s.delete(n),yield[n,r[n],e[n]];for(const e of s)yield[e,r[e],n]}},validator:e=>c(e)||`Expected an object, but received: ${d(e)}`,coercer:e=>c(e)?{...e}:e})}function O(e){return new f({...e,validator:(t,n)=>void 0===t||e.validator(t,n),refiner:(t,n)=>void 0===t||e.refiner(t,n)})}function S(e,t){return new f({type:"record",schema:null,*entries(n){if(c(n))for(const r in n){const s=n[r];yield[r,r,e],yield[r,s,t]}},validator:e=>c(e)||`Expected an object, but received: ${d(e)}`})}function A(){return v("string",(e=>"string"==typeof e||`Expected a string, but received: ${d(e)}`))}function N(e){const t=e.map((e=>e.type)).join(" | ");return new f({type:"union",schema:null,coercer(t){for(const n of e){const[e,r]=n.validate(t,{coerce:!0});if(!e)return r}return t},validator(n,r){const s=[];for(const t of e){const[...e]=h(n,t,r),[i]=e;if(!i?.[0])return[];for(const[t]of e)t&&s.push(t)}return[`Expected the value to satisfy a union of \\`${t}\\`, but received: ${d(n)}`,...s]}})}function T(e,t,n){return new f({...e,coercer:(r,s)=>g(r,t)?e.coercer(n(r,s),s):e.coercer(r,s)})}Error;function Z(e){return function(e){return function(e){return"object"==typeof e&&null!==e&&"message"in e}(e)&&"string"==typeof e.message?e.message:null==e?"":String(e)}(e).replace(/\\.$/u,"")}function I(e,t){return n=e,Boolean("string"==typeof n?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var n}class B extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}const C=e=>k(e);function j({path:e,branch:t}){const n=e[e.length-1];return s(t[t.length-2],n)}function R(e){return new f({...e,type:`optional ${e.type}`,validator:(t,n)=>!j(n)||e.validator(t,n),refiner:(t,n)=>!j(n)||e.refiner(t,n)})}const P=N([b(null),v("boolean",(e=>"boolean"==typeof e)),v("finite number",(e=>g(e,E())&&Number.isFinite(e))),A(),_(w((()=>P))),S(A(),w((()=>P)))]),L=T(P,v("any",(()=>!0)),(e=>(function(e,t,n="Assertion failed",r=B){try{p(e,t)}catch(e){throw I(r,`${n}: ${Z(e)}.`)}}(e,P),JSON.parse(JSON.stringify(e,((e,t)=>{if("__proto__"!==e&&"constructor"!==e)return t}))))));function U(e){try{return function(e){m(e,L)}(e),!0}catch{return!1}}const $=b("2.0"),M=(z=N([E(),A()]),new f({...z,validator:(e,t)=>null===e||z.validator(e,t),refiner:(e,t)=>null===e||z.refiner(e,t)}));var z;const q=C({code:v("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${d(e)}`)),message:A(),data:R(L),stack:R(A())}),D=N([S(A(),L),_(L)]);C({id:M,jsonrpc:$,method:A(),params:R(D)}),C({jsonrpc:$,method:A(),params:R(D)});k({id:M,jsonrpc:$,result:O(v("unknown",(()=>!0))),error:O(q)});const F=C({id:M,jsonrpc:$,result:L}),V=C({id:M,jsonrpc:$,error:q});N([F,V]);const H={invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},K={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}},W=H.internal,J=(G(W),"Unspecified server error.");function G(e,t="Unspecified error message. This is a bug, please report it."){if(function(e){return Number.isInteger(e)}(e)){const t=e.toString();if(s(K,t))return K[t].message;if(function(e){return e>=-32099&&e<=-32e3}(e))return J}return t}function Y(e){return Array.isArray(e)?e.map((e=>U(e)?e:t(e)?X(e):null)):t(e)?X(e):U(e)?e:null}function X(e){return Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=e[n];return U(r)&&(t[n]=r),t}),{})}const Q=(ee=a,ee?.__esModule?ee.default:ee);var ee;class te extends Error{constructor(e,n,r){if(!Number.isInteger(e))throw new Error(\'"code" must be an integer.\');if(!n||"string"!=typeof n)throw new Error(\'"message" must be a non-empty string.\');!function(e){return t(e)&&s(e,"cause")&&t(e.cause)}(r)?super(n):(super(n,{cause:r.cause}),s(this,"cause")||Object.assign(this,{cause:r.cause})),void 0!==r&&(this.data=r),this.code=e}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data,function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}}(this.data)&&(e.data.cause=Y(this.data.cause))),this.stack&&(e.stack=this.stack),e}toString(){return Q(this.serialize(),ne,2)}}function ne(e,t){if("[Circular]"!==t)return t}const re=e=>ie(H.invalidParams,e),se=e=>ie(H.methodNotFound,e);function ie(e,t){const[n,r]=ae(t);return new te(e,n??G(e),r)}function ae(e){if(e){if("string"==typeof e)return[e];if("object"==typeof e&&!Array.isArray(e)){const{message:t,data:n}=e;if(t&&"string"!=typeof t)throw new Error("Must specify string message.");return[t??void 0,n]}}return[]}var oe,ce;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),r={};for(const e of n)r[e]=t[e];return e.objectValues(r)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`\'${e}\'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(oe||(oe={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(ce||(ce={}));const de=oe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ue=e=>{switch(typeof e){case"undefined":return de.undefined;case"string":return de.string;case"number":return isNaN(e)?de.nan:de.number;case"boolean":return de.boolean;case"function":return de.function;case"bigint":return de.bigint;case"symbol":return de.symbol;case"object":return Array.isArray(e)?de.array:null===e?de.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?de.promise:"undefined"!=typeof Map&&e instanceof Map?de.map:"undefined"!=typeof Set&&e instanceof Set?de.set:"undefined"!=typeof Date&&e instanceof Date?de.date:de.object;default:return de.unknown}},le=oe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class he extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(r);else if("invalid_return_type"===s.code)r(s.returnTypeError);else if("invalid_arguments"===s.code)r(s.argumentsError);else if(0===s.path.length)n._errors.push(t(s));else{let e=n,r=0;for(;r<s.path.length;){const n=s.path[r];r===s.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(s))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof he))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,oe.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}he.create=e=>new he(e);const fe=(e,t)=>{let n;switch(e.code){case le.invalid_type:n=e.received===de.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,oe.jsonStringifyReplacer)}`;break;case le.unrecognized_keys:n=`Unrecognized key(s) in object: ${oe.joinValues(e.keys,", ")}`;break;case le.invalid_union:n="Invalid input";break;case le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${oe.joinValues(e.options)}`;break;case le.invalid_enum_value:n=`Invalid enum value. Expected ${oe.joinValues(e.options)}, received \'${e.received}\'`;break;case le.invalid_arguments:n="Invalid function arguments";break;case le.invalid_return_type:n="Invalid function return type";break;case le.invalid_date:n="Invalid date";break;case le.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:oe.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case le.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case le.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case le.custom:n="Invalid input";break;case le.invalid_intersection_types:n="Intersection results could not be merged";break;case le.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case le.not_finite:n="Number must be finite";break;default:n=t.defaultError,oe.assertNever(e)}return{message:n}};let pe=fe;function me(){return pe}const ge=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let o="";const c=r.filter((e=>!!e)).slice().reverse();for(const e of c)o=e(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function ye(e,t){const n=me(),r=ge({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===fe?void 0:fe].filter((e=>!!e))});e.common.issues.push(r)}class ve{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if("aborted"===r.status)return we;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t){const t=await e.key,r=await e.value;n.push({key:t,value:r})}return ve.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:t,value:s}=r;if("aborted"===t.status)return we;if("aborted"===s.status)return we;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!r.alwaysSet||(n[t.value]=s.value)}return{status:e.value,value:n}}}const we=Object.freeze({status:"aborted"}),_e=e=>({status:"dirty",value:e}),be=e=>({status:"valid",value:e}),xe=e=>"aborted"===e.status,Ee=e=>"dirty"===e.status,ke=e=>"valid"===e.status,Oe=e=>"undefined"!=typeof Promise&&e instanceof Promise;function Se(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function Ae(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n}var Ne,Te,Ze;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(Ne||(Ne={}));class Ie{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Be=(e,t)=>{if(ke(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new he(e.common.issues);return this._error=t,this._error}}};function Ce(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(\'Can\\\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.\');if(t)return{errorMap:t,description:s};return{errorMap:(t,s)=>{var i,a;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:s.defaultError}:void 0===s.data?{message:null!==(i=null!=o?o:r)&&void 0!==i?i:s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:null!==(a=null!=o?o:n)&&void 0!==a?a:s.defaultError}},description:s}}class je{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ue(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ue(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ve,ctx:{common:e.parent.common,data:e.data,parsedType:ue(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Oe(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ue(e)},s=this._parseSync({data:e,path:r.path,parent:r});return Be(r,s)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ue(e)},r=this._parse({data:e,path:n.path,parent:n}),s=await(Oe(r)?r:Promise.resolve(r));return Be(n,s)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,r)=>{const s=e(t),i=()=>r.addIssue({code:le.custom,...n(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then((e=>!!e||(i(),!1))):!!s||(i(),!1)}))}refinement(e,t){return this._refinement(((n,r)=>!!e(n)||(r.addIssue("function"==typeof t?t(n,r):t),!1)))}_refinement(e){return new Nt({schema:this,typeName:Mt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Tt.create(this,this._def)}nullable(){return Zt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return dt.create(this,this._def)}promise(){return At.create(this,this._def)}or(e){return ht.create([this,e],this._def)}and(e){return gt.create(this,e,this._def)}transform(e){return new Nt({...Ce(this._def),schema:this,typeName:Mt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new It({...Ce(this._def),innerType:this,defaultValue:t,typeName:Mt.ZodDefault})}brand(){return new Rt({typeName:Mt.ZodBranded,type:this,...Ce(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new Bt({...Ce(this._def),innerType:this,catchValue:t,typeName:Mt.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Pt.create(this,e)}readonly(){return Lt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Re=/^c[^\\s-]{8,}$/i,Pe=/^[0-9a-z]+$/,Le=/^[0-9A-HJKMNP-TV-Z]{26}$/,Ue=/^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i,$e=/^[a-z0-9_-]{21}$/i,Me=/^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/,ze=/^(?!\\.)(?!.*\\.\\.)([A-Z0-9_\'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i;let qe;const De=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Fe=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Ve=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,He="((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))",Ke=new RegExp(`^${He}$`);function We(e){let t="([01]\\\\d|2[0-3]):[0-5]\\\\d:[0-5]\\\\d";return e.precision?t=`${t}\\\\.\\\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\\\.\\\\d+)?`),t}function Je(e){let t=`${He}T${We(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\\\d{2}:?\\\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}class Ge extends je{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==de.string){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.string,received:t.parsedType}),we}const t=new ve;let n;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),ye(n,{code:le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),ye(n,{code:le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const r=e.data.length>i.value,s=e.data.length<i.value;(r||s)&&(n=this._getOrReturnCtx(e,n),r?ye(n,{code:le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):s&&ye(n,{code:le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)ze.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"email",code:le.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)qe||(qe=new RegExp("^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$","u")),qe.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"emoji",code:le.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)Ue.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"uuid",code:le.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)$e.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"nanoid",code:le.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)Re.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"cuid",code:le.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)Pe.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"cuid2",code:le.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)Le.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"ulid",code:le.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(r){n=this._getOrReturnCtx(e,n),ye(n,{validation:"url",code:le.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"regex",code:le.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),ye(n,{code:le.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),ye(n,{code:le.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),ye(n,{code:le.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){Je(i).test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{code:le.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else if("date"===i.kind){Ke.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{code:le.invalid_string,validation:"date",message:i.message}),t.dirty())}else if("time"===i.kind){new RegExp(`^${We(i)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{code:le.invalid_string,validation:"time",message:i.message}),t.dirty())}else"duration"===i.kind?Me.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"duration",code:le.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?(r=e.data,("v4"!==(s=i.version)&&s||!De.test(r))&&("v6"!==s&&s||!Fe.test(r))&&(n=this._getOrReturnCtx(e,n),ye(n,{validation:"ip",code:le.invalid_string,message:i.message}),t.dirty())):"base64"===i.kind?Ve.test(e.data)||(n=this._getOrReturnCtx(e,n),ye(n,{validation:"base64",code:le.invalid_string,message:i.message}),t.dirty()):oe.assertNever(i);var r,s;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:le.invalid_string,...Ne.errToObj(n)})}_addCheck(e){return new Ge({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ne.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ne.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ne.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ne.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ne.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ne.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ne.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ne.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ne.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ne.errToObj(e)})}datetime(e){var t,n;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null==e?void 0:e.local)&&void 0!==n&&n,...Ne.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...Ne.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Ne.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Ne.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...Ne.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Ne.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Ne.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Ne.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Ne.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Ne.errToObj(t)})}nonempty(e){return this.min(1,Ne.errToObj(e))}trim(){return new Ge({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ge({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ge({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Ye(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r;return parseInt(e.toFixed(s).replace(".",""))%parseInt(t.toFixed(s).replace(".",""))/Math.pow(10,s)}Ge.create=e=>{var t;return new Ge({checks:[],typeName:Mt.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ce(e)})};class Xe extends je{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==de.number){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.number,received:t.parsedType}),we}let t;const n=new ve;for(const r of this._def.checks)if("int"===r.kind)oe.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),ye(t,{code:le.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty());else if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),ye(t,{code:le.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),ye(t,{code:le.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else"multipleOf"===r.kind?0!==Ye(e.data,r.value)&&(t=this._getOrReturnCtx(e,t),ye(t,{code:le.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),ye(t,{code:le.not_finite,message:r.message}),n.dirty()):oe.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ne.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ne.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ne.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ne.toString(t))}setLimit(e,t,n,r){return new Xe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Ne.toString(r)}]})}_addCheck(e){return new Xe({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ne.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ne.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ne.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Ne.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ne.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ne.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&oe.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Xe.create=e=>new Xe({checks:[],typeName:Mt.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Ce(e)});class Qe extends je{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==de.bigint){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.bigint,received:t.parsedType}),we}let t;const n=new ve;for(const r of this._def.checks)if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),ye(t,{code:le.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),ye(t,{code:le.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty())}else"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),ye(t,{code:le.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):oe.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ne.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ne.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ne.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ne.toString(t))}setLimit(e,t,n,r){return new Qe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Ne.toString(r)}]})}_addCheck(e){return new Qe({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ne.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ne.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Qe.create=e=>{var t;return new Qe({checks:[],typeName:Mt.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ce(e)})};class et extends je{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==de.boolean){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.boolean,received:t.parsedType}),we}return be(e.data)}}et.create=e=>new et({typeName:Mt.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Ce(e)});class tt extends je{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==de.date){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.date,received:t.parsedType}),we}if(isNaN(e.data.getTime())){return ye(this._getOrReturnCtx(e),{code:le.invalid_date}),we}const t=new ve;let n;for(const r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(n=this._getOrReturnCtx(e,n),ye(n,{code:le.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),t.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(n=this._getOrReturnCtx(e,n),ye(n,{code:le.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),t.dirty()):oe.assertNever(r);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new tt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Ne.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Ne.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}tt.create=e=>new tt({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Mt.ZodDate,...Ce(e)});class nt extends je{_parse(e){if(this._getType(e)!==de.symbol){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.symbol,received:t.parsedType}),we}return be(e.data)}}nt.create=e=>new nt({typeName:Mt.ZodSymbol,...Ce(e)});class rt extends je{_parse(e){if(this._getType(e)!==de.undefined){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.undefined,received:t.parsedType}),we}return be(e.data)}}rt.create=e=>new rt({typeName:Mt.ZodUndefined,...Ce(e)});class st extends je{_parse(e){if(this._getType(e)!==de.null){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.null,received:t.parsedType}),we}return be(e.data)}}st.create=e=>new st({typeName:Mt.ZodNull,...Ce(e)});class it extends je{constructor(){super(...arguments),this._any=!0}_parse(e){return be(e.data)}}it.create=e=>new it({typeName:Mt.ZodAny,...Ce(e)});class at extends je{constructor(){super(...arguments),this._unknown=!0}_parse(e){return be(e.data)}}at.create=e=>new at({typeName:Mt.ZodUnknown,...Ce(e)});class ot extends je{_parse(e){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.never,received:t.parsedType}),we}}ot.create=e=>new ot({typeName:Mt.ZodNever,...Ce(e)});class ct extends je{_parse(e){if(this._getType(e)!==de.undefined){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.void,received:t.parsedType}),we}return be(e.data)}}ct.create=e=>new ct({typeName:Mt.ZodVoid,...Ce(e)});class dt extends je{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==de.array)return ye(t,{code:le.invalid_type,expected:de.array,received:t.parsedType}),we;if(null!==r.exactLength){const e=t.data.length>r.exactLength.value,s=t.data.length<r.exactLength.value;(e||s)&&(ye(t,{code:e?le.too_big:le.too_small,minimum:s?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(ye(t,{code:le.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(ye(t,{code:le.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>r.type._parseAsync(new Ie(t,e,t.path,n))))).then((e=>ve.mergeArray(n,e)));const s=[...t.data].map(((e,n)=>r.type._parseSync(new Ie(t,e,t.path,n))));return ve.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new dt({...this._def,minLength:{value:e,message:Ne.toString(t)}})}max(e,t){return new dt({...this._def,maxLength:{value:e,message:Ne.toString(t)}})}length(e,t){return new dt({...this._def,exactLength:{value:e,message:Ne.toString(t)}})}nonempty(e){return this.min(1,e)}}function ut(e){if(e instanceof lt){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Tt.create(ut(r))}return new lt({...e._def,shape:()=>t})}return e instanceof dt?new dt({...e._def,type:ut(e.element)}):e instanceof Tt?Tt.create(ut(e.unwrap())):e instanceof Zt?Zt.create(ut(e.unwrap())):e instanceof yt?yt.create(e.items.map((e=>ut(e)))):e}dt.create=(e,t)=>new dt({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Mt.ZodArray,...Ce(t)});class lt extends je{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=oe.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==de.object){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.object,received:t.parsedType}),we}const{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:s}=this._getCached(),i=[];if(!(this._def.catchall instanceof ot&&"strip"===this._def.unknownKeys))for(const e in n.data)s.includes(e)||i.push(e);const a=[];for(const e of s){const t=r[e],s=n.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new Ie(n,s,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof ot){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of i)a.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)i.length>0&&(ye(n,{code:le.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of i){const r=n.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new Ie(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of a){const n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e})).then((e=>ve.mergeObjectSync(t,e))):ve.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return Ne.errToObj,new lt({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var r,s,i,a;const o=null!==(i=null===(s=(r=this._def).errorMap)||void 0===s?void 0:s.call(r,t,n).message)&&void 0!==i?i:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=Ne.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new lt({...this._def,unknownKeys:"strip"})}passthrough(){return new lt({...this._def,unknownKeys:"passthrough"})}extend(e){return new lt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new lt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Mt.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new lt({...this._def,catchall:e})}pick(e){const t={};return oe.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new lt({...this._def,shape:()=>t})}omit(e){const t={};return oe.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new lt({...this._def,shape:()=>t})}deepPartial(){return ut(this)}partial(e){const t={};return oe.objectKeys(this.shape).forEach((n=>{const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()})),new lt({...this._def,shape:()=>t})}required(e){const t={};return oe.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof Tt;)e=e._def.innerType;t[n]=e}})),new lt({...this._def,shape:()=>t})}keyof(){return kt(oe.objectKeys(this.shape))}}lt.create=(e,t)=>new lt({shape:()=>e,unknownKeys:"strip",catchall:ot.create(),typeName:Mt.ZodObject,...Ce(t)}),lt.strictCreate=(e,t)=>new lt({shape:()=>e,unknownKeys:"strict",catchall:ot.create(),typeName:Mt.ZodObject,...Ce(t)}),lt.lazycreate=(e,t)=>new lt({shape:e,unknownKeys:"strip",catchall:ot.create(),typeName:Mt.ZodObject,...Ce(t)});class ht extends je{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new he(e.ctx.common.issues)));return ye(t,{code:le.invalid_union,unionErrors:n}),we}));{let e;const r=[];for(const s of n){const n={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:n});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=r.map((e=>new he(e)));return ye(t,{code:le.invalid_union,unionErrors:s}),we}}get options(){return this._def.options}}ht.create=(e,t)=>new ht({options:e,typeName:Mt.ZodUnion,...Ce(t)});const ft=e=>e instanceof xt?ft(e.schema):e instanceof Nt?ft(e.innerType()):e instanceof Et?[e.value]:e instanceof Ot?e.options:e instanceof St?oe.objectValues(e.enum):e instanceof It?ft(e._def.innerType):e instanceof rt?[void 0]:e instanceof st?[null]:e instanceof Tt?[void 0,...ft(e.unwrap())]:e instanceof Zt?[null,...ft(e.unwrap())]:e instanceof Rt||e instanceof Lt?ft(e.unwrap()):e instanceof Bt?ft(e._def.innerType):[];class pt extends je{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==de.object)return ye(t,{code:le.invalid_type,expected:de.object,received:t.parsedType}),we;const n=this.discriminator,r=t.data[n],s=this.optionsMap.get(r);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(ye(t,{code:le.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),we)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const r=new Map;for(const n of t){const t=ft(n.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \\`${e}\\` could not be extracted from all schema options`);for(const s of t){if(r.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);r.set(s,n)}}return new pt({typeName:Mt.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...Ce(n)})}}function mt(e,t){const n=ue(e),r=ue(t);if(e===t)return{valid:!0,data:e};if(n===de.object&&r===de.object){const n=oe.objectKeys(t),r=oe.objectKeys(e).filter((e=>-1!==n.indexOf(e))),s={...e,...t};for(const n of r){const r=mt(e[n],t[n]);if(!r.valid)return{valid:!1};s[n]=r.data}return{valid:!0,data:s}}if(n===de.array&&r===de.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let r=0;r<e.length;r++){const s=mt(e[r],t[r]);if(!s.valid)return{valid:!1};n.push(s.data)}return{valid:!0,data:n}}return n===de.date&&r===de.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class gt extends je{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(xe(e)||xe(r))return we;const s=mt(e.value,r.value);return s.valid?((Ee(e)||Ee(r))&&t.dirty(),{status:t.value,value:s.data}):(ye(n,{code:le.invalid_intersection_types}),we)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>r(e,t))):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}gt.create=(e,t,n)=>new gt({left:e,right:t,typeName:Mt.ZodIntersection,...Ce(n)});class yt extends je{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.array)return ye(n,{code:le.invalid_type,expected:de.array,received:n.parsedType}),we;if(n.data.length<this._def.items.length)return ye(n,{code:le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),we;!this._def.rest&&n.data.length>this._def.items.length&&(ye(n,{code:le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map(((e,t)=>{const r=this._def.items[t]||this._def.rest;return r?r._parse(new Ie(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(r).then((e=>ve.mergeArray(t,e))):ve.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new yt({...this._def,rest:e})}}yt.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new yt({items:e,typeName:Mt.ZodTuple,rest:null,...Ce(t)})};class vt extends je{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.object)return ye(n,{code:le.invalid_type,expected:de.object,received:n.parsedType}),we;const r=[],s=this._def.keyType,i=this._def.valueType;for(const e in n.data)r.push({key:s._parse(new Ie(n,e,n.path,e)),value:i._parse(new Ie(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?ve.mergeObjectAsync(t,r):ve.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new vt(t instanceof je?{keyType:e,valueType:t,typeName:Mt.ZodRecord,...Ce(n)}:{keyType:Ge.create(),valueType:e,typeName:Mt.ZodRecord,...Ce(t)})}}class wt extends je{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.map)return ye(n,{code:le.invalid_type,expected:de.map,received:n.parsedType}),we;const r=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map((([e,t],i)=>({key:r._parse(new Ie(n,e,n.path,[i,"key"])),value:s._parse(new Ie(n,t,n.path,[i,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of i){const r=await n.key,s=await n.value;if("aborted"===r.status||"aborted"===s.status)return we;"dirty"!==r.status&&"dirty"!==s.status||t.dirty(),e.set(r.value,s.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of i){const r=n.key,s=n.value;if("aborted"===r.status||"aborted"===s.status)return we;"dirty"!==r.status&&"dirty"!==s.status||t.dirty(),e.set(r.value,s.value)}return{status:t.value,value:e}}}}wt.create=(e,t,n)=>new wt({valueType:t,keyType:e,typeName:Mt.ZodMap,...Ce(n)});class _t extends je{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.set)return ye(n,{code:le.invalid_type,expected:de.set,received:n.parsedType}),we;const r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(ye(n,{code:le.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(ye(n,{code:le.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const s=this._def.valueType;function i(e){const n=new Set;for(const r of e){if("aborted"===r.status)return we;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}const a=[...n.data.values()].map(((e,t)=>s._parse(new Ie(n,e,n.path,t))));return n.common.async?Promise.all(a).then((e=>i(e))):i(a)}min(e,t){return new _t({...this._def,minSize:{value:e,message:Ne.toString(t)}})}max(e,t){return new _t({...this._def,maxSize:{value:e,message:Ne.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}_t.create=(e,t)=>new _t({valueType:e,minSize:null,maxSize:null,typeName:Mt.ZodSet,...Ce(t)});class bt extends je{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==de.function)return ye(t,{code:le.invalid_type,expected:de.function,received:t.parsedType}),we;function n(e,n){return ge({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,me(),fe].filter((e=>!!e)),issueData:{code:le.invalid_arguments,argumentsError:n}})}function r(e,n){return ge({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,me(),fe].filter((e=>!!e)),issueData:{code:le.invalid_return_type,returnTypeError:n}})}const s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof At){const e=this;return be((async function(...t){const a=new he([]),o=await e._def.args.parseAsync(t,s).catch((e=>{throw a.addIssue(n(t,e)),a})),c=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(c,s).catch((e=>{throw a.addIssue(r(c,e)),a}))}))}{const e=this;return be((function(...t){const a=e._def.args.safeParse(t,s);if(!a.success)throw new he([n(t,a.error)]);const o=Reflect.apply(i,this,a.data),c=e._def.returns.safeParse(o,s);if(!c.success)throw new he([r(o,c.error)]);return c.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new bt({...this._def,args:yt.create(e).rest(at.create())})}returns(e){return new bt({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new bt({args:e||yt.create([]).rest(at.create()),returns:t||at.create(),typeName:Mt.ZodFunction,...Ce(n)})}}class xt extends je{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}xt.create=(e,t)=>new xt({getter:e,typeName:Mt.ZodLazy,...Ce(t)});class Et extends je{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ye(t,{received:t.data,code:le.invalid_literal,expected:this._def.value}),we}return{status:"valid",value:e.data}}get value(){return this._def.value}}function kt(e,t){return new Ot({values:e,typeName:Mt.ZodEnum,...Ce(t)})}Et.create=(e,t)=>new Et({value:e,typeName:Mt.ZodLiteral,...Ce(t)});class Ot extends je{constructor(){super(...arguments),Te.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return ye(t,{expected:oe.joinValues(n),received:t.parsedType,code:le.invalid_type}),we}if(Se(this,Te,"f")||Ae(this,Te,new Set(this._def.values),"f"),!Se(this,Te,"f").has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return ye(t,{received:t.data,code:le.invalid_enum_value,options:n}),we}return be(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Ot.create(e,{...this._def,...t})}exclude(e,t=this._def){return Ot.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}Te=new WeakMap,Ot.create=kt;class St extends je{constructor(){super(...arguments),Ze.set(this,void 0)}_parse(e){const t=oe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==de.string&&n.parsedType!==de.number){const e=oe.objectValues(t);return ye(n,{expected:oe.joinValues(e),received:n.parsedType,code:le.invalid_type}),we}if(Se(this,Ze,"f")||Ae(this,Ze,new Set(oe.getValidEnumValues(this._def.values)),"f"),!Se(this,Ze,"f").has(e.data)){const e=oe.objectValues(t);return ye(n,{received:n.data,code:le.invalid_enum_value,options:e}),we}return be(e.data)}get enum(){return this._def.values}}Ze=new WeakMap,St.create=(e,t)=>new St({values:e,typeName:Mt.ZodNativeEnum,...Ce(t)});class At extends je{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==de.promise&&!1===t.common.async)return ye(t,{code:le.invalid_type,expected:de.promise,received:t.parsedType}),we;const n=t.parsedType===de.promise?t.data:Promise.resolve(t.data);return be(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}At.create=(e,t)=>new At({type:e,typeName:Mt.ZodPromise,...Ce(t)});class Nt extends je{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Mt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:e=>{ye(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===r.type){const e=r.transform(n.data,s);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return we;const r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?we:"dirty"===r.status||"dirty"===t.value?_e(r.value):r}));{if("aborted"===t.value)return we;const r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?we:"dirty"===r.status||"dirty"===t.value?_e(r.value):r}}if("refinement"===r.type){const e=e=>{const t=r.refinement(e,s);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?we:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?we:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===r.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ke(e))return e;const i=r.transform(e.value,s);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>ke(e)?Promise.resolve(r.transform(e.value,s)).then((e=>({status:t.value,value:e}))):e))}oe.assertNever(r)}}Nt.create=(e,t,n)=>new Nt({schema:e,typeName:Mt.ZodEffects,effect:t,...Ce(n)}),Nt.createWithPreprocess=(e,t,n)=>new Nt({schema:t,effect:{type:"preprocess",transform:e},typeName:Mt.ZodEffects,...Ce(n)});class Tt extends je{_parse(e){return this._getType(e)===de.undefined?be(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Tt.create=(e,t)=>new Tt({innerType:e,typeName:Mt.ZodOptional,...Ce(t)});class Zt extends je{_parse(e){return this._getType(e)===de.null?be(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Zt.create=(e,t)=>new Zt({innerType:e,typeName:Mt.ZodNullable,...Ce(t)});class It extends je{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===de.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}It.create=(e,t)=>new It({innerType:e,typeName:Mt.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Ce(t)});class Bt extends je{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Oe(r)?r.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new he(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new he(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Bt.create=(e,t)=>new Bt({innerType:e,typeName:Mt.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Ce(t)});class Ct extends je{_parse(e){if(this._getType(e)!==de.nan){const t=this._getOrReturnCtx(e);return ye(t,{code:le.invalid_type,expected:de.nan,received:t.parsedType}),we}return{status:"valid",value:e.data}}}Ct.create=e=>new Ct({typeName:Mt.ZodNaN,...Ce(e)});const jt=Symbol("zod_brand");class Rt extends je{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Pt extends je{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?we:"dirty"===e.status?(t.dirty(),_e(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?we:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new Pt({in:e,out:t,typeName:Mt.ZodPipeline})}}class Lt extends je{_parse(e){const t=this._def.innerType._parse(e),n=e=>(ke(e)&&(e.value=Object.freeze(e.value)),e);return Oe(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function Ut(e,t={},n){return e?it.create().superRefine(((r,s)=>{var i,a;if(!e(r)){const e="function"==typeof t?t(r):"string"==typeof t?{message:t}:t,o=null===(a=null!==(i=e.fatal)&&void 0!==i?i:n)||void 0===a||a,c="string"==typeof e?{message:e}:e;s.addIssue({code:"custom",...c,fatal:o})}})):it.create()}Lt.create=(e,t)=>new Lt({innerType:e,typeName:Mt.ZodReadonly,...Ce(t)});const $t={object:lt.lazycreate};var Mt;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Mt||(Mt={}));const zt=Ge.create,qt=Xe.create,Dt=Ct.create,Ft=Qe.create,Vt=et.create,Ht=tt.create,Kt=nt.create,Wt=rt.create,Jt=st.create,Gt=it.create,Yt=at.create,Xt=ot.create,Qt=ct.create,en=dt.create,tn=lt.create,nn=lt.strictCreate,rn=ht.create,sn=pt.create,an=gt.create,on=yt.create,cn=vt.create,dn=wt.create,un=_t.create,ln=bt.create,hn=xt.create,fn=Et.create,pn=Ot.create,mn=St.create,gn=At.create,yn=Nt.create,vn=Tt.create,wn=Zt.create,_n=Nt.createWithPreprocess,bn=Pt.create,xn={string:e=>Ge.create({...e,coerce:!0}),number:e=>Xe.create({...e,coerce:!0}),boolean:e=>et.create({...e,coerce:!0}),bigint:e=>Qe.create({...e,coerce:!0}),date:e=>tt.create({...e,coerce:!0})},En=we;var kn=Object.freeze({__proto__:null,defaultErrorMap:fe,setErrorMap:function(e){pe=e},getErrorMap:me,makeIssue:ge,EMPTY_PATH:[],addIssueToContext:ye,ParseStatus:ve,INVALID:we,DIRTY:_e,OK:be,isAborted:xe,isDirty:Ee,isValid:ke,isAsync:Oe,get util(){return oe},get objectUtil(){return ce},ZodParsedType:de,getParsedType:ue,ZodType:je,datetimeRegex:Je,ZodString:Ge,ZodNumber:Xe,ZodBigInt:Qe,ZodBoolean:et,ZodDate:tt,ZodSymbol:nt,ZodUndefined:rt,ZodNull:st,ZodAny:it,ZodUnknown:at,ZodNever:ot,ZodVoid:ct,ZodArray:dt,ZodObject:lt,ZodUnion:ht,ZodDiscriminatedUnion:pt,ZodIntersection:gt,ZodTuple:yt,ZodRecord:vt,ZodMap:wt,ZodSet:_t,ZodFunction:bt,ZodLazy:xt,ZodLiteral:Et,ZodEnum:Ot,ZodNativeEnum:St,ZodPromise:At,ZodEffects:Nt,ZodTransformer:Nt,ZodOptional:Tt,ZodNullable:Zt,ZodDefault:It,ZodCatch:Bt,ZodNaN:Ct,BRAND:jt,ZodBranded:Rt,ZodPipeline:Pt,ZodReadonly:Lt,custom:Ut,Schema:je,ZodSchema:je,late:$t,get ZodFirstPartyTypeKind(){return Mt},coerce:xn,any:Gt,array:en,bigint:Ft,boolean:Vt,date:Ht,discriminatedUnion:sn,effect:yn,enum:pn,function:ln,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>Ut((t=>t instanceof e),t),intersection:an,lazy:hn,literal:fn,map:dn,nan:Dt,nativeEnum:mn,never:Xt,null:Jt,nullable:wn,number:qt,object:tn,oboolean:()=>Vt().optional(),onumber:()=>qt().optional(),optional:vn,ostring:()=>zt().optional(),pipeline:bn,preprocess:_n,promise:gn,record:cn,set:un,strictObject:nn,string:zt,symbol:Kt,transformer:yn,tuple:on,undefined:Wt,union:rn,unknown:Yt,void:Qt,NEVER:En,ZodIssueCode:le,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:he});function On(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Sn(e,...t){if(!((n=e)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function An(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");On(e.outputLen),On(e.blockLen)}function Nn(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Tn(e,t){Sn(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Zn="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;const In=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Bn=(e,t)=>e<<32-t|e>>>t;Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Cn(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),Sn(e),e}class jn{clone(){return this._cloneInto()}}function Rn(e=32){if(Zn&&"function"==typeof Zn.getRandomValues)return Zn.getRandomValues(new Uint8Array(e));if(Zn&&"function"==typeof Zn.randomBytes)return Zn.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}const Pn=(e,t,n)=>e&t^e&n^t&n;class Ln extends jn{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=In(this.buffer)}update(e){Nn(this);const{view:t,buffer:n,blockLen:r}=this,s=(e=Cn(e)).length;for(let i=0;i<s;){const a=Math.min(r-this.pos,s-i);if(a!==r)n.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=In(e);for(;r<=s-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Nn(this),Tn(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:s}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),a=Number(n>>s&i),o=Number(n&i),c=r?4:0,d=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+d,o,r)}(n,r-8,BigInt(8*this.length),s),this.process(n,0);const a=In(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,d=this.get();if(c>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,d[e],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:s,destroyed:i,pos:a}=this;return e.length=r,e.pos=a,e.finished=s,e.destroyed=i,r%t&&e.buffer.set(n),e}}const Un=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$n=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Mn=new Uint32Array(64);class zn extends Ln{constructor(){super(64,32,8,!1),this.A=0|$n[0],this.B=0|$n[1],this.C=0|$n[2],this.D=0|$n[3],this.E=0|$n[4],this.F=0|$n[5],this.G=0|$n[6],this.H=0|$n[7]}get(){const{A:e,B:t,C:n,D:r,E:s,F:i,G:a,H:o}=this;return[e,t,n,r,s,i,a,o]}set(e,t,n,r,s,i,a,o){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|s,this.F=0|i,this.G=0|a,this.H=0|o}process(e,t){for(let n=0;n<16;n++,t+=4)Mn[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Mn[e-15],n=Mn[e-2],r=Bn(t,7)^Bn(t,18)^t>>>3,s=Bn(n,17)^Bn(n,19)^n>>>10;Mn[e]=s+Mn[e-7]+r+Mn[e-16]|0}let{A:n,B:r,C:s,D:i,E:a,F:o,G:c,H:d}=this;for(let e=0;e<64;e++){const t=d+(Bn(a,6)^Bn(a,11)^Bn(a,25))+((u=a)&o^~u&c)+Un[e]+Mn[e]|0,l=(Bn(n,2)^Bn(n,13)^Bn(n,22))+Pn(n,r,s)|0;d=c,c=o,o=a,a=i+t|0,i=s,s=r,r=n,n=t+l|0}var u;n=n+this.A|0,r=r+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,d=d+this.H|0,this.set(n,r,s,i,a,o,c,d)}roundClean(){Mn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const qn=function(e){const t=t=>e().update(Cn(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}((()=>new zn));class Dn extends jn{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,An(e);const n=Cn(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,s=new Uint8Array(r);s.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return Nn(this),this.iHash.update(e),this}digestInto(e){Nn(this),Sn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:s,blockLen:i,outputLen:a}=this;return e.finished=r,e.destroyed=s,e.blockLen=i,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Fn=(e,t,n)=>new Dn(e,t).update(n).digest();Fn.create=(e,t)=>new Dn(e,t);const Vn=BigInt(0),Hn=BigInt(1),Kn=BigInt(2);function Wn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Jn(e){if(!Wn(e))throw new Error("Uint8Array expected")}function Gn(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const Yn=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Xn(e){Jn(e);let t="";for(let n=0;n<e.length;n++)t+=Yn[e[n]];return t}function Qn(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function er(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Vn:BigInt("0x"+e)}const tr={_0:48,_9:57,A:65,F:70,a:97,f:102};function nr(e){return e>=tr._0&&e<=tr._9?e-tr._0:e>=tr.A&&e<=tr.F?e-(tr.A-10):e>=tr.a&&e<=tr.f?e-(tr.a-10):void 0}function rr(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,s=0;t<n;t++,s+=2){const n=nr(e.charCodeAt(s)),i=nr(e.charCodeAt(s+1));if(void 0===n||void 0===i){const t=e[s]+e[s+1];throw new Error(\'hex string expected, got non-hex character "\'+t+\'" at index \'+s)}r[t]=16*n+i}return r}function sr(e){return er(Xn(e))}function ir(e){return Jn(e),er(Xn(Uint8Array.from(e).reverse()))}function ar(e,t){return rr(e.toString(16).padStart(2*t,"0"))}function or(e,t){return ar(e,t).reverse()}function cr(e,t,n){let r;if("string"==typeof t)try{r=rr(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!Wn(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const s=r.length;if("number"==typeof n&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}function dr(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];Jn(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const s=e[t];n.set(s,r),r+=s.length}return n}const ur=e=>"bigint"==typeof e&&Vn<=e;function lr(e,t,n){return ur(e)&&ur(t)&&ur(n)&&t<=e&&e<n}function hr(e,t,n,r){if(!lr(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function fr(e){let t;for(t=0;e>Vn;e>>=Hn,t+=1);return t}const pr=e=>(Kn<<BigInt(e-1))-Hn,mr=e=>new Uint8Array(e),gr=e=>Uint8Array.from(e);function yr(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=mr(e),s=mr(e),i=0;const a=()=>{r.fill(1),s.fill(0),i=0},o=(...e)=>n(s,r,...e),c=(e=mr())=>{s=o(gr([0]),e),r=o(),0!==e.length&&(s=o(gr([1]),e),r=o())},d=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=o();const t=r.slice();n.push(t),e+=r.length}return dr(...n)};return(e,t)=>{let n;for(a(),c(e);!(n=t(d()));)c();return a(),n}}const vr={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||Wn(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function wr(e,t,n={}){const r=(t,n,r)=>{const s=vr[n];if("function"!=typeof s)throw new Error("invalid validator function");const i=e[t];if(!(r&&void 0===i||s(i,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+i)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}function _r(e){const t=new WeakMap;return(n,...r)=>{const s=t.get(n);if(void 0!==s)return s;const i=e(n,...r);return t.set(n,i),i}}const br=BigInt(0),xr=BigInt(1),Er=BigInt(2),kr=BigInt(3),Or=BigInt(4),Sr=BigInt(5),Ar=BigInt(8);BigInt(9),BigInt(16);function Nr(e,t){const n=e%t;return n>=br?n:t+n}function Tr(e,t,n){if(t<br)throw new Error("invalid exponent, negatives unsupported");if(n<=br)throw new Error("invalid modulus");if(n===xr)return br;let r=xr;for(;t>br;)t&xr&&(r=r*e%n),e=e*e%n,t>>=xr;return r}function Zr(e,t,n){let r=e;for(;t-- >br;)r*=r,r%=n;return r}function Ir(e,t){if(e===br)throw new Error("invert: expected non-zero number");if(t<=br)throw new Error("invert: expected positive modulus, got "+t);let n=Nr(e,t),r=t,s=br,i=xr,a=xr,o=br;for(;n!==br;){const e=r/n,t=r%n,c=s-a*e,d=i-o*e;r=n,n=t,s=a,i=o,a=c,o=d}if(r!==xr)throw new Error("invert: does not exist");return Nr(s,t)}function Br(e){if(e%Or===kr){const t=(e+xr)/Or;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%Ar===Sr){const t=(e-Sr)/Ar;return function(e,n){const r=e.mul(n,Er),s=e.pow(r,t),i=e.mul(n,s),a=e.mul(e.mul(i,Er),s),o=e.mul(i,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),n))throw new Error("Cannot find square root");return o}}return function(e){const t=(e-xr)/Er;let n,r,s;for(n=e-xr,r=0;n%Er===br;n/=Er,r++);for(s=Er;s<e&&Tr(s,t,e)!==e-xr;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===r){const t=(e+xr)/Or;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+xr)/Er;return function(e,a){if(e.pow(a,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let o=r,c=e.pow(e.mul(e.ONE,s),n),d=e.pow(a,i),u=e.pow(a,n);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(u);t<o&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const n=e.pow(c,xr<<BigInt(o-t-1));c=e.sqr(n),d=e.mul(d,n),u=e.mul(u,c),o=t}return d}}(e)}const Cr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function jr(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Rr(e,t,n=!1,r={}){if(e<=br)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:s,nByteLength:i}=jr(e,t);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const o=Object.freeze({ORDER:e,BITS:s,BYTES:i,MASK:pr(s),ZERO:br,ONE:xr,create:t=>Nr(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return br<=t&&t<e},is0:e=>e===br,isOdd:e=>(e&xr)===xr,neg:t=>Nr(-t,e),eql:(e,t)=>e===t,sqr:t=>Nr(t*t,e),add:(t,n)=>Nr(t+n,e),sub:(t,n)=>Nr(t-n,e),mul:(t,n)=>Nr(t*n,e),pow:(e,t)=>function(e,t,n){if(n<br)throw new Error("invalid exponent, negatives unsupported");if(n===br)return e.ONE;if(n===xr)return t;let r=e.ONE,s=t;for(;n>br;)n&xr&&(r=e.mul(r,s)),s=e.sqr(s),n>>=xr;return r}(o,e,t),div:(t,n)=>Nr(t*Ir(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Ir(t,e),sqrt:r.sqrt||(t=>(a||(a=Br(e)),a(o,t))),invertBatch:e=>function(e,t){const n=new Array(t.length),r=t.reduce(((t,r,s)=>e.is0(r)?t:(n[s]=t,e.mul(t,r))),e.ONE),s=e.inv(r);return t.reduceRight(((t,r,s)=>e.is0(r)?t:(n[s]=e.mul(t,n[s]),e.mul(t,r))),s),n}(o,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?or(e,i):ar(e,i),fromBytes:e=>{if(e.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+e.length);return n?ir(e):sr(e)}});return Object.freeze(o)}function Pr(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Lr(e){const t=Pr(e);return t+Math.ceil(t/2)}const Ur=BigInt(0),$r=BigInt(1);function Mr(e,t){const n=t.negate();return e?n:t}function zr(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function qr(e,t){zr(e,t);return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}function Dr(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)}))}function Fr(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)}))}const Vr=new WeakMap,Hr=new WeakMap;function Kr(e){return Hr.get(e)||1}function Wr(e){return function(e){const t=Cr.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});wr(e,t)}(e.Fp),wr(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...jr(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}function Jr(e){void 0!==e.lowS&&Gn("lowS",e.lowS),void 0!==e.prehash&&Gn("prehash",e.prehash)}const{Ph:Gr,aT:Yr}=e,Xr={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{const{Err:n}=Xr;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");const r=t.length/2,s=Qn(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?Qn(s.length/2|128):"";return Qn(e)+i+s+t},decode(e,t){const{Err:n}=Xr;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const s=t[r++];let i=0;if(!!(128&s)){const e=127&s;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const a=t.subarray(r,r+e);if(a.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===a[0])throw new n("tlv.decode(long): zero leftmost byte");for(const e of a)i=i<<8|e;if(r+=e,i<128)throw new n("tlv.decode(long): not minimal encoding")}else i=s;const a=t.subarray(r,r+i);if(a.length!==i)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+i)}}},_int:{encode(e){const{Err:t}=Xr;if(e<Qr)throw new t("integer: negative integers are not allowed");let n=Qn(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Xr;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return Gr(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Xr,s="string"==typeof e?Yr(e):e;Jn(s);const{v:i,l:a}=r.decode(48,s);if(a.length)throw new t("invalid signature: left bytes after parsing");const{v:o,l:c}=r.decode(2,i),{v:d,l:u}=r.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(o),s:n.decode(d)}},hexFromSig(e){const{_tlv:t,_int:n}=Xr,r=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,r)}},Qr=BigInt(0),es=BigInt(1),ts=(BigInt(2),BigInt(3));BigInt(4);function ns(e){const t=function(e){const t=Wr(e);wr(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=t;if(n){if(!r.eql(s,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,r=Rr(t.n,t.nBitLength),s=t.toBytes||((e,t,r)=>{const s=t.toAffine();return dr(Uint8Array.from([4]),n.toBytes(s.x),n.toBytes(s.y))}),i=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function a(e){const{a:r,b:s}=t,i=n.sqr(e),a=n.mul(i,e);return n.add(n.add(a,n.mul(e,r)),s)}if(!n.eql(n.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function o(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:s,n:i}=t;if(n&&"bigint"!=typeof e){if(Wn(e)&&(e=Xn(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*r,"0")}let a;try{a="bigint"==typeof e?e:sr(cr("private key",e,r))}catch(t){throw new Error("invalid private key, expected hex or "+r+" bytes, got "+typeof e)}return s&&(a=Nr(a,i)),hr("private key",a,es,i),a}function c(e){if(!(e instanceof l))throw new Error("ProjectivePoint expected")}const d=_r(((e,t)=>{const{px:r,py:s,pz:i}=e;if(n.eql(i,n.ONE))return{x:r,y:s};const a=e.is0();null==t&&(t=a?n.ONE:n.inv(i));const o=n.mul(r,t),c=n.mul(s,t),d=n.mul(i,t);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(d,n.ONE))throw new Error("invZ was invalid");return{x:o,y:c}})),u=_r((e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:r,y:s}=e.toAffine();if(!n.isValid(r)||!n.isValid(s))throw new Error("bad point: x or y not FE");const i=n.sqr(s),o=a(r);if(!n.eql(i,o))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class l{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required");Object.freeze(this)}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof l)throw new Error("projective point not allowed");const s=e=>n.eql(e,n.ZERO);return s(t)&&s(r)?l.ZERO:new l(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(l.fromAffine)}static fromHex(e){const t=l.fromAffine(i(cr("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return l.BASE.multiply(o(e))}static msm(e,t){return function(e,t,n,r){if(Dr(n,e),Fr(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,i=fr(BigInt(n.length)),a=i>12?i-3:i>4?i-2:i?2:1,o=(1<<a)-1,c=new Array(o+1).fill(s);let d=s;for(let e=Math.floor((t.BITS-1)/a)*a;e>=0;e-=a){c.fill(s);for(let t=0;t<r.length;t++){const s=r[t],i=Number(s>>BigInt(e)&BigInt(o));c[i]=c[i].add(n[t])}let t=s;for(let e=c.length-1,n=s;e>0;e--)n=n.add(c[e]),t=t.add(n);if(d=d.add(t),0!==e)for(let e=0;e<a;e++)d=d.double()}return d}(l,r,e,t)}_setWindowSize(e){f.setWindowSize(this,e)}assertValidity(){u(this)}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn\'t support isOdd")}equals(e){c(e);const{px:t,py:r,pz:s}=this,{px:i,py:a,pz:o}=e,d=n.eql(n.mul(t,o),n.mul(i,s)),u=n.eql(n.mul(r,o),n.mul(a,s));return d&&u}negate(){return new l(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,s=n.mul(r,ts),{px:i,py:a,pz:o}=this;let c=n.ZERO,d=n.ZERO,u=n.ZERO,h=n.mul(i,i),f=n.mul(a,a),p=n.mul(o,o),m=n.mul(i,a);return m=n.add(m,m),u=n.mul(i,o),u=n.add(u,u),c=n.mul(e,u),d=n.mul(s,p),d=n.add(c,d),c=n.sub(f,d),d=n.add(f,d),d=n.mul(c,d),c=n.mul(m,c),u=n.mul(s,u),p=n.mul(e,p),m=n.sub(h,p),m=n.mul(e,m),m=n.add(m,u),u=n.add(h,h),h=n.add(u,h),h=n.add(h,p),h=n.mul(h,m),d=n.add(d,h),p=n.mul(a,o),p=n.add(p,p),h=n.mul(p,m),c=n.sub(c,h),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new l(c,d,u)}add(e){c(e);const{px:r,py:s,pz:i}=this,{px:a,py:o,pz:d}=e;let u=n.ZERO,h=n.ZERO,f=n.ZERO;const p=t.a,m=n.mul(t.b,ts);let g=n.mul(r,a),y=n.mul(s,o),v=n.mul(i,d),w=n.add(r,s),_=n.add(a,o);w=n.mul(w,_),_=n.add(g,y),w=n.sub(w,_),_=n.add(r,i);let b=n.add(a,d);return _=n.mul(_,b),b=n.add(g,v),_=n.sub(_,b),b=n.add(s,i),u=n.add(o,d),b=n.mul(b,u),u=n.add(y,v),b=n.sub(b,u),f=n.mul(p,_),u=n.mul(m,v),f=n.add(u,f),u=n.sub(y,f),f=n.add(y,f),h=n.mul(u,f),y=n.add(g,g),y=n.add(y,g),v=n.mul(p,v),_=n.mul(m,_),y=n.add(y,v),v=n.sub(g,v),v=n.mul(p,v),_=n.add(_,v),g=n.mul(y,_),h=n.add(h,g),g=n.mul(b,_),u=n.mul(w,u),u=n.sub(u,g),g=n.mul(w,y),f=n.mul(b,f),f=n.add(f,g),new l(u,h,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(l.ZERO)}wNAF(e){return f.wNAFCached(this,e,l.normalizeZ)}multiplyUnsafe(e){const{endo:r,n:s}=t;hr("scalar",e,Qr,s);const i=l.ZERO;if(e===Qr)return i;if(this.is0()||e===es)return this;if(!r||f.hasPrecomputes(this))return f.wNAFCachedUnsafe(this,e,l.normalizeZ);let{k1neg:a,k1:o,k2neg:c,k2:d}=r.splitScalar(e),u=i,h=i,p=this;for(;o>Qr||d>Qr;)o&es&&(u=u.add(p)),d&es&&(h=h.add(p)),p=p.double(),o>>=es,d>>=es;return a&&(u=u.negate()),c&&(h=h.negate()),h=new l(n.mul(h.px,r.beta),h.py,h.pz),u.add(h)}multiply(e){const{endo:r,n:s}=t;let i,a;if(hr("scalar",e,es,s),r){const{k1neg:t,k1:s,k2neg:o,k2:c}=r.splitScalar(e);let{p:d,f:u}=this.wNAF(s),{p:h,f:p}=this.wNAF(c);d=f.constTimeNegate(t,d),h=f.constTimeNegate(o,h),h=new l(n.mul(h.px,r.beta),h.py,h.pz),i=d.add(h),a=u.add(p)}else{const{p:t,f:n}=this.wNAF(e);i=t,a=n}return l.normalizeZ([i,a])[0]}multiplyAndAddUnsafe(e,t,n){const r=l.BASE,s=(e,t)=>t!==Qr&&t!==es&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),i=s(this,t).add(s(e,n));return i.is0()?void 0:i}toAffine(e){return d(this,e)}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===es)return!0;if(n)return n(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===es?this:n?n(l,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return Gn("isCompressed",e),this.assertValidity(),s(l,this,e)}toHex(e=!0){return Gn("isCompressed",e),Xn(this.toRawBytes(e))}}l.BASE=new l(t.Gx,t.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);const h=t.nBitLength,f=(p=l,m=t.endo?Math.ceil(h/2):h,{constTimeNegate:Mr,hasPrecomputes:e=>1!==Kr(e),unsafeLadder(e,t,n=p.ZERO){let r=e;for(;t>Ur;)t&$r&&(n=n.add(r)),r=r.double(),t>>=$r;return n},precomputeWindow(e,t){const{windows:n,windowSize:r}=qr(t,m),s=[];let i=e,a=i;for(let e=0;e<n;e++){a=i,s.push(a);for(let e=1;e<r;e++)a=a.add(i),s.push(a);i=a.double()}return s},wNAF(e,t,n){const{windows:r,windowSize:s}=qr(e,m);let i=p.ZERO,a=p.BASE;const o=BigInt(2**e-1),c=2**e,d=BigInt(e);for(let e=0;e<r;e++){const r=e*s;let u=Number(n&o);n>>=d,u>s&&(u-=c,n+=$r);const l=r,h=r+Math.abs(u)-1,f=e%2!=0,p=u<0;0===u?a=a.add(Mr(f,t[l])):i=i.add(Mr(p,t[h]))}return{p:i,f:a}},wNAFUnsafe(e,t,n,r=p.ZERO){const{windows:s,windowSize:i}=qr(e,m),a=BigInt(2**e-1),o=2**e,c=BigInt(e);for(let e=0;e<s;e++){const s=e*i;if(n===Ur)break;let d=Number(n&a);if(n>>=c,d>i&&(d-=o,n+=$r),0===d)continue;let u=t[s+Math.abs(d)-1];d<0&&(u=u.negate()),r=r.add(u)}return r},getPrecomputes(e,t,n){let r=Vr.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&Vr.set(t,n(r))),r},wNAFCached(e,t,n){const r=Kr(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe(e,t,n,r){const s=Kr(e);return 1===s?this.unsafeLadder(e,t,r):this.wNAFUnsafe(s,this.getPrecomputes(s,e,n),t,r)},setWindowSize(e,t){zr(t,m),Hr.set(e,t),Vr.delete(e)}});var p,m;return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(e){return lr(e,es,t.n)}}}function rs(e){const t=function(e){const t=Wr(e);return wr(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:r}=t,s=n.BYTES+1,i=2*n.BYTES+1;function a(e){return Nr(e,r)}function o(e){return Ir(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:d,weierstrassEquation:u,isWithinCurveOrder:l}=ns({...t,toBytes(e,t,r){const s=t.toAffine(),i=n.toBytes(s.x),a=dr;return Gn("isCompressed",r),r?a(Uint8Array.from([t.hasEvenY()?2:3]),i):a(Uint8Array.from([4]),i,n.toBytes(s.y))},fromBytes(e){const t=e.length,r=e[0],a=e.subarray(1);if(t!==s||2!==r&&3!==r){if(t===i&&4===r){return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))}}throw new Error("invalid Point, expected length of "+s+", or uncompressed "+i+", got "+t)}{const e=sr(a);if(!lr(e,es,n.ORDER))throw new Error("Point is not on curve");const t=u(e);let s;try{s=n.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("Point is not on curve"+t)}return!(1&~r)!==((s&es)===es)&&(s=n.neg(s)),{x:e,y:s}}}}),h=e=>Xn(ar(e,t.nByteLength));function f(e){return e>r>>es}const p=(e,t,n)=>sr(e.slice(t,n));class m{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=cr("compactSignature",e,2*n),new m(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=Xr.toSig(cr("DER",e));return new m(t,n)}assertValidity(){hr("r",this.r,es,r),hr("s",this.s,es,r)}addRecoveryBit(e){return new m(this.r,this.s,e)}recoverPublicKey(e){const{r,s,recovery:i}=this,d=w(cr("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const u=2===i||3===i?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const l=1&i?"03":"02",f=c.fromHex(l+h(u)),p=o(u),m=a(-d*p),g=a(s*p),y=c.BASE.multiplyAndAddUnsafe(f,m,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return rr(this.toDERHex())}toDERHex(){return Xr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return rr(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const g={isValidPrivateKey(e){try{return d(e),!0}catch(e){return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const e=Lr(t.n);return function(e,t,n=!1){const r=e.length,s=Pr(t),i=Lr(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const a=Nr(n?sr(e):ir(e),t-xr)+xr;return n?or(a,s):ar(a,s)}(t.randomBytes(e),t.n)},precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function y(e){const t=Wn(e),n="string"==typeof e,r=(t||n)&&e.length;return t?r===s||r===i:n?r===2*s||r===2*i:e instanceof c}const v=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const n=sr(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},w=t.bits2int_modN||function(e){return a(v(e))},_=pr(t.nBitLength);function b(e){return hr("num < 2^"+t.nBitLength,e,Qr,_),ar(e,t.nByteLength)}function x(e,r,s=E){if(["recovered","canonical"].some((e=>e in s)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:u}=t;let{lowS:h,prehash:p,extraEntropy:g}=s;null==h&&(h=!0),e=cr("msgHash",e),Jr(s),p&&(e=cr("prehashed msgHash",i(e)));const y=w(e),_=d(r),x=[b(_),b(y)];if(null!=g&&!1!==g){const e=!0===g?u(n.BYTES):g;x.push(cr("extraEntropy",e))}const k=dr(...x),O=y;return{seed:k,k2sig:function(e){const t=v(e);if(!l(t))return;const n=o(t),r=c.BASE.multiply(t).toAffine(),s=a(r.x);if(s===Qr)return;const i=a(n*a(O+s*_));if(i===Qr)return;let d=(r.x===s?0:2)|Number(r.y&es),u=i;return h&&f(i)&&(u=function(e){return f(e)?a(-e):e}(i),d^=1),new m(s,u,d)}}}const E={lowS:t.lowS,prehash:!1},k={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(y(e))throw new Error("first arg must be private key");if(!y(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(d(e)).toRawBytes(n)},sign:function(e,n,r=E){const{seed:s,k2sig:i}=x(e,n,r),a=t;return yr(a.hash.outputLen,a.nByteLength,a.hmac)(s,i)},verify:function(e,n,r,s=k){const i=e;n=cr("msgHash",n),r=cr("publicKey",r);const{lowS:d,prehash:u,format:l}=s;if(Jr(s),"strict"in s)throw new Error("options.strict was renamed to lowS");if(void 0!==l&&"compact"!==l&&"der"!==l)throw new Error("format must be compact or der");const h="string"==typeof i||Wn(i),f=!h&&!l&&"object"==typeof i&&null!==i&&"bigint"==typeof i.r&&"bigint"==typeof i.s;if(!h&&!f)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let p,g;try{if(f&&(p=new m(i.r,i.s)),h){try{"compact"!==l&&(p=m.fromDER(i))}catch(e){if(!(e instanceof Xr.Err))throw e}p||"der"===l||(p=m.fromCompact(i))}g=c.fromHex(r)}catch(e){return!1}if(!p)return!1;if(d&&p.hasHighS())return!1;u&&(n=t.hash(n));const{r:y,s:v}=p,_=w(n),b=o(v),x=a(_*b),E=a(y*b),O=c.BASE.multiplyAndAddUnsafe(g,x,E)?.toAffine();return!!O&&a(O.x)===y},ProjectivePoint:c,Signature:m,utils:g}}function ss(e){return{hash:e,hmac:(t,...n)=>Fn(e,t,function(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];Sn(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const s=e[t];n.set(s,r),r+=s.length}return n}(...n)),randomBytes:Rn}}const is=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),as=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),os=BigInt(1),cs=BigInt(2),ds=(e,t)=>(e+t/cs)/t;function us(e){const t=is,n=BigInt(3),r=BigInt(6),s=BigInt(11),i=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),d=e*e*e%t,u=d*d*e%t,l=Zr(u,n,t)*u%t,h=Zr(l,n,t)*u%t,f=Zr(h,cs,t)*d%t,p=Zr(f,s,t)*f%t,m=Zr(p,i,t)*p%t,g=Zr(m,o,t)*m%t,y=Zr(g,c,t)*g%t,v=Zr(y,o,t)*m%t,w=Zr(v,n,t)*u%t,_=Zr(w,a,t)*p%t,b=Zr(_,r,t)*d%t,x=Zr(b,cs,t);if(!ls.eql(ls.sqr(x),e))throw new Error("Cannot find square root");return x}const ls=Rr(is,void 0,void 0,{sqrt:us}),hs=function(e,t){const n=t=>rs({...e,...ss(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:ls,n:as,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=as,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-os*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,a=BigInt("0x100000000000000000000000000000000"),o=ds(i*e,t),c=ds(-r*e,t);let d=Nr(e-o*n-c*s,t),u=Nr(-o*r-c*i,t);const l=d>a,h=u>a;if(l&&(d=t-d),h&&(u=t-u),d>a||u>a)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:l,k1:d,k2neg:h,k2:u}}}},qn);BigInt(0);hs.ProjectivePoint;function fs(e,...t){if(!((n=e)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ps(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ms(e,t){fs(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const gs=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ys=(e,t)=>e<<32-t|e>>>t;Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function vs(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),fs(e),e}class ws{clone(){return this._cloneInto()}}const _s=(e,t,n)=>e&t^e&n^t&n;class bs extends ws{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=gs(this.buffer)}update(e){ps(this);const{view:t,buffer:n,blockLen:r}=this,s=(e=vs(e)).length;for(let i=0;i<s;){const a=Math.min(r-this.pos,s-i);if(a!==r)n.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=gs(e);for(;r<=s-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){ps(this),ms(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:s}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),a=Number(n>>s&i),o=Number(n&i),c=r?4:0,d=r?0:4;e.setUint32(t+c,a,r),e.setUint32(t+d,o,r)}(n,r-8,BigInt(8*this.length),s),this.process(n,0);const a=gs(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,d=this.get();if(c>d.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,d[e],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:s,destroyed:i,pos:a}=this;return e.length=r,e.pos=a,e.finished=s,e.destroyed=i,r%t&&e.buffer.set(n),e}}const xs=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Es=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ks=new Uint32Array(64);class Os extends bs{constructor(){super(64,32,8,!1),this.A=0|Es[0],this.B=0|Es[1],this.C=0|Es[2],this.D=0|Es[3],this.E=0|Es[4],this.F=0|Es[5],this.G=0|Es[6],this.H=0|Es[7]}get(){const{A:e,B:t,C:n,D:r,E:s,F:i,G:a,H:o}=this;return[e,t,n,r,s,i,a,o]}set(e,t,n,r,s,i,a,o){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|s,this.F=0|i,this.G=0|a,this.H=0|o}process(e,t){for(let n=0;n<16;n++,t+=4)ks[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=ks[e-15],n=ks[e-2],r=ys(t,7)^ys(t,18)^t>>>3,s=ys(n,17)^ys(n,19)^n>>>10;ks[e]=s+ks[e-7]+r+ks[e-16]|0}let{A:n,B:r,C:s,D:i,E:a,F:o,G:c,H:d}=this;for(let e=0;e<64;e++){const t=d+(ys(a,6)^ys(a,11)^ys(a,25))+((u=a)&o^~u&c)+xs[e]+ks[e]|0,l=(ys(n,2)^ys(n,13)^ys(n,22))+_s(n,r,s)|0;d=c,c=o,o=a,a=i+t|0,i=s,s=r,r=n,n=t+l|0}var u;n=n+this.A|0,r=r+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,d=d+this.H|0,this.set(n,r,s,i,a,o,c,d)}roundClean(){ks.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ss=function(e){const t=t=>e().update(vs(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}((()=>new Os));function As(e,t){return Ns(e,"pattern",(n=>t.test(n)||`Expected a ${e.type} matching \\`/${t.source}/\\` but received "${n}"`))}function Ns(e,t,n){return new f({...e,*refiner(r,s){yield*e.refiner(r,s);const i=l(n(r,s),s,e,r);for(const e of i)yield{...e,refinement:t}}})}As(A(),/^(?:0x)?[0-9a-f]+$/iu),As(A(),/^0x[0-9a-f]+$/iu),As(A(),/^0x[0-9a-f]{40}$/u),As(A(),/^0x[0-9a-fA-F]{40}$/u);function Ts(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}function Zs(e,...t){if(!((n=e)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const Is=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Bs(e){Zs(e);let t="";for(let n=0;n<e.length;n++)t+=Is[e[n]];return t}const Cs=48,js=57,Rs=65,Ps=70,Ls=97,Us=102;function $s(e){return e>=Cs&&e<=js?e-Cs:e>=Rs&&e<=Ps?e-(Rs-10):e>=Ls&&e<=Us?e-(Ls-10):void 0}function Ms(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,s=0;t<n;t++,s+=2){const n=$s(e.charCodeAt(s)),i=$s(e.charCodeAt(s+1));if(void 0===n||void 0===i){const t=e[s]+e[s+1];throw new Error(\'hex string expected, got non-hex character "\'+t+\'" at index \'+s)}r[t]=16*n+i}return r}async function zs(){const e=await async function(){return await snap.request({method:"snap_getEntropy",params:{version:1}})}();return Ms(Ts(e))}async function qs(){const e=await zs();return`0x${Bs(hs.getPublicKey(e))}`}const Ds=kn.object({message:kn.string().startsWith("metamask:")});const Fs=async({request:e})=>{switch(e.method){case"getPublicKey":return qs();case"signMessage":{const{params:t}=e;!function(e){try{Ds.parse(e)}catch{throw re({message:"`signMessage`, must take a `message` parameter that must begin with `metamask:`"})}}(t);const{message:n}=t;return await async function(e){const t=await zs(),n=Ss(e);return`0x${hs.sign(n,t).toCompactHex()}`}(n)}default:throw se({data:{method:e.method}})}}})();var s=exports;for(var i in r)s[i]=r[i];r.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();'}],removable:!1}}}},{package:"@metamask/message-signing-snap",file:"node_modules/@metamask/message-signing-snap/dist/preinstalled-snap.json"}],[1967,{"./metamask-airgapped-keyring.cjs.development.js":1968,"./metamask-airgapped-keyring.cjs.production.min.js":1969},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./metamask-airgapped-keyring.cjs.production.min.js")}}},{package:"@metamask/metamask-airgapped-keyring",file:"node_modules/@metamask/metamask-airgapped-keyring/dist/index.js"}],[1968,{"@ethereumjs/rlp":421,"@ethereumjs/tx":434,"@keystonehq/base-eth-keyring":605,"@keystonehq/bc-ur-registry-eth":1972,"@metamask/obs-store":2315,buffer:3998,events:4323,uuid:5587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@keystonehq/base-eth-keyring"),s=e("events"),i=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),o=e("uuid"),c=e("@ethereumjs/tx"),l=e("@ethereumjs/rlp");class u extends s.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(`${e}-signed`),this.removeAllListeners(`${e}-canceled`)},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=a.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=a.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,i)=>{const c=e.toUR(),l=e.getRequestId(),u=o.stringify(l),d={requestId:u,payload:{type:c.type,cbor:c.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:d}}),this.once(`${u}-signed`,(e=>{const r=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(`${u}-canceled`,(()=>{this.resetState(),i(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(`${e}-signed`,t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(`${t}-canceled`)}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},u.instance)return u.instance;this.memStore=new i.ObservableStore({sync:{reading:!1},sign:{},_version:1}),u.instance=this}}class d extends n.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new u,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=undefined,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,d.instance)return d.instance.deserialize(e),d.instance;d.instance=this}async addAccounts(e=1){return(await super.addAccounts(e)).slice(-1*e)}async signTransaction(e,r){const n=0===r.type?a.DataType.transaction:a.DataType.typedTransaction;let s;s=0===r.type?t.from(l.RLP.encode(r.getMessageToSign())):t.from(r.getMessageToSign());const i=await this._pathFromAddress(e),u=r.common.chainId(),d=o.v4(),h=a.EthSignRequest.constructETHRequest(s,n,i,this.xfp,d,u,e),{r:p,s:m,v:g}=await this.requestSignature(d,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),f=r.toJSON();f.v=g,f.s=m,f.r=p,f.type=r.type;return c.TransactionFactory.fromTxData(f,{common:r.common})}}d.type=n.BaseKeyring.type,r.MetaMaskKeyring=d}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring",file:"node_modules/@metamask/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.development.js"}],[1969,{"@ethereumjs/rlp":421,"@ethereumjs/tx":434,"@keystonehq/base-eth-keyring":605,"@keystonehq/bc-ur-registry-eth":1972,"@metamask/obs-store":2315,buffer:3998,events:4323,uuid:5587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("@keystonehq/base-eth-keyring"),s=e("events"),i=e("@metamask/obs-store"),a=e("@keystonehq/bc-ur-registry-eth"),o=e("uuid"),c=e("@ethereumjs/tx"),l=e("@ethereumjs/rlp");class u extends s.EventEmitter{constructor(){if(super(),this.cleanSyncListeners=()=>{this.removeAllListeners("keystone-sync_success-hdkey"),this.removeAllListeners("keystone-sync_success-account"),this.removeAllListeners("keystone-sync_cancel")},this.cleanSignListeners=e=>{this.removeAllListeners(e+"-signed"),this.removeAllListeners(e+"-canceled")},this.readCryptoHDKeyOrCryptoAccount=()=>new Promise(((e,r)=>{this.memStore.updateState({sync:{reading:!0}}),this.on("keystone-sync_success-hdkey",(r=>{const n=a.CryptoHDKey.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_success-account",(r=>{const n=a.CryptoAccount.fromCBOR(t.from(r,"hex"));this.resetState(),e(n)})),this.on("keystone-sync_cancel",(()=>{this.resetState(),r(new Error("KeystoneError#sync_cancel. Sync process canceled, please retry"))}))})),this.submitCryptoHDKey=e=>{this.emit("keystone-sync_success-hdkey",e)},this.submitCryptoAccount=e=>{this.emit("keystone-sync_success-account",e)},this.cancelSync=()=>{this.emit("keystone-sync_cancel")},this.requestSignature=(e,r,n)=>new Promise(((s,i)=>{const c=e.toUR(),l=e.getRequestId(),u=o.stringify(l),d={requestId:u,payload:{type:c.type,cbor:c.cbor.toString("hex")},title:r,description:n};this.memStore.updateState({sign:{request:d}}),this.once(u+"-signed",(e=>{const r=a.ETHSignature.fromCBOR(t.from(e,"hex"));this.resetState(),s(r)})),this.once(u+"-canceled",(()=>{this.resetState(),i(new Error("KeystoneError#Tx_canceled. Signing canceled, please retry"))}))})),this.submitSignature=(e,t)=>{this.emit(e+"-signed",t)},this.cancelRequestSignature=()=>{const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.memStore.updateState({sign:{}}),this.emit(t+"-canceled")}},this.reset=()=>{this.cleanSyncListeners();const e=this.memStore.getState().sign.request;if(e){const{requestId:t}=e;this.cleanSignListeners(t)}this.resetState()},this.resetState=()=>{this.memStore.updateState({sync:{reading:!1},sign:{}})},u.instance)return u.instance;this.memStore=new i.ObservableStore({sync:{reading:!1},sign:{},_version:1}),u.instance=this}}class d extends n.BaseKeyring{constructor(e){if(super(e),this.getInteraction=()=>new u,this.resetStore=()=>{this.getInteraction().reset()},this.getMemStore=()=>this.getInteraction().memStore,this.removeAccount=e=>{if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))},this.forgetDevice=()=>{this.page=0,this.perPage=5,this.accounts=[],this.currentAccount=0,this.name="QR Hardware",this.initialized=!1,this.xfp="",this.xpub="",this.hdPath="",this.indexes={},this.hdk=void 0,this.paths={}},this.submitCryptoHDKey=this.getInteraction().submitCryptoHDKey,this.submitCryptoAccount=this.getInteraction().submitCryptoAccount,this.submitSignature=this.getInteraction().submitSignature,this.cancelSync=this.getInteraction().cancelSync,this.cancelSignRequest=this.getInteraction().cancelRequestSignature,d.instance)return d.instance.deserialize(e),d.instance;d.instance=this}async addAccounts(e=1){return(await super.addAccounts(e)).slice(-1*e)}async signTransaction(e,r){const n=0===r.type?a.DataType.transaction:a.DataType.typedTransaction;let s;s=0===r.type?t.from(l.RLP.encode(r.getMessageToSign())):t.from(r.getMessageToSign());const i=await this._pathFromAddress(e),u=r.common.chainId(),d=o.v4(),h=a.EthSignRequest.constructETHRequest(s,n,i,this.xfp,d,u,e),{r:p,s:m,v:g}=await this.requestSignature(d,h,"Scan with your Keystone",'After your Keystone has signed the transaction, click on "Scan Keystone" to receive the signature'),f=r.toJSON();return f.v=g,f.s=m,f.r=p,f.type=r.type,c.TransactionFactory.fromTxData(f,{common:r.common})}}d.type=n.BaseKeyring.type,r.MetaMaskKeyring=d}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring",file:"node_modules/@metamask/metamask-airgapped-keyring/dist/metamask-airgapped-keyring.cjs.production.min.js"}],[197,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");r.default={version:14,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=14;try{const e=function(e){const t=e;return t.NetworkController={},t.NetworkController.provider=t.config.provider,delete t.config.provider,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #14${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/014.js"}],[1970,{"@ethereumjs/util":1980,"@keystonehq/bc-ur-registry":2007,buffer:3998,hdkey:4556,uuid:5587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/bc-ur-registry"),i=e("uuid"),a=(n=e("hdkey"))&&"object"==typeof n&&"default"in n?n.default:n,o=e("@ethereumjs/util");const c={ETH_SIGN_REQUEST:new s.RegistryType("eth-sign-request",401),ETH_SIGNATURE:new s.RegistryType("eth-signature",402),ETH_NFT_ITEM:new s.RegistryType("eth-nft-item",403)},{decodeToDataItem:l,RegistryTypes:u}=s.extend;var d,h;!function(e){e[e.requestId=1]="requestId",e[e.signData=2]="signData",e[e.dataType=3]="dataType",e[e.chainId=4]="chainId",e[e.derivationPath=5]="derivationPath",e[e.address=6]="address",e[e.origin=7]="origin"}(d||(d={})),(h=r.DataType||(r.DataType={}))[h.transaction=1]="transaction",h[h.typedData=2]="typedData",h[h.personalMessage=3]="personalMessage",h[h.typedTransaction=4]="typedTransaction";class p extends s.RegistryItem{constructor(e){super(),this.getRegistryType=()=>c.ETH_SIGN_REQUEST,this.getRequestId=()=>this.requestId,this.getSignData=()=>this.signData,this.getDataType=()=>this.dataType,this.getChainId=()=>this.chainId,this.getDerivationPath=()=>this.derivationPath.getPath(),this.getSourceFingerprint=()=>this.derivationPath.getSourceFingerprint(),this.getSignRequestAddress=()=>this.address,this.getOrigin=()=>this.origin,this.toDataItem=()=>{const e={};this.requestId&&(e[d.requestId]=new s.DataItem(this.requestId,u.UUID.getTag())),this.address&&(e[d.address]=this.address),this.chainId&&(e[d.chainId]=Number(this.chainId)),this.origin&&(e[d.origin]=this.origin),e[d.signData]=this.signData,e[d.dataType]=this.dataType;const t=this.derivationPath.toDataItem();return t.setTag(this.derivationPath.getRegistryType().getTag()),e[d.derivationPath]=t,new s.DataItem(e)},this.requestId=e.requestId,this.signData=e.signData,this.dataType=e.dataType,this.chainId=e.chainId,this.derivationPath=e.derivationPath,this.address=e.address,this.origin=e.origin}static constructETHRequest(e,r,n,a,o,c,l,u){const d=n.replace(/[m|M]\//,"").split("/"),h=new s.CryptoKeypath(d.map((e=>{const t=parseInt(e.replace("'",""));let r=!1;return e.endsWith("'")&&(r=!0),new s.PathComponent({index:t,hardened:r})})),t.from(a,"hex"));return new p({requestId:o?t.from(i.parse(o)):undefined,signData:e,dataType:r,derivationPath:h,chainId:c,address:l?t.from(l.replace("0x",""),"hex"):undefined,origin:u||undefined})}}p.fromDataItem=e=>{const t=e.getData(),r=t[d.signData],n=t[d.dataType],i=s.CryptoKeypath.fromDataItem(t[d.derivationPath]),a=t[d.chainId]?t[d.chainId]:undefined,o=t[d.address]?t[d.address]:undefined,c=t[d.requestId]?t[d.requestId].getData():undefined,l=t[d.origin]?t[d.origin]:undefined;return new p({requestId:c,signData:r,dataType:n,chainId:a,derivationPath:i,address:o,origin:l})},p.fromCBOR=e=>{const t=l(e);return p.fromDataItem(t)};const{RegistryTypes:m,decodeToDataItem:g}=s.extend;var f;!function(e){e[e.requestId=1]="requestId",e[e.signature=2]="signature",e[e.origin=3]="origin"}(f||(f={}));class y extends s.RegistryItem{constructor(e,t,r){super(),this.getRegistryType=()=>c.ETH_SIGNATURE,this.getRequestId=()=>this.requestId,this.getSignature=()=>this.signature,this.getOrigin=()=>this.origin,this.toDataItem=()=>{const e={};return this.requestId&&(e[f.requestId]=new s.DataItem(this.requestId,m.UUID.getTag())),this.origin&&(e[f.origin]=this.origin),e[f.signature]=this.signature,new s.DataItem(e)},this.signature=e,this.requestId=t,this.origin=r}}y.fromDataItem=e=>{const t=e.getData(),r=t[f.signature],n=t[f.requestId]?t[f.requestId].getData():undefined;return new y(r,n,t[f.origin])},y.fromCBOR=e=>{const t=g(e);return y.fromDataItem(t)};const{decodeToDataItem:b}=s.extend;var v;!function(e){e[e.chainId=1]="chainId",e[e.contractAddress=2]="contractAddress",e[e.contractName=3]="contractName",e[e.name=4]="name",e[e.mediaData=5]="mediaData"}(v||(v={}));class w extends s.RegistryItem{constructor(e){super(),this.getRegistryType=()=>c.ETH_NFT_ITEM,this.getChainId=()=>this.chainId,this.getName=()=>this.name,this.getmediaData=()=>this.mediaData,this.getContractAddress=()=>this.contractAddress,this.getContractName=()=>this.contractName,this.toDataItem=()=>{const e={};return e[v.chainId]=this.chainId,e[v.name]=this.name,e[v.contractAddress]=this.contractAddress,e[v.contractName]=this.contractName,e[v.mediaData]=this.mediaData,new s.DataItem(e)},this.chainId=e.chainId,this.name=e.name,this.contractAddress=e.contractAddress,this.contractName=e.contractName,this.mediaData=e.mediaData}static constructETHNFTItem(e,t,r,n,s){return new w({chainId:e,contractAddress:t,contractName:r,mediaData:s,name:n})}}w.fromDataItem=e=>{const t=e.getData(),r=t[v.chainId],n=t[v.name],s=t[v.mediaData],i=t[v.contractAddress],a=t[v.contractName];return new w({chainId:r,name:n,contractAddress:i,contractName:a,mediaData:s})},w.fromCBOR=e=>{const t=b(e);return w.fromDataItem(t)};const k=(e,t)=>{const r=a.fromExtendedKey(e).derive(t),n="0x"+o.publicToAddress(r.publicKey,!0).toString("hex");return o.toChecksumAddress(n)};s.patchTags(Object.values(c).filter((e=>!!e.getTag())).map((e=>e.getTag()))),Object.keys(s).forEach((function(e){"default"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}})})),r.ETHNFTItem=w,r.ETHSignature=y,r.EthSignRequest=p,r.findHDPathFromAddress=(e,t,r,n)=>{for(let s=0;s<r;s++){const r=k(t,`M/0/${s}`);if(e.toLowerCase()==r.toLowerCase())return`${n}/0/${s}`}return null},r.generateAddressFromXpub=k}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/dist/bc-ur-registry-eth.cjs.development.js"}],[1971,{"@ethereumjs/util":1980,"@keystonehq/bc-ur-registry":2007,buffer:3998,hdkey:4556,uuid:5587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n,s=e("@keystonehq/bc-ur-registry"),i=e("uuid"),a=(n=e("hdkey"))&&"object"==typeof n&&"default"in n?n.default:n,o=e("@ethereumjs/util");const c={ETH_SIGN_REQUEST:new s.RegistryType("eth-sign-request",401),ETH_SIGNATURE:new s.RegistryType("eth-signature",402),ETH_NFT_ITEM:new s.RegistryType("eth-nft-item",403)},{decodeToDataItem:l,RegistryTypes:u}=s.extend;var d,h;!function(e){e[e.requestId=1]="requestId",e[e.signData=2]="signData",e[e.dataType=3]="dataType",e[e.chainId=4]="chainId",e[e.derivationPath=5]="derivationPath",e[e.address=6]="address",e[e.origin=7]="origin"}(d||(d={})),(h=r.DataType||(r.DataType={}))[h.transaction=1]="transaction",h[h.typedData=2]="typedData",h[h.personalMessage=3]="personalMessage",h[h.typedTransaction=4]="typedTransaction";class p extends s.RegistryItem{constructor(e){super(),this.getRegistryType=()=>c.ETH_SIGN_REQUEST,this.getRequestId=()=>this.requestId,this.getSignData=()=>this.signData,this.getDataType=()=>this.dataType,this.getChainId=()=>this.chainId,this.getDerivationPath=()=>this.derivationPath.getPath(),this.getSourceFingerprint=()=>this.derivationPath.getSourceFingerprint(),this.getSignRequestAddress=()=>this.address,this.getOrigin=()=>this.origin,this.toDataItem=()=>{const e={};this.requestId&&(e[d.requestId]=new s.DataItem(this.requestId,u.UUID.getTag())),this.address&&(e[d.address]=this.address),this.chainId&&(e[d.chainId]=Number(this.chainId)),this.origin&&(e[d.origin]=this.origin),e[d.signData]=this.signData,e[d.dataType]=this.dataType;const t=this.derivationPath.toDataItem();return t.setTag(this.derivationPath.getRegistryType().getTag()),e[d.derivationPath]=t,new s.DataItem(e)},this.requestId=e.requestId,this.signData=e.signData,this.dataType=e.dataType,this.chainId=e.chainId,this.derivationPath=e.derivationPath,this.address=e.address,this.origin=e.origin}static constructETHRequest(e,r,n,a,o,c,l,u){const d=n.replace(/[m|M]\//,"").split("/"),h=new s.CryptoKeypath(d.map((e=>{const t=parseInt(e.replace("'",""));let r=!1;return e.endsWith("'")&&(r=!0),new s.PathComponent({index:t,hardened:r})})),t.from(a,"hex"));return new p({requestId:o?t.from(i.parse(o)):void 0,signData:e,dataType:r,derivationPath:h,chainId:c,address:l?t.from(l.replace("0x",""),"hex"):void 0,origin:u||void 0})}}p.fromDataItem=e=>{const t=e.getData(),r=t[d.signData],n=t[d.dataType],i=s.CryptoKeypath.fromDataItem(t[d.derivationPath]),a=t[d.chainId]?t[d.chainId]:void 0,o=t[d.address]?t[d.address]:void 0,c=t[d.requestId]?t[d.requestId].getData():void 0;return new p({requestId:c,signData:r,dataType:n,chainId:a,derivationPath:i,address:o,origin:t[d.origin]?t[d.origin]:void 0})},p.fromCBOR=e=>{const t=l(e);return p.fromDataItem(t)};const{RegistryTypes:m,decodeToDataItem:g}=s.extend;var f;!function(e){e[e.requestId=1]="requestId",e[e.signature=2]="signature",e[e.origin=3]="origin"}(f||(f={}));class y extends s.RegistryItem{constructor(e,t,r){super(),this.getRegistryType=()=>c.ETH_SIGNATURE,this.getRequestId=()=>this.requestId,this.getSignature=()=>this.signature,this.getOrigin=()=>this.origin,this.toDataItem=()=>{const e={};return this.requestId&&(e[f.requestId]=new s.DataItem(this.requestId,m.UUID.getTag())),this.origin&&(e[f.origin]=this.origin),e[f.signature]=this.signature,new s.DataItem(e)},this.signature=e,this.requestId=t,this.origin=r}}y.fromDataItem=e=>{const t=e.getData(),r=t[f.signature],n=t[f.requestId]?t[f.requestId].getData():void 0;return new y(r,n,t[f.origin])},y.fromCBOR=e=>{const t=g(e);return y.fromDataItem(t)};const{decodeToDataItem:b}=s.extend;var v;!function(e){e[e.chainId=1]="chainId",e[e.contractAddress=2]="contractAddress",e[e.contractName=3]="contractName",e[e.name=4]="name",e[e.mediaData=5]="mediaData"}(v||(v={}));class w extends s.RegistryItem{constructor(e){super(),this.getRegistryType=()=>c.ETH_NFT_ITEM,this.getChainId=()=>this.chainId,this.getName=()=>this.name,this.getmediaData=()=>this.mediaData,this.getContractAddress=()=>this.contractAddress,this.getContractName=()=>this.contractName,this.toDataItem=()=>{const e={};return e[v.chainId]=this.chainId,e[v.name]=this.name,e[v.contractAddress]=this.contractAddress,e[v.contractName]=this.contractName,e[v.mediaData]=this.mediaData,new s.DataItem(e)},this.chainId=e.chainId,this.name=e.name,this.contractAddress=e.contractAddress,this.contractName=e.contractName,this.mediaData=e.mediaData}static constructETHNFTItem(e,t,r,n,s){return new w({chainId:e,contractAddress:t,contractName:r,mediaData:s,name:n})}}w.fromDataItem=e=>{const t=e.getData();return new w({chainId:t[v.chainId],name:t[v.name],contractAddress:t[v.contractAddress],contractName:t[v.contractName],mediaData:t[v.mediaData]})},w.fromCBOR=e=>{const t=b(e);return w.fromDataItem(t)};const k=(e,t)=>{const r=a.fromExtendedKey(e).derive(t),n="0x"+o.publicToAddress(r.publicKey,!0).toString("hex");return o.toChecksumAddress(n)};s.patchTags(Object.values(c).filter((e=>!!e.getTag())).map((e=>e.getTag()))),Object.keys(s).forEach((function(e){"default"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}})})),r.ETHNFTItem=w,r.ETHSignature=y,r.EthSignRequest=p,r.findHDPathFromAddress=(e,t,r,n)=>{for(let s=0;s<r;s++){const r=k(t,"M/0/"+s);if(e.toLowerCase()==r.toLowerCase())return`${n}/0/${s}`}return null},r.generateAddressFromXpub=k}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/dist/bc-ur-registry-eth.cjs.production.min.js"}],[1972,{"./bc-ur-registry-eth.cjs.development.js":1970,"./bc-ur-registry-eth.cjs.production.min.js":1971},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./bc-ur-registry-eth.cjs.production.min.js")}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/dist/index.js"}]],[],{});