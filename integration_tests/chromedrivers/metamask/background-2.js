LavaPack.loadBundle([[1973,{"./bytes":1976,"./constants":1977,"./helpers":1979,"./internal":1981,"@ethereumjs/rlp":421,buffer:3998,"ethereum-cryptography/keccak":4224,"ethereum-cryptography/secp256k1":4241,"ethereum-cryptography/utils":4243},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.accountBodyToRLP=n.accountBodyToSlim=n.accountBodyFromSlim=n.isZeroAddress=n.zeroAddress=n.importPublic=n.privateToAddress=n.privateToPublic=n.publicToAddress=n.pubToAddress=n.isValidPublic=n.isValidPrivate=n.generateAddress2=n.generateAddress=n.isValidChecksumAddress=n.toChecksumAddress=n.isValidAddress=n.Account=void 0;const s=e("@ethereumjs/rlp"),r=e("ethereum-cryptography/keccak"),i=e("ethereum-cryptography/secp256k1"),a=e("ethereum-cryptography/utils"),o=e("./bytes"),c=e("./constants"),l=e("./helpers"),u=e("./internal"),d=BigInt(0);class h{constructor(e=d,t=d,n=c.KECCAK256_RLP,s=c.KECCAK256_NULL){this.nonce=e,this.balance=t,this.storageRoot=n,this.codeHash=s,this._validate()}static fromAccountData(e){const{nonce:t,balance:n,storageRoot:s,codeHash:r}=e;return new h(t!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(t)):undefined,n!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(n)):undefined,s!==undefined?(0,o.toBuffer)(s):undefined,r!==undefined?(0,o.toBuffer)(r):undefined)}static fromRlpSerializedAccount(e){const t=(0,o.arrToBufArr)(s.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(t))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(t)}static fromValuesArray(e){const[t,n,s,r]=e;return new h((0,o.bufferToBigInt)(t),(0,o.bufferToBigInt)(n),s,r)}_validate(){if(this.nonce<d)throw new Error("nonce must be greater than zero");if(this.balance<d)throw new Error("balance must be greater than zero");if(32!==this.storageRoot.length)throw new Error("storageRoot must have a length of 32");if(32!==this.codeHash.length)throw new Error("codeHash must have a length of 32")}raw(){return[(0,o.bigIntToUnpaddedBuffer)(this.nonce),(0,o.bigIntToUnpaddedBuffer)(this.balance),this.storageRoot,this.codeHash]}serialize(){return t.from(s.RLP.encode((0,o.bufArrToArr)(this.raw())))}isContract(){return!this.codeHash.equals(c.KECCAK256_NULL)}isEmpty(){return this.balance===d&&this.nonce===d&&this.codeHash.equals(c.KECCAK256_NULL)}}n.Account=h;n.isValidAddress=function(e){try{(0,l.assertIsString)(e)}catch(e){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};n.toChecksumAddress=function(e,n){(0,l.assertIsHexString)(e);const s=(0,u.stripHexPrefix)(e).toLowerCase();let i="";if(n!==undefined){i=(0,o.bufferToBigInt)((0,o.toBuffer)(n)).toString()+"0x"}const c=t.from(i+s,"utf8"),d=(0,a.bytesToHex)((0,r.keccak256)(c));let h="0x";for(let e=0;e<s.length;e++)parseInt(d[e],16)>=8?h+=s[e].toUpperCase():h+=s[e];return h};n.isValidChecksumAddress=function(e,t){return(0,n.isValidAddress)(e)&&(0,n.toChecksumAddress)(e,t)===e};n.generateAddress=function(e,n){return(0,l.assertIsBuffer)(e),(0,l.assertIsBuffer)(n),(0,o.bufferToBigInt)(n)===BigInt(0)?t.from((0,r.keccak256)(s.RLP.encode((0,o.bufArrToArr)([e,null])))).slice(-20):t.from((0,r.keccak256)(s.RLP.encode((0,o.bufArrToArr)([e,n])))).slice(-20)};n.generateAddress2=function(e,n,s){if((0,l.assertIsBuffer)(e),(0,l.assertIsBuffer)(n),(0,l.assertIsBuffer)(s),20!==e.length)throw new Error("Expected from to be of length 20");if(32!==n.length)throw new Error("Expected salt to be of length 32");const i=(0,r.keccak256)(t.concat([t.from("ff","hex"),e,n,(0,r.keccak256)(s)]));return(0,o.toBuffer)(i).slice(-20)};n.isValidPrivate=function(e){return i.secp256k1.utils.isValidPrivateKey(e)};n.isValidPublic=function(e,n=!1){if((0,l.assertIsBuffer)(e),64===e.length)try{return i.secp256k1.ProjectivePoint.fromHex(t.concat([t.from([4]),e])),!0}catch(e){return!1}if(!n)return!1;try{return i.secp256k1.ProjectivePoint.fromHex(e),!0}catch(e){return!1}};n.pubToAddress=function(e,n=!1){if((0,l.assertIsBuffer)(e),n&&64!==e.length&&(e=t.from(i.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),64!==e.length)throw new Error("Expected pubKey to be of length 64");return t.from((0,r.keccak256)(e)).slice(-20)},n.publicToAddress=n.pubToAddress;n.privateToPublic=function(e){return(0,l.assertIsBuffer)(e),t.from(i.secp256k1.ProjectivePoint.fromPrivateKey(e).toRawBytes(!1).slice(1))};n.privateToAddress=function(e){return(0,n.publicToAddress)((0,n.privateToPublic)(e))};n.importPublic=function(e){return(0,l.assertIsBuffer)(e),64!==e.length&&(e=t.from(i.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),e};n.zeroAddress=function(){const e=(0,o.zeros)(20);return(0,o.bufferToHex)(e)};function f(e){const[t,n,s,r]=e;return[t,n,0===(0,o.arrToBufArr)(s).length?c.KECCAK256_RLP:s,0===(0,o.arrToBufArr)(r).length?c.KECCAK256_NULL:r]}n.isZeroAddress=function(e){try{(0,l.assertIsString)(e)}catch(e){return!1}return(0,n.zeroAddress)()===e},n.accountBodyFromSlim=f;const p=new Uint8Array(0);n.accountBodyToSlim=function(e){const[t,n,s,r]=e;return[t,n,(0,o.arrToBufArr)(s).equals(c.KECCAK256_RLP)?p:s,(0,o.arrToBufArr)(r).equals(c.KECCAK256_NULL)?p:r]},n.accountBodyToRLP=function(e,t=!0){const n=t?f(e):e;return(0,o.arrToBufArr)(s.RLP.encode(n))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/account.js"}],[1974,{"./account":1973,"./bytes":1976,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.Address=void 0;const s=e("./account"),r=e("./bytes");class i{constructor(e){if(20!==e.length)throw new Error("Invalid address length");this.buf=e}static zero(){return new i((0,r.zeros)(20))}static fromString(e){if(!(0,s.isValidAddress)(e))throw new Error("Invalid address");return new i((0,r.toBuffer)(e))}static fromPublicKey(e){if(!t.isBuffer(e))throw new Error("Public key should be Buffer");const n=(0,s.pubToAddress)(e);return new i(n)}static fromPrivateKey(e){if(!t.isBuffer(e))throw new Error("Private key should be Buffer");const n=(0,s.privateToAddress)(e);return new i(n)}static generate(e,t){if("bigint"!=typeof t)throw new Error("Expected nonce to be a bigint");return new i((0,s.generateAddress)(e.buf,(0,r.bigIntToBuffer)(t)))}static generate2(e,n,r){if(!t.isBuffer(n))throw new Error("Expected salt to be a Buffer");if(!t.isBuffer(r))throw new Error("Expected initCode to be a Buffer");return new i((0,s.generateAddress2)(e.buf,n,r))}equals(e){return this.buf.equals(e.buf)}isZero(){return this.equals(i.zero())}isPrecompileOrSystemAddress(){const e=(0,r.bufferToBigInt)(this.buf),t=BigInt(0),n=BigInt("0xffff");return e>=t&&e<=n}toString(){return"0x"+this.buf.toString("hex")}toBuffer(){return t.from(this.buf)}}n.Address=i}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/address.js"}],[1975,{events:4323},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AsyncEventEmitter=void 0;const s=e("events");class r extends s.EventEmitter{emit(e,...t){let[n,s]=t;const r=this;let i=r._events[e]??[];return s===undefined&&"function"==typeof n&&(s=n,n=undefined),"newListener"!==e&&"removeListener"!==e||(n={event:n,fn:s},s=undefined),i=Array.isArray(i)?i:[i],async function(e,t,n){let s;for await(const r of t)try{r.length<2?r.call(e,n):await new Promise(((t,s)=>{r.call(e,n,(e=>{e?s(e):t()}))}))}catch(e){s=e}if(s)throw s}(r,i.slice(),n).then(s).catch(s),r.listenerCount(e)>0}once(e,t){const n=this;let s;if("function"!=typeof t)throw new TypeError("listener must be a function");return s=t.length>=2?function(r,i){n.removeListener(e,s),t(r,i)}:function(r){n.removeListener(e,s),t(r,s)},n.on(e,s),n}first(e,t){let n=this._events[e]??[];if("function"!=typeof t)throw new TypeError("listener must be a function");return Array.isArray(n)||(this._events[e]=n=[n]),n.unshift(t),this}before(e,t,n){return this.beforeOrAfter(e,t,n)}after(e,t,n){return this.beforeOrAfter(e,t,n,"after")}beforeOrAfter(e,t,n,s){let r,i,a=this._events[e]??[];const o="after"===s?1:0;if("function"!=typeof n)throw new TypeError("listener must be a function");if("function"!=typeof t)throw new TypeError("target must be a function");for(Array.isArray(a)||(this._events[e]=a=[a]),i=a.length,r=a.length;r--;)if(a[r]===t){i=r+o;break}return a.splice(i,0,n),this}on(e,t){return super.on(e,t)}addListener(e,t){return super.addListener(e,t)}prependListener(e,t){return super.prependListener(e,t)}prependOnceListener(e,t){return super.prependOnceListener(e,t)}removeAllListeners(e){return super.removeAllListeners(e)}removeListener(e,t){return super.removeListener(e,t)}eventNames(){return super.eventNames()}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}getMaxListeners(){return super.getMaxListeners()}setMaxListeners(e){return super.setMaxListeners(e)}}n.AsyncEventEmitter=r}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/asyncEventEmitter.js"}],[1976,{"./helpers":1979,"./internal":1981,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.intToUnpaddedBuffer=n.bigIntToUnpaddedBuffer=n.bigIntToHex=n.bufArrToArr=n.arrToBufArr=n.validateNoLeadingZeroes=n.baToJSON=n.toUtf8=n.short=n.addHexPrefix=n.toUnsigned=n.fromSigned=n.bufferToInt=n.bigIntToBuffer=n.bufferToBigInt=n.bufferToHex=n.toBuffer=n.unpadHexString=n.unpadArray=n.unpadBuffer=n.setLengthRight=n.setLengthLeft=n.zeros=n.intToBuffer=n.intToHex=void 0;const s=e("./helpers"),r=e("./internal");n.intToHex=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};n.intToBuffer=function(e){const s=(0,n.intToHex)(e);return t.from((0,r.padToEven)(s.slice(2)),"hex")};n.zeros=function(e){return t.allocUnsafe(e).fill(0)};const i=function(e,t,s){const r=(0,n.zeros)(t);return s?e.length<t?(e.copy(r),r):e.slice(0,t):e.length<t?(e.copy(r,t-e.length),r):e.slice(-t)};n.setLengthLeft=function(e,t){return(0,s.assertIsBuffer)(e),i(e,t,!1)};n.setLengthRight=function(e,t){return(0,s.assertIsBuffer)(e),i(e,t,!0)};const a=function(e){let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e};n.unpadBuffer=function(e){return(0,s.assertIsBuffer)(e),a(e)};n.unpadArray=function(e){return(0,s.assertIsArray)(e),a(e)};n.unpadHexString=function(e){return(0,s.assertIsHexString)(e),e=(0,r.stripHexPrefix)(e),"0x"+a(e)};n.toBuffer=function(e){if(null===e||e===undefined)return t.allocUnsafe(0);if(t.isBuffer(e))return t.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return t.from(e);if("string"==typeof e){if(!(0,r.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return t.from((0,r.padToEven)((0,r.stripHexPrefix)(e)),"hex")}if("number"==typeof e)return(0,n.intToBuffer)(e);if("bigint"==typeof e){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let n=e.toString(16);return n.length%2&&(n="0"+n),t.from(n,"hex")}if(e.toArray)return t.from(e.toArray());if(e.toBuffer)return t.from(e.toBuffer());throw new Error("invalid type")};function o(e){const t=(0,n.bufferToHex)(e);return"0x"===t?BigInt(0):BigInt(t)}function c(e){return(0,n.toBuffer)("0x"+e.toString(16))}n.bufferToHex=function(e){return"0x"+(e=(0,n.toBuffer)(e)).toString("hex")},n.bufferToBigInt=o,n.bigIntToBuffer=c;n.bufferToInt=function(e){const t=Number(o(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};n.fromSigned=function(e){return BigInt.asIntN(256,o(e))};n.toUnsigned=function(e){return c(BigInt.asUintN(256,e))};n.addHexPrefix=function(e){return"string"!=typeof e||(0,r.isHexPrefixed)(e)?e:"0x"+e},n.short=function(e,n=50){const s=t.isBuffer(e)?e.toString("hex"):e;return s.length<=n?s:s.slice(0,n)+"â€¦"};n.toUtf8=function(e){if((e=(0,r.stripHexPrefix)(e)).length%2!=0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return t.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};n.baToJSON=function(e){if(t.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){const t=[];for(let s=0;s<e.length;s++)t.push((0,n.baToJSON)(e[s]));return t}};n.validateNoLeadingZeroes=function(e){for(const[t,n]of Object.entries(e))if(n!==undefined&&n.length>0&&0===n[0])throw new Error(`${t} cannot have leading zeroes, received: ${n.toString("hex")}`)},n.arrToBufArr=function e(n){return Array.isArray(n)?n.map((t=>e(t))):t.from(n)},n.bufArrToArr=function e(t){return Array.isArray(t)?t.map((t=>e(t))):Uint8Array.from(t??[])};n.bigIntToHex=e=>"0x"+e.toString(16),n.bigIntToUnpaddedBuffer=function(e){return(0,n.unpadBuffer)(c(e))},n.intToUnpaddedBuffer=function(e){return(0,n.unpadBuffer)((0,n.intToBuffer)(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/bytes.js"}],[1977,{buffer:3998,"ethereum-cryptography/secp256k1":4241},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_WITHDRAWALS_PER_PAYLOAD=n.RLP_EMPTY_STRING=n.KECCAK256_RLP=n.KECCAK256_RLP_S=n.KECCAK256_RLP_ARRAY=n.KECCAK256_RLP_ARRAY_S=n.KECCAK256_NULL=n.KECCAK256_NULL_S=n.TWO_POW256=n.SECP256K1_ORDER_DIV_2=n.SECP256K1_ORDER=n.MAX_INTEGER_BIGINT=n.MAX_INTEGER=n.MAX_UINT64=void 0;const s=e("buffer"),r=e("ethereum-cryptography/secp256k1");n.MAX_UINT64=BigInt("0xffffffffffffffff"),n.MAX_INTEGER=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n.MAX_INTEGER_BIGINT=BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),n.SECP256K1_ORDER=r.secp256k1.CURVE.n,n.SECP256K1_ORDER_DIV_2=r.secp256k1.CURVE.n/BigInt(2),n.TWO_POW256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),n.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",n.KECCAK256_NULL=s.Buffer.from(n.KECCAK256_NULL_S,"hex"),n.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",n.KECCAK256_RLP_ARRAY=s.Buffer.from(n.KECCAK256_RLP_ARRAY_S,"hex"),n.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",n.KECCAK256_RLP=s.Buffer.from(n.KECCAK256_RLP_S,"hex"),n.RLP_EMPTY_STRING=s.Buffer.from([128]),n.MAX_WITHDRAWALS_PER_PAYLOAD=16}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/constants.js"}],[1978,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.compactBytesToNibbles=n.bytesToNibbles=n.nibblesToCompactBytes=n.nibblesToBytes=n.hasTerminator=void 0;n.hasTerminator=e=>e.length>0&&16===e[e.length-1];n.nibblesToBytes=(e,t)=>{for(let n=0,s=0;s<e.length;n+=1,s+=2)t[n]=e[s]<<4|e[s+1]};n.nibblesToCompactBytes=e=>{let t=0;(0,n.hasTerminator)(e)&&(t=1,e=e.subarray(0,e.length-1));const s=new Uint8Array(e.length/2+1);return s[0]=t<<5,1&~e.length||(s[0]|=16,s[0]|=e[0],e=e.subarray(1)),(0,n.nibblesToBytes)(e,s.subarray(1)),s};n.bytesToNibbles=e=>{const t=2*e.length+1,n=new Uint8Array(t);for(let t=0;t<e.length;t++){const s=e[t];n[2*t]=s/16,n[2*t+1]=s%16}return n[t-1]=16,n};n.compactBytesToNibbles=e=>{if(0===e.length)return e;let t=(0,n.bytesToNibbles)(e);t[0]<2&&(t=t.subarray(0,t.length-1));const s=2-(1&t[0]);return t.subarray(s)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/encoding.js"}],[1979,{"../../../../../../../../../is-buffer/index.js":4581,"./internal":1981},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.assertIsString=n.assertIsArray=n.assertIsBuffer=n.assertIsHexString=void 0;const s=e("./internal");n.assertIsHexString=function(e){if(!(0,s.isHexString)(e)){throw new Error(`This method only supports 0x-prefixed hex strings but input was: ${e}`)}};n.assertIsBuffer=function(e){if(!t.isBuffer(e)){throw new Error(`This method only supports Buffer but input was: ${e}`)}};n.assertIsArray=function(e){if(!Array.isArray(e)){throw new Error(`This method only supports number arrays but input was: ${e}`)}};n.assertIsString=function(e){if("string"!=typeof e){throw new Error(`This method only supports strings but input was: ${e}`)}}}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/helpers.js"}],[198,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/transaction-controller"),r=e("lodash");n.default={version:15,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=15;try{const e=function(e){const t=e,{TransactionController:n}=t;if(n&&n.transactions){const{transactions:e}=n;t.TransactionController.transactions=e.map((e=>e.err?("Gave up submitting tx."===e.err.message&&(e.status=s.TransactionStatus.failed),e):e))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #15${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/015.js"}],[1980,{"./account":1973,"./address":1974,"./asyncEventEmitter":1975,"./bytes":1976,"./constants":1977,"./encoding":1978,"./internal":1981,"./lock":1982,"./provider":1983,"./signature":1984,"./types":1985,"./units":1986,"./withdrawal":1987},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.toAscii=n.stripHexPrefix=n.padToEven=n.isHexString=n.isHexPrefixed=n.getKeys=n.getBinarySize=n.fromUtf8=n.fromAscii=n.arrayContainsArray=void 0,r(e("./constants"),n),r(e("./units"),n),r(e("./account"),n),r(e("./address"),n),r(e("./withdrawal"),n),r(e("./signature"),n),r(e("./bytes"),n),r(e("./types"),n),r(e("./encoding"),n),r(e("./asyncEventEmitter"),n);var i=e("./internal");Object.defineProperty(n,"arrayContainsArray",{enumerable:!0,get:function(){return i.arrayContainsArray}}),Object.defineProperty(n,"fromAscii",{enumerable:!0,get:function(){return i.fromAscii}}),Object.defineProperty(n,"fromUtf8",{enumerable:!0,get:function(){return i.fromUtf8}}),Object.defineProperty(n,"getBinarySize",{enumerable:!0,get:function(){return i.getBinarySize}}),Object.defineProperty(n,"getKeys",{enumerable:!0,get:function(){return i.getKeys}}),Object.defineProperty(n,"isHexPrefixed",{enumerable:!0,get:function(){return i.isHexPrefixed}}),Object.defineProperty(n,"isHexString",{enumerable:!0,get:function(){return i.isHexString}}),Object.defineProperty(n,"padToEven",{enumerable:!0,get:function(){return i.padToEven}}),Object.defineProperty(n,"stripHexPrefix",{enumerable:!0,get:function(){return i.stripHexPrefix}}),Object.defineProperty(n,"toAscii",{enumerable:!0,get:function(){return i.toAscii}}),r(e("./lock"),n),r(e("./provider"),n)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/index.js"}],[1981,{buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(e){(function(){function t(e){if("string"!=typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type "+typeof e);return"0"===e[0]&&"x"===e[1]}Object.defineProperty(n,"__esModule",{value:!0}),n.isHexString=n.getKeys=n.fromAscii=n.fromUtf8=n.toAscii=n.arrayContainsArray=n.getBinarySize=n.padToEven=n.stripHexPrefix=n.isHexPrefixed=void 0,n.isHexPrefixed=t;function s(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received "+typeof t);return t.length%2&&(t=`0${t}`),t}n.stripHexPrefix=e=>{if("string"!=typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received "+typeof e);return t(e)?e.slice(2):e},n.padToEven=s,n.getBinarySize=function(t){if("string"!=typeof t)throw new Error("[getBinarySize] method requires input type 'string', received "+typeof t);return e.byteLength(t,"utf8")},n.arrayContainsArray=function(e,t,n){if(!0!==Array.isArray(e))throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(!0!==Array.isArray(t))throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[!0===n?"some":"every"]((t=>e.indexOf(t)>=0))},n.toAscii=function(e){let t="",n=0;const s=e.length;for("0x"===e.substring(0,2)&&(n=2);n<s;n+=2){const s=parseInt(e.substr(n,2),16);t+=String.fromCharCode(s)}return t},n.fromUtf8=function(t){return`0x${s(e.from(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")}`},n.fromAscii=function(e){let t="";for(let n=0;n<e.length;n++){const s=e.charCodeAt(n).toString(16);t+=s.length<2?`0${s}`:s}return`0x${t}`},n.getKeys=function(e,t,n){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got "+typeof e);if("string"!=typeof t)throw new Error("[getKeys] method expects input 'key' to be type 'string', got "+typeof e);const s=[];for(let r=0;r<e.length;r++){let i=e[r][t];if(!0!==n||i){if("string"!=typeof i)throw new Error("invalid abi - expected type 'string', received "+typeof i)}else i="";s.push(i)}return s},n.isHexString=function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&!(void 0!==t&&t>0&&e.length!==2+2*t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/internal.js"}],[1982,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Lock=void 0;n.Lock=class{constructor(){this.permits=1,this.promiseResolverQueue=[]}async acquire(){return this.permits>0?(this.permits-=1,Promise.resolve(!0)):new Promise((e=>this.promiseResolverQueue.push(e)))}release(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)console.warn("Lock.permits should never be > 0 when there is someone waiting.");else if(1===this.permits&&this.promiseResolverQueue.length>0){this.permits-=1;const e=this.promiseResolverQueue.shift();e&&e(!0)}}}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/lock.js"}],[1983,{"micro-ftch":4834},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getProvider=n.fetchFromProvider=void 0;const s=e("micro-ftch");n.fetchFromProvider=async(e,t)=>(await(0,s.default)(e,{headers:{"content-type":"application/json"},type:"json",data:{method:t.method,params:t.params,jsonrpc:"2.0",id:1}})).result;n.getProvider=e=>{if("string"==typeof e)return e;if(e?.connection?.url!==undefined)return e.connection.url;throw new Error("Must provide valid provider URL or Web3Provider")}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/provider.js"}],[1984,{"./bytes":1976,"./constants":1977,"./helpers":1979,buffer:3998,"ethereum-cryptography/keccak":4224,"ethereum-cryptography/secp256k1":4241},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.hashPersonalMessage=n.isValidSignature=n.fromRpcSig=n.toCompactSig=n.toRpcSig=n.ecrecover=n.ecsign=void 0;const s=e("ethereum-cryptography/keccak"),r=e("ethereum-cryptography/secp256k1"),i=e("./bytes"),a=e("./constants"),o=e("./helpers");function c(e,t){return e===BigInt(0)||e===BigInt(1)?e:t===undefined?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}function l(e){return e===BigInt(0)||e===BigInt(1)}n.ecsign=function(e,n,s){const i=r.secp256k1.sign(e,n),a=i.toCompactRawBytes();return{r:t.from(a.slice(0,32)),s:t.from(a.slice(32,64)),v:s===undefined?BigInt(i.recovery+27):BigInt(i.recovery+35)+BigInt(s)*BigInt(2)}};n.ecrecover=function(e,n,s,a,o){const u=t.concat([(0,i.setLengthLeft)(s,32),(0,i.setLengthLeft)(a,32)],64),d=c(n,o);if(!l(d))throw new Error("Invalid signature v value");const h=r.secp256k1.Signature.fromCompact(u).addRecoveryBit(Number(d)).recoverPublicKey(e);return t.from(h.toRawBytes(!1).slice(1))};n.toRpcSig=function(e,n,s,r){if(!l(c(e,r)))throw new Error("Invalid signature v value");return(0,i.bufferToHex)(t.concat([(0,i.setLengthLeft)(n,32),(0,i.setLengthLeft)(s,32),(0,i.toBuffer)(e)]))};n.toCompactSig=function(e,n,s,r){if(!l(c(e,r)))throw new Error("Invalid signature v value");let a=s;return(e>BigInt(28)&&e%BigInt(2)===BigInt(1)||e===BigInt(1)||e===BigInt(28))&&(a=t.from(s),a[0]|=128),(0,i.bufferToHex)(t.concat([(0,i.setLengthLeft)(n,32),(0,i.setLengthLeft)(a,32)]))};n.fromRpcSig=function(e){const t=(0,i.toBuffer)(e);let n,s,r;if(t.length>=65)n=t.slice(0,32),s=t.slice(32,64),r=(0,i.bufferToBigInt)(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");n=t.slice(0,32),s=t.slice(32,64),r=BigInt((0,i.bufferToInt)(t.slice(32,33))>>7),s[0]&=127}return r<27&&(r+=BigInt(27)),{v:r,r:n,s:s}};n.isValidSignature=function(e,t,n,s=!0,r){if(32!==t.length||32!==n.length)return!1;if(!l(c(e,r)))return!1;const o=(0,i.bufferToBigInt)(t),u=(0,i.bufferToBigInt)(n);return!(o===BigInt(0)||o>=a.SECP256K1_ORDER||u===BigInt(0)||u>=a.SECP256K1_ORDER)&&!(s&&u>=a.SECP256K1_ORDER_DIV_2)};n.hashPersonalMessage=function(e){(0,o.assertIsBuffer)(e);const n=t.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return t.from((0,s.keccak256)(t.concat([n,e])))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/signature.js"}],[1985,{"./bytes":1976,"./internal":1981},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toType=n.TypeOutput=void 0;const s=e("./bytes"),r=e("./internal");var i;!function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(i=n.TypeOutput||(n.TypeOutput={})),n.toType=function(e,t){if(null===e)return null;if(e===undefined)return undefined;if("string"==typeof e&&!(0,r.isHexString)(e))throw new Error(`A string must be provided with a 0x-prefix, given: ${e}`);if("number"==typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const n=(0,s.toBuffer)(e);switch(t){case i.Buffer:return n;case i.BigInt:return(0,s.bufferToBigInt)(n);case i.Number:{const e=(0,s.bufferToBigInt)(n);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case i.PrefixedHexString:return(0,s.bufferToHex)(n);default:throw new Error("unknown outputType")}}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/types.js"}],[1986,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GWEI_TO_WEI=void 0,n.GWEI_TO_WEI=BigInt(1e9)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/units.js"}],[1987,{"./address":1974,"./bytes":1976,"./types":1985,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.Withdrawal=void 0;const s=e("./address"),r=e("./bytes"),i=e("./types");class a{constructor(e,t,n,s){this.index=e,this.validatorIndex=t,this.address=n,this.amount=s}static fromWithdrawalData(e){const{index:t,validatorIndex:n,address:r,amount:o}=e,c=(0,i.toType)(t,i.TypeOutput.BigInt),l=(0,i.toType)(n,i.TypeOutput.BigInt),u=new s.Address((0,i.toType)(r,i.TypeOutput.Buffer)),d=(0,i.toType)(o,i.TypeOutput.BigInt);return new a(c,l,u,d)}static fromValuesArray(e){if(4!==e.length)throw Error(`Invalid withdrawalArray length expected=4 actual=${e.length}`);const[t,n,s,r]=e;return a.fromWithdrawalData({index:t,validatorIndex:n,address:s,amount:r})}static toBufferArray(e){const{index:n,validatorIndex:r,address:a,amount:o}=e,c=(0,i.toType)(n,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(n,i.TypeOutput.Buffer),l=(0,i.toType)(r,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(r,i.TypeOutput.Buffer);let u;u=a instanceof s.Address?a.buf:(0,i.toType)(a,i.TypeOutput.Buffer);return[c,l,u,(0,i.toType)(o,i.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,i.toType)(o,i.TypeOutput.Buffer)]}raw(){return a.toBufferArray(this)}toValue(){return{index:this.index,validatorIndex:this.validatorIndex,address:this.address.buf,amount:this.amount}}toJSON(){return{index:(0,r.bigIntToHex)(this.index),validatorIndex:(0,r.bigIntToHex)(this.validatorIndex),address:"0x"+this.address.buf.toString("hex"),amount:(0,r.bigIntToHex)(this.amount)}}}n.Withdrawal=a}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@ethereumjs/util",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry-eth/node_modules/@ethereumjs/util/dist/withdrawal.js"}],[1988,{"./RegistryItem":1999,"./RegistryType":2e3,"./lib":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Bytes=void 0;const s=e("./lib"),r=e("./RegistryItem"),i=e("./RegistryType");class a extends r.RegistryItem{constructor(e){super(),this.bytes=e,this.getRegistryType=()=>i.RegistryTypes.BYTES,this.getData=()=>this.bytes,this.toDataItem=()=>new s.DataItem(this.bytes)}}n.Bytes=a,a.fromDataItem=e=>{const t=e.getData();if(!t)throw new Error(`#[ur-registry][Bytes][fn.fromDataItem]: decoded [dataItem][#data] is undefined: ${e}`);return new a(t)},a.fromCBOR=e=>{const t=(0,s.decodeToDataItem)(e);return a.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/Bytes.js"}],[1989,{".":2007,"./RegistryItem":1999,"./RegistryType":2e3,"./lib":2010,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoAccount=void 0;const s=e("."),r=e("./lib"),i=e("./RegistryItem"),a=e("./RegistryType");var o;!function(e){e[e.masterFingerprint=1]="masterFingerprint",e[e.outputDescriptors=2]="outputDescriptors"}(o||(o={}));class c extends i.RegistryItem{constructor(e,t){super(),this.masterFingerprint=e,this.outputDescriptors=t,this.getRegistryType=()=>a.RegistryTypes.CRYPTO_ACCOUNT,this.getMasterFingerprint=()=>this.masterFingerprint,this.getOutputDescriptors=()=>this.outputDescriptors,this.toDataItem=()=>{const e={};return this.masterFingerprint&&(e[o.masterFingerprint]=this.masterFingerprint.readUInt32BE(0)),this.outputDescriptors&&(e[o.outputDescriptors]=this.outputDescriptors.map((e=>e.toDataItem()))),new r.DataItem(e)}}}n.CryptoAccount=c,c.fromDataItem=e=>{const n=e.getData(),r=t.alloc(4),i=n[o.masterFingerprint];i&&r.writeUInt32BE(i,0);const a=n[o.outputDescriptors].map((e=>s.CryptoOutput.fromDataItem(e)));return new c(r,a)},c.fromCBOR=e=>{const t=(0,r.decodeToDataItem)(e);return c.fromDataItem(t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/CryptoAccount.js"}],[199,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/transaction-controller"),r=e("lodash");n.default={version:16,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=16;try{const e=function(e){const t=e,{TransactionController:n}=t;if(n&&n.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>e.err?("transaction with the same hash was already imported."===e.err&&(e.status=s.TransactionStatus.submitted,delete e.err),e):e))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #16${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/016.js"}],[1990,{"./RegistryItem":1999,"./RegistryType":2e3,"./lib":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoCoinInfo=n.Network=n.Type=void 0;const s=e("./lib"),r=e("./RegistryItem"),i=e("./RegistryType");var a,o,c;!function(e){e.type="1",e.network="2"}(a||(a={})),function(e){e[e.bitcoin=0]="bitcoin"}(o=n.Type||(n.Type={})),function(e){e[e.mainnet=0]="mainnet",e[e.testnet=1]="testnet"}(c=n.Network||(n.Network={}));class l extends r.RegistryItem{constructor(e,t){super(),this.type=e,this.network=t,this.getRegistryType=()=>i.RegistryTypes.CRYPTO_COIN_INFO,this.getType=()=>this.type||o.bitcoin,this.getNetwork=()=>this.network||c.mainnet,this.toDataItem=()=>{const e={};return this.type&&(e[a.type]=this.type),this.network&&(e[a.network]=this.network),new s.DataItem(e)}}}n.CryptoCoinInfo=l,l.fromDataItem=e=>{const t=e.getData(),n=t[a.type],s=t[a.network];return new l(n,s)},l.fromCBOR=e=>{const t=(0,s.decodeToDataItem)(e);return l.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/CryptoCoinInfo.js"}],[1991,{"./RegistryItem":1999,"./RegistryType":2e3,"./lib":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoECKey=void 0;const s=e("./lib"),r=e("./RegistryItem"),i=e("./RegistryType");var a;!function(e){e[e.curve=1]="curve",e[e.private=2]="private",e[e.data=3]="data"}(a||(a={}));class o extends r.RegistryItem{constructor(e){super(),this.isECKey=()=>!0,this.getCurve=()=>this.curve||0,this.isPrivateKey=()=>this.privateKey||!1,this.getData=()=>this.data,this.getRegistryType=()=>i.RegistryTypes.CRYPTO_ECKEY,this.toDataItem=()=>{const e={};return this.curve&&(e[a.curve]=this.curve),this.privateKey!==undefined&&(e[a.private]=this.privateKey),e[a.data]=this.data,new s.DataItem(e)},this.getOutputDescriptorContent=()=>this.data.toString("hex"),this.data=e.data,this.curve=e.curve,this.privateKey=e.privateKey||undefined}}n.CryptoECKey=o,o.fromDataItem=e=>{const t=e.getData(),n=t[a.curve],s=t[a.private],r=t[a.data];if(!r)throw new Error(`#[ur-registry][CryptoECKey][fn.fromDataItem]: decoded [dataItem][#data.data] is undefined: ${e}`);return new o({data:r,curve:n,privateKey:s})},o.fromCBOR=e=>{const t=(0,s.decodeToDataItem)(e);return o.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/CryptoECKey.js"}],[1992,{"./CryptoCoinInfo":1990,"./CryptoKeypath":1993,"./RegistryItem":1999,"./RegistryType":2e3,"./lib":2010,bs58check:4001,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoHDKey=void 0;const s=e("bs58check"),r=e("./CryptoCoinInfo"),i=e("./CryptoKeypath"),a=e("./lib"),o=e("./RegistryItem"),c=e("./RegistryType");var l;!function(e){e[e.is_master=1]="is_master",e[e.is_private=2]="is_private",e[e.key_data=3]="key_data",e[e.chain_code=4]="chain_code",e[e.use_info=5]="use_info",e[e.origin=6]="origin",e[e.children=7]="children",e[e.parent_fingerprint=8]="parent_fingerprint",e[e.name=9]="name",e[e.note=10]="note"}(l||(l={}));class u extends o.RegistryItem{constructor(e){super(),this.isECKey=()=>!1,this.getKey=()=>this.key,this.getChainCode=()=>this.chainCode,this.isMaster=()=>this.master,this.isPrivateKey=()=>!!this.privateKey,this.getUseInfo=()=>this.useInfo,this.getOrigin=()=>this.origin,this.getChildren=()=>this.children,this.getParentFingerprint=()=>this.parentFingerprint,this.getName=()=>this.name,this.getNote=()=>this.note,this.getBip32Key=()=>{var e,n,r;let i,a,o=0,c=t.alloc(4).fill(0);if(this.isMaster())i=t.from("0488ADE4","hex"),a=0,o=0;else{a=(null===(e=this.getOrigin())||void 0===e?void 0:e.getComponents().length)||(null===(n=this.getOrigin())||void 0===n?void 0:n.getDepth());const s=null===(r=this.getOrigin())||void 0===r?void 0:r.getComponents(),l=s[s.length-1];l&&(o=l.isHardened()?l.getIndex()+2147483648:l.getIndex(),this.getParentFingerprint()&&(c=this.getParentFingerprint())),i=this.isPrivateKey()?t.from("0488ADE4","hex"):t.from("0488B21E","hex")}const l=t.alloc(1);l.writeUInt8(a,0);const u=t.alloc(4);u.writeUInt32BE(o,0);const d=this.getChainCode(),h=this.getKey();return(0,s.encode)(t.concat([i,l,c,u,d,h]))},this.getRegistryType=()=>c.RegistryTypes.CRYPTO_HDKEY,this.getOutputDescriptorContent=()=>{var e,t,n,s,r,i,a;let o="";return this.getOrigin()&&(null===(e=this.getOrigin())||void 0===e?void 0:e.getSourceFingerprint())&&(null===(t=this.getOrigin())||void 0===t?void 0:t.getPath())&&(o+=`${null===(s=null===(n=this.getOrigin())||void 0===n?void 0:n.getSourceFingerprint())||void 0===s?void 0:s.toString("hex")}/${null===(r=this.getOrigin())||void 0===r?void 0:r.getPath()}`),o+=this.getBip32Key(),this.getChildren()&&(null===(i=this.getChildren())||void 0===i?void 0:i.getPath())&&(o+=`/${null===(a=this.getChildren())||void 0===a?void 0:a.getPath()}`),o},this.setupMasterKey=e=>{this.master=!0,this.key=e.key,this.chainCode=e.chainCode},this.setupDeriveKey=e=>{this.master=!1,this.privateKey=e.isPrivateKey,this.key=e.key,this.chainCode=e.chainCode,this.useInfo=e.useInfo,this.origin=e.origin,this.children=e.children,this.parentFingerprint=e.parentFingerprint,this.name=e.name,this.note=e.note},this.toDataItem=()=>{const e={};if(this.master)e[l.is_master]=!0,e[l.key_data]=this.key,e[l.chain_code]=this.chainCode;else{if(this.privateKey!==undefined&&(e[l.is_private]=this.privateKey),e[l.key_data]=this.key,this.chainCode&&(e[l.chain_code]=this.chainCode),this.useInfo){const t=this.useInfo.toDataItem();t.setTag(this.useInfo.getRegistryType().getTag()),e[l.use_info]=t}if(this.origin){const t=this.origin.toDataItem();t.setTag(this.origin.getRegistryType().getTag()),e[l.origin]=t}if(this.children){const t=this.children.toDataItem();t.setTag(this.children.getRegistryType().getTag()),e[l.children]=t}this.parentFingerprint&&(e[l.parent_fingerprint]=this.parentFingerprint.readUInt32BE(0)),this.name!==undefined&&(e[l.name]=this.name),this.note!==undefined&&(e[l.note]=this.note)}return new a.DataItem(e)},e.isMaster?this.setupMasterKey(e):this.setupDeriveKey(e)}}n.CryptoHDKey=u,u.fromDataItem=e=>{const n=e.getData(),s=!!n[l.is_master],a=n[l.is_private],o=n[l.key_data],c=n[l.chain_code],d=n[l.use_info]?r.CryptoCoinInfo.fromDataItem(n[l.use_info]):undefined,h=n[l.origin]?i.CryptoKeypath.fromDataItem(n[l.origin]):undefined,f=n[l.children]?i.CryptoKeypath.fromDataItem(n[l.children]):undefined,p=n[l.parent_fingerprint];let m=undefined;p&&(m=t.alloc(4),m.writeUInt32BE(p,0));const g=n[l.name],y=n[l.note];return new u({isMaster:s,isPrivateKey:a,key:o,chainCode:c,useInfo:d,origin:h,children:f,parentFingerprint:m,name:g,note:y})},u.fromCBOR=e=>{const t=(0,a.decodeToDataItem)(e);return u.fromDataItem(t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/CryptoHDKey.js"}],[1993,{"./PathComponent":1998,"./RegistryItem":1999,"./RegistryType":2e3,"./lib":2010,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoKeypath=void 0;const s=e("./lib"),r=e("./PathComponent"),i=e("./RegistryItem"),a=e("./RegistryType");var o;!function(e){e[e.components=1]="components",e[e.source_fingerprint=2]="source_fingerprint",e[e.depth=3]="depth"}(o||(o={}));class c extends i.RegistryItem{constructor(e=[],t,n){super(),this.components=e,this.sourceFingerprint=t,this.depth=n,this.getRegistryType=()=>a.RegistryTypes.CRYPTO_KEYPATH,this.getPath=()=>{if(0===this.components.length)return undefined;return this.components.map((e=>`${e.isWildcard()?"*":e.getIndex()}${e.isHardened()?"'":""}`)).join("/")},this.getComponents=()=>this.components,this.getSourceFingerprint=()=>this.sourceFingerprint,this.getDepth=()=>this.depth,this.toDataItem=()=>{const e={},t=[];return this.components&&this.components.forEach((e=>{e.isWildcard()?t.push([]):t.push(e.getIndex()),t.push(e.isHardened())})),e[o.components]=t,this.sourceFingerprint&&(e[o.source_fingerprint]=this.sourceFingerprint.readUInt32BE(0)),this.depth!==undefined&&(e[o.depth]=this.depth),new s.DataItem(e)}}}n.CryptoKeypath=c,c.fromDataItem=e=>{const n=e.getData(),s=[],i=n[o.components];if(i)for(let e=0;e<i.length;e+=2){const t=i[e+1],n=i[e];"number"==typeof n?s.push(new r.PathComponent({index:n,hardened:t})):s.push(new r.PathComponent({hardened:t}))}const a=n[o.source_fingerprint];let l;a&&(l=t.alloc(4),l.writeUInt32BE(a,0));const u=n[o.depth];return new c(s,l,u)},c.fromCBOR=e=>{const t=(0,s.decodeToDataItem)(e);return c.fromDataItem(t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/CryptoKeypath.js"}],[1994,{"./CryptoECKey":1991,"./CryptoHDKey":1992,"./MultiKey":1997,"./RegistryItem":1999,"./RegistryType":2e3,"./ScriptExpression":2001,"./lib":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoOutput=void 0;const s=e("./CryptoECKey"),r=e("./CryptoHDKey"),i=e("./lib"),a=e("./MultiKey"),o=e("./RegistryItem"),c=e("./RegistryType"),l=e("./ScriptExpression");class u extends o.RegistryItem{constructor(e,t){super(),this.scriptExpressions=e,this.cryptoKey=t,this.getRegistryType=()=>c.RegistryTypes.CRYPTO_OUTPUT,this.getCryptoKey=()=>this.cryptoKey,this.getHDKey=()=>this.cryptoKey instanceof r.CryptoHDKey?this.cryptoKey:undefined,this.getECKey=()=>this.cryptoKey instanceof s.CryptoECKey?this.cryptoKey:undefined,this.getMultiKey=()=>this.cryptoKey instanceof a.MultiKey?this.cryptoKey:undefined,this.getScriptExpressions=()=>this.scriptExpressions,this._toOutputDescriptor=e=>e>=this.scriptExpressions.length?this.cryptoKey.getOutputDescriptorContent():`${this.scriptExpressions[e].getExpression()}(${this._toOutputDescriptor(e+1)})`,this.toString=()=>this._toOutputDescriptor(0),this.toDataItem=()=>{let e=this.cryptoKey.toDataItem();(this.cryptoKey instanceof s.CryptoECKey||this.cryptoKey instanceof r.CryptoHDKey)&&e.setTag(this.cryptoKey.getRegistryType().getTag());return[...this.scriptExpressions].reverse().forEach((t=>{const n=t.getTag();e.getTag()===undefined?e.setTag(n):e=new i.DataItem(e,n)})),e}}}n.CryptoOutput=u,u.fromDataItem=e=>{const t=[];let n=e;for(;;){let e=n.getTag();const s=l.ScriptExpression.fromTag(e);if(!s)break;if(t.push(s),!(n.getData()instanceof i.DataItem))break;n=n.getData(),e=n.getTag()}const o=t.length;if(o>0&&(t[o-1].getExpression()===l.ScriptExpressions.MULTISIG.getExpression()||t[o-1].getExpression()===l.ScriptExpressions.SORTED_MULTISIG.getExpression())){const e=a.MultiKey.fromDataItem(n);return new u(t,e)}if(n.getTag()===c.RegistryTypes.CRYPTO_HDKEY.getTag()){const e=r.CryptoHDKey.fromDataItem(n);return new u(t,e)}{const e=s.CryptoECKey.fromDataItem(n);return new u(t,e)}},u.fromCBOR=e=>{const t=(0,i.decodeToDataItem)(e);return u.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/CryptoOutput.js"}],[1995,{"./RegistryItem":1999,"./RegistryType":2e3,"./lib":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoPSBT=void 0;const s=e("./lib"),r=e("./RegistryItem"),i=e("./RegistryType");class a extends r.RegistryItem{constructor(e){super(),this.psbt=e,this.getRegistryType=()=>i.RegistryTypes.CRYPTO_PSBT,this.getPSBT=()=>this.psbt,this.toDataItem=()=>new s.DataItem(this.psbt)}}n.CryptoPSBT=a,a.fromDataItem=e=>{const t=e.getData();if(!t)throw new Error(`#[ur-registry][CryptoPSBT][fn.fromDataItem]: decoded [dataItem][#data] is undefined: ${e}`);return new a(t)},a.fromCBOR=e=>{const t=(0,s.decodeToDataItem)(e);return a.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/CryptoPSBT.js"}],[1996,{"..":2007,"../RegistryType":2e3,"../errors":2002,"@ngraveio/bc-ur":2893},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.URRegistryDecoder=void 0;const s=e("@ngraveio/bc-ur"),r=e(".."),i=e("../RegistryType"),a=e("../errors");class o extends s.URDecoder{constructor(){super(...arguments),this.resultRegistryType=()=>{const e=this.resultUR();switch(e.type){case i.RegistryTypes.BYTES.getType():return r.Bytes.fromCBOR(e.cbor);case i.RegistryTypes.CRYPTO_HDKEY.getType():return r.CryptoHDKey.fromCBOR(e.cbor);case i.RegistryTypes.CRYPTO_KEYPATH.getType():return r.CryptoKeypath.fromCBOR(e.cbor);case i.RegistryTypes.CRYPTO_COIN_INFO.getType():return r.CryptoCoinInfo.fromCBOR(e.cbor);case i.RegistryTypes.CRYPTO_ECKEY.getType():return r.CryptoECKey.fromCBOR(e.cbor);case i.RegistryTypes.CRYPTO_OUTPUT.getType():return r.CryptoOutput.fromCBOR(e.cbor);case i.RegistryTypes.CRYPTO_PSBT.getType():return r.CryptoPSBT.fromCBOR(e.cbor);case i.RegistryTypes.CRYPTO_ACCOUNT.getType():return r.CryptoAccount.fromCBOR(e.cbor);default:throw new a.UnknownURTypeError(`#[ur-registry][Decoder][fn.resultRegistryType]: registry type ${e.type} is not supported now`)}}}}n.URRegistryDecoder=o}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/Decoder/index.js"}],[1997,{"./CryptoECKey":1991,"./CryptoHDKey":1992,"./RegistryItem":1999,"./RegistryType":2e3,"./lib/DataItem":2008},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultiKey=void 0;const s=e("./CryptoECKey"),r=e("./CryptoHDKey"),i=e("./lib/DataItem"),a=e("./RegistryItem"),o=e("./RegistryType");var c;!function(e){e[e.threshold=1]="threshold",e[e.keys=2]="keys"}(c||(c={}));class l extends a.RegistryItem{constructor(e,t){super(),this.threshold=e,this.keys=t,this.getThreshold=()=>this.threshold,this.getKeys=()=>this.keys,this.toDataItem=()=>{const e={};e[c.threshold]=this.threshold;const t=this.keys.map((e=>{const t=e.toDataItem();return t.setTag(e.getRegistryType().getTag()),t}));return e[c.keys]=t,new i.DataItem(e)},this.getOutputDescriptorContent=()=>[this.getThreshold(),this.keys.map((e=>e.getOutputDescriptorContent())).join(",")].join(",")}}n.MultiKey=l,l.fromDataItem=e=>{const t=e.getData(),n=t[c.threshold],i=t[c.keys],a=[];return i.forEach((e=>{e.getTag()===o.RegistryTypes.CRYPTO_HDKEY.getTag()?a.push(r.CryptoHDKey.fromDataItem(e)):e.getTag()===o.RegistryTypes.CRYPTO_ECKEY.getTag()&&a.push(s.CryptoECKey.fromDataItem(e))})),new l(n,a)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/MultiKey.js"}],[1998,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PathComponent=void 0;class s{constructor(e){if(this.getIndex=()=>this.index,this.isWildcard=()=>this.wildcard,this.isHardened=()=>this.hardened,this.index=e.index,this.hardened=e.hardened,this.index!==undefined?this.wildcard=!1:this.wildcard=!0,this.index&&this.index&s.HARDENED_BIT)throw new Error(`#[ur-registry][PathComponent][fn.constructor]: Invalid index ${this.index} - most significant bit cannot be set`)}}n.PathComponent=s,s.HARDENED_BIT=2147483648}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/PathComponent.js"}],[1999,{"./lib":2010,"@ngraveio/bc-ur":2893},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RegistryItem=void 0;const s=e("@ngraveio/bc-ur"),r=e("./lib");n.RegistryItem=class{constructor(){this.toCBOR=()=>{if(this.toDataItem()===undefined)throw new Error(`#[ur-registry][RegistryItem][fn.toCBOR]: registry ${this.getRegistryType()}'s method toDataItem returns undefined`);return(0,r.encodeDataItem)(this.toDataItem())},this.toUR=()=>new s.UR(this.toCBOR(),this.getRegistryType().getType()),this.toUREncoder=(e,t,n)=>{const r=this.toUR();return new s.UREncoder(r,e,t,n)}}}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/RegistryItem.js"}],[20,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainBalancesControllerMessenger=function(e){return e.getRestricted({name:"MultichainBalancesController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved","AccountsController:accountBalancesUpdated","MultichainAssetsController:stateChange"],allowedActions:["AccountsController:listMultichainAccounts","SnapController:handleRequest","MultichainAssetsController:getState","KeyringController:getState"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-balances-controller-messenger.ts"}],[200,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/transaction-controller"),r=e("lodash");n.default={version:17,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=17;try{const e=function(e){const t=e,{TransactionController:n}=t;if(n&&n.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(!e.status===s.TransactionStatus.failed||e.retryCount>0&&e.retryCount<2&&(e.status=s.TransactionStatus.submitted,delete e.err),e)))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #17${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/017.js"}],[2e3,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RegistryTypes=n.RegistryType=void 0;class s{constructor(e,t){this.type=e,this.tag=t,this.getTag=()=>this.tag,this.getType=()=>this.type}}n.RegistryType=s,n.RegistryTypes={UUID:new s("uuid",37),BYTES:new s("bytes",undefined),CRYPTO_HDKEY:new s("crypto-hdkey",303),CRYPTO_KEYPATH:new s("crypto-keypath",304),CRYPTO_COIN_INFO:new s("crypto-coin-info",305),CRYPTO_ECKEY:new s("crypto-eckey",306),CRYPTO_OUTPUT:new s("crypto-output",308),CRYPTO_PSBT:new s("crypto-psbt",310),CRYPTO_ACCOUNT:new s("crypto-account",311),CRYPTO_MULTI_ACCOUNTS:new s("crypto-multi-accounts",1103),QR_HARDWARE_CALL:new s("qr-hardware-call",1201),KEY_DERIVATION_CALL:new s("key-derivation-call",1301),KEY_DERIVATION_SCHEMA:new s("key-derivation-schema",1302)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/RegistryType.js"}],[2001,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ScriptExpressions=n.ScriptExpression=void 0;class s{constructor(e,t){this.tag=e,this.expression=t,this.getTag=()=>this.tag,this.getExpression=()=>this.expression}}n.ScriptExpression=s,s.fromTag=e=>Object.values(n.ScriptExpressions).find((t=>t.getTag()===e)),n.ScriptExpressions={SCRIPT_HASH:new s(400,"sh"),WITNESS_SCRIPT_HASH:new s(401,"wsh"),PUBLIC_KEY:new s(402,"pk"),PUBLIC_KEY_HASH:new s(403,"pkh"),WITNESS_PUBLIC_KEY_HASH:new s(404,"wpkh"),COMBO:new s(405,"combo"),MULTISIG:new s(406,"multi"),SORTED_MULTISIG:new s(407,"sortedmulti"),ADDRESS:new s(307,"addr"),RAW_SCRIPT:new s(408,"raw")}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/ScriptExpression.js"}],[2002,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UnknownURTypeError=void 0;class s extends Error{constructor(e){super(e)}}n.UnknownURTypeError=s}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/errors/index.js"}],[2003,{"../CryptoHDKey":1992,"../RegistryItem":1999,"../RegistryType":2e3,"../lib":2010,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CryptoMultiAccounts=void 0;const s=e("../RegistryType"),r=e("../CryptoHDKey"),i=e("../RegistryItem"),a=e("../lib");var o;!function(e){e[e.masterFingerprint=1]="masterFingerprint",e[e.keys=2]="keys",e[e.device=3]="device",e[e.deviceId=4]="deviceId",e[e.version=5]="version"}(o||(o={}));class c extends i.RegistryItem{constructor(e,t,n,r,i){super(),this.masterFingerprint=e,this.keys=t,this.device=n,this.deviceId=r,this.version=i,this.getRegistryType=()=>s.RegistryTypes.CRYPTO_MULTI_ACCOUNTS,this.getMasterFingerprint=()=>this.masterFingerprint,this.getKeys=()=>this.keys,this.getDevice=()=>this.device,this.getDeviceId=()=>this.deviceId,this.getVersion=()=>this.version,this.toDataItem=()=>{const e={};return this.masterFingerprint&&(e[o.masterFingerprint]=this.masterFingerprint.readUInt32BE(0)),this.keys&&(e[o.keys]=this.keys.map((e=>{const t=e.toDataItem();return t.setTag(e.getRegistryType().getTag()),t}))),this.device&&(e[o.device]=this.device),this.deviceId&&(e[o.deviceId]=this.deviceId),this.version&&(e[o.version]=this.version),new a.DataItem(e)}}}n.CryptoMultiAccounts=c,c.fromDataItem=e=>{const n=e.getData(),s=t.alloc(4),i=n[o.masterFingerprint];i&&s.writeUInt32BE(i,0);const a=n[o.keys].map((e=>r.CryptoHDKey.fromDataItem(e))),l=n[o.device],u=n[o.deviceId],d=n[o.version];return new c(s,a,l,u,d)},c.fromCBOR=e=>{const t=(0,a.decodeToDataItem)(e);return c.fromDataItem(t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/extended/CryptoMultiAccounts.js"}],[2004,{"../CryptoKeypath":1993,"../RegistryItem":1999,"../RegistryType":2e3,"../lib":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.KeyDerivationSchema=n.DerivationAlgorithm=n.Curve=void 0;const s=e("../RegistryType"),r=e("../RegistryItem"),i=e("../lib"),a=e("../CryptoKeypath");var o,c,l;!function(e){e[e.keyPath=1]="keyPath",e[e.curve=2]="curve",e[e.algo=3]="algo"}(o||(o={})),function(e){e[e.secp256k1=0]="secp256k1",e[e.ed25519=1]="ed25519"}(c=n.Curve||(n.Curve={})),function(e){e[e.slip10=0]="slip10",e[e.bip32ed25519=1]="bip32ed25519"}(l=n.DerivationAlgorithm||(n.DerivationAlgorithm={}));class u extends r.RegistryItem{constructor(e,t=c.secp256k1,n=l.slip10){super(),this.keypath=e,this.curve=t,this.algo=n,this.getRegistryType=()=>s.RegistryTypes.KEY_DERIVATION_SCHEMA,this.getKeypath=()=>this.keypath,this.getCurve=()=>this.curve,this.getAlgo=()=>this.algo,this.toDataItem=()=>{const e={},t=this.getKeypath().toDataItem();return t.setTag(this.getKeypath().getRegistryType().getTag()),e[o.keyPath]=t,e[o.curve]=this.curve,e[o.algo]=this.algo,new i.DataItem(e)}}}n.KeyDerivationSchema=u,u.fromDataItem=e=>{const t=e.getData(),n=a.CryptoKeypath.fromDataItem(t[o.keyPath]),s=t[o.curve],r=t[o.algo];return new u(n,s,r)},u.fromCBOR=e=>{const t=(0,i.decodeToDataItem)(e);return u.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/extended/DerivationSchema.js"}],[2005,{"../RegistryItem":1999,"../RegistryType":2e3,"../lib":2010,"./DerivationSchema":2004},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.KeyDerivation=void 0;const s=e("../RegistryType"),r=e("../RegistryItem"),i=e("../lib"),a=e("./DerivationSchema");var o;!function(e){e[e.schemas=1]="schemas"}(o||(o={}));class c extends r.RegistryItem{constructor(e){super(),this.schemas=e,this.getRegistryType=()=>s.RegistryTypes.KEY_DERIVATION_CALL,this.getSchemas=()=>this.schemas,this.toDataItem=()=>{const e={};return e[o.schemas]=this.schemas.map((e=>{const t=e.toDataItem();return t.setTag(e.getRegistryType().getTag()),t})),new i.DataItem(e)}}}n.KeyDerivation=c,c.fromDataItem=e=>{const t=e.getData()[o.schemas].map((e=>a.KeyDerivationSchema.fromDataItem(e)));return new c(t)},c.fromCBOR=e=>{const t=(0,i.decodeToDataItem)(e);return c.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/extended/KeyDerivation.js"}],[2006,{"../RegistryItem":1999,"../RegistryType":2e3,"../lib":2010,"./KeyDerivation":2005},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.QRHardwareCall=n.QRHardwareCallType=void 0;const s=e("../RegistryType"),r=e("../RegistryItem"),i=e("../lib"),a=e("./KeyDerivation");var o,c;!function(e){e[e.type=1]="type",e[e.params=2]="params",e[e.origin=3]="origin"}(o||(o={})),function(e){e[e.KeyDerivation=0]="KeyDerivation"}(c=n.QRHardwareCallType||(n.QRHardwareCallType={}));class l extends r.RegistryItem{constructor(e,t,n){super(),this.type=e,this.params=t,this.origin=n,this.getRegistryType=()=>s.RegistryTypes.QR_HARDWARE_CALL,this.getType=()=>this.type,this.getParams=()=>this.params,this.getOrigin=()=>this.origin,this.toDataItem=()=>{const e={};e[o.type]=this.type;const t=this.params.toDataItem();return t.setTag(this.params.getRegistryType().getTag()),e[o.params]=t,this.origin&&(e[o.origin]=this.origin),new i.DataItem(e)}}}n.QRHardwareCall=l,l.fromDataItem=e=>{const t=e.getData(),n=t[o.type]||c.KeyDerivation;let s;if(n===c.KeyDerivation)s=a.KeyDerivation.fromDataItem(t[o.params]);const r=t[o.origin];return new l(n,s,r)},l.fromCBOR=e=>{const t=(0,i.decodeToDataItem)(e);return l.fromDataItem(t)}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/extended/QRHardwareCall.js"}],[2007,{"./Bytes":1988,"./CryptoAccount":1989,"./CryptoCoinInfo":1990,"./CryptoECKey":1991,"./CryptoHDKey":1992,"./CryptoKeypath":1993,"./CryptoOutput":1994,"./CryptoPSBT":1995,"./Decoder":1996,"./MultiKey":1997,"./PathComponent":1998,"./RegistryItem":1999,"./RegistryType":2e3,"./ScriptExpression":2001,"./errors":2002,"./extended/CryptoMultiAccounts":2003,"./extended/DerivationSchema":2004,"./extended/KeyDerivation":2005,"./extended/QRHardwareCall":2006,"./lib":2010,"./patchCBOR":2011,"./types":2012,"./utils":2013,"buffer/":4005,tslib:5539},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=n.extend=n.PathComponent=n.ScriptExpressions=n.MultiKey=n.CryptoPSBT=n.CryptoOutput=n.CryptoECKey=n.CryptoCoinInfoNetwork=n.CryptoCoinInfoType=n.CryptoCoinInfo=n.CryptoKeypath=n.CryptoMultiAccounts=n.CryptoHDKey=n.CryptoAccount=n.Bytes=n.URRegistryDecoder=n.DataItem=void 0;const s=e("tslib");e("./patchCBOR");const r=e("buffer/");Object.defineProperty(n,"Buffer",{enumerable:!0,get:function(){return r.Buffer}});const i=e("./CryptoHDKey");Object.defineProperty(n,"CryptoHDKey",{enumerable:!0,get:function(){return i.CryptoHDKey}});const a=e("./CryptoKeypath");Object.defineProperty(n,"CryptoKeypath",{enumerable:!0,get:function(){return a.CryptoKeypath}});const o=e("./CryptoCoinInfo");Object.defineProperty(n,"CryptoCoinInfo",{enumerable:!0,get:function(){return o.CryptoCoinInfo}}),Object.defineProperty(n,"CryptoCoinInfoType",{enumerable:!0,get:function(){return o.Type}}),Object.defineProperty(n,"CryptoCoinInfoNetwork",{enumerable:!0,get:function(){return o.Network}});const c=e("./CryptoECKey");Object.defineProperty(n,"CryptoECKey",{enumerable:!0,get:function(){return c.CryptoECKey}});const l=e("./Bytes");Object.defineProperty(n,"Bytes",{enumerable:!0,get:function(){return l.Bytes}});const u=e("./CryptoOutput");Object.defineProperty(n,"CryptoOutput",{enumerable:!0,get:function(){return u.CryptoOutput}});const d=e("./CryptoPSBT");Object.defineProperty(n,"CryptoPSBT",{enumerable:!0,get:function(){return d.CryptoPSBT}});const h=e("./CryptoAccount");Object.defineProperty(n,"CryptoAccount",{enumerable:!0,get:function(){return h.CryptoAccount}});const f=e("./Decoder");Object.defineProperty(n,"URRegistryDecoder",{enumerable:!0,get:function(){return f.URRegistryDecoder}});const p=e("./MultiKey");Object.defineProperty(n,"MultiKey",{enumerable:!0,get:function(){return p.MultiKey}});const m=e("./ScriptExpression");Object.defineProperty(n,"ScriptExpressions",{enumerable:!0,get:function(){return m.ScriptExpressions}});const g=e("./PathComponent");Object.defineProperty(n,"PathComponent",{enumerable:!0,get:function(){return g.PathComponent}});const y=e("./RegistryItem"),w=e("./RegistryType"),b=e("./lib");var v=e("./lib");Object.defineProperty(n,"DataItem",{enumerable:!0,get:function(){return v.DataItem}});const S=e("./utils"),k=e("./extended/CryptoMultiAccounts");Object.defineProperty(n,"CryptoMultiAccounts",{enumerable:!0,get:function(){return k.CryptoMultiAccounts}});const T={URRegistryDecoder:f.URRegistryDecoder,Bytes:l.Bytes,CryptoAccount:h.CryptoAccount,CryptoHDKey:i.CryptoHDKey,CryptoMultiAccounts:k.CryptoMultiAccounts,CryptoKeypath:a.CryptoKeypath,CryptoCoinInfo:o.CryptoCoinInfo,CryptoCoinInfoType:o.Type,CryptoCoinInfoNetwork:o.Network,CryptoECKey:c.CryptoECKey,CryptoOutput:u.CryptoOutput,CryptoPSBT:d.CryptoPSBT,MultiKey:p.MultiKey,ScriptExpressions:m.ScriptExpressions,PathComponent:g.PathComponent},_={addReader:b.addReader,addSemanticDecode:b.addSemanticDecode,addSemanticEncode:b.addSemanticEncode,addWriter:b.addWriter,patchTags:S.patchTags},C={RegistryTypes:w.RegistryTypes,RegistryItem:y.RegistryItem,RegistryType:w.RegistryType,decodeToDataItem:b.decodeToDataItem,encodeDataItem:b.encodeDataItem,cbor:_};n.extend=C,(0,s.__exportStar)(e("./errors"),n),(0,s.__exportStar)(e("./Decoder"),n),(0,s.__exportStar)(e("./lib"),n),(0,s.__exportStar)(e("./CryptoAccount"),n),(0,s.__exportStar)(e("./CryptoPSBT"),n),(0,s.__exportStar)(e("./CryptoHDKey"),n),(0,s.__exportStar)(e("./extended/CryptoMultiAccounts"),n),(0,s.__exportStar)(e("./extended/QRHardwareCall"),n),(0,s.__exportStar)(e("./extended/KeyDerivation"),n),(0,s.__exportStar)(e("./extended/DerivationSchema"),n),(0,s.__exportStar)(e("./CryptoOutput"),n),(0,s.__exportStar)(e("./CryptoCoinInfo"),n),(0,s.__exportStar)(e("./CryptoECKey"),n),(0,s.__exportStar)(e("./MultiKey"),n),(0,s.__exportStar)(e("./CryptoKeypath"),n),(0,s.__exportStar)(e("./patchCBOR"),n),(0,s.__exportStar)(e("./PathComponent"),n),(0,s.__exportStar)(e("./RegistryItem"),n),(0,s.__exportStar)(e("./RegistryType"),n),(0,s.__exportStar)(e("./types"),n),(0,s.__exportStar)(e("./utils"),n),n.default=T}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/index.js"}],[2008,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DataItem=void 0;n.DataItem=class{constructor(e,t){this.setTag=e=>{this.tag=e},this.clearTag=()=>{this.tag=undefined},this.getTag=()=>this.tag,this.getData=()=>this.data,this.data=e,this.tag=t}}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/lib/DataItem.js"}],[2009,{"./DataItem":2008,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){!function(e,n){"function"==typeof define&&define.amd?define([],n):void 0!==t&&t.exports?t.exports=n():e.CBOR=n()}(this,(function(){const{DataItem:t}=e("./DataItem");var s=function(){function e(e){this.$hex=e}e.prototype={length:function(){return this.$hex.length/2},toString:function(e){if(!e||"hex"===e||16===e)return this.$hex;if("utf-8"===e){for(var t="",n=0;n<this.$hex.length;n+=2)t+="%"+this.$hex.substring(n,n+2);return decodeURIComponent(t)}if("latin"===e){for(t=[],n=0;n<this.$hex.length;n+=2)t.push(parseInt(this.$hex.substring(n,n+2),16));return String.fromCharCode.apply(String,t)}throw new Error("Unrecognised format: "+e)}},e.fromLatinString=function(t){for(var n="",s=0;s<t.length;s++){var r=t.charCodeAt(s).toString(16);1===r.length&&(r="0"+r),n+=r}return new e(n)},e.fromUtf8String=function(t){for(var n=encodeURIComponent(t),s="",r=0;r<n.length;r++)if("%"===n.charAt(r))s+=n.substring(r+1,r+3),r+=2;else{var i=n.charCodeAt(r).toString(16);i.length<2&&(i="0"+i),s+=i}return new e(s)};var s=[],r={},i=function(e){return function(){throw new Error(e+" not implemented")}};function a(){}function o(){}function c(e,t){var n=e.value;return n<24?n:24==n?t.readByte():25==n?t.readUint16():26==n?t.readUint32():27==n?t.readUint64():31==n?null:void i("Additional info: "+n)()}function l(e,t,n){var s=e<<5;t<24?n.writeByte(s|t):t<256?(n.writeByte(24|s),n.writeByte(t)):t<65536?(n.writeByte(25|s),n.writeUint16(t)):t<4294967296?(n.writeByte(26|s),n.writeUint32(t)):(n.writeByte(27|s),n.writeUint64(t))}a.prototype={peekByte:i("peekByte"),readByte:i("readByte"),readChunk:i("readChunk"),readFloat16:function(){var e=this.readUint16(),t=(32767&e)>>10,n=1023&e,s=32768&e;if(31===t)return 0===n?s?-Infinity:Infinity:NaN;var r=t?Math.pow(2,t-25)*(1024+n):Math.pow(2,-24)*n;return s?-r:r},readFloat32:function(){var e=this.readUint32(),t=(2147483647&e)>>23,n=8388607&e,s=2147483648&e;if(255===t)return 0===n?s?-Infinity:Infinity:NaN;var r=t?Math.pow(2,t-23-127)*(8388608+n):Math.pow(2,-149)*n;return s?-r:r},readFloat64:function(){var e=this.readUint32(),t=e>>20&2047,n=4294967296*(1048575&e)+this.readUint32(),s=2147483648&e;if(2047===t)return 0===n?s?-Infinity:Infinity:NaN;var r=t?Math.pow(2,t-52-1023)*(4503599627370496+n):Math.pow(2,-1074)*n;return s?-r:r},readUint16:function(){return 256*this.readByte()+this.readByte()},readUint32:function(){return 65536*this.readUint16()+this.readUint16()},readUint64:function(){return 4294967296*this.readUint32()+this.readUint32()}},o.prototype={writeByte:i("writeByte"),result:i("result"),writeFloat16:i("writeFloat16"),writeFloat32:i("writeFloat32"),writeFloat64:i("writeFloat64"),writeUint16:function(e){this.writeByte(e>>8&255),this.writeByte(255&e)},writeUint32:function(e){this.writeUint16(e>>16&65535),this.writeUint16(65535&e)},writeUint64:function(e){if(e>=9007199254740992||e<=-9007199254740992)throw new Error("Cannot encode Uint64 of: "+e+" magnitude to big (floating point errors)");this.writeUint32(Math.floor(e/4294967296)),this.writeUint32(e%4294967296)},writeString:i("writeString"),canWriteBinary:function(e){return!1},writeBinary:i("writeChunk")};var u=new Error;function d(e){var t=function(e){var t=e.readByte();return{type:t>>5,value:31&t}}(e);switch(t.type){case 0:return c(t,e);case 1:return-1-c(t,e);case 2:return e.readChunk(c(t,e));case 3:return e.readChunk(c(t,e)).toString("utf-8");case 4:case 5:var n=c(t,e),s=[];if(null!==n){5===t.type&&(n*=2);for(var i=0;i<n;i++)s[i]=d(e)}else for(var a;(a=d(e))!==u;)s.push(a);if(5===t.type){var o={};for(i=0;i<s.length;i+=2)o[s[i]]=s[i+1];return o}return s;case 6:var l=c(t,e),h=r[l];s=d(e);return h?h(s):s;case 7:if(25===t.value)return e.readFloat16();if(26===t.value)return e.readFloat32();if(27===t.value)return e.readFloat64();switch(c(t,e)){case 20:return!1;case 21:return!0;case 22:return null;case 23:return undefined;case null:return u;default:throw new Error("Unknown fixed value: "+t.value)}default:throw new Error("Unsupported header: "+JSON.stringify(t))}throw new Error("not implemented yet")}function h(e,t){for(var n=0;n<s.length;n++){var r=s[n].fn(e);if(r!==undefined)return l(6,s[n].tag,t),h(r,t)}if(e&&"function"==typeof e.toCBOR&&(e=e.toCBOR()),!1===e)l(7,20,t);else if(!0===e)l(7,21,t);else if(null===e)l(7,22,t);else if(e===undefined)l(7,23,t);else if("number"==typeof e)Math.floor(e)===e&&e<9007199254740992&&e>-9007199254740992?e<0?l(1,-1-e,t):l(0,e,t):(!function(e,t,n){n.writeByte(e<<5|t)}(7,27,t),t.writeFloat64(e));else if("string"==typeof e)t.writeString(e,(function(e){l(3,e,t)}));else if(t.canWriteBinary(e))t.writeBinary(e,(function(e){l(2,e,t)}));else{if("object"!=typeof e)throw new Error("CBOR encoding not supported: "+e);if(m.config.useToJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),Array.isArray(e)){l(4,e.length,t);for(n=0;n<e.length;n++)h(e[n],t)}else{var i=Object.keys(e);l(5,i.length,t);for(n=0;n<i.length;n++){const s=parseInt(i[n]);isNaN(s)?(h(i[n],t),h(e[i[n]],t)):(h(s,t),h(e[i[n]],t))}}}}var f=[],p=[],m={config:{useToJSON:!0},addWriter:function(e,t){"string"==typeof e?p.push((function(n){if(e===n)return t(n)})):p.push(e)},addReader:function(e,t){"string"==typeof e?f.push((function(n,s){if(e===s)return t(n,s)})):f.push(e)},encode:function(e,t){for(var n=0;n<p.length;n++){var s=(0,p[n])(t);if(s)return h(e,s),s.result()}throw new Error("Unsupported output format: "+t)},encodeDataItem:function(e,t){for(var n=0;n<p.length;n++){var s=(0,p[n])(t);if(s)return e.getTag()!==undefined?(h(e,s),s.result()):(h(e.getData(),s),s.result())}throw new Error("Unsupported output format: "+t)},decode:function(e,t){for(var n=0;n<f.length;n++){var s=(0,f[n])(e,t);if(s)return d(s)}throw new Error("Unsupported input format: "+t)},decodeToDataItem:function(e,n){for(var s=0;s<f.length;s++){var r=(0,f[s])(e,n);if(r){const e=d(r);return e instanceof t?e:new t(e)}}throw new Error("Unsupported input format: "+n)},addSemanticEncode:function(e,t){if("number"!=typeof e||e%1!=0||e<0)throw new Error("Tag must be a positive integer");return s.push({tag:e,fn:t}),this},addSemanticDecode:function(e,t){if("number"!=typeof e||e%1!=0||e<0)throw new Error("Tag must be a positive integer");return r[e]=t,this}};function g(e){this.buffer=e,this.pos=0}function y(e){this.byteLength=0,this.defaultBufferLength=16384,this.latestBuffer=n.alloc(this.defaultBufferLength),this.latestBufferOffset=0,this.completeBuffers=[],this.stringFormat=e}function w(e){this.hex=e,this.pos=0}function b(e){this.$hex="",this.finalFormat=e||"hex"}return g.prototype=Object.create(a.prototype),g.prototype.peekByte=function(){return this.buffer[this.pos]},g.prototype.readByte=function(){return this.buffer[this.pos++]},g.prototype.readUint16=function(){var e=this.buffer.readUInt16BE(this.pos);return this.pos+=2,e},g.prototype.readUint32=function(){var e=this.buffer.readUInt32BE(this.pos);return this.pos+=4,e},g.prototype.readFloat32=function(){var e=this.buffer.readFloatBE(this.pos);return this.pos+=4,e},g.prototype.readFloat64=function(){var e=this.buffer.readDoubleBE(this.pos);return this.pos+=8,e},g.prototype.readChunk=function(e){var t=n.alloc(e);return this.buffer.copy(t,0,this.pos,this.pos+=e),t},y.prototype=Object.create(o.prototype),y.prototype.writeByte=function(e){this.latestBuffer[this.latestBufferOffset++]=e,this.latestBufferOffset>=this.latestBuffer.length&&(this.completeBuffers.push(this.latestBuffer),this.latestBuffer=n.alloc(this.defaultBufferLength),this.latestBufferOffset=0),this.byteLength++},y.prototype.writeFloat32=function(e){var t=n.alloc(4);t.writeFloatBE(e,0),this.writeBuffer(t)},y.prototype.writeFloat64=function(e){var t=n.alloc(8);t.writeDoubleBE(e,0),this.writeBuffer(t)},y.prototype.writeString=function(e,t){var s=n.from(e,"utf-8");t(s.length),this.writeBuffer(s)},y.prototype.canWriteBinary=function(e){return e instanceof n},y.prototype.writeBinary=function(e,t){t(e.length),this.writeBuffer(e)},y.prototype.writeBuffer=function(e){if(!(e instanceof n))throw new TypeError("BufferWriter only accepts Buffers");this.latestBufferOffset?this.latestBuffer.length-this.latestBufferOffset>=e.length?(e.copy(this.latestBuffer,this.latestBufferOffset),this.latestBufferOffset+=e.length,this.latestBufferOffset>=this.latestBuffer.length&&(this.completeBuffers.push(this.latestBuffer),this.latestBuffer=n.alloc(this.defaultBufferLength),this.latestBufferOffset=0)):(this.completeBuffers.push(this.latestBuffer.slice(0,this.latestBufferOffset)),this.completeBuffers.push(e),this.latestBuffer=n.alloc(this.defaultBufferLength),this.latestBufferOffset=0):this.completeBuffers.push(e),this.byteLength+=e.length},y.prototype.result=function(){for(var e=n.alloc(this.byteLength),t=0,s=0;s<this.completeBuffers.length;s++){var r=this.completeBuffers[s];r.copy(e,t,0,r.length),t+=r.length}return this.latestBufferOffset&&this.latestBuffer.copy(e,t,0,this.latestBufferOffset),this.stringFormat?e.toString(this.stringFormat):e},"function"==typeof n&&(m.addReader((function(e,t){return n.isBuffer(e)?new g(e):"hex"===t||"base64"===t?new g(n.from(e,t)):void 0})),m.addWriter((function(e){return e&&"buffer"!==e?"hex"===e||"base64"===e?new y(e):void 0:new y}))),w.prototype=Object.create(a.prototype),w.prototype.peekByte=function(){var e=this.hex.substring(this.pos,2);return parseInt(e,16)},w.prototype.readByte=function(){var e=this.hex.substring(this.pos,this.pos+2);return this.pos+=2,parseInt(e,16)},w.prototype.readChunk=function(t){var s=this.hex.substring(this.pos,this.pos+2*t);return this.pos+=2*t,"function"==typeof n?n.from(s,"hex"):new e(s)},b.prototype=Object.create(o.prototype),b.prototype.writeByte=function(e){if(e<0||e>255)throw new Error("Byte value out of range: "+e);var t=e.toString(16);1==t.length&&(t="0"+t),this.$hex+=t},b.prototype.canWriteBinary=function(t){return t instanceof e||"function"==typeof n&&t instanceof n},b.prototype.writeBinary=function(t,s){if(t instanceof e)s(t.length()),this.$hex+=t.$hex;else{if(!("function"==typeof n&&t instanceof n))throw new TypeError("HexWriter only accepts BinaryHex or Buffers");s(t.length),this.$hex+=t.toString("hex")}},b.prototype.result=function(){return"buffer"===this.finalFormat&&"function"==typeof n?n.from(this.$hex,"hex"):new e(this.$hex).toString(this.finalFormat)},b.prototype.writeString=function(t,n){var s=e.fromUtf8String(t);n(s.length()),this.$hex+=s.$hex},m.addReader((function(t,n){return t instanceof e||t.$hex?new w(t.$hex):"hex"===n?new w(t):void 0})),m.addWriter((function(e){if("hex"===e)return new b})),m}();return s.addSemanticEncode(0,(function(e){if(e instanceof Date)return e.toISOString()})).addSemanticDecode(0,(function(e){return new Date(e)})).addSemanticDecode(1,(function(e){return new Date(e)})),s}))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/lib/cbor-sync.js"}],[201,{"fast-json-patch":4357,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s,r=(s=e("fast-json-patch"))&&s.__esModule?s:{default:s},i=e("lodash");n.default={version:18,migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=18;try{const e=function(e){const t=e,{TransactionController:n}=t;if(n&&n.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>{if(!e.history||0===e.history.length){const t=function(e){const t={...e};return delete t.history,(0,i.cloneDeep)(t)}(e);return e.history=[t],e}const t=(n=e.history,n.map(((e,t)=>0===t?e:function(e,t,n){const s=r.default.compare(e,t);return s[0]&&(n&&(s[0].note=n),s[0].timestamp=Date.now()),s}(n[t-1],e)))).filter((e=>!Array.isArray(e)||e.length>0));var n;return e.history=t,e}))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #18${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/018.js"}],[2010,{"./DataItem":2008,"./cbor-sync":2009},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DataItem=n.addWriter=n.addReader=n.addSemanticEncode=n.addSemanticDecode=n.decodeToDataItem=n.encodeDataItem=void 0;var s=e("./cbor-sync");Object.defineProperty(n,"encodeDataItem",{enumerable:!0,get:function(){return s.encodeDataItem}}),Object.defineProperty(n,"decodeToDataItem",{enumerable:!0,get:function(){return s.decodeToDataItem}}),Object.defineProperty(n,"addSemanticDecode",{enumerable:!0,get:function(){return s.addSemanticDecode}}),Object.defineProperty(n,"addSemanticEncode",{enumerable:!0,get:function(){return s.addSemanticEncode}}),Object.defineProperty(n,"addReader",{enumerable:!0,get:function(){return s.addReader}}),Object.defineProperty(n,"addWriter",{enumerable:!0,get:function(){return s.addWriter}});var r=e("./DataItem");Object.defineProperty(n,"DataItem",{enumerable:!0,get:function(){return r.DataItem}})}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/lib/index.js"}],[2011,{"./RegistryType":2e3,"./ScriptExpression":2001,"./utils":2013},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const s=e("./utils"),r=e("./RegistryType"),i=e("./ScriptExpression"),a=Object.values(r.RegistryTypes).filter((e=>!!e.getTag())).map((e=>e.getTag())),o=Object.values(i.ScriptExpressions).map((e=>e.getTag()));(0,s.patchTags)(a.concat(o))}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/patchCBOR.js"}],[2012,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/types.js"}],[2013,{"./lib":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.patchTags=void 0;const s=e("./lib"),r=[];n.patchTags=e=>{e.forEach((e=>{r.find((t=>t===e))||((0,s.addSemanticEncode)(e,(t=>{if(t instanceof s.DataItem&&t.getTag()===e)return t.getData()})),(0,s.addSemanticDecode)(e,(t=>new s.DataItem(t,e))),r.push(e))}))}}}},{package:"@metamask/metamask-airgapped-keyring>@keystonehq/bc-ur-registry-eth>@keystonehq/bc-ur-registry",file:"node_modules/@metamask/metamask-airgapped-keyring/node_modules/@keystonehq/bc-ur-registry/dist/utils.js"}],[202,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/transaction-controller"),r=e("lodash");n.default={version:19,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=19;try{const e=function(e){const t=e,{TransactionController:n}=t;if(n&&n.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map(((e,t,n)=>{if(e.status!==s.TransactionStatus.submitted)return e;const r=function(e){const t=e.map((e=>{const{nonce:t}=e.txParams;return parseInt(t||"0x0",16)}));return Math.max.apply(null,t)}(n.filter((e=>e.status===s.TransactionStatus.confirmed)).filter((t=>t.txParams.from===e.txParams.from)).filter((t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from))),i=function(e,t){const n=e.map((e=>{const{nonce:t}=e.txParams;return parseInt(t,16)}));let s=t;for(;n.includes(s);)s+=1;return s}(n.filter((e=>e.status===s.TransactionStatus.submitted)).filter((t=>t.txParams.from===e.txParams.from)).filter((t=>t.metamaskNetworkId.from===e.metamaskNetworkId.from)),r),a=Math.max(i,r);return parseInt(e.txParams.nonce,16)>a+1&&(e.status=s.TransactionStatus.failed,e.err={message:"nonce too high",note:"migration 019 custom error"}),e}))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #19${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/019.js"}],[2025,{"./constants.cjs":2026,"@metamask/base-controller":1332,"@metamask/keyring-api":1873,"@metamask/keyring-snap-client":1926,"@metamask/snaps-utils":2046,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainTransactionsController=n.getDefaultMultichainTransactionsControllerState=void 0;const p=e("@metamask/base-controller"),m=e("@metamask/keyring-api"),g=e("@metamask/keyring-snap-client"),y=e("@metamask/snaps-utils"),w=e("@metamask/utils"),b=e("./constants.cjs");function v(){return{nonEvmTransactions:{}}}n.getDefaultMultichainTransactionsControllerState=v;const S={nonEvmTransactions:{persist:!0,anonymous:!1}};class k extends p.BaseController{constructor({messenger:e,state:t}){super({messenger:e,name:"MultichainTransactionsController",metadata:S,state:{nonEvmTransactions:{},...t}}),s.add(this);for(const e of f(this,s,"m",i).call(this))this.updateTransactionsForAccount(e.id).catch((t=>{console.error(`Failed to fetch initial transactions for account ${e.id}:`,t)}));this.messagingSystem.subscribe("AccountsController:accountAdded",(e=>f(this,s,"m",l).call(this,e))),this.messagingSystem.subscribe("AccountsController:accountRemoved",(e=>f(this,s,"m",u).call(this,e))),this.messagingSystem.subscribe("AccountsController:accountTransactionsUpdated",(e=>f(this,s,"m",d).call(this,e)))}async updateTransactionsForAccount(e){const{isUnlocked:t}=this.messagingSystem.call("KeyringController:getState");if(t)try{const t=f(this,s,"m",i).call(this).find((t=>t.id===e));if(t?.metadata.snap){const e=await f(this,s,"m",a).call(this,t.id,t.metadata.snap.id,{limit:10}),n=f(this,s,"m",o).call(this,e.data);this.update((s=>{const r={transactions:n,next:e.next,lastUpdated:Date.now()};Object.assign(s.nonEvmTransactions,{[t.id]:r})}))}}catch(t){console.error(`Failed to fetch transactions for account ${e}:`,t)}}}n.MultichainTransactionsController=k,s=new WeakSet,r=function(){return this.messagingSystem.call("AccountsController:listMultichainAccounts")},i=function(){return f(this,s,"m",r).call(this).filter((e=>f(this,s,"m",c).call(this,e)))},a=async function(e,t,n){return await f(this,s,"m",h).call(this,t).listAccountTransactions(e,n)},o=function(e){return e.filter((e=>{const t=e.chain,{namespace:n}=(0,w.parseCaipChainId)(t);return n!==w.KnownCaipNamespace.Solana||t===b.MultichainNetwork.Solana}))},c=function(e){return!(0,m.isEvmAccountType)(e.type)&&e.metadata.snap!==undefined},l=async function(e){f(this,s,"m",c).call(this,e)&&await this.updateTransactionsForAccount(e.id)},u=async function(e){e in this.state.nonEvmTransactions&&this.update((t=>{delete t.nonEvmTransactions[e]}))},d=function(e){const t={};e?.transactions&&(Object.entries(e.transactions).forEach((([e,n])=>{const r=this.state.nonEvmTransactions[e]?.transactions??[],i=f(this,s,"m",o).call(this,n),a=new Map;r.forEach((e=>{a.set(e.id,e)})),i.forEach((e=>{a.set(e.id,e)})),t[e]=Array.from(a.values()).sort(((e,t)=>(t.timestamp??0)-(e.timestamp??0)))})),this.update((e=>{Object.entries(t).forEach((([t,n])=>{e.nonEvmTransactions[t]={...e.nonEvmTransactions[t],transactions:n,lastUpdated:Date.now()}}))})))},h=function(e){return new g.KeyringClient({send:async t=>await this.messagingSystem.call("SnapController:handleRequest",{snapId:e,origin:"metamask",handler:y.HandlerType.OnKeyringRequest,request:t})})}}}},{package:"@metamask/multichain-transactions-controller",file:"node_modules/@metamask/multichain-transactions-controller/dist/MultichainTransactionsController.cjs"}],[2026,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r;Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainNativeAsset=n.MultichainNetwork=void 0,function(e){e.Bitcoin="bip122:000000000019d6689c085ae165831e93",e.BitcoinTestnet="bip122:000000000933ea01ad0ee984209779ba",e.Solana="solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",e.SolanaDevnet="solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",e.SolanaTestnet="solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"}(s||(n.MultichainNetwork=s={})),function(e){e.Bitcoin="bip122:000000000019d6689c085ae165831e93/slip44:0",e.BitcoinTestnet="bip122:000000000933ea01ad0ee984209779ba/slip44:0",e.Solana="solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp/slip44:501",e.SolanaDevnet="solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1/slip44:501",e.SolanaTestnet="solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z/slip44:501"}(r||(n.MultichainNativeAsset=r={}))}}},{package:"@metamask/multichain-transactions-controller",file:"node_modules/@metamask/multichain-transactions-controller/dist/constants.cjs"}],[2027,{"./MultichainTransactionsController.cjs":2025,"./constants.cjs":2026},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainNativeAsset=n.MultichainNetwork=n.MultichainTransactionsController=void 0;var s=e("./MultichainTransactionsController.cjs");Object.defineProperty(n,"MultichainTransactionsController",{enumerable:!0,get:function(){return s.MultichainTransactionsController}});var r=e("./constants.cjs");Object.defineProperty(n,"MultichainNetwork",{enumerable:!0,get:function(){return r.MultichainNetwork}}),Object.defineProperty(n,"MultichainNativeAsset",{enumerable:!0,get:function(){return r.MultichainNativeAsset}})}}},{package:"@metamask/multichain-transactions-controller",file:"node_modules/@metamask/multichain-transactions-controller/dist/index.cjs"}],[2028,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isEqual=void 0,n.isEqual=function(e,t){return e.length===t.length&&e.every(((e,n)=>e===t[n]))}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/array.cjs"}],[2029,{"./base64.cjs":2030,"./constants.cjs":2034,"@metamask/snaps-sdk":2676,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateAuxiliaryFiles=n.encodeAuxiliaryFile=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/utils"),i=e("./base64.cjs"),a=e("./constants.cjs");n.encodeAuxiliaryFile=async function(e,t){if(t===s.AuxiliaryFileEncoding.Base64)return e;const n=await(0,i.decodeBase64)(e);return t===s.AuxiliaryFileEncoding.Utf8?(0,r.bytesToString)(n):(0,r.bytesToHex)(n)},n.validateAuxiliaryFiles=function(e){for(const t of e)(0,r.assert)(t.size<a.MAX_FILE_SIZE,"Static files required by the Snap must be smaller than 64 MB.")}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/auxiliary-files.cjs"}],[203,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:20,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=20;try{const e=function(e){const t=e;"metamask"in t&&!("firstTimeInfo"in t.metamask)&&(t.metamask.firstTimeInfo={version:"3.12.0",date:Date.now()});return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #20${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/020.js"}],[2030,{"./bytes.cjs":2031,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeBase64=n.encodeBase64=void 0;const s=e("@metamask/utils"),r=e("./bytes.cjs");n.encodeBase64=async function(e){const t=(0,r.getBytes)(e);return"FileReader"in globalThis?await new Promise(((e,n)=>{const s=Object.assign(new FileReader,{onload:()=>e(s.result.replace("data:application/octet-stream;base64,","")),onerror:()=>n(s.error)});s.readAsDataURL(new File([t],"",{type:"application/octet-stream"}))})):(0,s.bytesToBase64)(t)},n.decodeBase64=async function(e){const t=await fetch(`data:application/octet-stream;base64,${e}`);return new Uint8Array(await t.arrayBuffer())}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/base64.cjs"}],[2031,{"./virtual-file/VirtualFile.cjs":2066,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getBytes=void 0;const s=e("@metamask/utils"),r=e("./virtual-file/VirtualFile.cjs");n.getBytes=function(e){const t=e instanceof r.VirtualFile?e.value:e;return"string"==typeof t?(0,s.stringToBytes)(t):t}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/bytes.cjs"}],[2032,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.SnapCaveatType=void 0,function(e){e.PermittedDerivationPaths="permittedDerivationPaths",e.PermittedCoinTypes="permittedCoinTypes",e.SnapCronjob="snapCronjob",e.TransactionOrigin="transactionOrigin",e.SignatureOrigin="signatureOrigin",e.RpcOrigin="rpcOrigin",e.KeyringOrigin="keyringOrigin",e.SnapIds="snapIds",e.ChainIds="chainIds",e.LookupMatchers="lookupMatchers",e.MaxRequestTime="maxRequestTime",e.ProtocolSnapScopes="protocolSnapScopes"}(s||(n.SnapCaveatType=s={}))}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/caveats.cjs"}],[2033,{"./bytes.cjs":2031,"@metamask/utils":2874,"@noble/hashes/sha256":2924},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.checksumFiles=n.checksum=void 0;const s=e("@metamask/utils"),r=e("@noble/hashes/sha256"),i=e("./bytes.cjs");async function a(e){const t=(0,i.getBytes)(e);return"crypto"in globalThis&&"object"==typeof globalThis.crypto&&crypto.subtle?.digest?new Uint8Array(await crypto.subtle.digest("SHA-256",t)):(0,r.sha256)(t)}n.checksum=a,n.checksumFiles=async function(e){const t=await Promise.all([...e].sort(((e,t)=>((0,s.assert)(e.path!==t.path,"Tried to sort files with non-unique paths."),e.path<t.path?-1:1))).map((async e=>a(e))));return a((0,s.concatBytes)(t))}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/checksum.cjs"}],[2034,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MAX_FILE_SIZE=void 0,n.MAX_FILE_SIZE=64e6}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/constants.cjs"}],[2035,{"@metamask/superstruct":2799,"@metamask/utils":2874,"cron-parser":4103},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isCronjobSpecificationArray=n.CronjobSpecificationArrayStruct=n.isCronjobSpecification=n.CronjobSpecificationStruct=n.parseCronExpression=n.CronExpressionStruct=n.CronjobRpcRequestStruct=void 0;const s=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("cron-parser");n.CronjobRpcRequestStruct=(0,s.object)({jsonrpc:(0,s.optional)(r.JsonRpcVersionStruct),id:(0,s.optional)(r.JsonRpcIdStruct),method:(0,s.string)(),params:(0,s.optional)(r.JsonRpcParamsStruct)}),n.CronExpressionStruct=(0,s.refine)((0,s.string)(),"CronExpression",(e=>{try{return(0,i.parseExpression)(e),!0}catch{return!1}})),n.parseCronExpression=function(e){const t=(0,s.create)(e,n.CronExpressionStruct);return(0,i.parseExpression)(t)},n.CronjobSpecificationStruct=(0,s.object)({expression:n.CronExpressionStruct,request:n.CronjobRpcRequestStruct}),n.isCronjobSpecification=function(e){try{return(0,s.create)(e,n.CronjobSpecificationStruct),!0}catch{return!1}},n.CronjobSpecificationArrayStruct=(0,s.array)(n.CronjobSpecificationStruct),n.isCronjobSpecificationArray=function(e){try{return(0,s.create)(e,n.CronjobSpecificationArrayStruct),!0}catch{return!1}}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/cronjob.cjs"}],[2036,{"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.currency=void 0;const s=e("@metamask/superstruct");n.currency=function(e){const t=e.toLowerCase();return(0,s.coerce)((0,s.literal)(t),(0,s.literal)(e.toUpperCase()),(e=>(0,s.create)(e.toLowerCase(),(0,s.literal)(t))))}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/currency.cjs"}],[2037,{rfdc:5212},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.deepClone=void 0;const r=s(e("rfdc"));n.deepClone=(0,r.default)({proto:!1,circles:!1})}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/deep-clone.cjs"}],[2038,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_ENDOWMENTS=void 0,n.DEFAULT_ENDOWMENTS=Object.freeze(["atob","btoa","BigInt","console","crypto","Date","Math","setTimeout","clearTimeout","SubtleCrypto","TextDecoder","TextEncoder","URL","URLSearchParams","setInterval","clearInterval","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","isSecureContext","Intl","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","DataView","ArrayBuffer","AbortController","AbortSignal"])}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/default-endowments.cjs"}],[2039,{"./array.cjs":2028,"@metamask/slip44":2554},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getSlip44ProtocolName=n.getSnapDerivationPathName=n.SNAPS_DERIVATION_PATHS=void 0;const r=s(e("@metamask/slip44")),i=e("./array.cjs");function a(e){return"1"===String(e)?"Test Networks":r.default[e]?.name??null}n.SNAPS_DERIVATION_PATHS=[{path:["m","44'","0'"],curve:"ed25519",name:"Test BIP-32 Path (ed25519)"},{path:["m","44'","1'"],curve:"secp256k1",name:"Testnet"},{path:["m","44'","0'"],curve:"secp256k1",name:"Bitcoin Legacy"},{path:["m","49'","0'"],curve:"secp256k1",name:"Bitcoin Nested SegWit"},{path:["m","49'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Nested SegWit"},{path:["m","84'","0'"],curve:"secp256k1",name:"Bitcoin Native SegWit"},{path:["m","84'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Native SegWit"},{path:["m","86'","0'"],curve:"secp256k1",name:"Bitcoin Taproot"},{path:["m","86'","1'"],curve:"secp256k1",name:"Bitcoin Testnet Taproot"},{path:["m","44'","501'"],curve:"ed25519",name:"Solana"},{path:["m","44'","501'","0'","0'"],curve:"ed25519",name:"Solana"},{path:["m","44'","2'"],curve:"secp256k1",name:"Litecoin"},{path:["m","44'","3'"],curve:"secp256k1",name:"Dogecoin"},{path:["m","44'","60'"],curve:"secp256k1",name:"Ethereum"},{path:["m","44'","118'"],curve:"secp256k1",name:"Atom"},{path:["m","44'","145'"],curve:"secp256k1",name:"Bitcoin Cash"},{path:["m","44'","637'"],curve:"ed25519",name:"Aptos"},{path:["m","44'","714'"],curve:"secp256k1",name:"Binance (BNB)"},{path:["m","44'","784'"],curve:"ed25519",name:"Sui"},{path:["m","44'","931'"],curve:"secp256k1",name:"THORChain (RUNE)"},{path:["m","44'","330'"],curve:"secp256k1",name:"Terra (LUNA)"},{path:["m","44'","459'"],curve:"secp256k1",name:"Kava"},{path:["m","44'","529'"],curve:"secp256k1",name:"Secret Network"},{path:["m","44'","397'","0'"],curve:"ed25519",name:"NEAR Protocol"},{path:["m","44'","1'","0'"],curve:"ed25519",name:"Testnet"},{path:["m","44'","472'"],curve:"ed25519",name:"Arweave"},{path:["m","44'","12586'"],curve:"secp256k1",name:"Mina"},{path:["m","44'","242'"],curve:"ed25519",name:"Nimiq"},{path:["m","44'","1729'","0'","0'"],curve:"ed25519",name:"Tezos"},{path:["m","1789'","0'"],curve:"ed25519",name:"Vega"},{path:["m","1852'","1815'"],curve:"ed25519Bip32",name:"Cardano"},{path:["m","44'","508'","0'","0'","0'"],curve:"ed25519",name:"MultiversX"},{path:["m","44'","709'"],curve:"secp256k1",name:"Avail"},{path:["m","44'","626'"],curve:"ed25519",name:"Kadena"},{path:["m","44'","632'"],curve:"ed25519",name:"Massa"}],n.getSnapDerivationPathName=function(e,t){const s=n.SNAPS_DERIVATION_PATHS.find((n=>n.curve===t&&(0,i.isEqual)(n.path,e)));if(s)return s.name;if("secp256k1"===t&&"m"===e[0]&&"44'"===e[1]&&e[2].endsWith("'")){return a(e[2].slice(0,-1))??null}return null},n.getSlip44ProtocolName=a}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/derivation-paths.cjs"}],[204,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:21,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=21;try{const e=function(e){const t=e;return delete t.BlacklistController,delete t.RecentBlocks,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #21${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/021.js"}],[2040,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.STATE_ENCRYPTION_MAGIC_VALUE=n.SIP_6_MAGIC_VALUE=void 0,n.SIP_6_MAGIC_VALUE="1399742832'",n.STATE_ENCRYPTION_MAGIC_VALUE="572232532'"}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/entropy.cjs"}],[2041,{"@metamask/rpc-errors":2484,"@metamask/snaps-sdk":2676,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.unwrapError=n.isWrappedSnapError=n.isSerializedSnapError=n.isSnapError=n.WrappedSnapError=n.SNAP_ERROR_WRAPPER_MESSAGE=n.SNAP_ERROR_WRAPPER_CODE=void 0;const c=e("@metamask/rpc-errors"),l=e("@metamask/snaps-sdk"),u=e("@metamask/utils");n.SNAP_ERROR_WRAPPER_CODE=-31001,n.SNAP_ERROR_WRAPPER_MESSAGE="Wrapped Snap Error";class d extends Error{constructor(e){const t=(0,l.getErrorMessage)(e);super(t),s.set(this,void 0),r.set(this,void 0),i.set(this,void 0),a(this,s,e,"f"),a(this,r,t,"f"),a(this,i,(0,l.getErrorStack)(e),"f")}get name(){return"WrappedSnapError"}get message(){return o(this,r,"f")}get stack(){return o(this,i,"f")}toJSON(){const e=h(o(this,s,"f"))?o(this,s,"f").serialize():(0,c.serializeCause)(o(this,s,"f"));return{code:n.SNAP_ERROR_WRAPPER_CODE,message:n.SNAP_ERROR_WRAPPER_MESSAGE,data:{cause:e}}}serialize(){return this.toJSON()}}function h(e){if((0,u.isObject)(e)&&"serialize"in e&&"function"==typeof e.serialize){const t=e.serialize();return(0,u.isJsonRpcError)(t)&&f(t)}return!1}function f(e){return e.code===l.SNAP_ERROR_CODE&&e.message===l.SNAP_ERROR_MESSAGE}function p(e){return(0,u.isJsonRpcError)(e)&&e.code===n.SNAP_ERROR_WRAPPER_CODE&&e.message===n.SNAP_ERROR_WRAPPER_MESSAGE}function m(e,t,n,s){const r=new c.JsonRpcError(e,t,s);return r.stack=n,r}n.WrappedSnapError=d,s=new WeakMap,r=new WeakMap,i=new WeakMap,n.isSnapError=h,n.isSerializedSnapError=f,n.isWrappedSnapError=p,n.unwrapError=function(e){if(p(e)){if((0,u.isJsonRpcError)(e.data.cause)){if(f(e.data.cause)){const{code:t,message:n,stack:s,data:r}=e.data.cause.data.cause;return[m(t,n,s,r),!0]}const{code:t,message:n,stack:s,data:r}=e.data.cause;return[m(t,n,s,r),!1]}return[m(c.errorCodes.rpc.internal,(0,l.getErrorMessage)(e.data.cause),(0,l.getErrorStack)(e.data.cause)),!1]}if((0,u.isJsonRpcError)(e)){const{code:t,message:n,stack:s,data:r}=e;return[m(t,n,s,r),!1]}return[m(c.errorCodes.rpc.internal,(0,l.getErrorMessage)(e),(0,l.getErrorStack)(e)),!1]}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/errors.cjs"}],[2042,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.SNAP_EXPORT_NAMES=n.HandlerType=void 0,function(e){e.OnRpcRequest="onRpcRequest",e.OnSignature="onSignature",e.OnTransaction="onTransaction",e.OnCronjob="onCronjob",e.OnInstall="onInstall",e.OnUpdate="onUpdate",e.OnNameLookup="onNameLookup",e.OnKeyringRequest="onKeyringRequest",e.OnHomePage="onHomePage",e.OnSettingsPage="onSettingsPage",e.OnUserInput="onUserInput",e.OnAssetsLookup="onAssetsLookup",e.OnAssetsConversion="onAssetsConversion",e.OnProtocolRequest="onProtocolRequest"}(s||(n.HandlerType=s={})),n.SNAP_EXPORT_NAMES=Object.values(s)}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/handler-types.cjs"}],[2043,{"./handler-types.cjs":2042,"@metamask/snaps-sdk":2676,"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OnNameLookupResponseStruct=n.DomainResolutionResponseStruct=n.AddressResolutionResponseStruct=n.DomainResolutionStruct=n.AddressResolutionStruct=n.OnSettingsPageResponseStruct=n.OnHomePageResponseStruct=n.OnHomePageResponseWithIdStruct=n.OnHomePageResponseWithContentStruct=n.OnSignatureResponseStruct=n.OnTransactionResponseStruct=n.OnTransactionResponseWithContentStruct=n.OnTransactionResponseWithIdStruct=n.OnTransactionSeverityResponseStruct=n.SNAP_EXPORTS=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),i=e("./handler-types.cjs");n.SNAP_EXPORTS={[i.HandlerType.OnRpcRequest]:{type:i.HandlerType.OnRpcRequest,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnTransaction]:{type:i.HandlerType.OnTransaction,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnCronjob]:{type:i.HandlerType.OnCronjob,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnNameLookup]:{type:i.HandlerType.OnNameLookup,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnInstall]:{type:i.HandlerType.OnInstall,required:!1,validator:e=>"function"==typeof e},[i.HandlerType.OnUpdate]:{type:i.HandlerType.OnUpdate,required:!1,validator:e=>"function"==typeof e},[i.HandlerType.OnKeyringRequest]:{type:i.HandlerType.OnKeyringRequest,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnHomePage]:{type:i.HandlerType.OnHomePage,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnSettingsPage]:{type:i.HandlerType.OnSettingsPage,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnSignature]:{type:i.HandlerType.OnSignature,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnUserInput]:{type:i.HandlerType.OnUserInput,required:!1,validator:e=>"function"==typeof e},[i.HandlerType.OnAssetsLookup]:{type:i.HandlerType.OnAssetsLookup,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnAssetsConversion]:{type:i.HandlerType.OnAssetsConversion,required:!0,validator:e=>"function"==typeof e},[i.HandlerType.OnProtocolRequest]:{type:i.HandlerType.OnProtocolRequest,required:!0,validator:e=>"function"==typeof e}},n.OnTransactionSeverityResponseStruct=(0,r.object)({severity:(0,r.optional)((0,r.literal)(s.SeverityLevel.Critical))}),n.OnTransactionResponseWithIdStruct=(0,r.assign)(n.OnTransactionSeverityResponseStruct,(0,r.object)({id:(0,r.string)()})),n.OnTransactionResponseWithContentStruct=(0,r.assign)(n.OnTransactionSeverityResponseStruct,(0,r.object)({content:s.ComponentOrElementStruct})),n.OnTransactionResponseStruct=(0,r.nullable)((0,r.union)([n.OnTransactionResponseWithContentStruct,n.OnTransactionResponseWithIdStruct])),n.OnSignatureResponseStruct=n.OnTransactionResponseStruct,n.OnHomePageResponseWithContentStruct=(0,r.object)({content:s.ComponentOrElementStruct}),n.OnHomePageResponseWithIdStruct=(0,r.object)({id:(0,r.string)()}),n.OnHomePageResponseStruct=(0,r.union)([n.OnHomePageResponseWithContentStruct,n.OnHomePageResponseWithIdStruct]),n.OnSettingsPageResponseStruct=n.OnHomePageResponseStruct,n.AddressResolutionStruct=(0,r.object)({protocol:(0,r.string)(),resolvedDomain:(0,r.string)()}),n.DomainResolutionStruct=(0,r.object)({protocol:(0,r.string)(),resolvedAddress:(0,r.string)(),domainName:(0,r.string)()}),n.AddressResolutionResponseStruct=(0,r.object)({resolvedDomains:(0,r.size)((0,r.array)(n.AddressResolutionStruct),1,Infinity)}),n.DomainResolutionResponseStruct=(0,r.object)({resolvedAddresses:(0,r.size)((0,r.array)(n.DomainResolutionStruct),1,Infinity)}),n.OnNameLookupResponseStruct=(0,r.nullable)((0,r.union)([n.AddressResolutionResponseStruct,n.DomainResolutionResponseStruct]))}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/handlers.cjs"}],[2044,{"./svg.cjs":2060,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSvgDimensions=n.assertIsSnapIcon=n.SVG_MAX_BYTE_SIZE_TEXT=n.SVG_MAX_BYTE_SIZE=void 0;const s=e("@metamask/utils"),r=e("./svg.cjs");n.SVG_MAX_BYTE_SIZE=1e5,n.SVG_MAX_BYTE_SIZE_TEXT=`${Math.floor(n.SVG_MAX_BYTE_SIZE/1e3)}kb`,n.assertIsSnapIcon=function(e){(0,s.assert)(e.path.endsWith(".svg"),'Expected snap icon to end in ".svg".');const t="string"==typeof e.value?(0,s.stringToBytes)(e.value).byteLength:e.value.byteLength;(0,s.assert)(t<=n.SVG_MAX_BYTE_SIZE,`The specified SVG icon exceeds the maximum size of ${n.SVG_MAX_BYTE_SIZE_TEXT}.`),(0,s.assert)((0,r.isSvg)(e.toString()),"Snap icon must be a valid SVG.")},n.getSvgDimensions=function(e){try{const t=(0,r.parseSvg)(e),n=t["@_height"],i=t["@_width"];if(n&&i)return{height:n,width:i};const a=t["@_viewBox"];if(a){const[e,t,n,r]=a.split(" ");if(n&&r){const e=parseInt(n,10),t=parseInt(r,10);return(0,s.assert)(Number.isInteger(e)&&e>0),(0,s.assert)(Number.isInteger(t)&&t>0),{width:e,height:t}}}}catch{throw new Error("Snap icon must be a valid SVG.")}return null}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/icon.cjs"}],[2045,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createWindow=void 0,n.createWindow=async function({uri:e,id:t,sandbox:n=!0,testId:s="snaps-iframe"}){return await new Promise(((r,i)=>{const a=document.createElement("iframe");a.setAttribute("id",t),a.setAttribute("data-testid",s),n&&a.setAttribute("sandbox","allow-scripts"),a.setAttribute("src",e),document.body.appendChild(a),a.addEventListener("load",(()=>{a.contentWindow?r(a.contentWindow):i(new Error(`iframe.contentWindow not present on load for job "${t}".`))}))}))}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/iframe.cjs"}],[2046,{"./array.cjs":2028,"./auxiliary-files.cjs":2029,"./base64.cjs":2030,"./bytes.cjs":2031,"./caveats.cjs":2032,"./checksum.cjs":2033,"./constants.cjs":2034,"./cronjob.cjs":2035,"./currency.cjs":2036,"./deep-clone.cjs":2037,"./default-endowments.cjs":2038,"./derivation-paths.cjs":2039,"./entropy.cjs":2040,"./errors.cjs":2041,"./handler-types.cjs":2042,"./handlers.cjs":2043,"./iframe.cjs":2045,"./json-rpc.cjs":2047,"./json.cjs":2048,"./localization.cjs":2049,"./logging.cjs":2050,"./manifest/index.cjs":2051,"./namespace.cjs":2053,"./path.cjs":2054,"./platform-version.cjs":2055,"./promise.cjs":2056,"./snaps.cjs":2057,"./strings.cjs":2058,"./structs.cjs":2059,"./types.cjs":2061,"./ui.cjs":2062,"./url.cjs":2063,"./validation.cjs":2064,"./versions.cjs":2065,"./virtual-file/index.cjs":2067},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./array.cjs"),n),r(e("./auxiliary-files.cjs"),n),r(e("./base64.cjs"),n),r(e("./bytes.cjs"),n),r(e("./caveats.cjs"),n),r(e("./checksum.cjs"),n),r(e("./constants.cjs"),n),r(e("./cronjob.cjs"),n),r(e("./currency.cjs"),n),r(e("./deep-clone.cjs"),n),r(e("./default-endowments.cjs"),n),r(e("./derivation-paths.cjs"),n),r(e("./entropy.cjs"),n),r(e("./errors.cjs"),n),r(e("./handlers.cjs"),n),r(e("./handler-types.cjs"),n),r(e("./iframe.cjs"),n),r(e("./json.cjs"),n),r(e("./json-rpc.cjs"),n),r(e("./localization.cjs"),n),r(e("./logging.cjs"),n),r(e("./manifest/index.cjs"),n),r(e("./namespace.cjs"),n),r(e("./path.cjs"),n),r(e("./platform-version.cjs"),n),r(e("./snaps.cjs"),n),r(e("./strings.cjs"),n),r(e("./structs.cjs"),n),r(e("./types.cjs"),n),r(e("./ui.cjs"),n),r(e("./url.cjs"),n),r(e("./validation.cjs"),n),r(e("./versions.cjs"),n),r(e("./virtual-file/index.cjs"),n),r(e("./promise.cjs"),n)}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/index.cjs"}],[2047,{"@metamask/permission-controller":2322,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.assertIsJsonRpcSuccess=n.isOriginAllowed=n.assertIsKeyringOrigins=n.KeyringOriginsStruct=n.assertIsRpcOrigins=n.RpcOriginsStruct=void 0;const s=e("@metamask/permission-controller"),r=e("@metamask/superstruct"),i=e("@metamask/utils"),a=(0,r.array)((0,r.refine)((0,r.string)(),"Allowed origin",(e=>!(e.split("*").length-1>2)||'No more than two wildcards ("*") are allowed in an origin specifier.')));function o(e,t){if("*"===e||e===t)return!0;const n=function(e){const t=e.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*");return RegExp(`^${t}$`,"u")}(e);return n.test(t)}n.RpcOriginsStruct=(0,r.refine)((0,r.object)({dapps:(0,r.optional)((0,r.boolean)()),snaps:(0,r.optional)((0,r.boolean)()),allowedOrigins:(0,r.optional)(a)}),"RPC origins",(e=>!!Boolean(!0===e.snaps||!0===e.dapps||e.allowedOrigins&&e.allowedOrigins.length>0)||"Must specify at least one JSON-RPC origin.")),n.assertIsRpcOrigins=function(e,t){(0,i.assertStruct)(e,n.RpcOriginsStruct,"Invalid JSON-RPC origins",t)},n.KeyringOriginsStruct=(0,r.object)({allowedOrigins:(0,r.optional)(a)}),n.assertIsKeyringOrigins=function(e,t){(0,i.assertStruct)(e,n.KeyringOriginsStruct,"Invalid keyring origins",t)},n.isOriginAllowed=function(e,t,n){return"metamask"===n||(!!e.allowedOrigins?.some((e=>o(e,n)))||(!(t!==s.SubjectType.Website||!e.dapps)||Boolean(t===s.SubjectType.Snap&&e.snaps)))},n.assertIsJsonRpcSuccess=function(e){if(!(0,i.isJsonRpcSuccess)(e)){if((0,i.isJsonRpcFailure)(e))throw new Error(`JSON-RPC request failed: ${e.error.message}`);throw new Error("Invalid JSON-RPC response.")}}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/json-rpc.cjs"}],[2048,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getJsonSizeUnsafe=n.parseJson=void 0;const s=e("@metamask/utils");n.parseJson=function(e){return(0,s.getSafeJson)(JSON.parse(e))},n.getJsonSizeUnsafe=function(e){const t=JSON.stringify(e);return(new TextEncoder).encode(t).byteLength}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/json.cjs"}],[2049,{"./json.cjs":2048,"@metamask/snaps-sdk":2676,"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSnapManifestLocalizations=n.getLocalizedSnapManifest=n.translate=n.TRANSLATION_REGEX=n.getLocalizationFile=n.getValidatedLocalizationFiles=n.LocalizationFileStruct=n.LOCALIZABLE_FIELDS=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),i=e("./json.cjs");function a(e,t){const n=t.find((t=>t.locale===e));return n||t.find((e=>"en"===e.locale))}function o(e,t){const s=e.matchAll(n.TRANSLATION_REGEX);return Array.from(s).reduce(((n,[s,r])=>{if(!t)throw new Error(`Failed to translate "${e}": No localization file found.`);const i=t.messages[r.trim()];if(!i)throw new Error(`Failed to translate "${e}": No translation found for "${r.trim()}" in "${t.locale}" file.`);return n.replace(s,i.message)}),e)}function c(e,t,s){const r=a(t,s);return n.LOCALIZABLE_FIELDS.reduce(((e,t)=>{const n=o(e[t],r);return{...e,[t]:n}}),e)}n.LOCALIZABLE_FIELDS=["description","proposedName"],n.LocalizationFileStruct=(0,r.object)({locale:(0,r.string)(),messages:(0,r.record)((0,r.string)(),(0,r.object)({message:(0,r.string)(),description:(0,r.optional)((0,r.string)())}))}),n.getValidatedLocalizationFiles=function(e){for(const t of e)try{t.result=(0,r.create)((0,i.parseJson)(t.toString()),n.LocalizationFileStruct)}catch(e){if(e instanceof r.StructError)throw new Error(`Failed to validate localization file "${t.path}": ${e.message}.`);if(e instanceof SyntaxError)throw new Error(`Failed to parse localization file "${t.path}" as JSON.`);throw e}return e},n.getLocalizationFile=a,n.TRANSLATION_REGEX=/\{\{\s?([a-zA-Z0-9-_\s]+)\s?\}\}/gu,n.translate=o,n.getLocalizedSnapManifest=c,n.validateSnapManifestLocalizations=function(e,t){try{t.filter((e=>"en"!==e.locale)).forEach((n=>{c(e,n.locale,t)})),c(e,"en",t)}catch(e){throw new Error(`Failed to localize Snap manifest: ${(0,s.getErrorMessage)(e)}`)}}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/localization.cjs"}],[205,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/transaction-controller"),r=e("lodash");n.default={version:22,migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=22;try{const e=function(e){const t=e,{TransactionController:n}=t;if(n&&n.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(e.status!==s.TransactionStatus.submitted||e.submittedTime||(e.submittedTime=(new Date).getTime()),e)))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #22${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/022.js"}],[2050,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.logWarning=n.logError=n.logInfo=n.snapsLogger=void 0;const s=e("@metamask/utils");n.snapsLogger=(0,s.createProjectLogger)("snaps"),n.logInfo=function(e,...t){console.log(e,...t)},n.logError=function(e,...t){console.error(e,...t)},n.logWarning=function(e,...t){console.warn(e,...t)}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/logging.cjs"}],[2051,{"./validation.cjs":2052},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./validation.cjs"),n)}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/manifest/index.cjs"}],[2052,{"../array.cjs":2028,"../cronjob.cjs":2035,"../entropy.cjs":2040,"../json-rpc.cjs":2047,"../namespace.cjs":2053,"../snaps.cjs":2057,"../structs.cjs":2059,"../types.cjs":2061,"@metamask/key-tree":1850,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSnapManifest=n.assertIsSnapManifest=n.isSnapManifest=n.SnapManifestStruct=n.InitialConnectionsStruct=n.SnapAuxilaryFilesStruct=n.PermissionsStruct=n.EmptyObjectStruct=n.HandlerCaveatsStruct=n.ProtocolScopesStruct=n.MaxRequestTimeStruct=n.MAXIMUM_REQUEST_TIMEOUT=n.MINIMUM_REQUEST_TIMEOUT=n.LookupMatchersStruct=n.ChainIdsStruct=n.SnapIdsStruct=n.SemVerRangeStruct=n.SnapGetBip32EntropyPermissionsStruct=n.Bip32EntropyStruct=n.CurveStruct=n.bip32entropy=n.Bip32PathStruct=n.FORBIDDEN_COIN_TYPES=void 0;const s=e("@metamask/key-tree"),r=e("@metamask/superstruct"),i=e("@metamask/utils"),a=e("../array.cjs"),o=e("../cronjob.cjs"),c=e("../entropy.cjs"),l=e("../json-rpc.cjs"),u=e("../namespace.cjs"),d=e("../snaps.cjs"),h=e("../structs.cjs"),f=e("../types.cjs"),p=[c.SIP_6_MAGIC_VALUE,c.STATE_ENCRYPTION_MAGIC_VALUE];n.FORBIDDEN_COIN_TYPES=[60];const m=n.FORBIDDEN_COIN_TYPES.map((e=>["m","44'",`${e}'`]));n.Bip32PathStruct=(0,r.refine)((0,r.array)((0,r.string)()),"BIP-32 path",(e=>0===e.length?"Path must be a non-empty BIP-32 derivation path array":"m"!==e[0]?'Path must start with "m".':e.length<3?"Paths must have a length of at least three.":e.slice(1).some((e=>!(0,s.isValidBIP32PathSegment)(e)))?"Path must be a valid BIP-32 derivation path array.":p.includes(e[1])?`The purpose "${e[1]}" is not allowed for entropy derivation.`:!m.some((t=>(0,a.isEqual)(e.slice(0,t.length),t)))||`The path "${e.join("/")}" is not allowed for entropy derivation.`));n.bip32entropy=e=>(0,r.refine)(e,"BIP-32 entropy",(e=>"ed25519"!==e.curve||!e.path.slice(1).some((e=>!e.endsWith("'")))||"Ed25519 does not support unhardened paths.")),n.CurveStruct=(0,r.enums)(["ed25519","secp256k1","ed25519Bip32"]),n.Bip32EntropyStruct=(0,n.bip32entropy)((0,r.type)({path:n.Bip32PathStruct,curve:n.CurveStruct})),n.SnapGetBip32EntropyPermissionsStruct=(0,r.size)((0,r.array)(n.Bip32EntropyStruct),1,Infinity),n.SemVerRangeStruct=(0,r.refine)((0,r.string)(),"SemVer range",(e=>!!(0,i.isValidSemVerRange)(e)||"Expected a valid SemVer range.")),n.SnapIdsStruct=(0,r.refine)((0,r.record)(d.SnapIdStruct,(0,r.object)({version:(0,r.optional)(n.SemVerRangeStruct)})),"SnapIds",(e=>0!==Object.keys(e).length)),n.ChainIdsStruct=(0,r.size)((0,r.array)(u.ChainIdStruct),1,Infinity),n.LookupMatchersStruct=(0,r.union)([(0,r.object)({tlds:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity)}),(0,r.object)({schemes:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity)}),(0,r.object)({tlds:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity),schemes:(0,r.size)((0,r.array)((0,r.string)()),1,Infinity)})]),n.MINIMUM_REQUEST_TIMEOUT=(0,i.inMilliseconds)(5,i.Duration.Second),n.MAXIMUM_REQUEST_TIMEOUT=(0,i.inMilliseconds)(3,i.Duration.Minute),n.MaxRequestTimeStruct=(0,r.size)((0,r.integer)(),n.MINIMUM_REQUEST_TIMEOUT,n.MAXIMUM_REQUEST_TIMEOUT),n.ProtocolScopesStruct=(0,r.record)(i.CaipChainIdStruct,(0,r.object)({methods:(0,r.array)((0,r.string)())})),n.HandlerCaveatsStruct=(0,r.object)({maxRequestTime:(0,r.optional)(n.MaxRequestTimeStruct)}),n.EmptyObjectStruct=(0,r.object)({}),n.PermissionsStruct=(0,r.type)({"endowment:assets":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({scopes:n.ChainIdsStruct}))),"endowment:cronjob":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({jobs:(0,r.optional)(o.CronjobSpecificationArrayStruct)}))),"endowment:ethereum-provider":(0,r.optional)(n.EmptyObjectStruct),"endowment:keyring":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,l.KeyringOriginsStruct)),"endowment:protocol":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({scopes:n.ProtocolScopesStruct}))),"endowment:lifecycle-hooks":(0,r.optional)(n.HandlerCaveatsStruct),"endowment:name-lookup":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({chains:(0,r.optional)(n.ChainIdsStruct),matchers:(0,r.optional)(n.LookupMatchersStruct)}))),"endowment:network-access":(0,r.optional)(n.EmptyObjectStruct),"endowment:page-home":(0,r.optional)(n.HandlerCaveatsStruct),"endowment:rpc":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,l.RpcOriginsStruct)),"endowment:signature-insight":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({allowSignatureOrigin:(0,r.optional)((0,r.boolean)())}))),"endowment:transaction-insight":(0,r.optional)((0,h.mergeStructs)(n.HandlerCaveatsStruct,(0,r.object)({allowTransactionOrigin:(0,r.optional)((0,r.boolean)())}))),"endowment:webassembly":(0,r.optional)(n.EmptyObjectStruct),snap_dialog:(0,r.optional)(n.EmptyObjectStruct),snap_manageState:(0,r.optional)(n.EmptyObjectStruct),snap_manageAccounts:(0,r.optional)(n.EmptyObjectStruct),snap_notify:(0,r.optional)(n.EmptyObjectStruct),snap_getBip32Entropy:(0,r.optional)(n.SnapGetBip32EntropyPermissionsStruct),snap_getBip32PublicKey:(0,r.optional)(n.SnapGetBip32EntropyPermissionsStruct),snap_getBip44Entropy:(0,r.optional)((0,r.size)((0,r.array)((0,r.object)({coinType:(0,r.size)((0,r.integer)(),0,2**32-1)})),1,Infinity)),snap_getEntropy:(0,r.optional)(n.EmptyObjectStruct),snap_getLocale:(0,r.optional)(n.EmptyObjectStruct),wallet_snap:(0,r.optional)(n.SnapIdsStruct)}),n.SnapAuxilaryFilesStruct=(0,r.array)((0,r.string)()),n.InitialConnectionsStruct=(0,r.record)((0,r.intersection)([(0,r.string)(),(0,f.uri)()]),(0,r.object)({})),n.SnapManifestStruct=(0,r.object)({version:i.VersionStruct,description:(0,r.size)((0,r.string)(),1,280),proposedName:(0,r.size)((0,r.string)(),1,214),repository:(0,r.optional)((0,r.type)({type:(0,r.size)((0,r.string)(),1,Infinity),url:(0,r.size)((0,r.string)(),1,Infinity)})),source:(0,r.object)({shasum:i.ChecksumStruct,location:(0,r.object)({npm:(0,r.object)({filePath:(0,r.size)((0,r.string)(),1,Infinity),iconPath:(0,r.optional)((0,r.size)((0,r.string)(),1,Infinity)),packageName:f.NameStruct,registry:(0,r.union)([(0,r.literal)("https://registry.npmjs.org"),(0,r.literal)("https://registry.npmjs.org/")])})}),files:(0,r.optional)(n.SnapAuxilaryFilesStruct),locales:(0,r.optional)(n.SnapAuxilaryFilesStruct)}),initialConnections:(0,r.optional)(n.InitialConnectionsStruct),initialPermissions:n.PermissionsStruct,manifestVersion:(0,r.literal)("0.1"),platformVersion:(0,r.optional)(i.VersionStruct),$schema:(0,r.optional)((0,r.string)())}),n.isSnapManifest=function(e){return(0,r.is)(e,n.SnapManifestStruct)},n.assertIsSnapManifest=function(e){(0,i.assertStruct)(e,n.SnapManifestStruct,`"${f.NpmSnapFileNames.Manifest}" is invalid`)},n.createSnapManifest=function(e){return(0,r.create)(e,n.SnapManifestStruct)}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/manifest/validation.cjs"}],[2053,{"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isNamespace=n.isAccountIdArray=n.isAccountId=n.isChainId=n.isNamespaceId=n.NamespaceIdStruct=n.NamespaceStruct=n.ChainStruct=n.AccountAddressStruct=n.AccountIdArrayStruct=n.AccountIdStruct=n.ChainIdStruct=n.ChainIdStringStruct=n.LimitedString=n.parseAccountId=n.parseChainId=n.ACCOUNT_ADDRESS_REGEX=n.ACCOUNT_ID_REGEX=n.CHAIN_ID_REGEX=void 0;const s=e("@metamask/superstruct");n.CHAIN_ID_REGEX=/^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-a-zA-Z0-9]{1,32})$/u,n.ACCOUNT_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-a-zA-Z0-9]{1,32})):(?<accountAddress>[a-zA-Z0-9]{1,64})$/u,n.ACCOUNT_ADDRESS_REGEX=/^(?<accountAddress>[a-zA-Z0-9]{1,64})$/u,n.parseChainId=function(e){const t=n.CHAIN_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid chain ID.");return{namespace:t.groups.namespace,reference:t.groups.reference}},n.parseAccountId=function(e){const t=n.ACCOUNT_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid account ID.");return{address:t.groups.accountAddress,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.LimitedString=(0,s.size)((0,s.string)(),1,40),n.ChainIdStringStruct=(0,s.define)("Chain ID",(0,s.string)().validator),n.ChainIdStruct=(0,s.pattern)(n.ChainIdStringStruct,n.CHAIN_ID_REGEX),n.AccountIdStruct=(0,s.pattern)((0,s.string)(),n.ACCOUNT_ID_REGEX),n.AccountIdArrayStruct=(0,s.array)(n.AccountIdStruct),n.AccountAddressStruct=(0,s.pattern)((0,s.string)(),n.ACCOUNT_ADDRESS_REGEX),n.ChainStruct=(0,s.object)({id:n.ChainIdStruct,name:n.LimitedString}),n.NamespaceStruct=(0,s.object)({chains:(0,s.array)(n.ChainStruct),methods:(0,s.optional)((0,s.array)(n.LimitedString)),events:(0,s.optional)((0,s.array)(n.LimitedString))}),n.NamespaceIdStruct=(0,s.pattern)((0,s.string)(),/^[-a-z0-9]{3,8}$/u),n.isNamespaceId=function(e){return(0,s.is)(e,n.NamespaceIdStruct)},n.isChainId=function(e){return(0,s.is)(e,n.ChainIdStruct)},n.isAccountId=function(e){return(0,s.is)(e,n.AccountIdStruct)},n.isAccountIdArray=function(e){return(0,s.is)(e,n.AccountIdArrayStruct)},n.isNamespace=function(e){return(0,s.is)(e,n.NamespaceStruct)}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/namespace.cjs"}],[2054,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeRelative=void 0;const s=e("@metamask/utils");n.normalizeRelative=function(e){return(0,s.assert)(!e.startsWith("/")),(0,s.assert)(-1===e.search(/:|\/\//u),`Path "${e}" potentially an URI instead of local relative`),e.startsWith("./")?e.slice(2):e}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/path.cjs"}],[2055,{"@metamask/snaps-sdk/package.json":2758},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getPlatformVersion=void 0;const r=s(e("@metamask/snaps-sdk/package.json"));n.getPlatformVersion=function(){return r.default.version}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/platform-version.cjs"}],[2056,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/promise.cjs"}],[2057,{"./caveats.cjs":2032,"./checksum.cjs":2033,"./types.cjs":2061,"@metamask/superstruct":2799,"@metamask/utils":2874,"@scure/base":2951,"fast-json-stable-stringify":4358,"validate-npm-package-name":5603},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.verifyRequestedSnapPermissions=n.isSnapPermitted=n.isCaipChainId=n.assertIsValidSnapId=n.isSnapId=n.stripSnapPrefix=n.getSnapPrefix=n.SnapIdStruct=n.HttpSnapIdStruct=n.NpmSnapIdStruct=n.LocalSnapIdStruct=n.BaseSnapIdStruct=n.LOCALHOST_HOSTNAMES=n.validateSnapShasum=n.getSnapChecksum=n.SnapStatusEvents=n.SnapStatus=n.PROPOSED_NAME_REGEX=void 0;const r=e("@metamask/superstruct"),i=e("@metamask/utils"),a=e("@scure/base"),o=s(e("fast-json-stable-stringify")),c=s(e("validate-npm-package-name")),l=e("./caveats.cjs"),u=e("./checksum.cjs"),d=e("./types.cjs");var h,f;function p(e){const t=e.clone();return delete t.result.source.shasum,t.value=(0,o.default)(t.result),t}async function m(e){const{manifest:t,sourceCode:n,svgIcon:s,auxiliaryFiles:r,localizationFiles:i}=e,o=[p(t),n,s,...r,...i].filter((e=>e!==undefined));return a.base64.encode(await(0,u.checksumFiles)(o))}n.PROPOSED_NAME_REGEX=/^(?:[A-Za-z0-9-_]+( [A-Za-z0-9-_]+)*)|(?:(?:@[A-Za-z0-9-*~][A-Za-z0-9-*._~]*\/)?[A-Za-z0-9-~][A-Za-z0-9-._~]*)$/u,function(e){e.Installing="installing",e.Updating="updating",e.Running="running",e.Stopped="stopped",e.Crashed="crashed"}(h||(n.SnapStatus=h={})),function(e){e.Start="START",e.Stop="STOP",e.Crash="CRASH",e.Update="UPDATE"}(f||(n.SnapStatusEvents=f={})),n.getSnapChecksum=m,n.validateSnapShasum=async function(e,t="Invalid Snap manifest: manifest shasum does not match computed shasum."){if(e.manifest.result.source.shasum!==await m(e))throw new Error(t)},n.LOCALHOST_HOSTNAMES=["localhost","127.0.0.1","[::1]"],n.BaseSnapIdStruct=(0,r.pattern)((0,r.string)(),/^[\x21-\x7E]*$/u);const g=(0,d.uri)({protocol:(0,r.enums)(["http:","https:"]),hostname:(0,r.enums)(n.LOCALHOST_HOSTNAMES),hash:(0,r.empty)((0,r.string)()),search:(0,r.empty)((0,r.string)())});function y(e){const t=Object.values(d.SnapIdPrefixes).find((t=>e.startsWith(t)));if(t!==undefined)return t;throw new Error(`Invalid or no prefix found for "${e}"`)}n.LocalSnapIdStruct=(0,r.refine)(n.BaseSnapIdStruct,"local Snap Id",(e=>{if(!e.startsWith(d.SnapIdPrefixes.local))return`Expected local snap ID, got "${e}".`;const[t]=(0,r.validate)(e.slice(d.SnapIdPrefixes.local.length),g);return t??!0})),n.NpmSnapIdStruct=(0,r.intersection)([n.BaseSnapIdStruct,(0,d.uri)({protocol:(0,r.literal)(d.SnapIdPrefixes.npm),pathname:(0,r.refine)((0,r.string)(),"package name",(function*(e){const t=e.startsWith("/")?e.slice(1):e,{errors:n,validForNewPackages:s,warnings:r}=(0,c.default)(t);return s||(n===undefined?((0,i.assert)(r!==undefined),yield*r):yield*n),!0})),search:(0,r.empty)((0,r.string)()),hash:(0,r.empty)((0,r.string)())})]),n.HttpSnapIdStruct=(0,r.intersection)([n.BaseSnapIdStruct,(0,d.uri)({protocol:(0,r.enums)(["http:","https:"]),search:(0,r.empty)((0,r.string)()),hash:(0,r.empty)((0,r.string)())})]),n.SnapIdStruct=(0,r.union)([n.NpmSnapIdStruct,n.LocalSnapIdStruct]),n.getSnapPrefix=y,n.stripSnapPrefix=function(e){return e.replace(y(e),"")},n.isSnapId=function(e){return(0,r.is)(e,n.SnapIdStruct)},n.assertIsValidSnapId=function(e){(0,i.assertStruct)(e,n.SnapIdStruct,"Invalid snap ID")},n.isCaipChainId=function(e){return"string"==typeof e&&/^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-a-zA-Z0-9]{1,32})$/u.test(e)},n.isSnapPermitted=function(e,t){return Boolean((e?.wallet_snap?.caveats?.find((e=>e.type===l.SnapCaveatType.SnapIds))??{}).value?.[t])},n.verifyRequestedSnapPermissions=function(e){(0,i.assert)((0,i.isObject)(e),"Requested permissions must be an object.");const{wallet_snap:t}=e;(0,i.assert)((0,i.isObject)(t),"wallet_snap is missing from the requested permissions.");const{caveats:n}=t;(0,i.assert)(Array.isArray(n)&&1===n.length,"wallet_snap must have a caveat property with a single-item array value.");const[s]=n;(0,i.assert)((0,i.isObject)(s)&&s.type===l.SnapCaveatType.SnapIds&&(0,i.isObject)(s.value),`The requested permissions do not have a valid ${l.SnapCaveatType.SnapIds} caveat.`)}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/snaps.cjs"}],[2058,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.indent=void 0,n.indent=function(e,t=2){return e.replace(/^/gmu," ".repeat(t))}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/strings.cjs"}],[2059,{"./strings.cjs":2058,"@metamask/snaps-sdk":2676,"@metamask/superstruct":2799,"@metamask/utils":2874,chalk:4018},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mergeStructs=n.createUnion=n.validateUnion=n.getStructErrorMessage=n.getStructFailureMessage=n.getStructErrorPrefix=n.getUnionStructNames=n.getStructFromPath=n.createFromStruct=n.getError=n.arrayToGenerator=n.SnapsStructError=n.named=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/superstruct"),i=e("@metamask/utils"),a=e("chalk"),o=e("./strings.cjs");function c(e,t,n){return n?t(e):e}n.named=function(e,t){return new r.Struct({...t,type:e})};class l extends r.StructError{constructor(e,t,n,s,r,i=!0){super(s,r),this.name="SnapsStructError",this.message=`${t}.\n\n${g(e,[...r()],i)}${n?`\n\n${n}`:""}`}}function*u(e){for(const t of e)yield t}function d({struct:e,prefix:t,suffix:n="",error:s,colorize:r}){return new l(e,t,n,s,(()=>u(s.failures())),r)}function h(e,t){return t.reduce(((t,n)=>(0,i.isObject)(e.schema)&&e.schema[n]?e.schema[n]:t),e)}function f(e,t=!0){return Array.isArray(e.schema)?e.schema.map((({type:e})=>c(e,a.green,t))):null}function p(e,t=!0){return"never"===e.type||0===e.path.length?"":`At path: ${c(e.path.join("."),a.bold,t)} â€” `}function m(e,t,n=!0){const s=c(JSON.stringify(t.value),a.red,n),r=p(t,n);if("union"===t.type){const i=f(h(e,t.path),n);return i?`${r}Expected the value to be one of: ${i.join(", ")}, but received: ${s}.`:`${r}${t.message}.`}if("literal"===t.type){return`${r}${t.message.replace(/the literal `(.+)`,/u,`the value to be \`${c("$1",a.green,n)}\`,`).replace(/, but received: (.+)/u,`, but received: ${c("$1",a.red,n)}`)}.`}if("never"===t.type)return`Unknown key: ${c(t.path.join("."),a.bold,n)}, received: ${s}.`;if("size"===t.refinement){return`${r}${t.message.replace(/length between `(\d+)` and `(\d+)`/u,`length between ${c("$1",a.green,n)} and ${c("$2",a.green,n)},`).replace(/length of `(\d+)`/u,`length of ${c("$1",a.red,n)}`).replace(/a array/u,"an array")}.`}return t.refinement!==undefined?`${r}${t.message}.`:`${r}Expected a value of type ${c(t.type,a.green,n)}, but received: ${s}.`}function g(e,t,n=!0){return t.map((t=>(0,o.indent)(`â€¢ ${m(e,t,n)}`))).join("\n")}function y(e,t,n,a=!1){(0,i.assert)(t.schema,"Expected a struct with a schema. Make sure to use `union` from `@metamask/snaps-sdk`."),(0,i.assert)(t.schema.length>0,"Expected a non-empty array of structs.");const o=t.schema.map((e=>e.schema[n])),c=(0,r.type)({[n]:(0,s.union)(o)}),[l]=(0,r.validate)(e,c,{coerce:a});if(l)throw new Error(m(c,l.failures()[0],!1));const u=e,d=t.schema.filter((e=>(0,r.is)(u[n],e.schema[n])));(0,i.assert)(d.length>0,"Expected a struct to match the value.");const h=d.map((e=>(0,r.validate)(u,e,{coerce:a}))),f=h.find((([e])=>!e));if(f)return f[1];(0,i.assert)(h[0][0],"Expected at least one error.");const p=h.reduce(((e,[t])=>((0,i.assert)(t,"Expected an error."),t.failures().length<e.failures().length?t:e)),h[0][0]);throw new Error(m(t,p.failures()[0],!1))}n.SnapsStructError=l,n.arrayToGenerator=u,n.getError=d,n.createFromStruct=function(e,t,n,s=""){try{return(0,r.create)(e,t)}catch(e){if(e instanceof r.StructError)throw d({struct:t,prefix:n,suffix:s,error:e});throw e}},n.getStructFromPath=h,n.getUnionStructNames=f,n.getStructErrorPrefix=p,n.getStructFailureMessage=m,n.getStructErrorMessage=g,n.validateUnion=y,n.createUnion=function(e,t,n){return y(e,t,n,!0)},n.mergeStructs=function(...e){const t=r.assign(...e);return new r.Struct({...t,*refiner(t,n){for(const s of e)yield*s.refiner(t,n)}})}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/structs.cjs"}],[206,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/transaction-controller");n.default={version:23,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=23;try{const e=function(e){const t=e,{TransactionController:n}=t;if(n&&n.transactions){const{transactions:e}=t.TransactionController;if(e.length<=40)return t;const n=e.reverse();let s=!0;for(;n.length>40&&s;){const e=n.findIndex((e=>e.status===r.TransactionStatus.failed||e.status===r.TransactionStatus.rejected||e.status===r.TransactionStatus.confirmed||e.status===r.TransactionStatus.dropped));e<0?s=!1:n.splice(e,1)}t.TransactionController.transactions=n.reverse()}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #23${e.stack}`)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/023.js"}],[2060,{"@metamask/utils":2874,"fast-xml-parser":4360},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSvg=n.parseSvg=void 0;const s=e("@metamask/utils"),r=e("fast-xml-parser");function i(e){try{const t=e.trim();(0,s.assert)(t.length>0);const n=new r.XMLParser({ignoreAttributes:!1,parseAttributeValue:!0}).parse(t,!0);return(0,s.assert)((0,s.hasProperty)(n,"svg")),(0,s.isObject)(n.svg)?n.svg:{}}catch{throw new Error("Snap icon must be a valid SVG.")}}n.parseSvg=i,n.isSvg=function(e){try{return i(e),!0}catch{return!1}}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/svg.cjs"}],[2061,{"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WALLET_SNAP_PERMISSION_KEY=n.isValidUrl=n.uri=n.SNAP_STREAM_NAMES=n.SnapIdPrefixes=n.NpmSnapPackageJsonStruct=n.NameStruct=n.NpmSnapFileNames=void 0;const s=e("@metamask/superstruct"),r=e("@metamask/utils");var i,a,o;!function(e){e.PackageJson="package.json",e.Manifest="snap.manifest.json"}(i||(n.NpmSnapFileNames=i={})),n.NameStruct=(0,s.size)((0,s.pattern)((0,s.string)(),/^(?:@[a-z0-9-*~][a-z0-9-*._~]*\/)?[a-z0-9-~][a-z0-9-._~]*$/u),1,214),n.NpmSnapPackageJsonStruct=(0,s.type)({version:r.VersionStruct,name:n.NameStruct,main:(0,s.optional)((0,s.size)((0,s.string)(),1,Infinity)),repository:(0,s.optional)((0,s.type)({type:(0,s.size)((0,s.string)(),1,Infinity),url:(0,s.size)((0,s.string)(),1,Infinity)}))}),function(e){e.npm="npm:",e.local="local:"}(a||(n.SnapIdPrefixes=a={})),function(e){e.JSON_RPC="jsonRpc",e.COMMAND="command"}(o||(n.SNAP_STREAM_NAMES=o={}));n.uri=(e={})=>(0,s.refine)((0,s.union)([(0,s.string)(),(0,s.instance)(URL)]),"uri",(t=>{try{const n=new URL(t),r=(0,s.type)(e);return(0,s.assert)(n,r),!0}catch{return`Expected URL, got "${t.toString()}".`}})),n.isValidUrl=function(e,t={}){return(0,s.is)(e,(0,n.uri)(t))},n.WALLET_SNAP_PERMISSION_KEY="wallet_snap"}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/types.cjs"}],[2062,{"./url.cjs":2063,"@metamask/snaps-sdk":2676,"@metamask/snaps-sdk/jsx":2757,"@metamask/snaps-sdk/jsx-runtime":2756,"@metamask/utils":2874,marked:4790},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.serialiseJsx=n.walkJsx=n.getJsxChildren=n.hasChildren=n.getTotalTextLength=n.validateJsxLinks=n.validateTextLinks=n.validateLink=n.getJsxElementFromComponent=n.getTextChildren=void 0;const s=e("@metamask/snaps-sdk/jsx-runtime"),r=e("@metamask/snaps-sdk"),i=e("@metamask/snaps-sdk/jsx"),a=e("@metamask/utils"),o=e("marked"),c=e("./url.cjs"),l=5e4,u=["https:","mailto:","metamask:"];function d(e){switch(e){case"primary":return"primary";case"secondary":return"destructive";default:return undefined}}function h(e){return 1===e.length?e[0]:e}function f(e){return e.tokens&&e.tokens.length>0?h(e.tokens.flatMap(m)):e.href}function p(e){return h(e.flatMap(m))}function m(e){switch(e.type){case"link":return(0,s.jsx)(i.Link,{href:e.href,children:f(e)});case"text":return e.text;case"strong":return(0,s.jsx)(i.Bold,{children:p(e.tokens)});case"em":return(0,s.jsx)(i.Italic,{children:p(e.tokens)});default:return null}}function g(e){const t=(0,o.lexer)(e,{gfm:!1}),n=[];return(0,o.walkTokens)(t,(e=>{if("paragraph"===e.type){n.length>0&&n.push("\n\n");const{tokens:t}=e;n.push(...t.flatMap(m))}})),n.filter((e=>null!==e))}function y(e,t,n){try{const s=new URL(e);if((0,a.assert)(u.includes(s.protocol),`Protocol must be one of: ${u.join(", ")}.`),"metamask:"===s.protocol){const t=(0,c.parseMetaMaskUrl)(e);t.snapId&&(0,a.assert)(n(t.snapId),"The Snap being navigated to is not installed.")}else if("mailto:"===s.protocol){const e=s.pathname.split(",");for(const n of e){const e=n.split("@")[1];(0,a.assert)(!e.includes(":"));const s=`https://${e}`;(0,a.assert)(!t(s),"The specified URL is not allowed.")}return}(0,a.assert)(!t(s.href),"The specified URL is not allowed.")}catch(e){throw new Error(`Invalid URL: ${"ERR_ASSERTION"===e?.code?e.message:"Unable to parse URL."}`)}}function w(e){const{type:t}=e;switch(t){case r.NodeType.Panel:return e.children.reduce(((e,t)=>e+w(t)),0);case r.NodeType.Row:return w(e.value);case r.NodeType.Text:return e.value.length;default:return 0}}function b(e){return(0,a.hasProperty)(e.props,"children")}function v(e){return Boolean(e)&&!0!==e}function S(e){if(b(e)){if(Array.isArray(e.props.children))return e.props.children.filter(v).flat(Infinity);if(e.props.children)return[e.props.children]}return[]}function k(e,t,n=0){if(Array.isArray(e)){for(const s of e){const e=k(s,t,n);if(e!==undefined)return e}return undefined}const s=t(e,n);if(s!==undefined)return s;if((0,a.hasProperty)(e,"props")&&(0,a.isPlainObject)(e.props)&&(0,a.hasProperty)(e.props,"children")){const s=S(e);for(const e of s)if((0,a.isPlainObject)(e)){const s=k(e,t,n+1);if(s!==undefined)return s}}return undefined}function T(e){return Object.entries(e).filter((([e])=>"children"!==e)).sort((([e],[t])=>e.localeCompare(t))).map((([e,t])=>{return` ${e}=${n=t,"string"==typeof n?`"${n}"`:`{${JSON.stringify(n)}}`}`;var n})).join("")}n.getTextChildren=g,n.getJsxElementFromComponent=function(e){return function(e){const t=w(e);(0,a.assert)(t<=l,`The text in a Snap UI may not be larger than ${l/1e3} kB.`)}(e),function e(t){switch(t.type){case r.NodeType.Address:return(0,s.jsx)(i.Address,{address:t.value});case r.NodeType.Button:return(0,s.jsx)(i.Button,{name:t.name,variant:d(t.variant),type:t.buttonType,children:t.value});case r.NodeType.Copyable:return(0,s.jsx)(i.Copyable,{value:t.value,sensitive:t.sensitive});case r.NodeType.Divider:return(0,s.jsx)(i.Divider,{});case r.NodeType.Form:return(0,s.jsx)(i.Form,{name:t.name,children:h(t.children.map(e))});case r.NodeType.Heading:return(0,s.jsx)(i.Heading,{children:t.value});case r.NodeType.Image:return(0,s.jsx)(i.Image,{src:t.value});case r.NodeType.Input:return(0,s.jsx)(i.Field,{label:t.label,error:t.error,children:(0,s.jsx)(i.Input,{name:t.name,type:t.inputType,value:t.value,placeholder:t.placeholder})});case r.NodeType.Panel:return(0,s.jsx)(i.Box,{children:h(t.children.map(e))});case r.NodeType.Row:return(0,s.jsx)(i.Row,{label:t.label,variant:t.variant,children:e(t.value)});case r.NodeType.Spinner:return(0,s.jsx)(i.Spinner,{});case r.NodeType.Text:return(0,s.jsx)(i.Text,{children:h(g(t.value))});default:return(0,a.assertExhaustive)(t)}}(e)},n.validateLink=y,n.validateTextLinks=function(e,t,n){const s=function(e){const t=(0,o.lexer)(e,{gfm:!1}),n=[];return(0,o.walkTokens)(t,(e=>{"link"===e.type&&n.push(e)})),n}(e);for(const e of s)y(e.href,t,n)},n.validateJsxLinks=function(e,t,n){k(e,(e=>{"Link"===e.type&&y(e.props.href,t,n)}))},n.getTotalTextLength=w,n.hasChildren=b,n.getJsxChildren=S,n.walkJsx=k,n.serialiseJsx=function e(t,n=0){if(Array.isArray(t))return t.map((t=>e(t,n))).join("");const s="  ".repeat(n);if("string"==typeof t)return`${s}${t}\n`;if(!t)return"";const{type:r,props:i}=t,o=n>0?"\n":"";if((0,a.hasProperty)(i,"children")){const t=e(i.children,n+1);return`${s}<${r}${T(i)}>\n${t}${s}</${r}>${o}`}return`${s}<${r}${T(i)} />${o}`}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/ui.cjs"}],[2063,{"./snaps.cjs":2057,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseMetaMaskUrl=n.SNAP_PATHS=n.CLIENT_PATHS=void 0;const s=e("@metamask/utils"),r=e("./snaps.cjs");n.CLIENT_PATHS=["/"],n.SNAP_PATHS=["/home"],n.parseMetaMaskUrl=function(e){const t=new URL(e),{protocol:i}=t;if("metamask:"!==i)throw new Error(`Unable to parse URL. Expected the protocol to be "metamask:", but received "${i}".`);const[a,...o]=t.href.replace("metamask://","").split("/"),c=`/${o.join("/")}`;switch(a){case"client":return(0,s.assert)(n.CLIENT_PATHS.includes(c),`Unable to navigate to "${c}". The provided path is not allowed.`),{authority:a,path:c};case"snap":return function(e){const t="Invalid MetaMask url:",i=(0,r.stripSnapPrefix)(e.slice(1)),a=e.slice(1).startsWith("npm:")?"npm:":"local:",o=i.startsWith("@"),c=i.split("/"),l=`/${c[c.length-1]}`;let u;if("local:"===a){const[e,,...r]=c.slice(0,-1);u=`${e}//${r.join("/")}`,(0,s.assert)(n.SNAP_PATHS.includes(l),`${t} invalid snap path.`)}else u=o?`${c[0]}/${c[1]}`:c[0],(0,s.assert)(o?3===c.length&&n.SNAP_PATHS.includes(l):2===c.length&&n.SNAP_PATHS.includes(l),`${t} invalid snap path.`);const d=`${a}${u}`;return(0,r.assertIsValidSnapId)(d),{authority:"snap",snapId:d,path:l}}(c);default:throw new Error(`Expected "metamask:" URL to start with "client" or "snap", but received "${a}".`)}}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/url.cjs"}],[2064,{"./icon.cjs":2044,"./localization.cjs":2049,"./manifest/validation.cjs":2052,"./snaps.cjs":2057},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateFetchedSnap=void 0;const s=e("./icon.cjs"),r=e("./localization.cjs"),i=e("./manifest/validation.cjs"),a=e("./snaps.cjs");n.validateFetchedSnap=async function(e){(0,i.assertIsSnapManifest)(e.manifest.result),await(0,a.validateSnapShasum)(e),(0,r.validateSnapManifestLocalizations)(e.manifest.result,e.localizationFiles.map((e=>e.result))),e.svgIcon&&(0,s.assertIsSnapIcon)(e.svgIcon)}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/validation.cjs"}],[2065,{"@metamask/superstruct":2799,"@metamask/utils":2874,semver:5471},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.resolveVersionRange=n.getTargetVersion=n.DEFAULT_REQUESTED_SNAP_VERSION=void 0;const s=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("semver");n.DEFAULT_REQUESTED_SNAP_VERSION="*",n.getTargetVersion=function(e,t){const n=(0,i.maxSatisfying)(e,t);return n||(0,i.maxSatisfying)(e,t,{includePrerelease:!0})},n.resolveVersionRange=function(e){return e===undefined||"latest"===e?[undefined,n.DEFAULT_REQUESTED_SNAP_VERSION]:(0,s.validate)(e,r.VersionRangeStruct)}}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/versions.cjs"}],[2066,{"../deep-clone.cjs":2037,"@metamask/utils":2874,"@scure/base":2951},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VirtualFile=void 0;const s=e("@metamask/utils"),r=e("@scure/base"),i=e("../deep-clone.cjs");class a{constructor(e){let t;t="string"==typeof e||e instanceof Uint8Array?{value:e}:e,this.value=t?.value??"",this.result=t?.result??undefined,this.data=t?.data??{},this.path=t?.path??"/"}get size(){return"string"==typeof this.value?this.value.length:this.value.byteLength}toString(e){if("string"==typeof this.value)return(0,s.assert)(e===undefined,"Tried to encode string."),this.value;if(this.value instanceof Uint8Array&&"hex"===e)return(0,s.bytesToHex)(this.value);if(this.value instanceof Uint8Array&&"base64"===e)return r.base64.encode(this.value);return new TextDecoder(e).decode(this.value)}clone(){const e=new a;return"string"==typeof this.value?e.value=this.value:e.value=this.value.slice(0),e.result=(0,i.deepClone)(this.result),e.data=(0,i.deepClone)(this.data),e.path=this.path,e}}n.VirtualFile=a}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/virtual-file/VirtualFile.cjs"}],[2067,{"./VirtualFile.cjs":2066},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./VirtualFile.cjs"),n)}}},{package:"@metamask/multichain-transactions-controller>@metamask/snaps-utils",file:"node_modules/@metamask/multichain-transactions-controller/node_modules/@metamask/snaps-utils/dist/virtual-file/index.cjs"}],[207,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/transaction-controller");n.default={version:24,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=24;const n=function(e){const t=e;if(!t.TransactionController)return t;const{transactions:n}=t.TransactionController;return t.TransactionController.transactions=n.map(((e,t)=>(e.status===r.TransactionStatus.unapproved&&e.txParams&&e.txParams.from&&(e.txParams.from=e.txParams.from.toLowerCase()),e))),t}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/024.js"}],[208,{"../lib/util":183,"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/transaction-controller"),i=e("../lib/util");n.default={version:25,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=25;const n=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.map((e=>(e.status!==r.TransactionStatus.unapproved||(e.txParams=function(e){const t={from:e=>(0,i.addHexPrefix)(e).toLowerCase(),to:()=>(0,i.addHexPrefix)(e.to).toLowerCase(),nonce:e=>(0,i.addHexPrefix)(e),value:e=>(0,i.addHexPrefix)(e),data:e=>(0,i.addHexPrefix)(e),gas:e=>(0,i.addHexPrefix)(e),gasPrice:e=>(0,i.addHexPrefix)(e)},n={};return Object.keys(t).forEach((s=>{e[s]&&(n[s]=t[s](e[s]))})),n}(e.txParams)),e)))}return t}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/025.js"}],[209,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:26,migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=26;try{const e=t.data;t.data=function(e){if(!e.KeyringController||!e.PreferencesController)return e;if(!e.KeyringController.walletNicknames)return e;return e.PreferencesController.identities=Object.keys(e.KeyringController.walletNicknames).reduce(((t,n)=>(t[n]={name:e.KeyringController.walletNicknames[n],address:n},t)),{}),delete e.KeyringController.walletNicknames,e}(e)}catch(e){return console.warn(`MetaMask Migration #26${e.stack}`),Promise.reject(e)}return Promise.resolve(t)}}}}},{package:"$root$",file:"app/scripts/migrations/026.js"}],[21,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainNetworkControllerMessenger=function(e){return e.getRestricted({name:"MultichainNetworkController",allowedActions:["NetworkController:setActiveNetwork","NetworkController:getState"],allowedEvents:["AccountsController:selectedAccountChange"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-network-controller-messenger.ts"}],[210,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/transaction-controller");n.default={version:27,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=27;const n=function(e){const t=e;if(t.TransactionController&&t.TransactionController.transactions){const{transactions:e}=t.TransactionController;t.TransactionController.transactions=e.filter((e=>e.status!==r.TransactionStatus.rejected))}return t}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/027.js"}],[211,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:28,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=28;const n=function(e){const t=e;if(t.PreferencesController&&t.PreferencesController.tokens&&t.PreferencesController.identities){const{identities:e,tokens:n}=t.PreferencesController;t.PreferencesController.accountTokens={},Object.keys(e).forEach((e=>{t.PreferencesController.accountTokens[e]={mainnet:n}})),t.PreferencesController.tokens=[]}return t}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/028.js"}],[212,{"./fail-tx":352,"@metamask/transaction-controller":2829},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s,r=e("@metamask/transaction-controller"),i=(s=e("./fail-tx"))&&s.__esModule?s:{default:s};n.default={version:29,migrate:(0,i.default)(29,"Stuck in approved state for too long.",(e=>{const t=e.status===r.TransactionStatus.approved,n=e.submittedTime,s=Date.now();return t&&s-n>432e5}))}}}},{package:"$root$",file:"app/scripts/migrations/029.js"}],[213,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:30,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=30;const n=function(e){const t=e;if(e.PreferencesController){const{frequentRpcListDetail:e}=t.PreferencesController;e&&(e.forEach(((t,n)=>{Boolean(t.chainId)&&Number.isNaN(parseInt(t.chainId))&&delete e[n].chainId})),t.PreferencesController.frequentRpcListDetail=e)}e.NetworkController&&(t.NetworkController.network&&Number.isNaN(parseInt(t.NetworkController.network))&&delete t.NetworkController.network,t.NetworkController.provider&&t.NetworkController.provider.chainId&&Number.isNaN(parseInt(t.NetworkController.provider.chainId))&&delete t.NetworkController.provider.chainId);return t}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/030.js"}],[214,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:31,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=31;const n=function(e){const{KeyringController:t,PreferencesController:n}=e;if(t&&n){const{vault:e}=t;n.completedOnboarding=Boolean(e)}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/031.js"}],[215,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:32,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=32;const n=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const{betaUI:e}=t.featureFlags||{};t.completedUiMigration=e}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/032.js"}],[216,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:33,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=33;const n=function(e){const t=e;e.NoticeController&&delete t.NoticeController;return t}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/033.js"}],[217,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:34,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=34;const n=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.featureFlags||{};e.privacyMode||void 0!==t.migratedPrivacyMode||(t.migratedPrivacyMode=!0,e.privacyMode=!0)}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/034.js"}],[218,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:35,async migrate(e){const t=(0,s.cloneDeep)(e);return t.meta.version=35,t.data=function(e){e.PreferencesController&&e.PreferencesController.seedWords!==undefined&&delete e.PreferencesController.seedWords;return e}(t.data),t}}}}},{package:"$root$",file:"app/scripts/migrations/035.js"}],[219,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:36,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=36;const n=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.featureFlags||{};void 0!==e.privacyMode&&delete e.privacyMode}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/036.js"}],[22,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getMultichainTransactionsControllerMessenger=function(e){return e.getRestricted({name:"MultichainTransactionsController",allowedEvents:["AccountsController:accountAdded","AccountsController:accountRemoved","AccountsController:accountTransactionsUpdated"],allowedActions:["AccountsController:listMultichainAccounts","SnapController:handleRequest","KeyringController:getState"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/multichain/multichain-transactions-controller-messenger.ts"}],[220,{"@metamask/controller-utils":1360,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/controller-utils");n.default={version:37,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=37;const n=t.data;return t.data=function(e){if(e.AddressBookController){const t=e.AddressBookController.addressBook,n=new Set,s={};Object.values(t).forEach((e=>{n.add(e.chainId)}));for(const e of n.values()){s[e]={};for(const n in t)t[n].chainId===e&&(t[n].isEns=!1,(0,r.normalizeEnsName)(t[n].name)&&(t[n].isEns=!0),s[e][n]=t[n])}e.AddressBookController.addressBook=s}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/037.js"}],[221,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:38,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=38;const n=t.data;return t.data=function(e){const{ABTestController:t={}}=e,{abTests:n={}}=t;if(n.fullScreenVsPopup)return e;return{...e,ABTestController:{...t,abTests:{...n,fullScreenVsPopup:"control"}}}}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/038.js"}],[222,{"../../../shared/modules/hexstring-utils":5716,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("../../../shared/modules/hexstring-utils");const i="0x89d24A6b4CcB1B6fAA2625fE562bDD9a23260359",a="DAI",o="SAI";function c(e={}){return e&&"object"==typeof e&&e.symbol===a&&(0,r.toChecksumHexAddress)(e.address)===i}n.default={version:39,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=39;const n=t.data;return t.data=function(e){const{PreferencesController:t}=e;if(t){const e=t.tokens||[];if(Array.isArray(e))for(const t of e)c(t)&&(t.symbol=o);const n=t.accountTokens||{};if(n&&"object"==typeof n)for(const e of Object.keys(n)){const t=n[e];if(t&&"object"==typeof t)for(const e of Object.keys(t)){const n=t[e];if(Array.isArray(n))for(const e of n)c(e)&&(e.symbol=o)}}}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/039.js"}],[223,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:40,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=40;const n=t.data;return t.data=function(e){return delete e.ProviderApprovalController,e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/040.js"}],[224,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:41,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=41;const n=t.data;return t.data=function(e){e.PreferencesController&&e.PreferencesController.preferences&&(e.PreferencesController.preferences.autoLockTimeLimit=e.PreferencesController.preferences.autoLogoutTimeLimit,delete e.PreferencesController.preferences.autoLogoutTimeLimit);return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/041.js"}],[225,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:42,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=42;const n=t.data;return t.data=function(e){e.AppStateController?e.AppStateController.connectedStatusPopoverHasBeenShown=!1:e.AppStateController={connectedStatusPopoverHasBeenShown:!1};return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/042.js"}],[226,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:43,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=43;const n=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.PreferencesController)&&void 0!==t&&t.currentAccountTab&&delete e.PreferencesController.currentAccountTab;return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/043.js"}],[227,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:44,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=44;const n=t.data;return t.data=function(e){var t;void 0!==(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.mkrMigrationReminderTimestamp)&&delete e.AppStateController.mkrMigrationReminderTimestamp;return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/044.js"}],[228,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:45,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=45;const n=t.data;return t.data=function(e){var t;r.includes(null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.ipfsGateway)&&(e.PreferencesController.ipfsGateway="dweb.link");return e}(n),t}};const r=["ipfs.io","ipfs.dweb.link"]}}},{package:"$root$",file:"app/scripts/migrations/045.js"}],[229,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:46,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=46;const n=t.data;return t.data=function(e){void 0!==(null==e?void 0:e.ABTestController)&&delete e.ABTestController;return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/046.js"}],[23,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPPOMControllerInitMessenger=function(e){return e.getRestricted({name:"PPOMControllerInit",allowedEvents:["PreferencesController:stateChange"],allowedActions:[]})},n.getPPOMControllerMessenger=function(e){return e.getRestricted({name:"PPOMController",allowedEvents:["NetworkController:stateChange","NetworkController:networkDidChange"],allowedActions:["NetworkController:getNetworkClientById"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/ppom-controller-messenger.ts"}],[230,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:47,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=47;const n=t.data;return t.data=function(e){var t;const n=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;Array.isArray(n)&&n.forEach((e=>{"number"==typeof e.metamaskNetworkId&&(e.metamaskNetworkId=e.metamaskNetworkId.toString())}));return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/047.js"}],[2300,{"./push-utils.cjs":2301},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSubscribeToPushNotifications=n.deleteRegToken=n.createRegToken=void 0;var s=e("./push-utils.cjs");Object.defineProperty(n,"createRegToken",{enumerable:!0,get:function(){return s.createRegToken}}),Object.defineProperty(n,"deleteRegToken",{enumerable:!0,get:function(){return s.deleteRegToken}}),Object.defineProperty(n,"createSubscribeToPushNotifications",{enumerable:!0,get:function(){return s.createSubscribeToPushNotifications}})}}},{package:"@metamask/notification-services-controller",file:"node_modules/@metamask/notification-services-controller/dist/NotificationServicesPushController/web/index.cjs"}],[2301,{"../../NotificationServicesController/index.cjs":2280,"../../shared/to-raw-notification.cjs":2305,"firebase/app":4372,"firebase/messaging":4373,"firebase/messaging/sw":4374,loglevel:4787},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.createSubscribeToPushNotifications=n.deleteRegToken=n.createRegToken=n.supportedCache=void 0;const r=e("firebase/app"),i=e("firebase/messaging"),a=e("firebase/messaging/sw"),o=s(e("loglevel")),c=e("../../NotificationServicesController/index.cjs"),l=e("../../shared/to-raw-notification.cjs");n.supportedCache=null;const u=async e=>{if(!await(async()=>(n.supportedCache??(n.supportedCache=await(0,a.isSupported)()),n.supportedCache))())return null;const t=await(async e=>{try{return(0,r.getApp)()}catch{const t={apiKey:e.apiKey,authDomain:e.authDomain,storageBucket:e.storageBucket,projectId:e.projectId,messagingSenderId:e.messagingSenderId,appId:e.appId,measurementId:e.measurementId};return(0,r.initializeApp)(t)}})(e);return(0,a.getMessaging)(t)};n.createRegToken=async function(e){try{const t=await u(e);if(!t)return null;return await(0,i.getToken)(t,{serviceWorkerRegistration:self.registration,vapidKey:e.vapidKey})}catch{return null}},n.deleteRegToken=async function(e){try{const t=await u(e);return!t||(await(0,i.deleteToken)(t),!0)}catch{return!1}},n.createSubscribeToPushNotifications=function(e){return async function(t){const n=await async function(e,t){const n=await u(e);if(!n)return null;const s=(0,a.onBackgroundMessage)(n,(async e=>{try{const n=e?.data?.data?JSON.parse(e?.data?.data):undefined;if(!n)return;const s=(0,l.toRawOnChainNotification)(n),r=c.Processors.processNotification(s);await t(r)}catch(t){throw o.default.error("Unable to send push notification:",{notification:e?.data?.data,error:t}),new Error("Unable to send push notification")}}));return()=>s()}(t,(async t=>{e.messenger.publish("NotificationServicesPushController:onNewNotifications",t),await e.onReceivedHandler(t)})),s=function(e){const t=t=>{const n=t?.notification?.data;e(t,n)};return self.addEventListener("notificationclick",t),()=>self.removeEventListener("notificationclick",t)}(((t,n)=>{e.messenger.publish("NotificationServicesPushController:pushNotificationClicked",n),e.onClickHandler(t,n)}));return()=>{n?.(),s()}}}}}},{package:"@metamask/notification-services-controller",file:"node_modules/@metamask/notification-services-controller/dist/NotificationServicesPushController/web/push-utils.cjs"}],[231,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:48,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=48;const n=t.data;return t.data=function(e={}){var t,n,s,a,o,c,l,u;null===(t=e.NetworkController)||void 0===t||delete t.settings;const d=(null===(n=e.NetworkController)||void 0===n?void 0:n.provider)||{};if(("rpc"!==d.type||"string"==typeof d.chainId&&i.test(d.chainId))&&"localhost"!==d.type){if(null!==(s=e.NetworkController)&&void 0!==s&&s.provider){var h;if("rpcTarget"in e.NetworkController.provider){const t=e.NetworkController.provider.rpcTarget;e.NetworkController.provider.rpcUrl=t}null===(h=e.NetworkController)||void 0===h||null===(h=h.provider)||void 0===h||delete h.rpcTarget}}else e.NetworkController.provider={type:"rinkeby",rpcUrl:"",chainId:"0x4",nickname:"",rpcPrefs:{},ticker:"ETH"};e.PreferencesController||(e.PreferencesController={});e.PreferencesController.frequentRpcListDetail||(e.PreferencesController.frequentRpcListDetail=[]);e.PreferencesController.frequentRpcListDetail.unshift({rpcUrl:"http://localhost:8545",chainId:"0x539",ticker:"ETH",nickname:"Localhost 8545",rpcPrefs:{}}),null===(a=e.CachedBalancesController)||void 0===a||delete a.cachedBalances;const f=null===(o=e.TransactionController)||void 0===o?void 0:o.transactions;Array.isArray(f)&&f.forEach((e=>{const t=null==e?void 0:e.metamaskNetworkId;"string"==typeof t&&r.test(t)&&(e.metamaskNetworkId=parseInt(t,16).toString(10))}));const p=(null===(c=e.AddressBookController)||void 0===c?void 0:c.addressBook)||{};Object.keys(p).forEach((e=>{if(/^\d+$/iu.test(e)){const t=`0x${parseInt(e,10).toString(16)}`;!function(e,t){Object.values(e).forEach((e=>{e&&"object"==typeof e&&(e.chainId=t)}))}(p[e],t),p[t]?function(e,t,n){const s=e[t]||{},r={...e[n]};Object.keys(s).forEach((e=>{if(r[e]&&"object"==typeof r[e]){const t={};new Set([...Object.keys(r[e]),...Object.keys(s[e]||{})]).forEach((n=>{var i;t[n]=r[e][n]||(null===(i=s[e])||void 0===i?void 0:i[n])||""})),r[e]=t}else s[e]&&"object"==typeof s[e]&&(r[e]=s[e])})),e[n]=r}(p,e,t):p[t]=p[e],delete p[e]}})),null===(l=e.IncomingTransactionsController)||void 0===l||null===(l=l.incomingTxLastFetchedBlocksByNetwork)||void 0===l||delete l.localhost;const m=null===(u=e.PreferencesController)||void 0===u?void 0:u.accountTokens;m&&Object.keys(m).forEach((e=>{var t,n;const s=(null===(t=m[e])||void 0===t?void 0:t.localhost)||[];if(s.length>0){const t=m[e].rpc||[];t.length>0?m[e].rpc=function(e,t){const n=i(e),s=i(t),r=[];return new Set([...Object.keys(n),...Object.keys(s)]).forEach((e=>{r.push({...n[e],...s[e]})})),r;function i(e){return e.reduce(((e,t)=>(null!=t&&t.address&&"string"==typeof(null==t?void 0:t.address)&&(e[t.address]=t),e)),{})}}(s,t):m[e].rpc=s}null===(n=m[e])||void 0===n||delete n.localhost}));return e}(n),t}};const r=/^0x[0-9a-f]+$/iu,i=/^0x[1-9a-f]+[0-9a-f]*$/iu}}},{package:"$root$",file:"app/scripts/migrations/048.js"}],[2311,{"./ObservableStore":2313},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComposedStore=void 0;const s=e("./ObservableStore");class r extends s.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const n=t=>{const n=this.getState();n[e]=t,this.putState(n)};t.subscribe(n),n(t.getState())}}n.ComposedStore=r}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/ComposedStore.js"}],[2312,{"./ObservableStore":2313},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MergedStore=void 0;const s=e("./ObservableStore");class r extends s.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}n.MergedStore=r}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/MergedStore.js"}],[2313,{"@metamask/safe-event-emitter":2486},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ObservableStore=void 0;const r=s(e("@metamask/safe-event-emitter"));class i extends r.default{constructor(e){super(),e===undefined?this._state={}:this._state=e}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}n.ObservableStore=i}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/ObservableStore.js"}],[2314,{"readable-stream":5198},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.storeAsStream=void 0;const s=e("readable-stream");class r extends s.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const n=super.pipe(e,t);return e.write(this.obsStore.getState()),n}_write(e,t,n){this.obsStore.putState(e),n()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}n.storeAsStream=function(e){return new r(e)}}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/asStream.js"}],[2315,{"./ComposedStore":2311,"./MergedStore":2312,"./ObservableStore":2313,"./asStream":2314,"./transform":2316},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./asStream"),n),r(e("./ComposedStore"),n),r(e("./MergedStore"),n),r(e("./ObservableStore"),n),r(e("./transform"),n)}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/index.js"}],[2316,{"readable-stream":5198},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.storeTransformStream=void 0;const s=e("readable-stream");n.storeTransformStream=function(e){return new s.Transform({objectMode:!0,transform:(t,n,s)=>{try{const n=e(t);return s(undefined,n),undefined}catch(e){return s(e),undefined}}})}}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/transform.js"}],[232,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:49,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=49;const n=t.data;return t.data=function(e={}){if(e.PreferencesController){const{metaMetricsId:t,participateInMetaMetrics:n,metaMetricsSendCount:s}=e.PreferencesController;e.MetaMetricsController=e.MetaMetricsController??{},t!==undefined&&(e.MetaMetricsController.metaMetricsId=t,delete e.PreferencesController.metaMetricsId),n!==undefined&&(e.MetaMetricsController.participateInMetaMetrics=n,delete e.PreferencesController.participateInMetaMetrics),s!==undefined&&(e.MetaMetricsController.metaMetricsSendCount=s,delete e.PreferencesController.metaMetricsSendCount)}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/049.js"}],[2329,{"./enums.cjs":2330,"@metamask/base-controller":1332,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PermissionLogController=void 0;const p=e("@metamask/base-controller"),m=e("@metamask/utils"),g=e("./enums.cjs"),y={permissionHistory:{},permissionActivityLog:[]};class w extends p.BaseController{constructor({messenger:e,restrictedMethods:t,state:n}){super({messenger:e,name:"PermissionLogController",metadata:{permissionHistory:{persist:!0,anonymous:!1},permissionActivityLog:{persist:!0,anonymous:!1}},state:{...y,...n}}),s.add(this),r.set(this,void 0),h(this,r,t,"f")}updateAccountsHistory(e,t){if(0===t.length)return;const n={eth_accounts:{accounts:f(this,s,"m",i).call(this,t,Date.now())}};f(this,s,"m",l).call(this,e,n)}createMiddleware(){return(e,t,n)=>{const{origin:i,method:l}=e,d=l.startsWith(g.WALLET_PREFIX),h="eth_requestAccounts"===l;if(!g.LOG_IGNORE_METHODS.includes(l)&&(d||f(this,r,"f").has(l))||h){const r=f(this,s,"m",a).call(this,e,d),l=f(this,s,"m",u).call(this,e);n((e=>{const n=Date.now();f(this,s,"m",o).call(this,r,t,n),l&&!t.error&&t.result&&i&&f(this,s,"m",c).call(this,l,i,t.result,n,h),e()}))}else n()}}}n.PermissionLogController=w,r=new WeakMap,s=new WeakSet,i=function(e,t){return e.reduce(((e,n)=>({...e,[n]:t})),{})},a=function(e,t){const n={id:e.id,method:e.method,methodType:t?g.LOG_METHOD_TYPES.internal:g.LOG_METHOD_TYPES.restricted,origin:e.origin,requestTime:Date.now(),responseTime:null,success:null};return this.update((e=>{const t=[...e.permissionActivityLog,n];e.permissionActivityLog=t.length>g.LOG_LIMIT?t.slice(1):t})),n},o=function(e,t,n){e&&t&&this.update((s=>{s.permissionActivityLog=s.permissionActivityLog.map((s=>s.id===e.id?{...s,success:(0,m.hasProperty)(t,"result"),responseTime:n}:s))}))},c=function(e,t,n,r,a){let o;if(a){const e=n;o={eth_accounts:{accounts:f(this,s,"m",i).call(this,e,r),lastApproved:r}}}else{o=n.reduce(((t,n)=>{const a=n.parentCapability;if(!e.includes(a))return t;if("eth_accounts"===a){const e=f(this,s,"m",d).call(this,n);return{...t,[a]:{lastApproved:r,accounts:f(this,s,"m",i).call(this,e,r)}}}return{...t,[a]:{lastApproved:r}}}),{})}Object.keys(o).length>0&&f(this,s,"m",l).call(this,t,o)},l=function(e,t){const{permissionHistory:n}=this.state,s=n[e]??{},r={...s,...t},i=s.eth_accounts,a=t.eth_accounts;if(i&&a){const e=a.lastApproved??i.lastApproved;r.eth_accounts={lastApproved:e,accounts:{...i.accounts,...a.accounts}}}this.update((t=>{t.permissionHistory={...n,[e]:r}}))},u=function(e){const{method:t,params:n}=e;return"eth_requestAccounts"===t?["eth_accounts"]:t===`${g.WALLET_PREFIX}requestPermissions`&&n&&Array.isArray(n)&&n[0]&&"object"==typeof n[0]&&!Array.isArray(n[0])?Object.keys(n[0]):null},d=function(e){if("eth_accounts"!==e.parentCapability||!e.caveats)return[];const t=new Set;for(const n of e.caveats)if(n.type===g.CAVEAT_TYPES.restrictReturnedAccounts&&Array.isArray(n.value))for(const e of n.value)t.add(e);return[...t]}}}},{package:"@metamask/permission-log-controller",file:"node_modules/@metamask/permission-log-controller/dist/PermissionLogController.cjs"}],[233,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");const r=["METASWAP_GAS_PRICE_ESTIMATES_LAST_RETRIEVED","METASWAP_GAS_PRICE_ESTIMATES","cachedFetch","BASIC_PRICE_ESTIMATES_LAST_RETRIEVED","BASIC_PRICE_ESTIMATES","BASIC_GAS_AND_TIME_API_ESTIMATES","BASIC_GAS_AND_TIME_API_ESTIMATES_LAST_RETRIEVED","GAS_API_ESTIMATES_LAST_RETRIEVED","GAS_API_ESTIMATES"];n.default={version:50,async migrate(e){const t=(0,s.cloneDeep)(e);return t.meta.version=50,r.forEach((e=>{var t;return null===(t=window.localStorage)||void 0===t?void 0:t.removeItem(e)})),t}}}}},{package:"$root$",file:"app/scripts/migrations/050.js"}],[2330,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.LOG_LIMIT=n.LOG_METHOD_TYPES=n.LOG_IGNORE_METHODS=n.CAVEAT_TYPES=n.WALLET_PREFIX=void 0,n.WALLET_PREFIX="wallet_",n.CAVEAT_TYPES=Object.freeze({restrictReturnedAccounts:"restrictReturnedAccounts"}),n.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"],function(e){e.restricted="restricted",e.internal="internal"}(s||(n.LOG_METHOD_TYPES=s={})),n.LOG_LIMIT=100}}},{package:"@metamask/permission-log-controller",file:"node_modules/@metamask/permission-log-controller/dist/enums.cjs"}],[2331,{"./PermissionLogController.cjs":2329},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./PermissionLogController.cjs"),n)}}},{package:"@metamask/permission-log-controller",file:"node_modules/@metamask/permission-log-controller/dist/index.cjs"}],[2332,{"./PhishingDetector.cjs":2333,"./types.cjs":2335,"./utils.cjs":2336,"@metamask/base-controller":1332,"@metamask/controller-utils":1360,"punycode/punycode.js":4995},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p,m,g=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},y=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PhishingController=n.phishingListKeyNameMap=n.ListNames=n.ListKeys=n.C2_DOMAIN_BLOCKLIST_URL=n.METAMASK_HOTLIST_DIFF_URL=n.METAMASK_STALELIST_URL=n.STALELIST_REFRESH_INTERVAL=n.HOTLIST_REFRESH_INTERVAL=n.C2_DOMAIN_BLOCKLIST_REFRESH_INTERVAL=n.PHISHING_DETECTION_SCAN_ENDPOINT=n.PHISHING_DETECTION_BASE_URL=n.C2_DOMAIN_BLOCKLIST_ENDPOINT=n.CLIENT_SIDE_DETECION_BASE_URL=n.METAMASK_HOTLIST_DIFF_FILE=n.METAMASK_STALELIST_FILE=n.PHISHING_CONFIG_BASE_URL=void 0;const w=e("@metamask/base-controller"),b=e("@metamask/controller-utils"),v=e("punycode/punycode.js"),S=e("./PhishingDetector.cjs"),k=e("./types.cjs"),T=e("./utils.cjs");var _,C;n.PHISHING_CONFIG_BASE_URL="https://phishing-detection.api.cx.metamask.io",n.METAMASK_STALELIST_FILE="/v1/stalelist",n.METAMASK_HOTLIST_DIFF_FILE="/v1/diffsSince",n.CLIENT_SIDE_DETECION_BASE_URL="https://client-side-detection.api.cx.metamask.io",n.C2_DOMAIN_BLOCKLIST_ENDPOINT="/v1/request-blocklist",n.PHISHING_DETECTION_BASE_URL="https://dapp-scanning.api.cx.metamask.io",n.PHISHING_DETECTION_SCAN_ENDPOINT="scan",n.C2_DOMAIN_BLOCKLIST_REFRESH_INTERVAL=300,n.HOTLIST_REFRESH_INTERVAL=300,n.STALELIST_REFRESH_INTERVAL=2592e3,n.METAMASK_STALELIST_URL=`${n.PHISHING_CONFIG_BASE_URL}${n.METAMASK_STALELIST_FILE}`,n.METAMASK_HOTLIST_DIFF_URL=`${n.PHISHING_CONFIG_BASE_URL}${n.METAMASK_HOTLIST_DIFF_FILE}`,n.C2_DOMAIN_BLOCKLIST_URL=`${n.CLIENT_SIDE_DETECION_BASE_URL}${n.C2_DOMAIN_BLOCKLIST_ENDPOINT}`,function(e){e.EthPhishingDetectConfig="eth_phishing_detect_config"}(_||(n.ListKeys=_={})),function(e){e.MetaMask="MetaMask"}(C||(n.ListNames=C={}));const E={[C.MetaMask]:_.EthPhishingDetectConfig};n.phishingListKeyNameMap={[_.EthPhishingDetectConfig]:C.MetaMask};const P="PhishingController",j={phishingLists:{persist:!0,anonymous:!1},whitelist:{persist:!0,anonymous:!1},hotlistLastFetched:{persist:!0,anonymous:!1},stalelistLastFetched:{persist:!0,anonymous:!1},c2DomainBlocklistLastFetched:{persist:!0,anonymous:!1}};class I extends w.BaseController{constructor({stalelistRefreshInterval:e=n.STALELIST_REFRESH_INTERVAL,hotlistRefreshInterval:t=n.HOTLIST_REFRESH_INTERVAL,c2DomainBlocklistRefreshInterval:h=n.C2_DOMAIN_BLOCKLIST_REFRESH_INTERVAL,messenger:f,state:p={}}){super({name:P,metadata:j,messenger:f,state:{phishingLists:[],whitelist:[],hotlistLastFetched:0,stalelistLastFetched:0,c2DomainBlocklistLastFetched:0,...p}}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),this.scanUrl=async e=>{const[t,s]=(0,T.getHostnameFromWebUrl)(e);if(!s)return{domainName:"",recommendedAction:k.RecommendedAction.None,fetchError:"url is not a valid web URL"};const r=await(0,b.safelyExecuteWithTimeout)((async()=>{const e=await fetch(`${n.PHISHING_DETECTION_BASE_URL}/${n.PHISHING_DETECTION_SCAN_ENDPOINT}?url=${encodeURIComponent(t)}`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)return{error:`${e.status} ${e.statusText}`};return await e.json()}),!0,8e3);return r?"error"in r?{domainName:"",recommendedAction:k.RecommendedAction.None,fetchError:r.error}:{domainName:t,recommendedAction:r.recommendedAction}:{domainName:"",recommendedAction:k.RecommendedAction.None,fetchError:"timeout of 8000ms exceeded"}},g(this,i,e,"f"),g(this,a,t,"f"),g(this,o,h,"f"),y(this,s,"m",d).call(this),this.updatePhishingDetector()}updatePhishingDetector(){g(this,r,new S.PhishingDetector(this.state.phishingLists),"f")}setStalelistRefreshInterval(e){g(this,i,e,"f")}setHotlistRefreshInterval(e){g(this,a,e,"f")}setC2DomainBlocklistRefreshInterval(e){g(this,o,e,"f")}isStalelistOutOfDate(){return(0,T.fetchTimeNow)()-this.state.stalelistLastFetched>=y(this,i,"f")}isHotlistOutOfDate(){return(0,T.fetchTimeNow)()-this.state.hotlistLastFetched>=y(this,a,"f")}isC2DomainBlocklistOutOfDate(){return(0,T.fetchTimeNow)()-this.state.c2DomainBlocklistLastFetched>=y(this,o,"f")}async maybeUpdateState(){if(this.isStalelistOutOfDate())return void await this.updateStalelist();this.isHotlistOutOfDate()&&await this.updateHotlist();this.isC2DomainBlocklistOutOfDate()&&await this.updateC2DomainBlocklist()}test(e){const t=(0,v.toASCII)(e),n=(0,T.getHostnameFromUrl)(t);return this.state.whitelist.includes(n||t)?{result:!1,type:k.PhishingDetectorResultType.All}:y(this,r,"f").check(t)}isBlockedRequest(e){const t=(0,v.toASCII)(e),n=(0,T.getHostnameFromUrl)(t);return this.state.whitelist.includes(n||t)?{result:!1,type:k.PhishingDetectorResultType.All}:y(this,r,"f").isMaliciousC2Domain(t)}bypass(e){const t=(0,v.toASCII)(e),n=(0,T.getHostnameFromUrl)(t),{whitelist:s}=this.state;s.includes(n||t)||this.update((e=>{e.whitelist.push(n||t)}))}async updateC2DomainBlocklist(){if(y(this,u,"f"))await y(this,u,"f");else try{g(this,u,y(this,s,"m",p).call(this),"f"),await y(this,u,"f")}finally{g(this,u,undefined,"f")}}async updateHotlist(){if(y(this,c,"f"))await y(this,c,"f");else try{g(this,c,y(this,s,"m",f).call(this),"f"),await y(this,c,"f")}finally{g(this,c,undefined,"f")}}async updateStalelist(){if(y(this,l,"f"))await y(this,l,"f");else try{g(this,l,y(this,s,"m",h).call(this),"f"),await y(this,l,"f")}finally{g(this,l,undefined,"f")}}}n.PhishingController=I,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,s=new WeakSet,d=function(){this.messagingSystem.registerActionHandler(`${P}:maybeUpdateState`,this.maybeUpdateState.bind(this)),this.messagingSystem.registerActionHandler(`${P}:testOrigin`,this.test.bind(this))},h=async function(){let e=null,t=null,r=null;try{const i=y(this,s,"m",m).call(this,n.METAMASK_STALELIST_URL),a=y(this,s,"m",m).call(this,n.C2_DOMAIN_BLOCKLIST_URL);[e,r]=await Promise.all([i,a]),e?.data&&e.data.lastUpdated>0&&(t=await y(this,s,"m",m).call(this,`${n.METAMASK_HOTLIST_DIFF_URL}/${e.data.lastUpdated}`))}finally{const e=(0,T.fetchTimeNow)();this.update((t=>{t.stalelistLastFetched=e,t.hotlistLastFetched=e,t.c2DomainBlocklistLastFetched=e}))}if(!e||!t)return;const{eth_phishing_detect_config:i,...a}=e.data,o={...i,...a,c2DomainBlocklist:r?r.recentlyAdded:[],name:n.phishingListKeyNameMap.eth_phishing_detect_config},c=(0,T.applyDiffs)(o,t.data,_.EthPhishingDetectConfig);this.update((e=>{e.phishingLists=[c]})),this.updatePhishingDetector()},f=async function(){const e=Math.max(...this.state.phishingLists.map((({lastUpdated:e})=>e)));let t;try{t=await y(this,s,"m",m).call(this,`${n.METAMASK_HOTLIST_DIFF_URL}/${e}`)}finally{this.update((e=>{e.hotlistLastFetched=(0,T.fetchTimeNow)()}))}if(!t?.data)return;const r=t.data,i=this.state.phishingLists.map((e=>(0,T.applyDiffs)(e,r,E[e.name],[],[])));this.update((e=>{e.phishingLists=i})),this.updatePhishingDetector()},p=async function(){let e=null;try{e=await y(this,s,"m",m).call(this,`${n.C2_DOMAIN_BLOCKLIST_URL}?timestamp=${(0,T.roundToNearestMinute)(this.state.c2DomainBlocklistLastFetched)}`)}finally{this.update((e=>{e.c2DomainBlocklistLastFetched=(0,T.fetchTimeNow)()}))}if(!e)return;const t=e.recentlyAdded,r=e.recentlyRemoved,i=this.state.phishingLists.map((e=>(0,T.applyDiffs)(e,[],E[e.name],t,r)));this.update((e=>{e.phishingLists=i})),this.updatePhishingDetector()},m=async function(e){const t=await(0,b.safelyExecute)((()=>fetch(e,{cache:"no-cache"})),!0);return 200===t?.status?await t.json():null},n.default=I}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/PhishingController.cjs"}],[2333,{"./types.cjs":2335,"./utils.cjs":2336,"fastest-levenshtein":4371},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},c=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PhishingDetector=void 0;const l=e("fastest-levenshtein"),u=e("./types.cjs"),d=e("./utils.cjs");n.PhishingDetector=class{constructor(e){s.add(this),r.set(this,void 0),i.set(this,void 0),Array.isArray(e)?(o(this,r,(0,d.processConfigs)(e),"f"),o(this,i,!1,"f")):(o(this,r,[(0,d.getDefaultPhishingDetectorConfig)({allowlist:e.whitelist,blocklist:e.blacklist,c2DomainBlocklist:e.c2DomainBlocklist,fuzzylist:e.fuzzylist,tolerance:e.tolerance})],"f"),o(this,i,!0,"f"))}check(e){const t=c(this,s,"m",a).call(this,e);if(c(this,i,"f")){let e=t.type;return e===u.PhishingDetectorResultType.Allowlist?e=u.PhishingDetectorResultType.Whitelist:e===u.PhishingDetectorResultType.Blocklist&&(e=u.PhishingDetectorResultType.Blacklist),{match:t.match,result:t.result,type:e}}return t}isMaliciousC2Domain(e){const t=(0,d.getHostnameFromUrl)(e);if(!t)return{result:!1,type:u.PhishingDetectorResultType.C2DomainBlocklist};const n=t.endsWith(".")?t.slice(0,-1):t,s=(0,d.domainToParts)(n);for(const{allowlist:e,name:t,version:n}of c(this,r,"f")){const r=(0,d.matchPartsAgainstList)(s,e);if(r){return{match:(0,d.domainPartsToDomain)(r),name:t,result:!1,type:u.PhishingDetectorResultType.Allowlist,version:n===undefined?n:String(n)}}}const i=(0,d.sha256Hash)(t.toLowerCase()),a=(0,d.generateParentDomains)(s.reverse(),5);for(const{c2DomainBlocklist:e,name:t,version:n}of c(this,r,"f"))if(e&&0!==e.length){if(e.includes(i))return{name:t,result:!0,type:u.PhishingDetectorResultType.C2DomainBlocklist,version:n===undefined?n:String(n)};for(const s of a){const r=(0,d.sha256Hash)(s);if(e.includes(r))return{name:t,result:!0,type:u.PhishingDetectorResultType.C2DomainBlocklist,version:n===undefined?n:String(n)}}}return{result:!1,type:u.PhishingDetectorResultType.C2DomainBlocklist}}},r=new WeakMap,i=new WeakMap,s=new WeakSet,a=function(e){const t=e.match(new RegExp("Qm[1-9A-HJ-NP-Za-km-z]{44,}|b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,}|z[1-9A-HJ-NP-Za-km-z]{48,}|F[0-9A-F]{50,}","u"));if(null!==t){const e=t[0];for(const{blocklist:t,name:n,version:s}of c(this,r,"f")){if(t.filter((e=>1===e.length)).find((t=>t[0]===e)))return{name:n,match:e,result:!0,type:u.PhishingDetectorResultType.Blocklist,version:s===undefined?s:String(s)}}}let n;try{n=new URL(e).hostname}catch(e){return{result:!1,type:u.PhishingDetectorResultType.All}}const s=n.endsWith(".")?n.slice(0,-1):n,i=(0,d.domainToParts)(s);for(const{allowlist:e,name:t,version:n}of c(this,r,"f")){const s=(0,d.matchPartsAgainstList)(i,e);if(s){return{match:(0,d.domainPartsToDomain)(s),name:t,result:!1,type:u.PhishingDetectorResultType.Allowlist,version:n===undefined?n:String(n)}}}for(const{blocklist:e,fuzzylist:t,name:n,tolerance:s,version:a}of c(this,r,"f")){const r=(0,d.matchPartsAgainstList)(i,e);if(r){return{match:(0,d.domainPartsToDomain)(r),name:n,result:!0,type:u.PhishingDetectorResultType.Blocklist,version:a===undefined?a:String(a)}}if(s>0){let e=(0,d.domainPartsToFuzzyForm)(i);e=e.replace(/^www\./u,"");const r=t.find((t=>{const n=(0,d.domainPartsToFuzzyForm)(t);return(0,l.distance)(e,n)<=s}));if(r){return{name:n,match:(0,d.domainPartsToDomain)(r),result:!0,type:u.PhishingDetectorResultType.Fuzzy,version:a===undefined?a:String(a)}}}}return{result:!1,type:u.PhishingDetectorResultType.All}}}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/PhishingDetector.cjs"}],[2334,{"./PhishingController.cjs":2332,"./PhishingDetector.cjs":2333,"./types.cjs":2335},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.PhishingDetectorResultType=n.PhishingDetector=void 0,r(e("./PhishingController.cjs"),n);var i=e("./PhishingDetector.cjs");Object.defineProperty(n,"PhishingDetector",{enumerable:!0,get:function(){return i.PhishingDetector}});var a=e("./types.cjs");Object.defineProperty(n,"PhishingDetectorResultType",{enumerable:!0,get:function(){return a.PhishingDetectorResultType}})}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/index.cjs"}],[2335,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r;Object.defineProperty(n,"__esModule",{value:!0}),n.RecommendedAction=n.PhishingDetectorResultType=void 0,function(e){e.All="all",e.Fuzzy="fuzzy",e.Blocklist="blocklist",e.Allowlist="allowlist",e.Blacklist="blacklist",e.Whitelist="whitelist",e.C2DomainBlocklist="c2DomainBlocklist"}(s||(n.PhishingDetectorResultType=s={})),function(e){e.None="NONE",e.Warn="WARN",e.Block="BLOCK"}(r||(n.RecommendedAction=r={}))}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/types.cjs"}],[2336,{"./PhishingController.cjs":2332,"@noble/hashes/utils":2927,"ethereum-cryptography/sha256":4242},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.generateParentDomains=n.getHostnameFromWebUrl=n.getHostnameFromUrl=n.sha256Hash=n.matchPartsAgainstList=n.domainPartsToFuzzyForm=n.domainPartsToDomain=n.processConfigs=n.getDefaultPhishingDetectorConfig=n.processDomainList=n.domainToParts=n.validateConfig=n.applyDiffs=n.roundToNearestMinute=n.fetchTimeNow=void 0;const s=e("@noble/hashes/utils"),r=e("ethereum-cryptography/sha256"),i=e("./PhishingController.cjs");n.fetchTimeNow=()=>Math.round(Date.now()/1e3),n.roundToNearestMinute=function(e){return 60*Math.floor(e/60)};const a=e=>{const t=e.indexOf(".");return[e.slice(0,t),e.slice(t+1)]};function o(e){if(null===e||"object"!=typeof e)throw new Error("Invalid config");if("tolerance"in e&&!("fuzzylist"in e))throw new Error("Fuzzylist tolerance provided without fuzzylist");if("name"in e&&("string"!=typeof e.name||""===e.name))throw new Error("Invalid config parameter: 'name'");if("version"in e&&(!["number","string"].includes(typeof e.version)||""===e.version))throw new Error("Invalid config parameter: 'version'")}n.applyDiffs=(e,t,n,s=[],r=[])=>{const o=t.filter((({timestamp:t,targetList:s})=>t>e.lastUpdated&&a(s)[0]===n));let c=e.lastUpdated;const l={allowlist:new Set(e.allowlist),blocklist:new Set(e.blocklist),fuzzylist:new Set(e.fuzzylist),c2DomainBlocklist:new Set(e.c2DomainBlocklist)};for(const{isRemoval:e,targetList:t,url:n,timestamp:s}of o){const r=a(t)[1];s>c&&(c=s),e?l[r].delete(n):l[r].add(n)}if(n===i.ListKeys.EthPhishingDetectConfig){for(const e of s)l.c2DomainBlocklist.add(e);for(const e of r)l.c2DomainBlocklist.delete(e)}return{c2DomainBlocklist:Array.from(l.c2DomainBlocklist),allowlist:Array.from(l.allowlist),blocklist:Array.from(l.blocklist),fuzzylist:Array.from(l.fuzzylist),version:e.version,name:i.phishingListKeyNameMap[n],tolerance:e.tolerance,lastUpdated:c}},n.validateConfig=o;n.domainToParts=e=>{try{return e.split(".").reverse()}catch(t){throw new Error(JSON.stringify(e))}};n.processDomainList=e=>e.map(n.domainToParts);n.getDefaultPhishingDetectorConfig=({allowlist:e=[],blocklist:t=[],fuzzylist:s=[],tolerance:r=3})=>({allowlist:(0,n.processDomainList)(e),blocklist:(0,n.processDomainList)(t),fuzzylist:(0,n.processDomainList)(s),tolerance:r});n.processConfigs=(e=[])=>e.filter((e=>{try{return o(e),!0}catch(e){return console.error(e),!1}})).map((e=>({...e,...(0,n.getDefaultPhishingDetectorConfig)(e)})));n.domainPartsToDomain=e=>e.slice().reverse().join(".");n.domainPartsToFuzzyForm=e=>e.slice(1).reverse().join(".");n.matchPartsAgainstList=(e,t)=>t.find((t=>!(t.length>e.length)&&t.every(((t,n)=>e[n]===t))));n.sha256Hash=e=>{const t=(0,r.sha256)((new TextEncoder).encode(e.toLowerCase()));return(0,s.bytesToHex)(t)};n.getHostnameFromUrl=e=>{let t;try{if(t=new URL(e).hostname,!t||""===t.split(".").join(""))return null}catch{return null}return t};n.getHostnameFromWebUrl=e=>{if(!e.toLowerCase().startsWith("http://")&&!e.toLowerCase().startsWith("https://"))return["",!1];const t=(0,n.getHostnameFromUrl)(e);return[t||"",Boolean(t)]};n.generateParentDomains=(e,t=5)=>{const n=[];if(0===e.length)return n;if(1===e.length)n.push(e[0].toLowerCase());else{const s=e.slice(-2).join(".");n.push(s.toLowerCase());for(let s=e.length-3;s>=0&&n.length<t;s--){const t=e.slice(s).join(".");n.push(t.toLowerCase())}}return n}}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/utils.cjs"}],[234,{"../../../shared/constants/network":5658,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("../../../shared/constants/network");n.default={version:51,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=51;const n=t.data;return t.data=function(e){var t,n;const{chainId:s,type:i}=(null==e||null===(t=e.NetworkController)||void 0===t?void 0:t.provider)||{},a=null===(n=r.BUILT_IN_NETWORKS[i])||void 0===n?void 0:n.chainId;a&&s!==a&&(e.NetworkController.provider.chainId=a);return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/051.js"}],[2348,{"./ppom-controller":2349},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PPOMController=n.NETWORK_CACHE_DURATION=void 0;var s=e("./ppom-controller");Object.defineProperty(n,"NETWORK_CACHE_DURATION",{enumerable:!0,get:function(){return s.NETWORK_CACHE_DURATION}}),Object.defineProperty(n,"PPOMController",{enumerable:!0,get:function(){return s.PPOMController}})}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/index.js"}],[2349,{"./ppom-storage":2350,"./util":2351,"@metamask/base-controller":2356,"@metamask/controller-utils":1360,"await-semaphore":3841},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p,m,g,y,w,b,v,S,k,T,_,C,E,P,j,I,O,R,A,M,x,N=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},D=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PPOMController=n.NETWORK_CACHE_DURATION=void 0;const B=e("@metamask/base-controller"),L=e("@metamask/controller-utils"),$=e("await-semaphore"),H=e("./ppom-storage"),F=e("./util");n.NETWORK_CACHE_DURATION=6048e5;const q=["eth_call","eth_blockNumber","eth_createAccessList","eth_getLogs","eth_getFilterLogs","eth_getTransactionByHash","eth_chainId","eth_getBlockByHash","eth_getBlockByNumber","eth_getCode","eth_getStorageAt","eth_getBalance","eth_getTransactionCount","trace_call","trace_callMany","debug_traceCall","trace_filter"],U={versionInfo:{persist:!0,anonymous:!1},storageMetadata:{persist:!0,anonymous:!1}},W="PPOMController",K={headers:{"Content-Type":"application/json"}};class V extends B.BaseController{constructor({chainId:e,messenger:t,provider:n,storageBackend:w,securityAlertsEnabled:b,onPreferencesChange:v,ppomProvider:_,cdnBaseUrl:C,providerRequestLimit:E,state:P,blockaidPublicKey:j,nativeCrypto:I}){super({name:W,metadata:U,messenger:t,state:{versionInfo:P?.versionInfo??[],storageMetadata:P?.storageMetadata??[]}}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,0),h.set(this,void 0),f.set(this,void 0),p.set(this,{}),m.set(this,void 0),g.set(this,!1),y.set(this,undefined),N(this,h,(0,F.addHexPrefix)(e),"f"),N(this,i,n,"f"),N(this,c,_,"f"),N(this,a,new H.PPOMStorage({storageBackend:w,readMetadata:()=>[...this.state.storageMetadata],writeMetadata:e=>{this.update((t=>{t.storageMetadata=e}))}}),"f"),N(this,o,new $.Mutex,"f"),N(this,l,C,"f"),N(this,u,E??300,"f"),N(this,f,b,"f"),N(this,m,j,"f"),N(this,y,I,"f"),v(D(this,s,"m",S).bind(this)),D(this,s,"m",k).call(this),D(this,s,"m",T).call(this)}async usePPOM(e,t){const n=t??D(this,h,"f");if(!D(this,f,"f"))throw Error("User has securityAlertsEnabled set to false");if(!(0,F.blockaidValidationSupportedForNetwork)(n))throw Error(`Blockaid validation not available on network with chainId: ${n}`);return await D(this,o,"f").use((async()=>{const t=await D(this,s,"m",C).call(this,n);N(this,d,0,"f"),N(this,p,{},"f");return{...await e(t),providerRequestsCount:{...D(this,p,"f")}}}))}}n.PPOMController=V,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,y=new WeakMap,s=new WeakSet,w=async function(){if(D(this,f,"f")&&!D(this,g,"f")){const{ppomInit:e}=D(this,c,"f");await e("./ppom_bg.wasm"),N(this,g,!0,"f")}},b=function(){D(this,s,"m",_).call(this).catch((e=>{console.error(`Error in resetting ppom: ${e.message}`)}));const{storageMetadata:e}=this.state;this.update((e=>{e.versionInfo=[],e.storageMetadata=[]})),D(this,a,"f").deleteAllFiles(e).catch((e=>{console.error(`Error in deleting files: ${e.message}`)}))},v=function(e){const t=this.messagingSystem.call("NetworkController:getNetworkClientById",e.selectedNetworkClientId),{chainId:n}=t.configuration,r=(0,F.addHexPrefix)(n);r!==D(this,h,"f")&&(N(this,h,r,"f"),D(this,s,"m",_).call(this).catch((e=>{console.error(`Error in resetting ppom: ${e.message}`)})))},S=function(e){const t=e.securityAlertsEnabled;t!==D(this,f,"f")&&(N(this,f,t,"f"),t||D(this,s,"m",b).call(this))},k=function(){this.messagingSystem.registerActionHandler(`${W}:usePPOM`,this.usePPOM.bind(this))},T=function(){const e=D(this,s,"m",v).bind(this);this.messagingSystem.subscribe("NetworkController:networkDidChange",e)},_=async function(){await D(this,o,"f").use((async()=>{D(this,r,"f")&&(D(this,r,"f").free(),N(this,r,undefined,"f"))}))},C=async function(e){const t=await D(this,s,"m",E).call(this);let n;return(D(this,r,"f")===undefined||t)&&(n=await D(this,s,"m",x).call(this,e),D(this,h,"f")===e&&(D(this,r,"f")&&D(this,r,"f").free(),N(this,r,n,"f")),D(this,a,"f").syncMetadata(this.state.versionInfo).catch((e=>{console.error(`Error while trying to sync metadata: ${e.message}`)}))),n},E=async function(){const e=await D(this,s,"m",R).call(this);return!!e&&(this.update((t=>{t.versionInfo=e})),!0)},P=function(e,t){return e.find((e=>e.name===t.name&&e.chainId===t.chainId&&e.version===t.version&&e.checksum===t.checksum))},j=async function(e){const t=await Promise.all(e.map((async e=>{let t;try{t=await D(this,s,"m",I).call(this,e)}catch(t){console.error(`Error in getting file ${e.filePath}: ${t.message}`)}return t?[e.name,new Uint8Array(t)]:undefined})));return t?.filter((e=>e?.[1]!==undefined))},I=async function(e){const{storageMetadata:t}=this.state;if(D(this,s,"m",P).call(this,t,e))try{return await D(this,a,"f").readFile(e.name,e.chainId)}catch(e){console.error(`Error in reading file: ${e.message}`)}(0,F.checkFilePath)(e.filePath);const n=(0,F.constructURLHref)(D(this,l,"f"),e.filePath),r=await D(this,s,"m",A).call(this,n);return await(0,F.validateSignature)(r,e.hashSignature,D(this,m,"f"),e.filePath,D(this,y,"f")),await D(this,a,"f").writeFile({data:r,...e}).catch((e=>{console.error(`Error in writing file: ${e.message}`)})),r},O=async function(e,t={},n="GET"){const s=await(0,L.safelyExecute)((async()=>(0,L.timeoutFetch)(e,{method:n,cache:"no-cache",redirect:"error",...t},1e4)),!0),r=304===s?.status;if(!s?.status||s?.status<200||s?.status>399)throw new Error(`Failed to fetch file with url: ${e}`);return{cached:r,response:s}},R=async function(){const e=(0,F.constructURLHref)(D(this,l,"f"),"ppom_version.json"),{cached:t,response:n}=await D(this,s,"m",O).call(this,e,{headers:K});return t&&this.state.versionInfo?.length?undefined:n.json()},A=async function(e){const{response:t}=await D(this,s,"m",O).call(this,e);return await t.arrayBuffer()},M=async function(e,t){if(D(this,d,"f")>D(this,u,"f"))return F.PROVIDER_ERRORS.limitExceeded();if(N(this,d,D(this,d,"f")+1,"f"),!q.includes(e))return F.PROVIDER_ERRORS.methodNotSupported();D(this,p,"f")[e]=D(this,p,"f")[e]?Number(D(this,p,"f")[e])+1:1;const n=(0,F.createPayload)(e,t);try{const e=await D(this,i,"f").request(n);return{jsonrpc:"2.0",id:n.id,result:e}}catch(e){return{jsonrpc:"2.0",id:n.id,error:e}}},x=async function(e){await D(this,s,"m",w).call(this);const t=this.state.versionInfo.filter((({chainId:t})=>t===e));if(t?.length===undefined||0===t?.length)throw new Error(`Aborting initialising PPOM as no files are found for the network with chainId: ${e}`);const n=await D(this,s,"m",j).call(this,t);if(n?.length!==t?.length)throw new Error(`Aborting initialising PPOM as not all files could not be downloaded for the network with chainId: ${e}`);const{PPOM:r}=D(this,c,"f");return r.new(D(this,s,"m",M).bind(this),n)}}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/ppom-controller.js"}],[235,{"../../../shared/constants/network":5658,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("../../../shared/constants/network");n.default={version:52,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=52;const n=t.data;return t.data=function(e={}){if(e.PreferencesController){const{accountTokens:t,accountHiddenTokens:n,frequentRpcListDetail:s}=e.PreferencesController,i={},a={};if(t&&Object.keys(t).length>0){for(const e of Object.keys(t)){i[e]={},t[e][r.NETWORK_TYPES.RPC]&&s.forEach((n=>{i[e][n.chainId]=t[e][r.NETWORK_TYPES.RPC]}));for(const n of Object.keys(t[e]))switch(n){case r.NETWORK_TYPES.MAINNET:i[e][r.CHAIN_IDS.MAINNET]=t[e][r.NETWORK_TYPES.MAINNET];break;case"ropsten":i[e]["0x3"]=t[e].ropsten;break;case"rinkeby":i[e]["0x4"]=t[e].rinkeby;break;case r.NETWORK_TYPES.GOERLI:i[e][r.CHAIN_IDS.GOERLI]=t[e][r.NETWORK_TYPES.GOERLI];break;case"kovan":i[e]["0x2a"]=t[e].kovan}}e.PreferencesController.accountTokens=i}if(n&&Object.keys(n).length>0){for(const e of Object.keys(n)){a[e]={},n[e][r.NETWORK_TYPES.RPC]&&s.forEach((t=>{a[e][t.chainId]=n[e][r.NETWORK_TYPES.RPC]}));for(const t of Object.keys(n[e]))switch(t){case r.NETWORK_TYPES.MAINNET:a[e][r.CHAIN_IDS.MAINNET]=n[e][r.NETWORK_TYPES.MAINNET];break;case"ropsten":a[e]["0x3"]=n[e].ropsten;break;case"rinkeby":a[e]["0x4"]=n[e].rinkeby;break;case r.NETWORK_TYPES.GOERLI:a[e][r.CHAIN_IDS.GOERLI]=n[e][r.NETWORK_TYPES.GOERLI];break;case"kovan":a[e]["0x2a"]=n[e].kovan}}e.PreferencesController.accountHiddenTokens=a}}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/052.js"}],[2350,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PPOMStorage=void 0;n.PPOMStorage=class{constructor({storageBackend:e,readMetadata:t,writeMetadata:n}){s.set(this,void 0),r.set(this,void 0),i.set(this,void 0),a(this,s,e,"f"),a(this,r,t,"f"),a(this,i,n,"f")}async syncMetadata(e){const t=o(this,r,"f").call(this),n=[];for(const s of t){try{await this.readFile(s.name,s.chainId)}catch(e){console.error("Error: ",e);continue}e.find((e=>e.name===s.name&&e.chainId===s.chainId&&e.version===s.version&&e.checksum===s.checksum))&&n.push(s)}const a=await o(this,s,"f").dir();for(const{name:e,chainId:t}of a)n.find((n=>n.name===e&&n.chainId===t))||await o(this,s,"f").delete({name:e,chainId:t});return o(this,i,"f").call(this,n),n}async deleteAllFiles(e){for(const t of e){const{name:e,chainId:n}=t;try{await o(this,s,"f").delete({name:e,chainId:n})}catch(t){console.error(`Error in deleting file: ${e}, ${n}`,t)}}}async readFile(e,t){const n=o(this,r,"f").call(this).find((n=>n.name===e&&n.chainId===t));if(!n)throw new Error(`File metadata (${e}, ${t}) not found`);const i=await o(this,s,"f").read({name:e,chainId:t},n.checksum);if(!i)throw new Error(`Storage File (${e}, ${t}) not found`);return i}async writeFile({data:e,name:t,chainId:n,version:a,checksum:c}){await o(this,s,"f").write({name:t,chainId:n},e,c);const l=o(this,r,"f").call(this),u=l.find((e=>e.name===t&&e.chainId===n));u?(u.version=a,u.checksum=c):l.push({name:t,chainId:n,version:a,checksum:c}),o(this,i,"f").call(this,l)}},s=new WeakMap,r=new WeakMap,i=new WeakMap}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/ppom-storage.js"}],[2351,{buffer:3998,"crypto-js":4115,elliptic:4172,"json-rpc-random-id":4611},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return r(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.checkFilePath=n.addHexPrefix=n.constructURLHref=n.validateSignature=n.PROVIDER_ERRORS=n.createPayload=n.IdGenerator=n.blockaidValidationSupportedForNetwork=n.SUPPORTED_NETWORK_CHAINIDS=void 0;const o=i(e("crypto-js")),c=a(e("elliptic")),l=a(e("json-rpc-random-id")),u=c.default.eddsa;n.SUPPORTED_NETWORK_CHAINIDS={MAINNET:"0x1",BSC:"0x38",OPTIMISM:"0xa",POLYGON:"0x89",AVALANCHE:"0xa86a",ARBITRUM:"0xa4b1",LINEA_MAINNET:"0xe708",BASE:"0x2105",SEPOLIA:"0xaa36a7",OPBNB:"0xcc",ZKSYNC:"0x144",SCROLL:"0x82750",BERACHAIN:"0x138d4",METACHAIN_ONE:"0x1b6e6"};n.blockaidValidationSupportedForNetwork=e=>Object.values(n.SUPPORTED_NETWORK_CHAINIDS).some((t=>t===e)),n.IdGenerator=(0,l.default)();n.createPayload=(e,t)=>({id:(0,n.IdGenerator)(),jsonrpc:"2.0",method:e,params:t??[]}),n.PROVIDER_ERRORS={limitExceeded:()=>({jsonrpc:"2.0",id:(0,n.IdGenerator)(),error:{code:-32005,message:"Limit exceeded"}}),methodNotSupported:()=>({jsonrpc:"2.0",id:(0,n.IdGenerator)(),error:{code:-32601,message:"Method not supported"}})};n.validateSignature=async(e,n,s,r,i,a)=>{const c=await(async(e,t,n=!0)=>{if(t)return t.createHash("sha256").update(e).digest("hex");if("crypto"in globalThis&&"object"==typeof globalThis.crypto&&globalThis.crypto.subtle?.digest&&n){const t=await globalThis.crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map((e=>e.toString(16).padStart(2,"0"))).join("")}return(0,o.SHA256)(o.default.lib.WordArray.create(e)).toString()})(e,i,a);if(!new u("ed25519").keyFromPublic(s).verify(t.from(c),n))throw Error(`Signature verification failed for file path: ${r}`)};n.constructURLHref=(e,t)=>new URL(`https://${e}/${t}`.replace(/https:\/\/https:\/\//gu,"https://").replace(/\/\//gu,"/")).href;n.addHexPrefix=e=>"string"!=typeof e||e.match(/^-?0x/u)?e:e.match(/^-?0X/u)?e.replace("0X","0x"):`0x${parseInt(e,10).toString(16)}`;n.checkFilePath=e=>{if(!e.match(/^[\w./]+$/u))throw new Error(`Invalid file path for data file: ${e}`)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/util.js"}],[2352,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseControllerV1=n.isBaseControllerV1=void 0,n.isBaseControllerV1=function(e){return"name"in e&&"string"==typeof e.name&&"config"in e&&"object"==typeof e.config&&"defaultConfig"in e&&"object"==typeof e.defaultConfig&&"state"in e&&"object"==typeof e.state&&"defaultState"in e&&"object"==typeof e.defaultState&&"disabled"in e&&"boolean"==typeof e.disabled&&"subscribe"in e&&"function"==typeof e.subscribe};class s{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,n=!0){if(n){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];t!==undefined&&(this[e]=t)}}else for(const t of Object.keys(e))if(this.internalConfig[t]!==undefined){const n=e[t];this.internalConfig[t]=n,this[t]=n}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}n.BaseControllerV1=s,n.default=s}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/BaseControllerV1.cjs"}],[2353,{immer:4573},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseController=n.isBaseController=void 0;const a=e("immer");(0,a.enablePatches)(),n.isBaseController=function(e){return"name"in e&&"string"==typeof e.name&&"state"in e&&"object"==typeof e.state&&"metadata"in e&&"object"==typeof e.metadata};function o(e,t,n){return Object.keys(e).reduce(((s,r)=>{try{const i=t[r];if(!i)throw new Error(`No metadata found for '${String(r)}'`);const a=i[n],o=e[r];return"function"==typeof a?s[r]=a(o):a&&(s[r]=o),s}catch(e){return setTimeout((()=>{throw e})),s}}),{})}n.BaseController=class{constructor({messenger:e,metadata:t,name:n,state:i}){s.set(this,void 0),this.messagingSystem=e,this.name=n,r(this,s,(0,a.freeze)(i,!0),"f"),this.metadata=t,this.messagingSystem.registerActionHandler(`${n}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${n}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return i(this,s,"f")}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,n,o]=a.produceWithPatches(i(this,s,"f"),e);return r(this,s,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,n),{nextState:t,patches:n,inversePatches:o}}applyPatches(e){const t=(0,a.applyPatches)(i(this,s,"f"),e);r(this,s,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},s=new WeakMap,n.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},n.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/BaseControllerV2.cjs"}],[2354,{"./RestrictedMessenger.cjs":2355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ControllerMessenger=n.Messenger=void 0;const c=e("./RestrictedMessenger.cjs");class l{constructor(){s.set(this,new Map),r.set(this,new Map),i.set(this,new Map),a.set(this,new Map)}registerActionHandler(e,t){if(o(this,s,"f").has(e))throw new Error(`A handler for ${e} has already been registered`);o(this,s,"f").set(e,t)}unregisterActionHandler(e){o(this,s,"f").delete(e)}clearActions(){o(this,s,"f").clear()}call(e,...t){const n=o(this,s,"f").get(e);if(!n)throw new Error(`A handler for ${e} has not been registered`);return n(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){o(this,i,"f").set(e,t)}publish(e,...t){const n=o(this,r,"f").get(e);if(n)for(const[e,s]of n.entries())try{if(s){const n=o(this,a,"f").get(e),r=s(...t);r!==n&&(o(this,a,"f").set(e,r),e(r,n))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,n){let s=o(this,r,"f").get(e);if(s||(s=new Map,o(this,r,"f").set(e,s)),s.set(t,n),n){const s=o(this,i,"f").get(e);if(s){const e=n(...s());o(this,a,"f").set(t,e)}}}unsubscribe(e,t){const n=o(this,r,"f").get(e);if(!n||!n.has(t))throw new Error(`Subscription not found for event: ${e}`);n.get(t)&&o(this,a,"f").delete(t),n.delete(t)}clearEventSubscriptions(e){o(this,r,"f").delete(e)}clearSubscriptions(){o(this,r,"f").clear()}getRestricted({name:e,allowedActions:t,allowedEvents:n}){return new c.RestrictedMessenger({messenger:this,name:e,allowedActions:t,allowedEvents:n})}}n.Messenger=l,n.ControllerMessenger=l,s=new WeakMap,r=new WeakMap,i=new WeakMap,a=new WeakMap}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/Messenger.cjs"}],[2355,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.RestrictedControllerMessenger=n.RestrictedMessenger=void 0;class f{constructor({controllerMessenger:e,messenger:t,name:n,allowedActions:c,allowedEvents:l}){if(s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),t&&e)throw new Error("Both messenger properties provided. Provide message using only 'messenger' option, 'controllerMessenger' is deprecated");if(!t&&!e)throw new Error("Messenger not provided");d(this,r,t??e,"f"),d(this,i,n,"f"),d(this,a,c,"f"),d(this,o,l,"f")}registerActionHandler(e,t){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").registerActionHandler(e,t)}unregisterActionHandler(e){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").unregisterActionHandler(e)}call(e,...t){if(!h(this,s,"m",l).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return h(this,r,"f").call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").publish(e,...t)}subscribe(e,t,n){if(!h(this,s,"m",c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return n?h(this,r,"f").subscribe(e,t,n):h(this,r,"f").subscribe(e,t)}unsubscribe(e,t){if(!h(this,s,"m",c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);h(this,r,"f").unsubscribe(e,t)}clearEventSubscriptions(e){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").clearEventSubscriptions(e)}}n.RestrictedMessenger=f,n.RestrictedControllerMessenger=f,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakSet,c=function(e){const t=h(this,o,"f");return h(this,s,"m",u).call(this,e)||null!==t&&t.includes(e)},l=function(e){const t=h(this,a,"f");return h(this,s,"m",u).call(this,e)||null!==t&&t.includes(e)},u=function(e){return e.startsWith(`${h(this,i,"f")}:`)}}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/RestrictedMessenger.cjs"}],[2356,{"./BaseControllerV1.cjs":2352,"./BaseControllerV2.cjs":2353,"./Messenger.cjs":2354,"./RestrictedMessenger.cjs":2355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RestrictedMessenger=n.RestrictedControllerMessenger=n.Messenger=n.ControllerMessenger=n.isBaseController=n.getPersistentState=n.getAnonymizedState=n.BaseController=n.isBaseControllerV1=n.BaseControllerV1=void 0;var s=e("./BaseControllerV1.cjs");Object.defineProperty(n,"BaseControllerV1",{enumerable:!0,get:function(){return s.BaseControllerV1}}),Object.defineProperty(n,"isBaseControllerV1",{enumerable:!0,get:function(){return s.isBaseControllerV1}});var r=e("./BaseControllerV2.cjs");Object.defineProperty(n,"BaseController",{enumerable:!0,get:function(){return r.BaseController}}),Object.defineProperty(n,"getAnonymizedState",{enumerable:!0,get:function(){return r.getAnonymizedState}}),Object.defineProperty(n,"getPersistentState",{enumerable:!0,get:function(){return r.getPersistentState}}),Object.defineProperty(n,"isBaseController",{enumerable:!0,get:function(){return r.isBaseController}});var i=e("./Messenger.cjs");Object.defineProperty(n,"ControllerMessenger",{enumerable:!0,get:function(){return i.ControllerMessenger}}),Object.defineProperty(n,"Messenger",{enumerable:!0,get:function(){return i.Messenger}});var a=e("./RestrictedMessenger.cjs");Object.defineProperty(n,"RestrictedControllerMessenger",{enumerable:!0,get:function(){return a.RestrictedControllerMessenger}}),Object.defineProperty(n,"RestrictedMessenger",{enumerable:!0,get:function(){return a.RestrictedMessenger}})}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/index.cjs"}],[2357,{"./constants.cjs":2358,"@metamask/base-controller":1332,"@metamask/controller-utils":1360},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PreferencesController=n.getDefaultPreferencesState=void 0;const a=e("@metamask/base-controller"),o=e("@metamask/controller-utils"),c=e("./constants.cjs"),l={featureFlags:{persist:!0,anonymous:!0},identities:{persist:!0,anonymous:!1},ipfsGateway:{persist:!0,anonymous:!1},isIpfsGatewayEnabled:{persist:!0,anonymous:!0},isMultiAccountBalancesEnabled:{persist:!0,anonymous:!0},lostIdentities:{persist:!0,anonymous:!1},openSeaEnabled:{persist:!0,anonymous:!0},securityAlertsEnabled:{persist:!0,anonymous:!0},selectedAddress:{persist:!0,anonymous:!1},showTestNetworks:{persist:!0,anonymous:!0},showIncomingTransactions:{persist:!0,anonymous:!0},useNftDetection:{persist:!0,anonymous:!0},useTokenDetection:{persist:!0,anonymous:!0},smartTransactionsOptInStatus:{persist:!0,anonymous:!1},useTransactionSimulations:{persist:!0,anonymous:!0},useMultiRpcMigration:{persist:!0,anonymous:!0},useSafeChainsListValidation:{persist:!0,anonymous:!0},tokenSortConfig:{persist:!0,anonymous:!0},privacyMode:{persist:!0,anonymous:!0}};function u(){return{featureFlags:{},identities:{},ipfsGateway:"https://ipfs.io/ipfs/",isIpfsGatewayEnabled:!0,isMultiAccountBalancesEnabled:!0,lostIdentities:{},openSeaEnabled:!1,securityAlertsEnabled:!1,selectedAddress:"",showIncomingTransactions:{[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.MAINNET]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.GOERLI]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.BSC]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.BSC_TESTNET]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.OPTIMISM]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.OPTIMISM_SEPOLIA]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.POLYGON]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.POLYGON_TESTNET]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.AVALANCHE]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.AVALANCHE_TESTNET]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.FANTOM]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.FANTOM_TESTNET]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.SEPOLIA]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_GOERLI]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_SEPOLIA]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.LINEA_MAINNET]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONBEAM]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONBEAM_TESTNET]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.MOONRIVER]:!0,[c.ETHERSCAN_SUPPORTED_CHAIN_IDS.GNOSIS]:!0},showTestNetworks:!1,useNftDetection:!1,useTokenDetection:!0,useMultiRpcMigration:!0,smartTransactionsOptInStatus:!0,useTransactionSimulations:!0,useSafeChainsListValidation:!0,tokenSortConfig:{key:"tokenFiatAmount",order:"dsc",sortCallback:"stringNumeric"},privacyMode:!1}}n.getDefaultPreferencesState=u;class d extends a.BaseController{constructor({messenger:e,state:t}){super({name:"PreferencesController",metadata:l,messenger:e,state:{...u(),...t}}),s.add(this),e.subscribe("KeyringController:stateChange",(e=>{const t=new Set;for(const n of e.keyrings)for(const e of n.accounts)t.add(e);t.size>0&&i(this,s,"m",r).call(this,Array.from(t))}))}addIdentities(e){const t=e.map((e=>(0,o.toChecksumHexAddress)(e)));this.update((e=>{const{identities:n}=e;for(const e of t){if(n[e])continue;const t=Object.keys(n).length;n[e]={name:`Account ${t+1}`,address:e,importTime:Date.now()}}}))}removeIdentity(e){e=(0,o.toChecksumHexAddress)(e);const{identities:t}=this.state;t[e]&&this.update((t=>{delete t.identities[e],e===t.selectedAddress&&(t.selectedAddress=Object.keys(t.identities)[0])}))}setAccountLabel(e,t){e=(0,o.toChecksumHexAddress)(e),this.update((n=>{const s=n.identities[e]||{};s.name=t,n.identities[e]=s}))}setFeatureFlag(e,t){this.update((n=>{n.featureFlags[e]=t}))}setSelectedAddress(e){this.update((t=>{t.selectedAddress=(0,o.toChecksumHexAddress)(e)}))}setIpfsGateway(e){this.update((t=>{t.ipfsGateway=e}))}setUseTokenDetection(e){this.update((t=>{t.useTokenDetection=e}))}setUseNftDetection(e){if(e&&!this.state.openSeaEnabled)throw new Error("useNftDetection cannot be enabled if openSeaEnabled is false");this.update((t=>{t.useNftDetection=e}))}setOpenSeaEnabled(e){this.update((t=>{t.openSeaEnabled=e,e||(t.useNftDetection=!1)}))}setSecurityAlertsEnabled(e){this.update((t=>{t.securityAlertsEnabled=e}))}setIsMultiAccountBalancesEnabled(e){this.update((t=>{t.isMultiAccountBalancesEnabled=e}))}setShowTestNetworks(e){this.update((t=>{t.showTestNetworks=e}))}setIsIpfsGatewayEnabled(e){this.update((t=>{t.isIpfsGatewayEnabled=e}))}setEnableNetworkIncomingTransactions(e,t){Object.values(c.ETHERSCAN_SUPPORTED_CHAIN_IDS).includes(e)&&this.update((n=>{n.showIncomingTransactions={...this.state.showIncomingTransactions,[e]:t}}))}setUseMultiRpcMigration(e){this.update((t=>{t.useMultiRpcMigration=e,e||(t.useMultiRpcMigration=!1)}))}setSmartTransactionsOptInStatus(e){this.update((t=>{t.smartTransactionsOptInStatus=e}))}setUseTransactionSimulations(e){this.update((t=>{t.useTransactionSimulations=e}))}setTokenSortConfig(e){this.update((t=>{t.tokenSortConfig=e}))}setUseSafeChainsListValidation(e){this.update((t=>{t.useSafeChainsListValidation=e}))}setPrivacyMode(e){this.update((t=>{t.privacyMode=e}))}}n.PreferencesController=d,s=new WeakSet,r=function(e){e=e.map((e=>(0,o.toChecksumHexAddress)(e))),this.update((t=>{const{identities:n}=t,s={};for(const[t,r]of Object.entries(n))e.includes(t)||(s[t]=r,delete n[t]);for(const[e,n]of Object.entries(s))t.lostIdentities[e]=n})),this.addIdentities(e),e.includes(this.state.selectedAddress)||this.update((t=>{t.selectedAddress=e[0]}))},n.default=d}}},{package:"@metamask/preferences-controller",file:"node_modules/@metamask/preferences-controller/dist/PreferencesController.cjs"}],[2358,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ETHERSCAN_SUPPORTED_CHAIN_IDS=void 0,n.ETHERSCAN_SUPPORTED_CHAIN_IDS={MAINNET:"0x1",GOERLI:"0x5",BSC:"0x38",BSC_TESTNET:"0x61",OPTIMISM:"0xa",OPTIMISM_SEPOLIA:"0xaa37dc",POLYGON:"0x89",POLYGON_TESTNET:"0x13881",AVALANCHE:"0xa86a",AVALANCHE_TESTNET:"0xa869",FANTOM:"0xfa",FANTOM_TESTNET:"0xfa2",SEPOLIA:"0xaa36a7",LINEA_GOERLI:"0xe704",LINEA_SEPOLIA:"0xe705",LINEA_MAINNET:"0xe708",MOONBEAM:"0x504",MOONBEAM_TESTNET:"0x507",MOONRIVER:"0x505",GNOSIS:"0x64"}}}},{package:"@metamask/preferences-controller",file:"node_modules/@metamask/preferences-controller/dist/constants.cjs"}],[2359,{"./PreferencesController.cjs":2357,"./constants.cjs":2358},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.ETHERSCAN_SUPPORTED_CHAIN_IDS=void 0,r(e("./PreferencesController.cjs"),n);var i=e("./constants.cjs");Object.defineProperty(n,"ETHERSCAN_SUPPORTED_CHAIN_IDS",{enumerable:!0,get:function(){return i.ETHERSCAN_SUPPORTED_CHAIN_IDS}})}}},{package:"@metamask/preferences-controller",file:"node_modules/@metamask/preferences-controller/dist/index.cjs"}],[236,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/transaction-controller");n.default={version:53,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=53;const n=t.data;return t.data=function(e){var t,n;const s=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions,i=null==e||null===(n=e.IncomingTransactionsController)||void 0===n?void 0:n.incomingTransactions;Array.isArray(s)&&s.forEach((e=>{e&&(e.type!==r.TransactionType.retry&&e.type!==r.TransactionType.cancel&&(e.type=e.transactionCategory),delete e.transactionCategory)}));if(i){Object.entries(i).forEach((([t,n])=>{n&&(delete n.transactionCategory,e.IncomingTransactionsController.incomingTransactions[t]={...n,type:r.TransactionType.incoming})}))}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/053.js"}],[237,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");function r(e){return"number"==typeof e||"string"==typeof e&&e.match(/^(0x)?\d+$/u)}n.default={version:54,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=54;const n=function(e){const t=e;if(!t.PreferencesController)return t;const n=t.PreferencesController.tokens||[],s=n.filter((({decimals:e})=>r(e)));for(const e of s)"string"==typeof e.decimals&&(e.decimals=parseInt(e.decimals));t.PreferencesController.tokens=s;const{accountTokens:i}=t.PreferencesController;if(i&&"object"==typeof i)for(const e of Object.keys(i)){const t=i[e];if(t&&"object"==typeof t)for(const e of Object.keys(t)){const n=(t[e]||[]).filter((({decimals:e})=>r(e)));for(const e of n)"string"==typeof e.decimals&&(e.decimals=parseInt(e.decimals));t[e]=n}}return t.PreferencesController.accountTokens=i,t}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/054.js"}],[238,{"../../../shared/constants/network":5658,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("../../../shared/constants/network");n.default={version:55,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=55;const n=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.IncomingTransactionsController)&&void 0!==t&&t.incomingTxLastFetchedBlocksByNetwork&&(e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId=(0,s.mapKeys)(e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork,((e,t)=>{var n;return(null===(n=r.BUILT_IN_NETWORKS[t])||void 0===n?void 0:n.chainId)??i})),delete e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId[i],delete e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork);return e}(n),t}};const i="UNKNOWN";r.BUILT_IN_NETWORKS.rinkeby={networkId:"4",chainId:"0x4",ticker:"ETH"},r.BUILT_IN_NETWORKS.ropsten={networkId:"3",chainId:"0x3",ticker:"ETH"},r.BUILT_IN_NETWORKS.kovan={networkId:"42",chainId:"0x2a",ticker:"ETH"}}}},{package:"$root$",file:"app/scripts/migrations/055.js"}],[239,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:56,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=56;const{PreferencesController:n}=t.data;return Array.isArray(null==n?void 0:n.tokens)&&(n.tokens=n.tokens.filter((({address:e})=>e))),null!=n&&n.accountTokens&&"object"==typeof n.accountTokens&&Object.keys(n.accountTokens).forEach((e=>{Object.keys(n.accountTokens[e]).forEach((t=>{n.accountTokens[e][t]=n.accountTokens[e][t].filter((({address:e})=>e))}))})),null!=n&&n.assetImages&&"undefined"in n.assetImages&&delete n.assetImages.undefined,t}}}}},{package:"$root$",file:"app/scripts/migrations/056.js"}],[24,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getCronjobControllerMessenger=function(e){return e.getRestricted({name:"CronjobController",allowedEvents:["SnapController:snapInstalled","SnapController:snapUpdated","SnapController:snapUninstalled","SnapController:snapEnabled","SnapController:snapDisabled"],allowedActions:["PermissionController:getPermissions","SnapController:handleRequest","SnapController:getAll"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/cronjob-controller-messenger.ts"}],[240,{"../../../shared/modules/random-id":5722,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s,r=e("lodash"),i=(s=e("../../../shared/modules/random-id"))&&s.__esModule?s:{default:s};n.default={version:57,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=57;const n=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.TransactionController)&&void 0!==t&&t.transactions&&Array.isArray(e.TransactionController.transactions)&&!e.TransactionController.transactions.some((e=>"object"!=typeof e||void 0===e.txParams))&&(e.TransactionController.transactions=(0,r.keyBy)(e.TransactionController.transactions,(e=>(void 0!==e.id&&null!==e.id||(e.id=(0,i.default)()),e.id))));return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/057.js"}],[241,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:58,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=58;const n=t.data;return t.data=function(e){var t;return null===(t=e.AppStateController)||void 0===t||delete t.swapsWelcomeMessageHasBeenShown,e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/058.js"}],[242,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/transaction-controller");n.default={version:59,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=59;const n=t.data;return t.data=function(e){var t;const n=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,s.isPlainObject)(n)){const t=(0,s.groupBy)(Object.values(n),(e=>{var t;return`${null===(t=e.txParams)||void 0===t?void 0:t.nonce}-${e.chainId??e.metamaskNetworkId}`})),i=(0,s.pickBy)(t,(e=>e.some((e=>e.type!==r.TransactionType.cancel&&e.type!==r.TransactionType.retry))));e.TransactionController.transactions=(0,s.keyBy)((0,s.concat)(...Object.values(i)),(e=>e.id))}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/059.js"}],[243,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");const r="2020-08-31";n.default={version:60,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=60;const n=function(e){var t;const n=null==e||null===(t=e.NotificationController)||void 0===t?void 0:t.notifications;var i;(0,s.isPlainObject)(n)&&(null===(i=n[2])||void 0===i?void 0:i.date)===r&&delete e.NotificationController.notifications[2];return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/060.js"}],[244,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:61,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=61;const n=function(e){const t=(new Date).getTime();e.AppStateController?(e.AppStateController.recoveryPhraseReminderHasBeenShown=!1,e.AppStateController.recoveryPhraseReminderLastShown=t):e.AppStateController={recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:t};return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/061.js"}],[2444,{"@metamask/base-controller":2451,"@metamask/selected-network-controller":2500,"@metamask/utils":2462},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p,m,g,y,w,b=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},v=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.QueuedRequestController=n.QueuedRequestControllerEventTypes=n.QueuedRequestControllerActionTypes=n.controllerName=void 0;const S=e("@metamask/base-controller"),k=e("@metamask/selected-network-controller"),T=e("@metamask/utils");n.controllerName="QueuedRequestController",n.QueuedRequestControllerActionTypes={enqueueRequest:`${n.controllerName}:enqueueRequest`,getState:`${n.controllerName}:getState`},n.QueuedRequestControllerEventTypes={networkSwitched:`${n.controllerName}:networkSwitched`,stateChange:`${n.controllerName}:stateChange`};class _ extends S.BaseController{constructor({messenger:e,shouldRequestSwitchNetwork:t,canRequestSwitchNetworkWithoutApproval:f,clearPendingConfirmations:p,showApprovalRequest:m}){super({name:n.controllerName,metadata:{queuedRequestCount:{anonymous:!0,persist:!1}},messenger:e,state:{queuedRequestCount:0}}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,[]),o.set(this,0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,void 0),b(this,c,t,"f"),b(this,l,f,"f"),b(this,u,p,"f"),b(this,d,m,"f"),v(this,s,"m",h).call(this)}async enqueueRequest(e,t){if(e.networkClientId===undefined)throw new Error("Error while attempting to enqueue request: networkClientId is required.");v(this,r,"f")===undefined&&b(this,r,e.origin,"f"),v(this,i,"f")===undefined&&b(this,i,e.networkClientId,"f");try{let n;const a=v(this,o,"f")>0&&v(this,l,"f").call(this,e);if(this.state.queuedRequestCount>0||v(this,r,"f")!==e.origin||v(this,i,"f")!==e.networkClientId||a){v(this,d,"f").call(this);const t=v(this,s,"m",y).call(this,e);n=t.requestHasEnded,await t.dequeuedPromise}else v(this,c,"f").call(this,e)&&await v(this,s,"m",m).call(this,e.networkClientId);b(this,o,v(this,o,"f")+1,"f");try{await t()}finally{n?.(),b(this,o,v(this,o,"f")-1,"f")}return undefined}finally{v(this,s,"m",w).call(this)}}}n.QueuedRequestController=_,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,s=new WeakSet,h=function(){this.messagingSystem.registerActionHandler(`${n.controllerName}:enqueueRequest`,this.enqueueRequest.bind(this)),this.messagingSystem.subscribe(k.SelectedNetworkControllerEventTypes.stateChange,((e,t)=>{t.forEach((({op:e,path:t})=>{if(2===t.length&&"domains"===t[0]&&"string"==typeof t[1]){const n=t[1];v(this,s,"m",f).call(this,n),"remove"===e&&n===v(this,r,"f")&&v(this,u,"f").call(this)}}))}))},f=function(e){v(this,a,"f").filter((({request:t})=>t.origin===e)).forEach((({processRequest:e})=>{e(new Error("The request has been rejected due to a change in selected network. Please verify the selected network and retry the request."))})),b(this,a,v(this,a,"f").filter((({request:t})=>t.origin!==e)),"f"),v(this,s,"m",g).call(this)},p=async function(){const e=v(this,a,"f").shift();b(this,r,e.request.origin,"f"),b(this,i,e.request.networkClientId,"f");const t=[e];let n;try{await v(this,s,"m",m).call(this,e.request.networkClientId)}catch(e){n=e}if(v(this,l,"f").call(this,e.request)){b(this,o,v(this,o,"f")+1,"f");try{e.processRequest(n),v(this,s,"m",g).call(this),await e.requestHasBeenProcessed}finally{b(this,o,v(this,o,"f")-1,"f")}const{selectedNetworkClientId:t}=this.messagingSystem.call("NetworkController:getState");return v(this,i,"f")!==t&&v(this,s,"m",f).call(this,v(this,r,"f")),void v(this,s,"m",w).call(this)}for(;v(this,a,"f")[0]?.request.networkClientId===v(this,i,"f")&&v(this,a,"f")[0]?.request.origin===v(this,r,"f")&&!v(this,l,"f").call(this,v(this,a,"f")[0]?.request);){const e=v(this,a,"f").shift();t.push(e)}for(const{processRequest:e}of t)e(n);v(this,s,"m",g).call(this)},m=async function(e){const{selectedNetworkClientId:t}=this.messagingSystem.call("NetworkController:getState");e!==t&&(await this.messagingSystem.call("NetworkController:setActiveNetwork",e),this.messagingSystem.publish("QueuedRequestController:networkSwitched",e))},g=function(){this.update((e=>{e.queuedRequestCount=v(this,a,"f").length}))},y=function(e){const{promise:t,reject:n,resolve:r}=(0,T.createDeferredPromise)({suppressUnhandledRejection:!0}),{promise:i,resolve:o}=(0,T.createDeferredPromise)({suppressUnhandledRejection:!0});return v(this,a,"f").push({request:e,processRequest:e=>{e?n(e):r()},requestHasBeenProcessed:i}),v(this,s,"m",g).call(this),{dequeuedPromise:t,requestHasEnded:o}},w=function(){0===v(this,o,"f")&&(b(this,r,undefined,"f"),b(this,i,undefined,"f"),v(this,a,"f").length>0&&v(this,s,"m",p).call(this))}}}},{package:"@metamask/queued-request-controller",file:"node_modules/@metamask/queued-request-controller/dist/QueuedRequestController.cjs"}],[2445,{"@metamask/json-rpc-engine":1827,"@metamask/rpc-errors":2484},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createQueuedRequestMiddleware=void 0;const s=e("@metamask/json-rpc-engine"),r=e("@metamask/rpc-errors");n.createQueuedRequestMiddleware=({enqueueRequest:e,useRequestQueue:t,shouldEnqueueRequest:n})=>(0,s.createAsyncMiddleware)((async(s,i,a)=>{if(function(e){if(!e.origin)throw new Error("Request object is lacking an 'origin'");if("string"!=typeof e.origin)throw new Error(`Request object has an invalid origin of type '${typeof e.origin}'`);if(!e.networkClientId)throw new Error("Request object is lacking a 'networkClientId'");if("string"!=typeof e.networkClientId)throw new Error(`Request object has an invalid networkClientId of type '${typeof e.networkClientId}'`)}(s),!t()||!n(s))return await a();try{await e(s,a)}catch(e){i.error=(0,r.serializeError)(e)}return undefined}))}}},{package:"@metamask/queued-request-controller",file:"node_modules/@metamask/queued-request-controller/dist/QueuedRequestMiddleware.cjs"}],[2446,{"./QueuedRequestController.cjs":2444,"./QueuedRequestMiddleware.cjs":2445},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createQueuedRequestMiddleware=n.QueuedRequestController=n.QueuedRequestControllerEventTypes=n.QueuedRequestControllerActionTypes=void 0;var s=e("./QueuedRequestController.cjs");Object.defineProperty(n,"QueuedRequestControllerActionTypes",{enumerable:!0,get:function(){return s.QueuedRequestControllerActionTypes}}),Object.defineProperty(n,"QueuedRequestControllerEventTypes",{enumerable:!0,get:function(){return s.QueuedRequestControllerEventTypes}}),Object.defineProperty(n,"QueuedRequestController",{enumerable:!0,get:function(){return s.QueuedRequestController}});var r=e("./QueuedRequestMiddleware.cjs");Object.defineProperty(n,"createQueuedRequestMiddleware",{enumerable:!0,get:function(){return r.createQueuedRequestMiddleware}})}}},{package:"@metamask/queued-request-controller",file:"node_modules/@metamask/queued-request-controller/dist/index.cjs"}],[2447,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseControllerV1=n.isBaseControllerV1=void 0,n.isBaseControllerV1=function(e){return"name"in e&&"string"==typeof e.name&&"config"in e&&"object"==typeof e.config&&"defaultConfig"in e&&"object"==typeof e.defaultConfig&&"state"in e&&"object"==typeof e.state&&"defaultState"in e&&"object"==typeof e.defaultState&&"disabled"in e&&"boolean"==typeof e.disabled&&"subscribe"in e&&"function"==typeof e.subscribe};class s{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,n=!0){if(n){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];t!==undefined&&(this[e]=t)}}else for(const t of Object.keys(e))if(this.internalConfig[t]!==undefined){const n=e[t];this.internalConfig[t]=n,this[t]=n}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}n.BaseControllerV1=s,n.default=s}}},{package:"@metamask/queued-request-controller>@metamask/base-controller",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/base-controller/dist/BaseControllerV1.cjs"}],[2448,{immer:4573},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseController=n.isBaseController=void 0;const a=e("immer");(0,a.enablePatches)(),n.isBaseController=function(e){return"name"in e&&"string"==typeof e.name&&"state"in e&&"object"==typeof e.state&&"metadata"in e&&"object"==typeof e.metadata};function o(e,t,n){return Object.keys(e).reduce(((s,r)=>{try{const i=t[r];if(!i)throw new Error(`No metadata found for '${String(r)}'`);const a=i[n],o=e[r];return"function"==typeof a?s[r]=a(o):a&&(s[r]=o),s}catch(e){return setTimeout((()=>{throw e})),s}}),{})}n.BaseController=class{constructor({messenger:e,metadata:t,name:n,state:i}){s.set(this,void 0),this.messagingSystem=e,this.name=n,r(this,s,(0,a.freeze)(i,!0),"f"),this.metadata=t,this.messagingSystem.registerActionHandler(`${n}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${n}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return i(this,s,"f")}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,n,o]=a.produceWithPatches(i(this,s,"f"),e);return r(this,s,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,n),{nextState:t,patches:n,inversePatches:o}}applyPatches(e){const t=(0,a.applyPatches)(i(this,s,"f"),e);r(this,s,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},s=new WeakMap,n.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},n.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/queued-request-controller>@metamask/base-controller",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/base-controller/dist/BaseControllerV2.cjs"}],[2449,{"./RestrictedMessenger.cjs":2450},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ControllerMessenger=n.Messenger=void 0;const c=e("./RestrictedMessenger.cjs");class l{constructor(){s.set(this,new Map),r.set(this,new Map),i.set(this,new Map),a.set(this,new Map)}registerActionHandler(e,t){if(o(this,s,"f").has(e))throw new Error(`A handler for ${e} has already been registered`);o(this,s,"f").set(e,t)}unregisterActionHandler(e){o(this,s,"f").delete(e)}clearActions(){o(this,s,"f").clear()}call(e,...t){const n=o(this,s,"f").get(e);if(!n)throw new Error(`A handler for ${e} has not been registered`);return n(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){o(this,i,"f").set(e,t)}publish(e,...t){const n=o(this,r,"f").get(e);if(n)for(const[e,s]of n.entries())try{if(s){const n=o(this,a,"f").get(e),r=s(...t);r!==n&&(o(this,a,"f").set(e,r),e(r,n))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,n){let s=o(this,r,"f").get(e);if(s||(s=new Map,o(this,r,"f").set(e,s)),s.set(t,n),n){const s=o(this,i,"f").get(e);if(s){const e=n(...s());o(this,a,"f").set(t,e)}}}unsubscribe(e,t){const n=o(this,r,"f").get(e);if(!n||!n.has(t))throw new Error(`Subscription not found for event: ${e}`);n.get(t)&&o(this,a,"f").delete(t),n.delete(t)}clearEventSubscriptions(e){o(this,r,"f").delete(e)}clearSubscriptions(){o(this,r,"f").clear()}getRestricted({name:e,allowedActions:t,allowedEvents:n}){return new c.RestrictedMessenger({messenger:this,name:e,allowedActions:t,allowedEvents:n})}}n.Messenger=l,n.ControllerMessenger=l,s=new WeakMap,r=new WeakMap,i=new WeakMap,a=new WeakMap}}},{package:"@metamask/queued-request-controller>@metamask/base-controller",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/base-controller/dist/Messenger.cjs"}],[245,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:62,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=62;const n=function(e){if(e.MetaMetricsController){const{metaMetricsSendCount:t}=e.MetaMetricsController;t!==undefined&&delete e.MetaMetricsController.metaMetricsSendCount}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/062.js"}],[2450,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.RestrictedControllerMessenger=n.RestrictedMessenger=void 0;class f{constructor({controllerMessenger:e,messenger:t,name:n,allowedActions:c,allowedEvents:l}){if(s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),t&&e)throw new Error("Both messenger properties provided. Provide message using only 'messenger' option, 'controllerMessenger' is deprecated");if(!t&&!e)throw new Error("Messenger not provided");d(this,r,t??e,"f"),d(this,i,n,"f"),d(this,a,c,"f"),d(this,o,l,"f")}registerActionHandler(e,t){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").registerActionHandler(e,t)}unregisterActionHandler(e){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").unregisterActionHandler(e)}call(e,...t){if(!h(this,s,"m",l).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return h(this,r,"f").call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").publish(e,...t)}subscribe(e,t,n){if(!h(this,s,"m",c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return n?h(this,r,"f").subscribe(e,t,n):h(this,r,"f").subscribe(e,t)}unsubscribe(e,t){if(!h(this,s,"m",c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);h(this,r,"f").unsubscribe(e,t)}clearEventSubscriptions(e){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").clearEventSubscriptions(e)}}n.RestrictedMessenger=f,n.RestrictedControllerMessenger=f,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakSet,c=function(e){const t=h(this,o,"f");return h(this,s,"m",u).call(this,e)||null!==t&&t.includes(e)},l=function(e){const t=h(this,a,"f");return h(this,s,"m",u).call(this,e)||null!==t&&t.includes(e)},u=function(e){return e.startsWith(`${h(this,i,"f")}:`)}}}},{package:"@metamask/queued-request-controller>@metamask/base-controller",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/base-controller/dist/RestrictedMessenger.cjs"}],[2451,{"./BaseControllerV1.cjs":2447,"./BaseControllerV2.cjs":2448,"./Messenger.cjs":2449,"./RestrictedMessenger.cjs":2450},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RestrictedMessenger=n.RestrictedControllerMessenger=n.Messenger=n.ControllerMessenger=n.isBaseController=n.getPersistentState=n.getAnonymizedState=n.BaseController=n.isBaseControllerV1=n.BaseControllerV1=void 0;var s=e("./BaseControllerV1.cjs");Object.defineProperty(n,"BaseControllerV1",{enumerable:!0,get:function(){return s.BaseControllerV1}}),Object.defineProperty(n,"isBaseControllerV1",{enumerable:!0,get:function(){return s.isBaseControllerV1}});var r=e("./BaseControllerV2.cjs");Object.defineProperty(n,"BaseController",{enumerable:!0,get:function(){return r.BaseController}}),Object.defineProperty(n,"getAnonymizedState",{enumerable:!0,get:function(){return r.getAnonymizedState}}),Object.defineProperty(n,"getPersistentState",{enumerable:!0,get:function(){return r.getPersistentState}}),Object.defineProperty(n,"isBaseController",{enumerable:!0,get:function(){return r.isBaseController}});var i=e("./Messenger.cjs");Object.defineProperty(n,"ControllerMessenger",{enumerable:!0,get:function(){return i.ControllerMessenger}}),Object.defineProperty(n,"Messenger",{enumerable:!0,get:function(){return i.Messenger}});var a=e("./RestrictedMessenger.cjs");Object.defineProperty(n,"RestrictedControllerMessenger",{enumerable:!0,get:function(){return a.RestrictedControllerMessenger}}),Object.defineProperty(n,"RestrictedMessenger",{enumerable:!0,get:function(){return a.RestrictedMessenger}})}}},{package:"@metamask/queued-request-controller>@metamask/base-controller",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/base-controller/dist/index.cjs"}],[2452,{"./errors.cjs":2460,"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.assertExhaustive=n.assertStruct=n.assert=n.AssertionError=void 0;const s=e("@metamask/superstruct"),r=e("./errors.cjs");function i(e,t){return n=e,Boolean("string"==typeof n?.prototype?.constructor?.name)?new e({message:t}):e({message:t});var n}class a extends Error{constructor(e){super(e.message),this.code="ERR_ASSERTION"}}n.AssertionError=a,n.assert=function(e,t="Assertion failed.",n=a){if(!e){if(t instanceof Error)throw t;throw i(n,t)}},n.assertStruct=function(e,t,n="Assertion failed",o=a){try{(0,s.assert)(e,t)}catch(e){throw i(o,`${n}: ${function(e){return(0,r.getErrorMessage)(e).replace(/\.$/u,"")}(e)}.`)}},n.assertExhaustive=function(e){throw new Error("Invalid branch reached. Should be detected during compilation.")}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/assert.cjs"}],[2453,{"./assert.cjs":2452,"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;const s=e("@metamask/superstruct"),r=e("./assert.cjs");n.base64=(e,t={})=>{const n=t.paddingRequired??!1,i=t.characterSet??"base64";let a,o;return"base64"===i?a=String.raw`[A-Za-z0-9+\/]`:((0,r.assert)("base64url"===i),a=String.raw`[-_A-Za-z0-9]`),o=n?new RegExp(`^(?:${a}{4})*(?:${a}{3}=|${a}{2}==)?$`,"u"):new RegExp(`^(?:${a}{4})*(?:${a}{2,3}|${a}{3}=|${a}{2}==)?$`,"u"),(0,s.pattern)(e,o)}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/base64.cjs"}],[2454,{"./assert.cjs":2452,"./hex.cjs":2461,"@scure/base":2951,buffer:3998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.createDataView=n.concatBytes=n.valueToBytes=n.base64ToBytes=n.stringToBytes=n.numberToBytes=n.signedBigIntToBytes=n.bigIntToBytes=n.hexToBytes=n.bytesToBase64=n.bytesToString=n.bytesToNumber=n.bytesToSignedBigInt=n.bytesToBigInt=n.bytesToHex=n.assertIsBytes=n.isBytes=void 0;const s=e("@scure/base"),r=e("./assert.cjs"),i=e("./hex.cjs"),a=48,o=58,c=87;const l=function(){const e=[];return()=>{if(0===e.length)for(let t=0;t<256;t++)e.push(t.toString(16).padStart(2,"0"));return e}}();function u(e){return e instanceof Uint8Array}function d(e){(0,r.assert)(u(e),"Value must be a Uint8Array.")}function h(e){if(d(e),0===e.length)return"0x";const t=l(),n=new Array(e.length);for(let s=0;s<e.length;s++)n[s]=t[e[s]];return(0,i.add0x)(n.join(""))}function f(e){d(e);const t=h(e);return BigInt(t)}function p(e){if("0x"===e?.toLowerCase?.())return new Uint8Array;(0,i.assertIsHexString)(e);const t=(0,i.remove0x)(e).toLowerCase(),n=t.length%2==0?t:`0${t}`,s=new Uint8Array(n.length/2);for(let e=0;e<s.length;e++){const t=n.charCodeAt(2*e),r=n.charCodeAt(2*e+1),i=t-(t<o?a:c),l=r-(r<o?a:c);s[e]=16*i+l}return s}function m(e){(0,r.assert)("bigint"==typeof e,"Value must be a bigint."),(0,r.assert)(e>=BigInt(0),"Value must be a non-negative bigint.");return p(e.toString(16))}function g(e){(0,r.assert)("number"==typeof e,"Value must be a number."),(0,r.assert)(e>=0,"Value must be a non-negative number."),(0,r.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToBytes` instead.");return p(e.toString(16))}function y(e){return(0,r.assert)("string"==typeof e,"Value must be a string."),(new TextEncoder).encode(e)}function w(e){if("bigint"==typeof e)return m(e);if("number"==typeof e)return g(e);if("string"==typeof e)return e.startsWith("0x")?p(e):y(e);if(u(e))return e;throw new TypeError(`Unsupported value type: "${typeof e}".`)}n.isBytes=u,n.assertIsBytes=d,n.bytesToHex=h,n.bytesToBigInt=f,n.bytesToSignedBigInt=function(e){d(e);let t=BigInt(0);for(const n of e)t=(t<<BigInt(8))+BigInt(n);return BigInt.asIntN(8*e.length,t)},n.bytesToNumber=function(e){d(e);const t=f(e);return(0,r.assert)(t<=BigInt(Number.MAX_SAFE_INTEGER),"Number is not a safe integer. Use `bytesToBigInt` instead."),Number(t)},n.bytesToString=function(e){return d(e),(new TextDecoder).decode(e)},n.bytesToBase64=function(e){return d(e),s.base64.encode(e)},n.hexToBytes=p,n.bigIntToBytes=m,n.signedBigIntToBytes=function(e,t){(0,r.assert)("bigint"==typeof e,"Value must be a bigint."),(0,r.assert)("number"==typeof t,"Byte length must be a number."),(0,r.assert)(t>0,"Byte length must be greater than 0."),(0,r.assert)(function(e,t){(0,r.assert)(t>0);const n=e>>BigInt(31);return!((~e&n)+(e&~n)>>BigInt(8*t-1))}(e,t),"Byte length is too small to represent the given value.");let n=e;const s=new Uint8Array(t);for(let e=0;e<s.length;e++)s[e]=Number(BigInt.asUintN(8,n)),n>>=BigInt(8);return s.reverse()},n.numberToBytes=g,n.stringToBytes=y,n.base64ToBytes=function(e){return(0,r.assert)("string"==typeof e,"Value must be a string."),s.base64.decode(e)},n.valueToBytes=w,n.concatBytes=function(e){const t=new Array(e.length);let n=0;for(let s=0;s<e.length;s++){const r=w(e[s]);t[s]=r,n+=r.length}const s=new Uint8Array(n);for(let e=0,n=0;e<t.length;e++)s.set(t[e],n),n+=t[e].length;return s},n.createDataView=function(e){if(void 0!==t&&e instanceof t){const t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return new DataView(t)}return new DataView(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/bytes.cjs"}],[2455,{"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.toCaipChainId=n.parseCaipAccountId=n.parseCaipChainId=n.isCaipAssetId=n.isCaipAssetType=n.isCaipAccountAddress=n.isCaipAccountId=n.isCaipReference=n.isCaipNamespace=n.isCaipChainId=n.KnownCaipNamespace=n.CaipAssetIdStruct=n.CaipAssetTypeStruct=n.CaipAccountAddressStruct=n.CaipAccountIdStruct=n.CaipReferenceStruct=n.CaipNamespaceStruct=n.CaipChainIdStruct=n.CAIP_ASSET_ID_REGEX=n.CAIP_ASSET_TYPE_REGEX=n.CAIP_ACCOUNT_ADDRESS_REGEX=n.CAIP_ACCOUNT_ID_REGEX=n.CAIP_REFERENCE_REGEX=n.CAIP_NAMESPACE_REGEX=n.CAIP_CHAIN_ID_REGEX=void 0;const s=e("@metamask/superstruct");function r(e){return(0,s.is)(e,n.CaipNamespaceStruct)}function i(e){return(0,s.is)(e,n.CaipReferenceStruct)}n.CAIP_CHAIN_ID_REGEX=/^(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})$/u,n.CAIP_NAMESPACE_REGEX=/^[-a-z0-9]{3,8}$/u,n.CAIP_REFERENCE_REGEX=/^[-_a-zA-Z0-9]{1,32}$/u,n.CAIP_ACCOUNT_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32})):(?<accountAddress>[-.%a-zA-Z0-9]{1,128})$/u,n.CAIP_ACCOUNT_ADDRESS_REGEX=/^[-.%a-zA-Z0-9]{1,128}$/u,n.CAIP_ASSET_TYPE_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})$/u,n.CAIP_ASSET_ID_REGEX=/^(?<chainId>(?<namespace>[-a-z0-9]{3,8}):(?<reference>[-_a-zA-Z0-9]{1,32}))\/(?<assetNamespace>[-a-z0-9]{3,8}):(?<assetReference>[-.%a-zA-Z0-9]{1,128})\/(?<tokenId>[-.%a-zA-Z0-9]{1,78})$/u,n.CaipChainIdStruct=(0,s.pattern)((0,s.string)(),n.CAIP_CHAIN_ID_REGEX),n.CaipNamespaceStruct=(0,s.pattern)((0,s.string)(),n.CAIP_NAMESPACE_REGEX),n.CaipReferenceStruct=(0,s.pattern)((0,s.string)(),n.CAIP_REFERENCE_REGEX),n.CaipAccountIdStruct=(0,s.pattern)((0,s.string)(),n.CAIP_ACCOUNT_ID_REGEX),n.CaipAccountAddressStruct=(0,s.pattern)((0,s.string)(),n.CAIP_ACCOUNT_ADDRESS_REGEX),n.CaipAssetTypeStruct=(0,s.pattern)((0,s.string)(),n.CAIP_ASSET_TYPE_REGEX),n.CaipAssetIdStruct=(0,s.pattern)((0,s.string)(),n.CAIP_ASSET_ID_REGEX),function(e){e.Bip122="bip122",e.Solana="solana",e.Eip155="eip155",e.Wallet="wallet"}(n.KnownCaipNamespace||(n.KnownCaipNamespace={})),n.isCaipChainId=function(e){return(0,s.is)(e,n.CaipChainIdStruct)},n.isCaipNamespace=r,n.isCaipReference=i,n.isCaipAccountId=function(e){return(0,s.is)(e,n.CaipAccountIdStruct)},n.isCaipAccountAddress=function(e){return(0,s.is)(e,n.CaipAccountAddressStruct)},n.isCaipAssetType=function(e){return(0,s.is)(e,n.CaipAssetTypeStruct)},n.isCaipAssetId=function(e){return(0,s.is)(e,n.CaipAssetIdStruct)},n.parseCaipChainId=function(e){const t=n.CAIP_CHAIN_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP chain ID.");return{namespace:t.groups.namespace,reference:t.groups.reference}},n.parseCaipAccountId=function(e){const t=n.CAIP_ACCOUNT_ID_REGEX.exec(e);if(!t?.groups)throw new Error("Invalid CAIP account ID.");return{address:t.groups.accountAddress,chainId:t.groups.chainId,chain:{namespace:t.groups.namespace,reference:t.groups.reference}}},n.toCaipChainId=function(e,t){if(!r(e))throw new Error(`Invalid "namespace", must match: ${n.CAIP_NAMESPACE_REGEX.toString()}`);if(!i(t))throw new Error(`Invalid "reference", must match: ${n.CAIP_REFERENCE_REGEX.toString()}`);return`${e}:${t}`}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/caip-types.cjs"}],[2456,{"./base64.cjs":2453,"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ChecksumStruct=void 0;const s=e("@metamask/superstruct"),r=e("./base64.cjs");n.ChecksumStruct=(0,s.size)((0,r.base64)((0,s.string)(),{paddingRequired:!0}),44,44)}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/checksum.cjs"}],[2457,{"./assert.cjs":2452,"./bytes.cjs":2454,"./hex.cjs":2461,"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createHex=n.createBytes=n.createBigInt=n.createNumber=void 0;const s=e("@metamask/superstruct"),r=e("./assert.cjs"),i=e("./bytes.cjs"),a=e("./hex.cjs"),o=(0,s.union)([(0,s.number)(),(0,s.bigint)(),(0,s.string)(),a.StrictHexStruct]),c=(0,s.coerce)((0,s.number)(),o,Number),l=(0,s.coerce)((0,s.bigint)(),o,BigInt),u=((0,s.union)([a.StrictHexStruct,(0,s.instance)(Uint8Array)]),(0,s.coerce)((0,s.instance)(Uint8Array),(0,s.union)([a.StrictHexStruct]),i.hexToBytes)),d=(0,s.coerce)(a.StrictHexStruct,(0,s.instance)(Uint8Array),i.bytesToHex);n.createNumber=function(e){try{const t=(0,s.create)(e,c);return(0,r.assert)(Number.isFinite(t),`Expected a number-like value, got "${e}".`),t}catch(t){if(t instanceof s.StructError)throw new Error(`Expected a number-like value, got "${e}".`);throw t}},n.createBigInt=function(e){try{return(0,s.create)(e,l)}catch(e){if(e instanceof s.StructError)throw new Error(`Expected a number-like value, got "${String(e.value)}".`);throw e}},n.createBytes=function(e){if("string"==typeof e&&"0x"===e.toLowerCase())return new Uint8Array;try{return(0,s.create)(e,u)}catch(e){if(e instanceof s.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}},n.createHex=function(e){if(e instanceof Uint8Array&&0===e.length||"string"==typeof e&&"0x"===e.toLowerCase())return"0x";try{return(0,s.create)(e,d)}catch(e){if(e instanceof s.StructError)throw new Error(`Expected a bytes-like value, got "${String(e.value)}".`);throw e}}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/coercers.cjs"}],[2458,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},a=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.FrozenSet=n.FrozenMap=void 0;class o{get size(){return i(this,s,"f").size}[(s=new WeakMap,Symbol.iterator)](){return i(this,s,"f")[Symbol.iterator]()}constructor(e){s.set(this,void 0),a(this,s,new Map(e),"f"),Object.freeze(this)}entries(){return i(this,s,"f").entries()}forEach(e,t){return i(this,s,"f").forEach(((n,s,r)=>e.call(t,n,s,this)))}get(e){return i(this,s,"f").get(e)}has(e){return i(this,s,"f").has(e)}keys(){return i(this,s,"f").keys()}values(){return i(this,s,"f").values()}toString(){return`FrozenMap(${this.size}) {${this.size>0?` ${[...this.entries()].map((([e,t])=>`${String(e)} => ${String(t)}`)).join(", ")} `:""}}`}}n.FrozenMap=o;class c{get size(){return i(this,r,"f").size}[(r=new WeakMap,Symbol.iterator)](){return i(this,r,"f")[Symbol.iterator]()}constructor(e){r.set(this,void 0),a(this,r,new Set(e),"f"),Object.freeze(this)}entries(){return i(this,r,"f").entries()}forEach(e,t){return i(this,r,"f").forEach(((n,s,r)=>e.call(t,n,s,this)))}has(e){return i(this,r,"f").has(e)}keys(){return i(this,r,"f").keys()}values(){return i(this,r,"f").values()}toString(){return`FrozenSet(${this.size}) {${this.size>0?` ${[...this.values()].map((e=>String(e))).join(", ")} `:""}}`}}n.FrozenSet=c,Object.freeze(o),Object.freeze(o.prototype),Object.freeze(c),Object.freeze(c.prototype)}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/collections.cjs"}],[2459,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/encryption-types.cjs"}],[246,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:63,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=63;const n=function(e){var t,n,s,r,i,a,o,c;const l=null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.accountTokens,u=null==e||null===(n=e.PreferencesController)||void 0===n?void 0:n.accountHiddenTokens,d={};l&&Object.keys(l).forEach((e=>{Object.keys(l[e]).forEach((t=>{const n=l[e][t];d[t]===undefined?d[t]={[e]:n}:d[t]={...d[t],[e]:n}}))}));const h={};u&&Object.keys(u).forEach((e=>{Object.keys(u[e]).forEach((t=>{const n=u[e][t];h[t]===undefined?h[t]={[e]:n}:h[t]={...h[t],[e]:n}}))}));e.TokensController?(e.TokensController.allTokens=d,e.TokensController.allIgnoredTokens=h):e.TokensController={allTokens:d,allIgnoredTokens:h};return null==e||null===(s=e.PreferencesController)||void 0===s||delete s.accountHiddenTokens,null==e||null===(r=e.PreferencesController)||void 0===r||delete r.accountTokens,null==e||null===(i=e.PreferencesController)||void 0===i||delete i.assetImages,null==e||null===(a=e.PreferencesController)||void 0===a||delete a.hiddenTokens,null==e||null===(o=e.PreferencesController)||void 0===o||delete o.tokens,null==e||null===(c=e.PreferencesController)||void 0===c||delete c.suggestedTokens,e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/063.js"}],[2460,{"./misc.cjs":2466,"pony-cause":4927},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.wrapError=n.getErrorMessage=n.isErrorWithStack=n.isErrorWithMessage=n.isErrorWithCode=void 0;const s=e("pony-cause"),r=e("./misc.cjs");function i(e){return"object"==typeof e&&null!==e&&"code"in e}function a(e){return"object"==typeof e&&null!==e&&"message"in e}n.isErrorWithCode=i,n.isErrorWithMessage=a,n.isErrorWithStack=function(e){return"object"==typeof e&&null!==e&&"stack"in e},n.getErrorMessage=function(e){return a(e)&&"string"==typeof e.message?e.message:(0,r.isNullOrUndefined)(e)?"":String(e)},n.wrapError=function(e,t){if((n=e)instanceof Error||(0,r.isObject)(n)&&"Error"===n.constructor.name){let n;return n=2===Error.length?new Error(t,{cause:e}):new s.ErrorWithCause(t,{cause:e}),i(e)&&(n.code=e.code),n}var n;return t.length>0?new Error(`${String(e)}: ${t}`):new Error(String(e))}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/errors.cjs"}],[2461,{"./assert.cjs":2452,"./bytes.cjs":2454,"@metamask/superstruct":2799,"@noble/hashes/sha3":2925},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.remove0x=n.add0x=n.isValidChecksumAddress=n.getChecksumAddress=n.isValidHexAddress=n.assertIsStrictHexString=n.assertIsHexString=n.isStrictHexString=n.isHexString=n.HexChecksumAddressStruct=n.HexAddressStruct=n.StrictHexStruct=n.HexStruct=void 0;const s=e("@metamask/superstruct"),r=e("@noble/hashes/sha3"),i=e("./assert.cjs"),a=e("./bytes.cjs");function o(e){return(0,s.is)(e,n.HexStruct)}function c(e){return(0,s.is)(e,n.StrictHexStruct)}function l(e){(0,i.assert)((0,s.is)(e,n.HexChecksumAddressStruct),"Invalid hex address.");const t=d(e.toLowerCase()),o=d((0,a.bytesToHex)((0,r.keccak_256)(t)));return`0x${t.split("").map(((e,t)=>{const n=o[t];return(0,i.assert)((0,s.is)(n,(0,s.string)()),"Hash shorter than address."),parseInt(n,16)>7?e.toUpperCase():e})).join("")}`}function u(e){return!!(0,s.is)(e,n.HexChecksumAddressStruct)&&l(e)===e}function d(e){return e.startsWith("0x")||e.startsWith("0X")?e.substring(2):e}n.HexStruct=(0,s.pattern)((0,s.string)(),/^(?:0x)?[0-9a-f]+$/iu),n.StrictHexStruct=(0,s.pattern)((0,s.string)(),/^0x[0-9a-f]+$/iu),n.HexAddressStruct=(0,s.pattern)((0,s.string)(),/^0x[0-9a-f]{40}$/u),n.HexChecksumAddressStruct=(0,s.pattern)((0,s.string)(),/^0x[0-9a-fA-F]{40}$/u),n.isHexString=o,n.isStrictHexString=c,n.assertIsHexString=function(e){(0,i.assert)(o(e),"Value must be a hexadecimal string.")},n.assertIsStrictHexString=function(e){(0,i.assert)(c(e),'Value must be a hexadecimal string, starting with "0x".')},n.isValidHexAddress=function(e){return(0,s.is)(e,n.HexAddressStruct)||u(e)},n.getChecksumAddress=l,n.isValidChecksumAddress=u,n.add0x=function(e){return e.startsWith("0x")?e:e.startsWith("0X")?`0x${e.substring(2)}`:`0x${e}`},n.remove0x=d}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/hex.cjs"}],[2462,{"./assert.cjs":2452,"./base64.cjs":2453,"./bytes.cjs":2454,"./caip-types.cjs":2455,"./checksum.cjs":2456,"./coercers.cjs":2457,"./collections.cjs":2458,"./encryption-types.cjs":2459,"./errors.cjs":2460,"./hex.cjs":2461,"./json.cjs":2463,"./keyring.cjs":2464,"./logging.cjs":2465,"./misc.cjs":2466,"./number.cjs":2467,"./opaque.cjs":2468,"./promise.cjs":2469,"./time.cjs":2470,"./transaction-types.cjs":2471,"./versions.cjs":2472},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./assert.cjs"),n),r(e("./base64.cjs"),n),r(e("./bytes.cjs"),n),r(e("./caip-types.cjs"),n),r(e("./checksum.cjs"),n),r(e("./coercers.cjs"),n),r(e("./collections.cjs"),n),r(e("./encryption-types.cjs"),n),r(e("./errors.cjs"),n),r(e("./hex.cjs"),n),r(e("./json.cjs"),n),r(e("./keyring.cjs"),n),r(e("./logging.cjs"),n),r(e("./misc.cjs"),n),r(e("./number.cjs"),n),r(e("./opaque.cjs"),n),r(e("./promise.cjs"),n),r(e("./time.cjs"),n),r(e("./transaction-types.cjs"),n),r(e("./versions.cjs"),n)}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/index.cjs"}],[2463,{"./assert.cjs":2452,"./misc.cjs":2466,"@metamask/superstruct":2799},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getJsonRpcIdValidator=n.assertIsJsonRpcError=n.isJsonRpcError=n.assertIsJsonRpcFailure=n.isJsonRpcFailure=n.assertIsJsonRpcSuccess=n.isJsonRpcSuccess=n.assertIsJsonRpcResponse=n.isJsonRpcResponse=n.assertIsPendingJsonRpcResponse=n.isPendingJsonRpcResponse=n.JsonRpcResponseStruct=n.JsonRpcFailureStruct=n.JsonRpcSuccessStruct=n.PendingJsonRpcResponseStruct=n.assertIsJsonRpcRequest=n.isJsonRpcRequest=n.assertIsJsonRpcNotification=n.isJsonRpcNotification=n.JsonRpcNotificationStruct=n.JsonRpcRequestStruct=n.JsonRpcParamsStruct=n.JsonRpcErrorStruct=n.JsonRpcIdStruct=n.JsonRpcVersionStruct=n.jsonrpc2=n.getJsonSize=n.getSafeJson=n.isValidJson=n.JsonStruct=n.UnsafeJsonStruct=n.exactOptional=n.object=void 0;const s=e("@metamask/superstruct"),r=e("./assert.cjs"),i=e("./misc.cjs");function a({path:e,branch:t}){const n=e[e.length-1];return(0,i.hasProperty)(t[t.length-2],n)}function o(e){return new s.Struct({...e,type:`optional ${e.type}`,validator:(t,n)=>!a(n)||e.validator(t,n),refiner:(t,n)=>!a(n)||e.refiner(t,n)})}function c(e){if(null===e||"boolean"==typeof e||"string"==typeof e)return!0;if("number"==typeof e&&Number.isFinite(e))return!0;if("object"==typeof e){let t=!0;if(Array.isArray(e)){for(let n=0;n<e.length;n++)if(!c(e[n])){t=!1;break}return t}const n=Object.entries(e);for(let e=0;e<n.length;e++)if("string"!=typeof n[e][0]||!c(n[e][1])){t=!1;break}return t}return!1}function l(e){return(0,s.create)(e,n.JsonStruct)}n.object=e=>(0,s.object)(e),n.exactOptional=o,n.UnsafeJsonStruct=(0,s.define)("JSON",(e=>c(e))),n.JsonStruct=(0,s.coerce)(n.UnsafeJsonStruct,(0,s.any)(),(e=>((0,r.assertStruct)(e,n.UnsafeJsonStruct),JSON.parse(JSON.stringify(e,((e,t)=>"__proto__"===e||"constructor"===e?undefined:t)))))),n.isValidJson=function(e){try{return l(e),!0}catch{return!1}},n.getSafeJson=l,n.getJsonSize=function(e){(0,r.assertStruct)(e,n.JsonStruct,"Invalid JSON value");const t=JSON.stringify(e);return(new TextEncoder).encode(t).byteLength},n.jsonrpc2="2.0",n.JsonRpcVersionStruct=(0,s.literal)(n.jsonrpc2),n.JsonRpcIdStruct=(0,s.nullable)((0,s.union)([(0,s.number)(),(0,s.string)()])),n.JsonRpcErrorStruct=(0,n.object)({code:(0,s.integer)(),message:(0,s.string)(),data:o(n.JsonStruct),stack:o((0,s.string)())}),n.JsonRpcParamsStruct=(0,s.union)([(0,s.record)((0,s.string)(),n.JsonStruct),(0,s.array)(n.JsonStruct)]),n.JsonRpcRequestStruct=(0,n.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,method:(0,s.string)(),params:o(n.JsonRpcParamsStruct)}),n.JsonRpcNotificationStruct=(0,n.object)({jsonrpc:n.JsonRpcVersionStruct,method:(0,s.string)(),params:o(n.JsonRpcParamsStruct)}),n.isJsonRpcNotification=function(e){return(0,s.is)(e,n.JsonRpcNotificationStruct)},n.assertIsJsonRpcNotification=function(e,t){(0,r.assertStruct)(e,n.JsonRpcNotificationStruct,"Invalid JSON-RPC notification",t)},n.isJsonRpcRequest=function(e){return(0,s.is)(e,n.JsonRpcRequestStruct)},n.assertIsJsonRpcRequest=function(e,t){(0,r.assertStruct)(e,n.JsonRpcRequestStruct,"Invalid JSON-RPC request",t)},n.PendingJsonRpcResponseStruct=(0,s.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,result:(0,s.optional)((0,s.unknown)()),error:(0,s.optional)(n.JsonRpcErrorStruct)}),n.JsonRpcSuccessStruct=(0,n.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,result:n.JsonStruct}),n.JsonRpcFailureStruct=(0,n.object)({id:n.JsonRpcIdStruct,jsonrpc:n.JsonRpcVersionStruct,error:n.JsonRpcErrorStruct}),n.JsonRpcResponseStruct=(0,s.union)([n.JsonRpcSuccessStruct,n.JsonRpcFailureStruct]),n.isPendingJsonRpcResponse=function(e){return(0,s.is)(e,n.PendingJsonRpcResponseStruct)},n.assertIsPendingJsonRpcResponse=function(e,t){(0,r.assertStruct)(e,n.PendingJsonRpcResponseStruct,"Invalid pending JSON-RPC response",t)},n.isJsonRpcResponse=function(e){return(0,s.is)(e,n.JsonRpcResponseStruct)},n.assertIsJsonRpcResponse=function(e,t){(0,r.assertStruct)(e,n.JsonRpcResponseStruct,"Invalid JSON-RPC response",t)},n.isJsonRpcSuccess=function(e){return(0,s.is)(e,n.JsonRpcSuccessStruct)},n.assertIsJsonRpcSuccess=function(e,t){(0,r.assertStruct)(e,n.JsonRpcSuccessStruct,"Invalid JSON-RPC success response",t)},n.isJsonRpcFailure=function(e){return(0,s.is)(e,n.JsonRpcFailureStruct)},n.assertIsJsonRpcFailure=function(e,t){(0,r.assertStruct)(e,n.JsonRpcFailureStruct,"Invalid JSON-RPC failure response",t)},n.isJsonRpcError=function(e){return(0,s.is)(e,n.JsonRpcErrorStruct)},n.assertIsJsonRpcError=function(e,t){(0,r.assertStruct)(e,n.JsonRpcErrorStruct,"Invalid JSON-RPC error",t)},n.getJsonRpcIdValidator=function(e){const{permitEmptyString:t,permitFractions:n,permitNull:s}={permitEmptyString:!0,permitFractions:!1,permitNull:!0,...e};return e=>Boolean("number"==typeof e&&(n||Number.isInteger(e))||"string"==typeof e&&(t||e.length>0)||s&&null===e)}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/json.cjs"}],[2464,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/keyring.cjs"}],[2465,{debug:4150},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.createProjectLogger=void 0;const r=(0,s(e("debug")).default)("metamask");n.createProjectLogger=function(e){return r.extend(e)},n.createModuleLogger=function(e,t){return e.extend(t)}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/logging.cjs"}],[2466,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.calculateNumberSize=n.calculateStringSize=n.isASCII=n.isPlainObject=n.ESCAPE_CHARACTERS_REGEXP=n.JsonSize=n.getKnownPropertyNames=n.hasProperty=n.isObject=n.isNullOrUndefined=n.isNonEmptyArray=void 0,n.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},n.isNullOrUndefined=function(e){return null===e||e===undefined},n.isObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)};function s(e){return e.charCodeAt(0)<=127}n.hasProperty=(e,t)=>Object.hasOwnProperty.call(e,t),n.getKnownPropertyNames=function(e){return Object.getOwnPropertyNames(e)},function(e){e[e.Null=4]="Null",e[e.Comma=1]="Comma",e[e.Wrapper=1]="Wrapper",e[e.True=4]="True",e[e.False=5]="False",e[e.Quote=1]="Quote",e[e.Colon=1]="Colon",e[e.Date=24]="Date"}(n.JsonSize||(n.JsonSize={})),n.ESCAPE_CHARACTERS_REGEXP=/"|\\|\n|\r|\t/gu,n.isPlainObject=function(e){if("object"!=typeof e||null===e)return!1;try{let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}catch(e){return!1}},n.isASCII=s,n.calculateStringSize=function(e){return e.split("").reduce(((e,t)=>s(t)?e+1:e+2),0)+(e.match(n.ESCAPE_CHARACTERS_REGEXP)??[]).length},n.calculateNumberSize=function(e){return e.toString().length}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/misc.cjs"}],[2467,{"./assert.cjs":2452,"./hex.cjs":2461},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.hexToBigInt=n.hexToNumber=n.bigIntToHex=n.numberToHex=void 0;const s=e("./assert.cjs"),r=e("./hex.cjs");n.numberToHex=e=>((0,s.assert)("number"==typeof e,"Value must be a number."),(0,s.assert)(e>=0,"Value must be a non-negative number."),(0,s.assert)(Number.isSafeInteger(e),"Value is not a safe integer. Use `bigIntToHex` instead."),(0,r.add0x)(e.toString(16)));n.bigIntToHex=e=>((0,s.assert)("bigint"==typeof e,"Value must be a bigint."),(0,s.assert)(e>=0,"Value must be a non-negative bigint."),(0,r.add0x)(e.toString(16)));n.hexToNumber=e=>{(0,r.assertIsHexString)(e);const t=parseInt(e,16);return(0,s.assert)(Number.isSafeInteger(t),"Value is not a safe integer. Use `hexToBigInt` instead."),t};n.hexToBigInt=e=>((0,r.assertIsHexString)(e),BigInt((0,r.add0x)(e)))}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/number.cjs"}],[2468,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/opaque.cjs"}],[2469,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createDeferredPromise=void 0,n.createDeferredPromise=function({suppressUnhandledRejection:e=!1}={}){let t,n;const s=new Promise(((e,s)=>{t=e,n=s}));return e&&s.catch((e=>{})),{promise:s,resolve:t,reject:n}}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/promise.cjs"}],[247,{"@metamask/transaction-controller":2829,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("@metamask/transaction-controller");const i="sentEther";n.default={version:64,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=64;const n=function(e){var t;const n=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,s.isPlainObject)(n))for(const e of Object.values(n))e.type===i&&(e.type=r.TransactionType.simpleSend),e.history&&e.history.map((e=>(e.type&&e.type===i&&(e.type=r.TransactionType.simpleSend),e)));return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/064.js"}],[2470,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.timeSince=n.inMilliseconds=n.Duration=void 0,function(e){e[e.Millisecond=1]="Millisecond",e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=36e5]="Hour",e[e.Day=864e5]="Day",e[e.Week=6048e5]="Week",e[e.Year=31536e6]="Year"}(n.Duration||(n.Duration={}));const s=(e,t)=>{if(!(e=>Number.isInteger(e)&&e>=0)(e))throw new Error(`"${t}" must be a non-negative integer. Received: "${e}".`)};n.inMilliseconds=function(e,t){return s(e,"count"),e*t},n.timeSince=function(e){return s(e,"timestamp"),Date.now()-e}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/time.cjs"}],[2471,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0})}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/transaction-types.cjs"}],[2472,{"./assert.cjs":2452,"@metamask/superstruct":2799,semver:5471},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.satisfiesVersionRange=n.gtRange=n.gtVersion=n.assertIsSemVerRange=n.assertIsSemVerVersion=n.isValidSemVerRange=n.isValidSemVerVersion=n.VersionRangeStruct=n.VersionStruct=void 0;const s=e("@metamask/superstruct"),r=e("semver"),i=e("./assert.cjs");n.VersionStruct=(0,s.refine)((0,s.string)(),"Version",(e=>null!==(0,r.valid)(e)||`Expected SemVer version, got "${e}"`)),n.VersionRangeStruct=(0,s.refine)((0,s.string)(),"Version range",(e=>null!==(0,r.validRange)(e)||`Expected SemVer range, got "${e}"`)),n.isValidSemVerVersion=function(e){return(0,s.is)(e,n.VersionStruct)},n.isValidSemVerRange=function(e){return(0,s.is)(e,n.VersionRangeStruct)},n.assertIsSemVerVersion=function(e){(0,i.assertStruct)(e,n.VersionStruct)},n.assertIsSemVerRange=function(e){(0,i.assertStruct)(e,n.VersionRangeStruct)},n.gtVersion=function(e,t){return(0,r.gt)(e,t)},n.gtRange=function(e,t){return(0,r.gtr)(e,t)},n.satisfiesVersionRange=function(e,t){return(0,r.satisfies)(e,t,{includePrerelease:!0})}}}},{package:"@metamask/queued-request-controller>@metamask/utils",file:"node_modules/@metamask/queued-request-controller/node_modules/@metamask/utils/dist/versions.cjs"}],[2473,{"@metamask/base-controller":1332,"@metamask/rpc-errors":2484,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RateLimitController=void 0;const s=e("@metamask/base-controller"),r=e("@metamask/rpc-errors"),i=e("@metamask/utils"),a="RateLimitController",o={requests:{persist:!1,anonymous:!1}};class c extends s.BaseController{constructor({rateLimitTimeout:e=5e3,rateLimitCount:t=1,messenger:n,state:s,implementations:r}){const c={requests:(0,i.getKnownPropertyNames)(r).reduce(((e,t)=>({...e,[t]:{}})),{})};super({name:a,metadata:o,messenger:n,state:{...c,...s}}),this.implementations=r,this.rateLimitTimeout=e,this.rateLimitCount=t,this.messagingSystem.registerActionHandler(`${a}:call`,((e,t,...n)=>this.call(e,t,...n)))}async call(e,t,...n){if(this.isRateLimited(t,e))throw r.rpcErrors.limitExceeded({message:`"${t.toString()}" is currently rate-limited. Please try again later.`});this.recordRequest(t,e);const s=this.implementations[t].method;if(!s)throw new Error("Invalid api type");return s(...n)}isRateLimited(e,t){const n=this.implementations[e].rateLimitCount??this.rateLimitCount;return this.state.requests[e][t]>=n}recordRequest(e,t){const n=this.implementations[e].rateLimitTimeout??this.rateLimitTimeout,s=this.state.requests[e][t]??0;this.update((r=>{0===s&&setTimeout((()=>this.resetRequestCount(e,t)),n),Object.assign(r,{requests:{...r.requests,[e]:{[t]:s+1}}})}))}resetRequestCount(e,t){this.update((n=>{Object.assign(n,{requests:{...n.requests,[e]:{[t]:0}}})}))}}n.RateLimitController=c}}},{package:"@metamask/rate-limit-controller",file:"node_modules/@metamask/rate-limit-controller/dist/RateLimitController.cjs"}],[2474,{"./RateLimitController.cjs":2473},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RateLimitController=void 0;var s=e("./RateLimitController.cjs");Object.defineProperty(n,"RateLimitController",{enumerable:!0,get:function(){return s.RateLimitController}})}}},{package:"@metamask/rate-limit-controller",file:"node_modules/@metamask/rate-limit-controller/dist/index.cjs"}],[2475,{"../constants.cjs":2476,"@metamask/controller-utils":1360},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ClientConfigApiService=void 0;const u=e("@metamask/controller-utils"),d=e("../constants.cjs");n.ClientConfigApiService=class{constructor({fetch:e,retries:t=u.DEFAULT_MAX_RETRIES,maximumConsecutiveFailures:n=u.DEFAULT_MAX_CONSECUTIVE_FAILURES,circuitBreakDuration:d=u.DEFAULT_CIRCUIT_BREAK_DURATION,onBreak:h,onDegraded:f,config:p}){s.set(this,void 0),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c(this,s,e,"f"),c(this,i,p.client,"f"),c(this,a,p.distribution,"f"),c(this,o,p.environment,"f"),c(this,r,(0,u.createServicePolicy)({maxRetries:t,maxConsecutiveFailures:n,circuitBreakDuration:d}),"f"),h&&l(this,r,"f").onBreak(h),f&&l(this,r,"f").onDegraded(f)}onBreak(...e){return l(this,r,"f").onBreak(...e)}onDegraded(...e){return l(this,r,"f").onDegraded(...e)}async fetchRemoteFeatureFlags(){const e=`${d.BASE_URL}/flags?client=${l(this,i,"f")}&distribution=${l(this,a,"f")}&environment=${l(this,o,"f")}`,t=await l(this,r,"f").execute((()=>l(this,s,"f").call(this,e,{cache:"no-cache"})));if(!t.ok)throw new Error("Failed to fetch remote feature flags");const n=await t.json();if(!Array.isArray(n))throw new Error("Feature flags api did not return an array");return{remoteFeatureFlags:this.flattenFeatureFlags(n),cacheTimestamp:Date.now()}}flattenFeatureFlags(e){return e.reduce(((e,t)=>({...e,...t})),{})}},s=new WeakMap,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap}}},{package:"@metamask/remote-feature-flag-controller",file:"node_modules/@metamask/remote-feature-flag-controller/dist/client-config-api-service/client-config-api-service.cjs"}],[2476,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BASE_URL=void 0,n.BASE_URL="https://client-config.api.cx.metamask.io/v1"}}},{package:"@metamask/remote-feature-flag-controller",file:"node_modules/@metamask/remote-feature-flag-controller/dist/constants.cjs"}],[2477,{"./client-config-api-service/client-config-api-service.cjs":2475,"./remote-feature-flag-controller-types.cjs":2478,"./remote-feature-flag-controller.cjs":2479,"./utils/user-segmentation-utils.cjs":2480},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.generateDeterministicRandomNumber=n.ClientConfigApiService=n.EnvironmentType=n.DistributionType=n.ClientType=n.RemoteFeatureFlagController=void 0;var s=e("./remote-feature-flag-controller.cjs");Object.defineProperty(n,"RemoteFeatureFlagController",{enumerable:!0,get:function(){return s.RemoteFeatureFlagController}});var r=e("./remote-feature-flag-controller-types.cjs");Object.defineProperty(n,"ClientType",{enumerable:!0,get:function(){return r.ClientType}}),Object.defineProperty(n,"DistributionType",{enumerable:!0,get:function(){return r.DistributionType}}),Object.defineProperty(n,"EnvironmentType",{enumerable:!0,get:function(){return r.EnvironmentType}});var i=e("./client-config-api-service/client-config-api-service.cjs");Object.defineProperty(n,"ClientConfigApiService",{enumerable:!0,get:function(){return i.ClientConfigApiService}});var a=e("./utils/user-segmentation-utils.cjs");Object.defineProperty(n,"generateDeterministicRandomNumber",{enumerable:!0,get:function(){return a.generateDeterministicRandomNumber}})}}},{package:"@metamask/remote-feature-flag-controller",file:"node_modules/@metamask/remote-feature-flag-controller/dist/index.cjs"}],[2478,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i;Object.defineProperty(n,"__esModule",{value:!0}),n.EnvironmentType=n.DistributionType=n.ClientType=void 0,function(e){e.Extension="extension",e.Mobile="mobile"}(s||(n.ClientType=s={})),function(e){e.Main="main",e.Flask="flask",e.Beta="beta"}(r||(n.DistributionType=r={})),function(e){e.Production="prod",e.ReleaseCandidate="rc",e.Development="dev"}(i||(n.EnvironmentType=i={}))}}},{package:"@metamask/remote-feature-flag-controller",file:"node_modules/@metamask/remote-feature-flag-controller/dist/remote-feature-flag-controller-types.cjs"}],[2479,{"./utils/user-segmentation-utils.cjs":2480,"@metamask/base-controller":1332},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteFeatureFlagController=n.getDefaultRemoteFeatureFlagControllerState=n.DEFAULT_CACHE_DURATION=n.controllerName=void 0;const p=e("@metamask/base-controller"),m=e("./utils/user-segmentation-utils.cjs");n.controllerName="RemoteFeatureFlagController",n.DEFAULT_CACHE_DURATION=864e5;const g={remoteFeatureFlags:{persist:!0,anonymous:!0},cacheTimestamp:{persist:!0,anonymous:!0}};function y(){return{remoteFeatureFlags:{},cacheTimestamp:0}}n.getDefaultRemoteFeatureFlagControllerState=y;class w extends p.BaseController{constructor({messenger:e,state:t,clientConfigApiService:l,fetchInterval:u=n.DEFAULT_CACHE_DURATION,disabled:d=!1,getMetaMetricsId:f}){super({name:n.controllerName,metadata:g,messenger:e,state:{remoteFeatureFlags:{},cacheTimestamp:0,...t}}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),h(this,r,u,"f"),h(this,i,d,"f"),h(this,a,l,"f"),h(this,c,f,"f")}async updateRemoteFeatureFlags(){if(f(this,i,"f")||!f(this,s,"m",l).call(this))return;let e;if(f(this,o,"f"))await f(this,o,"f");else{try{h(this,o,f(this,a,"f").fetchRemoteFeatureFlags(),"f"),e=await f(this,o,"f")}finally{h(this,o,undefined,"f")}await f(this,s,"m",u).call(this,e.remoteFeatureFlags)}}enable(){h(this,i,!1,"f")}disable(){h(this,i,!0,"f")}}n.RemoteFeatureFlagController=w,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,s=new WeakSet,l=function(){return Date.now()-this.state.cacheTimestamp>f(this,r,"f")},u=async function(e){const t=await f(this,s,"m",d).call(this,e);this.update((()=>({remoteFeatureFlags:t,cacheTimestamp:Date.now()})))},d=async function(e){const t={},n=f(this,c,"f").call(this),s=(0,m.generateDeterministicRandomNumber)(n);for(const[n,r]of Object.entries(e)){let e=r;if(Array.isArray(r)&&s){const t=r.find((e=>!!(0,m.isFeatureFlagWithScopeValue)(e)&&s<=e.scope.value));t&&(e={name:t.name,value:t.value})}t[n]=e}return t}}}},{package:"@metamask/remote-feature-flag-controller",file:"node_modules/@metamask/remote-feature-flag-controller/dist/remote-feature-flag-controller.cjs"}],[248,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:65,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=65;const n=function(e){if(e.PreferencesController){const{completedOnboarding:t,firstTimeFlowType:n}=e.PreferencesController;e.OnboardingController=e.OnboardingController??{},t!==undefined&&(e.OnboardingController.completedOnboarding=t,delete e.PreferencesController.completedOnboarding),n!==undefined&&(e.OnboardingController.firstTimeFlowType=n,delete e.PreferencesController.firstTimeFlowType)}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/065.js"}],[2480,{uuid:5587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isFeatureFlagWithScopeValue=n.generateDeterministicRandomNumber=void 0;const s=e("uuid");function r(e){return BigInt(`0x${e.replace(/-/gu,"")}`)}const i=r("00000000-0000-4000-8000-000000000000"),a=r("ffffffff-ffff-4fff-bfff-ffffffffffff")-i;n.generateDeterministicRandomNumber=function(e){if(!e)throw new Error("MetaMetrics ID cannot be empty");let t,n;if((0,s.validate)(e)){if(4!==(0,s.version)(e))throw new Error(`Invalid UUID version. Expected v4, got v${(0,s.version)(e)}`);t=r(e)-i,n=a}else{if(!e.startsWith("0x"))throw new Error("Hex ID must start with 0x prefix");const s=e.slice(2),r=64;if(s.length!==r)throw new Error(`Invalid hex ID length. Expected ${r} characters, got ${s.length}`);if(!/^[0-9a-f]+$/iu.test(s))throw new Error("Hex ID contains invalid characters");t=BigInt(`0x${s}`),n=BigInt(`0x${"f".repeat(s.length)}`)}return Number(t*BigInt(1e6)/n)/1e6};n.isFeatureFlagWithScopeValue=e=>"object"==typeof e&&null!==e&&"scope"in e}}},{package:"@metamask/remote-feature-flag-controller",file:"node_modules/@metamask/remote-feature-flag-controller/dist/utils/user-segmentation-utils.cjs"}],[249,{"../../../shared/constants/hardware-wallets":5650,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=e("../../../shared/constants/hardware-wallets");n.default={version:66,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=66;const n=function(e){var t;const n=window.navigator.hid?r.LedgerTransportTypes.webhid:r.LedgerTransportTypes.u2f,s=Boolean(null===(t=e.PreferencesController)||void 0===t?void 0:t.useLedgerLive),i={...e,PreferencesController:{...null==e?void 0:e.PreferencesController,ledgerTransportType:s?r.LedgerTransportTypes.live:n}};return delete i.PreferencesController.useLedgerLive,i}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/066.js"}],[2498,{"@metamask/base-controller":2505,"@metamask/swappable-obj-proxy":2808},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectedNetworkController=n.SelectedNetworkControllerEventTypes=n.SelectedNetworkControllerActionTypes=n.METAMASK_DOMAIN=n.controllerName=void 0;const f=e("@metamask/base-controller"),p=e("@metamask/swappable-obj-proxy");n.controllerName="SelectedNetworkController";const m={domains:{persist:!0,anonymous:!1}},g=["npm:","local:"];n.METAMASK_DOMAIN="metamask",n.SelectedNetworkControllerActionTypes={getState:`${n.controllerName}:getState`,getNetworkClientIdForDomain:`${n.controllerName}:getNetworkClientIdForDomain`,setNetworkClientIdForDomain:`${n.controllerName}:setNetworkClientIdForDomain`},n.SelectedNetworkControllerEventTypes={stateChange:`${n.controllerName}:stateChange`};class y extends f.BaseController{constructor({messenger:e,state:t={domains:{}},useRequestQueuePreference:o,onPreferencesStateChange:l,domainProxyMap:f}){super({name:n.controllerName,metadata:m,messenger:e,state:t}),s.add(this),r.set(this,void 0),i.set(this,void 0),d(this,i,o,"f"),d(this,r,f,"f"),h(this,s,"m",a).call(this),this.messagingSystem.call("PermissionController:getSubjectNames").filter((e=>this.state.domains[e]===undefined)).forEach((e=>this.setNetworkClientIdForDomain(e,this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId))),this.messagingSystem.subscribe("PermissionController:stateChange",((e,t)=>{t.forEach((({op:e,path:t})=>{if("subjects"===t[0]&&t[1]!==undefined&&"string"==typeof t[1]){const n=t[1];"add"===e&&this.state.domains[n]===undefined?this.setNetworkClientIdForDomain(n,this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId):"remove"===e&&this.state.domains[n]!==undefined&&h(this,s,"m",c).call(this,n)}}))})),this.messagingSystem.subscribe("NetworkController:stateChange",(({selectedNetworkClientId:e,networkConfigurationsByChainId:t},n)=>{const s=n.find((({op:e,path:t})=>("replace"===e||"remove"===e)&&"networkConfigurationsByChainId"===t[0]));if(s){const n=Object.values(t).reduce(((e,t)=>(t.rpcEndpoints.forEach((({networkClientId:n})=>e[n]=t.chainId)),e)),{});Object.entries(this.state.domains).forEach((([r,i])=>{const a=n[i];if("remove"!==s.op||a){if("replace"===s.op){const e=s.path[1];if(!a||a===e){const n=t[e],{networkClientId:s}=n.rpcEndpoints[n.defaultRpcEndpointIndex];i!==s&&this.setNetworkClientIdForDomain(r,s)}}}else this.setNetworkClientIdForDomain(r,e)}))}})),l((({useRequestQueue:e})=>{h(this,i,"f")!==e&&(e?h(this,s,"m",u).call(this):Object.keys(this.state.domains).forEach((e=>{h(this,s,"m",c).call(this,e)})),d(this,i,e,"f"))}))}setNetworkClientIdForDomain(e,t){if(h(this,i,"f")){if(e===n.METAMASK_DOMAIN)throw new Error(`NetworkClientId for domain "${n.METAMASK_DOMAIN}" cannot be set on the SelectedNetworkController`);if(!g.some((t=>e.startsWith(t)))){if(!h(this,s,"m",l).call(this,e))throw new Error("NetworkClientId for domain cannot be called with a domain that has not yet been granted permissions");h(this,s,"m",o).call(this,e,t)}}}getNetworkClientIdForDomain(e){const{selectedNetworkClientId:t}=this.messagingSystem.call("NetworkController:getState");return h(this,i,"f")?this.state.domains[e]??t:t}getProviderAndBlockTracker(e){if(e===n.METAMASK_DOMAIN||g.some((t=>e.startsWith(t)))){const e=this.messagingSystem.call("NetworkController:getSelectedNetworkClient");if(e===undefined)throw new Error("Selected network not initialized");return e}let t=h(this,r,"f").get(e);if(t===undefined){let n;if(h(this,i,"f")&&h(this,s,"m",l).call(this,e)){const t=this.getNetworkClientIdForDomain(e);n=this.messagingSystem.call("NetworkController:getNetworkClientById",t)}else if(n=this.messagingSystem.call("NetworkController:getSelectedNetworkClient"),n===undefined)throw new Error("Selected network not initialized");t={provider:(0,p.createEventEmitterProxy)(n.provider),blockTracker:(0,p.createEventEmitterProxy)(n.blockTracker,{eventFilter:"skipInternal"})},h(this,r,"f").set(e,t)}return t}}n.SelectedNetworkController=y,r=new WeakMap,i=new WeakMap,s=new WeakSet,a=function(){this.messagingSystem.registerActionHandler(n.SelectedNetworkControllerActionTypes.getNetworkClientIdForDomain,this.getNetworkClientIdForDomain.bind(this)),this.messagingSystem.registerActionHandler(n.SelectedNetworkControllerActionTypes.setNetworkClientIdForDomain,this.setNetworkClientIdForDomain.bind(this))},o=function(e,t){const n=this.messagingSystem.call("NetworkController:getNetworkClientById",t);this.update((n=>{n.domains[e]=t}));const s=this.getProviderAndBlockTracker(e);s.provider.setTarget(n.provider),s.blockTracker.setTarget(n.blockTracker)},c=function(e){const t=this.messagingSystem.call("NetworkController:getSelectedNetworkClient"),n=h(this,r,"f").get(e);n&&t?(n.provider.setTarget(t.provider),n.blockTracker.setTarget(t.blockTracker)):n&&h(this,r,"f").delete(e),this.update((t=>{delete t.domains[e]}))},l=function(e){return this.messagingSystem.call("PermissionController:hasPermissions",e)},u=function(){h(this,r,"f").forEach(((e,t)=>{const{selectedNetworkClientId:n}=this.messagingSystem.call("NetworkController:getState");h(this,s,"m",l).call(this,t)&&h(this,s,"m",o).call(this,t,n)}))}}}},{package:"@metamask/selected-network-controller",file:"node_modules/@metamask/selected-network-controller/dist/SelectedNetworkController.cjs"}],[2499,{"./SelectedNetworkController.cjs":2498},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectedNetworkMiddleware=void 0;const s=e("./SelectedNetworkController.cjs");n.createSelectedNetworkMiddleware=e=>(t,n,r)=>{if(!t.origin)throw new Error("Request object is lacking an 'origin'");var i;return t.networkClientId=(i=t.origin,e.call(s.SelectedNetworkControllerActionTypes.getNetworkClientIdForDomain,i)),r()}}}},{package:"@metamask/selected-network-controller",file:"node_modules/@metamask/selected-network-controller/dist/SelectedNetworkMiddleware.cjs"}],[25,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getExecutionServiceMessenger=function(e){return e.getRestricted({name:"ExecutionService",allowedEvents:[],allowedActions:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/execution-service-messenger.ts"}],[250,{"../../../shared/constants/network":5658,"bignumber.js":3902,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s,r=e("lodash"),i=(s=e("bignumber.js"))&&s.__esModule?s:{default:s},a=e("../../../shared/constants/network");const o=e=>new i.default(e||"0x0",16).gt(0);n.default={version:67,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=67;const n=function(e){var t,n,s;const r=(null==e?void 0:e.PreferencesController)||{},i=r.preferences||{};if(i.showTestNetworks)return e;const c=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},l=(null===(n=e.NetworkController)||void 0===n?void 0:n.provider)||{},u=(null===(s=e.CachedBalancesController)||void 0===s?void 0:s.cachedBalances)||{},d=a.TEST_CHAINS.includes(null==l?void 0:l.chainId),h=Object.values(c).some((({chainId:e})=>a.TEST_CHAINS.includes(e))),f=a.TEST_CHAINS.some((e=>Object.values(u[e]||{}).some(o))),p=d||h||f,m={...e,PreferencesController:{...r,preferences:{...i,showTestNetworks:p}}};return m}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/067.js"}],[2500,{"./SelectedNetworkController.cjs":2498,"./SelectedNetworkMiddleware.cjs":2499},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectedNetworkMiddleware=n.METAMASK_DOMAIN=n.SelectedNetworkController=n.SelectedNetworkControllerEventTypes=n.SelectedNetworkControllerActionTypes=void 0;var s=e("./SelectedNetworkController.cjs");Object.defineProperty(n,"SelectedNetworkControllerActionTypes",{enumerable:!0,get:function(){return s.SelectedNetworkControllerActionTypes}}),Object.defineProperty(n,"SelectedNetworkControllerEventTypes",{enumerable:!0,get:function(){return s.SelectedNetworkControllerEventTypes}}),Object.defineProperty(n,"SelectedNetworkController",{enumerable:!0,get:function(){return s.SelectedNetworkController}}),Object.defineProperty(n,"METAMASK_DOMAIN",{enumerable:!0,get:function(){return s.METAMASK_DOMAIN}});var r=e("./SelectedNetworkMiddleware.cjs");Object.defineProperty(n,"createSelectedNetworkMiddleware",{enumerable:!0,get:function(){return r.createSelectedNetworkMiddleware}})}}},{package:"@metamask/selected-network-controller",file:"node_modules/@metamask/selected-network-controller/dist/index.cjs"}],[2501,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseControllerV1=n.isBaseControllerV1=void 0,n.isBaseControllerV1=function(e){return"name"in e&&"string"==typeof e.name&&"config"in e&&"object"==typeof e.config&&"defaultConfig"in e&&"object"==typeof e.defaultConfig&&"state"in e&&"object"==typeof e.state&&"defaultState"in e&&"object"==typeof e.defaultState&&"disabled"in e&&"boolean"==typeof e.disabled&&"subscribe"in e&&"function"==typeof e.subscribe};class s{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,n=!0){if(n){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];t!==undefined&&(this[e]=t)}}else for(const t of Object.keys(e))if(this.internalConfig[t]!==undefined){const n=e[t];this.internalConfig[t]=n,this[t]=n}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}n.BaseControllerV1=s,n.default=s}}},{package:"@metamask/selected-network-controller>@metamask/base-controller",file:"node_modules/@metamask/selected-network-controller/node_modules/@metamask/base-controller/dist/BaseControllerV1.cjs"}],[2502,{immer:4573},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseController=n.isBaseController=void 0;const a=e("immer");(0,a.enablePatches)(),n.isBaseController=function(e){return"name"in e&&"string"==typeof e.name&&"state"in e&&"object"==typeof e.state&&"metadata"in e&&"object"==typeof e.metadata};function o(e,t,n){return Object.keys(e).reduce(((s,r)=>{try{const i=t[r];if(!i)throw new Error(`No metadata found for '${String(r)}'`);const a=i[n],o=e[r];return"function"==typeof a?s[r]=a(o):a&&(s[r]=o),s}catch(e){return setTimeout((()=>{throw e})),s}}),{})}n.BaseController=class{constructor({messenger:e,metadata:t,name:n,state:i}){s.set(this,void 0),this.messagingSystem=e,this.name=n,r(this,s,(0,a.freeze)(i,!0),"f"),this.metadata=t,this.messagingSystem.registerActionHandler(`${n}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${n}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return i(this,s,"f")}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,n,o]=a.produceWithPatches(i(this,s,"f"),e);return r(this,s,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,n),{nextState:t,patches:n,inversePatches:o}}applyPatches(e){const t=(0,a.applyPatches)(i(this,s,"f"),e);r(this,s,t,"f"),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},s=new WeakMap,n.getAnonymizedState=function(e,t){return o(e,t,"anonymous")},n.getPersistentState=function(e,t){return o(e,t,"persist")}}}},{package:"@metamask/selected-network-controller>@metamask/base-controller",file:"node_modules/@metamask/selected-network-controller/node_modules/@metamask/base-controller/dist/BaseControllerV2.cjs"}],[2503,{"./RestrictedMessenger.cjs":2504},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ControllerMessenger=n.Messenger=void 0;const c=e("./RestrictedMessenger.cjs");class l{constructor(){s.set(this,new Map),r.set(this,new Map),i.set(this,new Map),a.set(this,new Map)}registerActionHandler(e,t){if(o(this,s,"f").has(e))throw new Error(`A handler for ${e} has already been registered`);o(this,s,"f").set(e,t)}unregisterActionHandler(e){o(this,s,"f").delete(e)}clearActions(){o(this,s,"f").clear()}call(e,...t){const n=o(this,s,"f").get(e);if(!n)throw new Error(`A handler for ${e} has not been registered`);return n(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){o(this,i,"f").set(e,t)}publish(e,...t){const n=o(this,r,"f").get(e);if(n)for(const[e,s]of n.entries())try{if(s){const n=o(this,a,"f").get(e),r=s(...t);r!==n&&(o(this,a,"f").set(e,r),e(r,n))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,n){let s=o(this,r,"f").get(e);if(s||(s=new Map,o(this,r,"f").set(e,s)),s.set(t,n),n){const s=o(this,i,"f").get(e);if(s){const e=n(...s());o(this,a,"f").set(t,e)}}}unsubscribe(e,t){const n=o(this,r,"f").get(e);if(!n||!n.has(t))throw new Error(`Subscription not found for event: ${e}`);n.get(t)&&o(this,a,"f").delete(t),n.delete(t)}clearEventSubscriptions(e){o(this,r,"f").delete(e)}clearSubscriptions(){o(this,r,"f").clear()}getRestricted({name:e,allowedActions:t,allowedEvents:n}){return new c.RestrictedMessenger({messenger:this,name:e,allowedActions:t,allowedEvents:n})}}n.Messenger=l,n.ControllerMessenger=l,s=new WeakMap,r=new WeakMap,i=new WeakMap,a=new WeakMap}}},{package:"@metamask/selected-network-controller>@metamask/base-controller",file:"node_modules/@metamask/selected-network-controller/node_modules/@metamask/base-controller/dist/Messenger.cjs"}],[2504,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},h=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.RestrictedControllerMessenger=n.RestrictedMessenger=void 0;class f{constructor({controllerMessenger:e,messenger:t,name:n,allowedActions:c,allowedEvents:l}){if(s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),t&&e)throw new Error("Both messenger properties provided. Provide message using only 'messenger' option, 'controllerMessenger' is deprecated");if(!t&&!e)throw new Error("Messenger not provided");d(this,r,t??e,"f"),d(this,i,n,"f"),d(this,a,c,"f"),d(this,o,l,"f")}registerActionHandler(e,t){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").registerActionHandler(e,t)}unregisterActionHandler(e){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").unregisterActionHandler(e)}call(e,...t){if(!h(this,s,"m",l).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return h(this,r,"f").call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").publish(e,...t)}subscribe(e,t,n){if(!h(this,s,"m",c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return n?h(this,r,"f").subscribe(e,t,n):h(this,r,"f").subscribe(e,t)}unsubscribe(e,t){if(!h(this,s,"m",c).call(this,e))throw new Error(`Event missing from allow list: ${e}`);h(this,r,"f").unsubscribe(e,t)}clearEventSubscriptions(e){if(!h(this,s,"m",u).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${h(this,i,"f")}:'`);h(this,r,"f").clearEventSubscriptions(e)}}n.RestrictedMessenger=f,n.RestrictedControllerMessenger=f,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakSet,c=function(e){const t=h(this,o,"f");return h(this,s,"m",u).call(this,e)||null!==t&&t.includes(e)},l=function(e){const t=h(this,a,"f");return h(this,s,"m",u).call(this,e)||null!==t&&t.includes(e)},u=function(e){return e.startsWith(`${h(this,i,"f")}:`)}}}},{package:"@metamask/selected-network-controller>@metamask/base-controller",file:"node_modules/@metamask/selected-network-controller/node_modules/@metamask/base-controller/dist/RestrictedMessenger.cjs"}],[2505,{"./BaseControllerV1.cjs":2501,"./BaseControllerV2.cjs":2502,"./Messenger.cjs":2503,"./RestrictedMessenger.cjs":2504},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RestrictedMessenger=n.RestrictedControllerMessenger=n.Messenger=n.ControllerMessenger=n.isBaseController=n.getPersistentState=n.getAnonymizedState=n.BaseController=n.isBaseControllerV1=n.BaseControllerV1=void 0;var s=e("./BaseControllerV1.cjs");Object.defineProperty(n,"BaseControllerV1",{enumerable:!0,get:function(){return s.BaseControllerV1}}),Object.defineProperty(n,"isBaseControllerV1",{enumerable:!0,get:function(){return s.isBaseControllerV1}});var r=e("./BaseControllerV2.cjs");Object.defineProperty(n,"BaseController",{enumerable:!0,get:function(){return r.BaseController}}),Object.defineProperty(n,"getAnonymizedState",{enumerable:!0,get:function(){return r.getAnonymizedState}}),Object.defineProperty(n,"getPersistentState",{enumerable:!0,get:function(){return r.getPersistentState}}),Object.defineProperty(n,"isBaseController",{enumerable:!0,get:function(){return r.isBaseController}});var i=e("./Messenger.cjs");Object.defineProperty(n,"ControllerMessenger",{enumerable:!0,get:function(){return i.ControllerMessenger}}),Object.defineProperty(n,"Messenger",{enumerable:!0,get:function(){return i.Messenger}});var a=e("./RestrictedMessenger.cjs");Object.defineProperty(n,"RestrictedControllerMessenger",{enumerable:!0,get:function(){return a.RestrictedControllerMessenger}}),Object.defineProperty(n,"RestrictedMessenger",{enumerable:!0,get:function(){return a.RestrictedMessenger}})}}},{package:"@metamask/selected-network-controller>@metamask/base-controller",file:"node_modules/@metamask/selected-network-controller/node_modules/@metamask/base-controller/dist/index.cjs"}],[251,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:68,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=68;const n=function(e){const{PermissionsController:t={},PermissionsMetadata:n={},...s}=e,{domainMetadata:a={},permissionsHistory:o={},permissionsLog:c=[]}=n;return{...s,PermissionController:r(t),PermissionLogController:{permissionActivityLog:c,permissionHistory:o},SubjectMetadataController:i(a)}}(t.data);return t.data=n,t}};function r(e){const{domains:t={}}=e;return{subjects:Object.entries(t).reduce(((e,[t,n])=>{const{permissions:[s]}=n,r=s.caveats.find((e=>"exposedAccounts"===e.name)),i={...s,caveats:[{type:"restrictReturnedAccounts",value:r.value}]};return delete i["@context"],e[t]={origin:t,permissions:{eth_accounts:i}},e}),{})}}function i(e){return{subjectMetadata:Object.entries(e).reduce(((e,[t,n])=>{const{name:s=null,icon:r=null,extensionId:i=null,...a}=n;return delete a.lastUpdated,delete a.host,t&&(e[t]={name:s,iconUrl:r,extensionId:i,...a,origin:t}),e}),{})}}}}},{package:"$root$",file:"app/scripts/migrations/068.js"}],[252,{"@metamask/permission-controller":2322,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("@metamask/permission-controller"),r=e("lodash");n.default={version:69,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=69;const n=function(e){var t;if("object"==typeof(null==e||null===(t=e.SubjectMetadataController)||void 0===t?void 0:t.subjectMetadata)){const{SubjectMetadataController:{subjectMetadata:t}}=e;Object.values(t).forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(e.subjectType=e.extensionId?s.SubjectType.Extension:s.SubjectType.Website)}))}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/069.js"}],[253,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:70,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=70;const n=function(e){var t;if(Array.isArray(null==e||null===(t=e.PermissionLogController)||void 0===t?void 0:t.permissionActivityLog)){const{PermissionLogController:{permissionActivityLog:t}}=e;t.forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(delete e.request,delete e.response)}))}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/070.js"}],[254,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:71,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=71;const n=function(e){e.NotificationController&&(e.AnnouncementController={announcements:e.NotificationController.notifications},delete e.NotificationController);return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/071.js"}],[255,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:72,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=72;const n=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/072.js"}],[2555,{"./constants":2556,"./types":2558,"./utils":2559,"@ethersproject/bytes":492,"@metamask/controller-utils":1360,"@metamask/eth-query":1587,"@metamask/polling-controller":2340,"@metamask/transaction-controller":2829,"bignumber.js":2560,"lodash/cloneDeep":4755},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p,m,g,y,w,b,v,S,k,T,_,C,E,P=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},j=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},I=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultSmartTransactionsControllerState=n.DEFAULT_INTERVAL=void 0;const O=e("@ethersproject/bytes"),R=e("@metamask/controller-utils"),A=I(e("@metamask/eth-query")),M=e("@metamask/polling-controller"),x=e("@metamask/transaction-controller"),N=e("bignumber.js"),D=I(e("lodash/cloneDeep")),B=e("./constants"),L=e("./types"),$=e("./utils");n.DEFAULT_INTERVAL=5e3;const H="`ethQuery` is not defined on SmartTransactionsController",F="SmartTransactionsController",q={smartTransactionsState:{persist:!0,anonymous:!0}};function U(){return{smartTransactionsState:{smartTransactions:{},userOptIn:null,userOptInV2:null,fees:{approvalTxFees:null,tradeTxFees:null},liveness:!0,livenessByChainId:{[R.ChainId.mainnet]:!0,[R.ChainId.sepolia]:!0},feesByChainId:{[R.ChainId.mainnet]:{approvalTxFees:null,tradeTxFees:null},[R.ChainId.sepolia]:{approvalTxFees:null,tradeTxFees:null}}}}}n.getDefaultSmartTransactionsControllerState=U;class W extends((0,M.StaticIntervalPollingController)()){constructor({interval:e=n.DEFAULT_INTERVAL,clientId:t,chainId:g=R.ChainId.mainnet,supportedChainIds:y=[R.ChainId.mainnet,R.ChainId.sepolia],getNonceLock:w,confirmExternalTransaction:b,trackMetaMetricsEvent:v,state:S={},messenger:k,getTransactions:T,getMetaMetricsProps:_,getFeatureFlags:C,updateTransaction:E}){super({name:F,metadata:q,messenger:k,state:Object.assign(Object.assign({},U()),S)}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,void 0),h.set(this,void 0),f.set(this,void 0),p.set(this,void 0),m.set(this,void 0),P(this,r,e,"f"),P(this,i,t,"f"),P(this,a,g,"f"),P(this,o,y,"f"),this.setIntervalLength(e),P(this,c,w,"f"),P(this,l,undefined,"f"),P(this,u,b,"f"),P(this,d,T,"f"),P(this,h,v,"f"),P(this,f,_,"f"),P(this,p,C,"f"),P(this,m,E,"f"),this.initializeSmartTransactionsForChainId(),this.messagingSystem.subscribe("NetworkController:stateChange",(({selectedNetworkClientId:e})=>{const{configuration:{chainId:t},provider:n}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);P(this,a,t,"f"),P(this,l,new A.default(n),"f"),this.initializeSmartTransactionsForChainId(),this.checkPoll(this.state)})),this.messagingSystem.subscribe(`${F}:stateChange`,(e=>this.checkPoll(e)))}async _executePoll({networkClientId:e}){const t=j(this,s,"m",T).call(this,{networkClientId:e});return j(this,o,"f").includes(t)?this.updateSmartTransactions({networkClientId:e}):Promise.resolve()}checkPoll({smartTransactionsState:{smartTransactions:e}}){const t=e[j(this,a,"f")],n=null==t?void 0:t.filter($.isSmartTransactionPending);!this.timeoutHandle&&(null==n?void 0:n.length)>0?this.poll():this.timeoutHandle&&0===(null==n?void 0:n.length)&&this.stop()}initializeSmartTransactionsForChainId(){j(this,o,"f").includes(j(this,a,"f"))&&this.update((e=>{var t;e.smartTransactionsState.smartTransactions[j(this,a,"f")]=null!==(t=e.smartTransactionsState.smartTransactions[j(this,a,"f")])&&void 0!==t?t:[]}))}async poll(e){e&&P(this,r,e,"f"),this.timeoutHandle&&clearInterval(this.timeoutHandle),j(this,o,"f").includes(j(this,a,"f"))&&(this.timeoutHandle=setInterval((()=>{(0,R.safelyExecute)((async()=>this.updateSmartTransactions()))}),j(this,r,"f")),await(0,R.safelyExecute)((async()=>this.updateSmartTransactions())))}async stop(){this.timeoutHandle&&clearInterval(this.timeoutHandle),this.timeoutHandle=undefined}setOptInState(e){this.update((t=>{t.smartTransactionsState.userOptInV2=e}))}trackStxStatusChange(e,t){let n=(0,D.default)(e);n=Object.assign(Object.assign({},(0,D.default)(t)),n),n.status!==(null==t?void 0:t.status)&&j(this,h,"f").call(this,{event:B.MetaMetricsEventName.StxStatusUpdated,category:B.MetaMetricsEventCategory.Transactions,properties:(0,$.getSmartTransactionMetricsProperties)(n),sensitiveProperties:(0,$.getSmartTransactionMetricsSensitiveProperties)(n)})}isNewSmartTransaction(e){const{smartTransactionsState:{smartTransactions:t}}=this.state,n=t[j(this,a,"f")],s=null==n?void 0:n.findIndex((t=>t.uuid===e));return-1===s||s===undefined}updateSmartTransaction(e,{networkClientId:t}={}){let n=j(this,l,"f"),r=j(this,a,"f");if(t){const{configuration:e,provider:s}=this.messagingSystem.call("NetworkController:getNetworkClientById",t);r=e.chainId,n=new A.default(s)}j(this,s,"m",b).call(this,e,{chainId:r,ethQuery:n})}async updateSmartTransactions({networkClientId:e}={}){const{smartTransactionsState:{smartTransactions:t}}=this.state,n=t[j(this,s,"m",T).call(this,{networkClientId:e})].filter($.isSmartTransactionPending).map((e=>e.uuid));n.length>0&&this.fetchSmartTransactionsStatus(n,{networkClientId:e})}async fetchSmartTransactionsStatus(e,{networkClientId:t}={}){const n=new URLSearchParams({uuids:e.join(",")}),r=j(this,s,"m",T).call(this,{networkClientId:t}),i=j(this,s,"m",_).call(this,{networkClientId:t}),a=`${(0,$.getAPIRequestURL)(L.APIType.BATCH_STATUS,r)}?${n.toString()}`,o=await j(this,s,"m",g).call(this,a);for(const[e,n]of Object.entries(o)){const a={statusMetadata:n,status:(0,$.calculateStatus)(n),cancellable:(0,$.isSmartTransactionCancellable)(n),uuid:e,networkClientId:t};await j(this,s,"m",b).call(this,a,{chainId:r,ethQuery:i})}return o}clearFees(){const e={approvalTxFees:null,tradeTxFees:null};return this.update((t=>{t.smartTransactionsState.fees=e})),e}async getFees(e,t,{networkClientId:n}={}){const r=null!=n?n:this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId,i=j(this,s,"m",T).call(this,{networkClientId:r}),o=[];let c;if(t){const n=await j(this,s,"m",k).call(this,t,r);o.push(n),c=Object.assign(Object.assign({},e),{nonce:(0,$.incrementNonceInHex)(n.nonce)})}else c=e.nonce?e:await j(this,s,"m",k).call(this,e,r);o.push(c);const l=await j(this,s,"m",g).call(this,(0,$.getAPIRequestURL)(L.APIType.GET_FEES,i),{method:"POST",body:JSON.stringify({txs:o})});let u,d;return t?(u=null==l?void 0:l.txs[0],d=null==l?void 0:l.txs[1]):(u=null,d=null==l?void 0:l.txs[0]),this.update((e=>{i===j(this,a,"f")&&(e.smartTransactionsState.fees={approvalTxFees:u,tradeTxFees:d}),e.smartTransactionsState.feesByChainId[i]={approvalTxFees:u,tradeTxFees:d}})),{approvalTxFees:u,tradeTxFees:d}}async submitSignedTransactions({transactionMeta:e,txParams:t,signedTransactions:n,signedCanceledTransactions:r,networkClientId:i}){var a,o;const l=null!=i?i:this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId,u=j(this,s,"m",T).call(this,{networkClientId:l}),d=j(this,s,"m",_).call(this,{networkClientId:l}),h=await j(this,s,"m",g).call(this,(0,$.getAPIRequestURL)(L.APIType.SUBMIT_TRANSACTIONS,u),{method:"POST",body:JSON.stringify({rawTxs:n,rawCancelTxs:r})}),f=Date.now();let p;try{const e=await(0,R.query)(d,"getBalance",[null==t?void 0:t.from]);p=new N.BigNumber(e).toString(16)}catch(e){console.error("provider error",e)}let m,y,w={};t&&!t.nonce&&(y=await j(this,c,"f").call(this,t.from,l),m=(0,O.hexlify)(y.nextNonce),w=y.nonceDetails,null!==(a=t.nonce)&&void 0!==a||(t.nonce=m));const v=Object.assign(Object.assign({},h),{txHash:(0,$.getTxHash)(n[0])});try{await j(this,s,"m",b).call(this,{chainId:u,nonceDetails:w,preTxBalance:p,status:L.SmartTransactionStatuses.PENDING,time:f,txParams:t,uuid:v.uuid,txHash:v.txHash,cancellable:!0,type:null!==(o=null==e?void 0:e.type)&&void 0!==o?o:"swap",transactionId:null==e?void 0:e.id,networkClientId:l},{chainId:u,ethQuery:d})}finally{null==y||y.releaseLock()}return v}async cancelSmartTransaction(e,{networkClientId:t}={}){const n=j(this,s,"m",T).call(this,{networkClientId:t});await j(this,s,"m",g).call(this,(0,$.getAPIRequestURL)(L.APIType.CANCEL,n),{method:"POST",body:JSON.stringify({uuid:e})})}async fetchLiveness({networkClientId:e}={}){const t=j(this,s,"m",T).call(this,{networkClientId:e});let n=!1;try{const e=await j(this,s,"m",g).call(this,(0,$.getAPIRequestURL)(L.APIType.LIVENESS,t));n=Boolean(e.smartTransactions)}catch(e){console.log('"fetchLiveness" API call failed')}return this.update((e=>{t===j(this,a,"f")&&(e.smartTransactionsState.liveness=n),e.smartTransactionsState.livenessByChainId[t]=n})),n}async setStatusRefreshInterval(e){e!==j(this,r,"f")&&P(this,r,e,"f")}getTransactions({addressFrom:e,status:t}){return j(this,s,"m",C).call(this).filter((n=>{var s;return n.status===t&&(null===(s=n.txParams)||void 0===s?void 0:s.from)===e}))}getSmartTransactionByMinedTxHash(e){if(!e)return undefined;return j(this,s,"m",C).call(this).find((t=>{var n,s;return(null===(s=null===(n=t.statusMetadata)||void 0===n?void 0:n.minedHash)||void 0===s?void 0:s.toLowerCase())===e.toLowerCase()}))}wipeSmartTransactions({address:e,ignoreNetwork:t}){if(!e)return;const n=e.toLowerCase();if(t){const{smartTransactionsState:{smartTransactions:e}}=this.state;Object.keys(e).forEach((e=>{j(this,s,"m",E).call(this,{chainId:e,addressLowerCase:n})}))}else j(this,s,"m",E).call(this,{chainId:j(this,a,"f"),addressLowerCase:n})}}n.default=W,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,s=new WeakSet,g=async function(e,t){const n=Object.assign(Object.assign({},t),{headers:Object.assign({"Content-Type":"application/json"},j(this,i,"f")&&{"X-Client-Id":j(this,i,"f")})});return(0,$.handleFetch)(e,n)},y=function(e,{chainId:t=j(this,a,"f")}){var n;const{smartTransactionsState:{smartTransactions:s}}=this.state,r=null!==(n=s[t])&&void 0!==n?n:[],i=null==r?void 0:r.findIndex((t=>t.uuid===e.uuid));-1!==i&&(0,R.isSafeDynamicKey)(t)&&this.update((n=>{n.smartTransactionsState.smartTransactions[t][i]=Object.assign(Object.assign({},n.smartTransactionsState.smartTransactions[t][i]),e)}))},w=async function(e){const t=await j(this,f,"f").call(this);e.accountHardwareType=null==t?void 0:t.accountHardwareType,e.accountType=null==t?void 0:t.accountType,e.deviceModel=null==t?void 0:t.deviceModel},b=async function(e,{chainId:t=j(this,a,"f"),ethQuery:n=j(this,l,"f")}){var r;const{smartTransactionsState:{smartTransactions:o}}=this.state,c=null!==(r=o[t])&&void 0!==r?r:[],u=null==c?void 0:c.findIndex((t=>t.uuid===e.uuid)),h=this.isNewSmartTransaction(e.uuid);if(j(this,l,"f")===undefined)throw new Error(H);if(h&&await j(this,s,"m",w).call(this,e),this.trackStxStatusChange(e,h?undefined:c[u]),h){const t=null==c?void 0:c.findIndex((t=>{var n,s,r;return(null===(n=t.txParams)||void 0===n?void 0:n.nonce)===(null===(s=e.txParams)||void 0===s?void 0:s.nonce)&&(null===(r=t.status)||void 0===r?void 0:r.startsWith("cancelled"))})),n=[(0,D.default)(e)],s=Object.assign(Object.assign({},e),{history:n}),r=t>-1?c.slice(0,t).concat(c.slice(t+1)).concat(s):c.concat(s);return void this.update((e=>{e.smartTransactionsState.smartTransactions[j(this,a,"f")]=r}))}const f=c[u],g=Object.assign(Object.assign({},f),e);this.messagingSystem.publish("SmartTransactionsController:smartTransaction",g),(0,$.shouldMarkRegularTransactionAsFailed)({smartTransaction:g,clientId:j(this,i,"f"),getFeatureFlags:j(this,p,"f")})&&(0,$.markRegularTransactionAsFailed)({smartTransaction:g,getRegularTransactions:j(this,d,"f"),updateTransaction:j(this,m,"f")}),e.status!==L.SmartTransactionStatuses.SUCCESS&&e.status!==L.SmartTransactionStatuses.REVERTED||e.confirmed?j(this,s,"m",y).call(this,e,{chainId:t}):await j(this,s,"m",S).call(this,g,{chainId:t,ethQuery:n})},v=function(e){if(!e)return!0;const t=j(this,d,"f").call(this),n=null==t?void 0:t.find((t=>{var n;return(null===(n=t.hash)||void 0===n?void 0:n.toLowerCase())===e.toLowerCase()}));return!n||![x.TransactionStatus.confirmed,x.TransactionStatus.submitted].includes(n.status)},S=async function(e,{chainId:t=j(this,a,"f"),ethQuery:n=j(this,l,"f")}){var r;if(n===undefined)throw new Error(H);const i=null===(r=e.statusMetadata)||void 0===r?void 0:r.minedHash;try{const r=await(0,R.query)(n,"getTransactionReceipt",[i]),a=await(0,R.query)(n,"getTransactionByHash",[i]),o=null==a?void 0:a.maxFeePerGas,c=null==a?void 0:a.maxPriorityFeePerGas;if(null==r?void 0:r.blockNumber){const a=await(0,R.query)(n,"getBlockByNumber",[null==r?void 0:r.blockNumber,!1]),l=null==a?void 0:a.baseFeePerGas,d=Object.assign(Object.assign({},e.txParams),{maxFeePerGas:o,maxPriorityFeePerGas:c}),f=Object.assign(Object.assign({},e),{id:e.uuid,status:x.TransactionStatus.confirmed,hash:i,txParams:d}),p=(0,$.snapshotFromTxMeta)(f),m=(0,$.replayHistory)(f.history),g=(0,$.generateHistoryEntry)(m,p,"txStateManager: setting status to confirmed"),w=g.length>0?Object.assign(Object.assign({},f),{history:f.history.concat(g)}):f;j(this,s,"m",v).call(this,i)&&j(this,u,"f").call(this,w,r,l),j(this,h,"f").call(this,{event:B.MetaMetricsEventName.StxConfirmed,category:B.MetaMetricsEventCategory.Transactions,properties:(0,$.getSmartTransactionMetricsProperties)(e),sensitiveProperties:(0,$.getSmartTransactionMetricsSensitiveProperties)(e)}),j(this,s,"m",y).call(this,Object.assign(Object.assign({},e),{confirmed:!0}),{chainId:t})}}catch(e){j(this,h,"f").call(this,{event:B.MetaMetricsEventName.StxConfirmationFailed,category:B.MetaMetricsEventCategory.Transactions}),console.error("confirm error",e)}finally{this.messagingSystem.publish("SmartTransactionsController:smartTransactionConfirmationDone",e)}},k=async function(e,t){const n=await j(this,c,"f").call(this,e.from,t),s=n.nextNonce;return n.releaseLock(),Object.assign(Object.assign({},e),{nonce:`0x${s.toString(16)}`})},T=function({networkClientId:e}={}){return e?this.messagingSystem.call("NetworkController:getNetworkClientById",e).configuration.chainId:j(this,a,"f")},_=function({networkClientId:e}={}){if(e){const{provider:t}=this.messagingSystem.call("NetworkController:getNetworkClientById",e);return new A.default(t)}if(j(this,l,"f")===undefined)throw new Error(H);return j(this,l,"f")},C=function(){const{smartTransactionsState:{smartTransactions:e}}=this.state,t=null==e?void 0:e[j(this,a,"f")];return t&&0!==t.length?t:[]},E=function({chainId:e,addressLowerCase:t}){const{smartTransactionsState:{smartTransactions:n}}=this.state,s=null==n?void 0:n[e];if(!s||0===s.length)return;const r=s.filter((e=>{var n;return(null===(n=e.txParams)||void 0===n?void 0:n.from)!==t}));this.update((t=>{t.smartTransactionsState.smartTransactions[e]=r}))}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/SmartTransactionsController.js"}],[2556,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MetaMetricsEventCategory=n.MetaMetricsEventName=n.SENTINEL_API_BASE_URL_MAP=n.API_BASE_URL=void 0,n.API_BASE_URL="https://transaction.api.cx.metamask.io",n.SENTINEL_API_BASE_URL_MAP={1:"https://tx-sentinel-ethereum-mainnet.api.cx.metamask.io",56:"https://tx-sentinel-bsc-mainnet.api.cx.metamask.io",8453:"https://tx-sentinel-base-mainnet.api.cx.metamask.io",11155111:"https://tx-sentinel-ethereum-sepolia.api.cx.metamask.io"},function(e){e.StxStatusUpdated="STX Status Updated",e.StxConfirmed="STX Confirmed",e.StxConfirmationFailed="STX Confirmation Failed",e.ReceiveRequest="Receive Request"}(n.MetaMetricsEventName||(n.MetaMetricsEventName={})),function(e){e.Transactions="Transactions",e.Navigation="Navigation"}(n.MetaMetricsEventCategory||(n.MetaMetricsEventCategory={}))}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/constants.js"}],[2557,{"./SmartTransactionsController":2555},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("./SmartTransactionsController");Object.defineProperty(n,"default",{enumerable:!0,get:function(){return s(r).default}})}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/index.js"}],[2559,{"../package.json":2561,"./constants":2556,"./types":2558,"@ethereumjs/tx":434,"@ethereumjs/util":449,"@ethersproject/bytes":492,"@metamask/transaction-controller":2829,"bignumber.js":2560,buffer:3998,"fast-json-patch":4357,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.markRegularTransactionAsFailed=n.shouldMarkRegularTransactionAsFailed=n.getReturnTxHashAsap=n.getSmartTransactionMetricsSensitiveProperties=n.getSmartTransactionMetricsProperties=n.getTxHash=n.incrementNonceInHex=n.isSmartTransactionCancellable=n.handleFetch=n.mapKeysToCamel=n.getStxProcessingTime=n.snapshotFromTxMeta=n.replayHistory=n.generateHistoryEntry=n.calculateStatus=n.getAPIRequestURL=n.isSmartTransactionStatusResolved=n.isSmartTransactionPending=void 0;const r=e("@ethereumjs/tx"),i=e("@ethereumjs/util"),a=e("@ethersproject/bytes"),o=e("@metamask/transaction-controller"),c=e("bignumber.js"),l=s(e("fast-json-patch")),u=s(e("lodash")),d=s(e("../package.json")),h=e("./constants"),f=e("./types");n.isSmartTransactionPending=function(e){return e.status===f.SmartTransactionStatuses.PENDING};n.isSmartTransactionStatusResolved=e=>"uuid_not_found"===e,n.getAPIRequestURL=function(e,t){const n=parseInt(t,16);switch(e){case f.APIType.GET_FEES:return`${h.API_BASE_URL}/networks/${n}/getFees`;case f.APIType.ESTIMATE_GAS:return`${h.API_BASE_URL}/networks/${n}/estimateGas`;case f.APIType.SUBMIT_TRANSACTIONS:return`${h.API_BASE_URL}/networks/${n}/submitTransactions?stxControllerVersion=${d.default.version}`;case f.APIType.CANCEL:return`${h.API_BASE_URL}/networks/${n}/cancel`;case f.APIType.BATCH_STATUS:return`${h.API_BASE_URL}/networks/${n}/batchStatus`;case f.APIType.LIVENESS:return`${h.SENTINEL_API_BASE_URL_MAP[n]}/network`;default:throw new Error("Invalid APIType")}};n.calculateStatus=e=>{if((0,n.isSmartTransactionStatusResolved)(e))return f.SmartTransactionStatuses.RESOLVED;const t=[f.SmartTransactionCancellationReason.WOULD_REVERT,f.SmartTransactionCancellationReason.TOO_CHEAP,f.SmartTransactionCancellationReason.DEADLINE_MISSED,f.SmartTransactionCancellationReason.INVALID_NONCE,f.SmartTransactionCancellationReason.USER_CANCELLED];if((null==e?void 0:e.minedTx)===f.SmartTransactionMinedTx.NOT_MINED){if(e.cancellationReason===f.SmartTransactionCancellationReason.NOT_CANCELLED)return f.SmartTransactionStatuses.PENDING;const n=t.findIndex((t=>t===e.cancellationReason))>-1;if(e.cancellationReason&&n)return e.isSettled?f.cancellationReasonToStatusMap[e.cancellationReason]:f.SmartTransactionStatuses.PENDING}else{if((null==e?void 0:e.minedTx)===f.SmartTransactionMinedTx.SUCCESS)return f.SmartTransactionStatuses.SUCCESS;if((null==e?void 0:e.minedTx)===f.SmartTransactionMinedTx.CANCELLED)return f.SmartTransactionStatuses.CANCELLED;if((null==e?void 0:e.minedTx)===f.SmartTransactionMinedTx.REVERTED)return f.SmartTransactionStatuses.REVERTED;if((null==e?void 0:e.minedTx)===f.SmartTransactionMinedTx.UNKNOWN)return f.SmartTransactionStatuses.UNKNOWN}return f.SmartTransactionStatuses.UNKNOWN},n.generateHistoryEntry=function(e,t,n){const s=l.default.compare(e,t);return s[0]&&(n&&(s[0].note=n),s[0].timestamp=Date.now()),s},n.replayHistory=function(e){return u.default.cloneDeep(e).reduce(((e,t)=>l.default.applyPatch(e,t).newDocument))},n.snapshotFromTxMeta=function(e){const t=Object.assign({},e);return delete t.history,u.default.cloneDeep(t)};n.getStxProcessingTime=e=>e?Math.round((Date.now()-e)/1e3):undefined;n.mapKeysToCamel=e=>{if(!u.default.isObject(e))return e;const t=u.default.mapValues(e,(e=>u.default.isArray(e)?e.map(n.mapKeysToCamel):u.default.isObject(e)?(0,n.mapKeysToCamel)(e):e));return u.default.mapKeys(t,((e,t)=>u.default.camelCase(t)))},n.handleFetch=async function(e,t){const s=await fetch(e,t),r=await s.json();if(!s.ok)throw console.log("response",s),new Error(`Fetch error:${JSON.stringify(Object.assign({status:s.status},(0,n.mapKeysToCamel)(r)))}`);return r};n.isSmartTransactionCancellable=e=>e.minedTx===f.SmartTransactionMinedTx.NOT_MINED&&(!e.cancellationReason||e.cancellationReason===f.SmartTransactionCancellationReason.NOT_CANCELLED);n.incrementNonceInHex=e=>{const t=new c.BigNumber(e,16).toString(10);return(0,a.hexlify)(Number(t)+1)};n.getTxHash=e=>{if(!e)return"";const n=r.TransactionFactory.fromSerializedData(t.from(e.slice(2),"hex")).hash();return(0,i.bytesToHex)(n)};n.getSmartTransactionMetricsProperties=e=>{if(!e)return{};const t=e.statusMetadata;return{stx_status:e.status,type:e.type,processing_time:(0,n.getStxProcessingTime)(e.time),is_smart_transaction:!0,stx_enabled:!0,current_stx_enabled:!0,stx_user_opt_in:!0,stx_duplicated:null==t?void 0:t.duplicated,stx_timed_out:null==t?void 0:t.timedOut,stx_proxied:null==t?void 0:t.proxied}};n.getSmartTransactionMetricsSensitiveProperties=e=>e?{token_from_symbol:e.sourceTokenSymbol,token_to_symbol:e.destinationTokenSymbol,account_hardware_type:e.accountHardwareType,account_type:e.accountType,device_model:e.deviceModel}:{};n.getReturnTxHashAsap=(e,t)=>e===f.ClientId.Extension?null==t?void 0:t.extensionReturnTxHashAsap:null==t?void 0:t.mobileReturnTxHashAsap;n.shouldMarkRegularTransactionAsFailed=({smartTransaction:e,clientId:t,getFeatureFlags:s})=>{var r;const{status:i,transactionId:a}=e,o=[f.SmartTransactionStatuses.CANCELLED,f.SmartTransactionStatuses.CANCELLED_USER_CANCELLED,f.SmartTransactionStatuses.UNKNOWN,f.SmartTransactionStatuses.RESOLVED];if(!i||!o.includes(i))return!1;const{smartTransactions:c}=null!==(r=s())&&void 0!==r?r:{},l=(0,n.getReturnTxHashAsap)(t,c);return Boolean(l&&a)};n.markRegularTransactionAsFailed=({smartTransaction:e,getRegularTransactions:t,updateTransaction:n})=>{const{transactionId:s,status:r}=e,i=t().find((e=>e.id===s));if(!i)throw new Error("Cannot find regular transaction to mark it as failed");if(i.status===o.TransactionStatus.failed)return;n(Object.assign(Object.assign({},i),{status:o.TransactionStatus.failed,error:{name:"SmartTransactionFailed",message:`Smart transaction failed with status: ${r}`}}),`Smart transaction status: ${r}`)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/utils.js"}],[256,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:73,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=73;const n=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/073.js"}],[2560,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){!function(e){var n,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,i=Math.floor,a="[BigNumber Error] ",o=a+"Number primitive has more than 15 significant digits: ",c=1e14,l=14,u=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,f=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,n,s=1,r=e.length,i=e[0]+"";s<r;){for(t=e[s++]+"",n=l-t.length;n--;t="0"+t);i+=t}for(r=i.length;48===i.charCodeAt(--r););return i.slice(0,r+1||1)}function g(e,t){var n,s,r=e.c,i=t.c,a=e.s,o=t.s,c=e.e,l=t.e;if(!a||!o)return null;if(n=r&&!r[0],s=i&&!i[0],n||s)return n?s?0:-o:a;if(a!=o)return a;if(n=a<0,s=c==l,!r||!i)return s?0:!r^n?1:-1;if(!s)return c>l^n?1:-1;for(o=(c=r.length)<(l=i.length)?c:l,a=0;a<o;a++)if(r[a]!=i[a])return r[a]>i[a]^n?1:-1;return c==l?0:c>l^n?1:-1}function y(e,t,n,s){if(e<t||e>n||e!==i(e))throw Error(a+(s||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function w(e){var t=e.c.length-1;return p(e.e/l)==t&&e.c[t]%2!=0}function b(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,n){var s,r;if(t<0){for(r=n+".";++t;r+=n);e=r+e}else if(++t>(s=e.length)){for(r=n,t-=s;--t;r+=n);e+=r}else t<s&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,S,k,T,_,C,E,P,j,I,O=W.prototype={constructor:W,toString:null,valueOf:null},R=new W(1),A=20,M=4,x=-7,N=21,D=-1e7,B=1e7,L=!1,$=1,H=0,F={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz",U=!0;function W(e,t){var n,r,a,c,d,h,f,p,m=this;if(!(m instanceof W))return new W(e,t);if(null==t){if(e&&!0===e._isBigNumber)return m.s=e.s,void(!e.c||e.e>B?m.c=m.e=null:e.e<D?m.c=[m.e=0]:(m.e=e.e,m.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,d=e;d>=10;d/=10,c++);return void(c>B?m.c=m.e=null:(m.e=c,m.c=[e]))}p=String(e)}else{if(!s.test(p=String(e)))return k(m,p,h);m.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(d=p.search(/e/i))>0?(c<0&&(c=d),c+=+p.slice(d+1),p=p.substring(0,d)):c<0&&(c=p.length)}else{if(y(t,2,q.length,"Base"),10==t&&U)return G(m=new W(e),A+m.e+1,M);if(p=String(e),h="number"==typeof e){if(0*e!=0)return k(m,p,h,t);if(m.s=1/e<0?(p=p.slice(1),-1):1,W.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else m.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=q.slice(0,t),c=d=0,f=p.length;d<f;d++)if(n.indexOf(r=p.charAt(d))<0){if("."==r){if(d>c){c=f;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,d=-1,c=0;continue}return k(m,String(e),h,t)}h=!1,(c=(p=S(p,t,10,m.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(d=0;48===p.charCodeAt(d);d++);for(f=p.length;48===p.charCodeAt(--f););if(p=p.slice(d,++f)){if(f-=d,h&&W.DEBUG&&f>15&&(e>u||e!==i(e)))throw Error(o+m.s*e);if((c=c-d-1)>B)m.c=m.e=null;else if(c<D)m.c=[m.e=0];else{if(m.e=c,m.c=[],d=(c+1)%l,c<0&&(d+=l),d<f){for(d&&m.c.push(+p.slice(0,d)),f-=l;d<f;)m.c.push(+p.slice(d,d+=l));d=l-(p=p.slice(d)).length}else d-=f;for(;d--;p+="0");m.c.push(+p)}}else m.c=[m.e=0]}function K(e,t,n,s){var r,i,a,o,c;if(null==n?n=M:y(n,0,8),!e.c)return e.toString();if(r=e.c[0],a=e.e,null==t)c=m(e.c),c=1==s||2==s&&(a<=x||a>=N)?b(c,a):v(c,a,"0");else if(i=(e=G(new W(e),t,n)).e,o=(c=m(e.c)).length,1==s||2==s&&(t<=i||i<=x)){for(;o<t;c+="0",o++);c=b(c,i)}else if(t-=a,c=v(c,i,"0"),i+1>o){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=i-o)>0)for(i+1==o&&(c+=".");t--;c+="0");return e.s<0&&r?"-"+c:c}function V(e,t){for(var n,s,r=1,i=new W(e[0]);r<e.length;r++)(!(s=new W(e[r])).s||(n=g(i,s))===t||0===n&&i.s===t)&&(i=s);return i}function z(e,t,n){for(var s=1,r=t.length;!t[--r];t.pop());for(r=t[0];r>=10;r/=10,s++);return(n=s+n*l-1)>B?e.c=e.e=null:n<D?e.c=[e.e=0]:(e.e=n,e.c=t),e}function G(e,t,n,s){var a,o,u,h,f,p,m,g=e.c,y=d;if(g){e:{for(a=1,h=g[0];h>=10;h/=10,a++);if((o=t-a)<0)o+=l,u=t,f=g[p=0],m=i(f/y[a-u-1]%10);else if((p=r((o+1)/l))>=g.length){if(!s)break e;for(;g.length<=p;g.push(0));f=m=0,a=1,u=(o%=l)-l+1}else{for(f=h=g[p],a=1;h>=10;h/=10,a++);m=(u=(o%=l)-l+a)<0?0:i(f/y[a-u-1]%10)}if(s=s||t<0||null!=g[p+1]||(u<0?f:f%y[a-u-1]),s=n<4?(m||s)&&(0==n||n==(e.s<0?3:2)):m>5||5==m&&(4==n||s||6==n&&(o>0?u>0?f/y[a-u]:0:g[p-1])%10&1||n==(e.s<0?8:7)),t<1||!g[0])return g.length=0,s?(t-=e.e+1,g[0]=y[(l-t%l)%l],e.e=-t||0):g[0]=e.e=0,e;if(0==o?(g.length=p,h=1,p--):(g.length=p+1,h=y[l-o],g[p]=u>0?i(f/y[a-u]%y[u])*h:0),s)for(;;){if(0==p){for(o=1,u=g[0];u>=10;u/=10,o++);for(u=g[0]+=h,h=1;u>=10;u/=10,h++);o!=h&&(e.e++,g[0]==c&&(g[0]=1));break}if(g[p]+=h,g[p]!=c)break;g[p--]=0,h=1}for(o=g.length;0===g[--o];g.pop());}e.e>B?e.c=e.e=null:e.e<D&&(e.c=[e.e=0])}return e}function J(e){var t,n=e.e;return null===n?e.toString():(t=m(e.c),t=n<=x||n>=N?b(t,n):v(t,n,"0"),e.s<0?"-"+t:t)}return W.clone=e,W.ROUND_UP=0,W.ROUND_DOWN=1,W.ROUND_CEIL=2,W.ROUND_FLOOR=3,W.ROUND_HALF_UP=4,W.ROUND_HALF_DOWN=5,W.ROUND_HALF_EVEN=6,W.ROUND_HALF_CEIL=7,W.ROUND_HALF_FLOOR=8,W.EUCLID=9,W.config=W.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(y(n=e[t],0,f,t),A=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(y(n=e[t],0,8,t),M=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(y(n[0],-f,0,t),y(n[1],0,f,t),x=n[0],N=n[1]):(y(n,-f,f,t),x=-(N=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)y(n[0],-f,-1,t),y(n[1],1,f,t),D=n[0],B=n[1];else{if(y(n,-f,f,t),!n)throw Error(a+t+" cannot be zero: "+n);D=-(B=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(a+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!n,Error(a+"crypto unavailable");L=n}else L=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(y(n=e[t],0,9,t),$=n),e.hasOwnProperty(t="POW_PRECISION")&&(y(n=e[t],0,f,t),H=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(a+t+" not an object: "+n);F=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(a+t+" invalid: "+n);U="0123456789"==n.slice(0,10),q=n}}return{DECIMAL_PLACES:A,ROUNDING_MODE:M,EXPONENTIAL_AT:[x,N],RANGE:[D,B],CRYPTO:L,MODULO_MODE:$,POW_PRECISION:H,FORMAT:F,ALPHABET:q}},W.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!W.DEBUG)return!0;var t,n,s=e.c,r=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(s)){if((1===o||-1===o)&&r>=-f&&r<=f&&r===i(r)){if(0===s[0]){if(0===r&&1===s.length)return!0;break e}if((t=(r+1)%l)<1&&(t+=l),String(s[0]).length==t){for(t=0;t<s.length;t++)if((n=s[t])<0||n>=c||n!==i(n))break e;if(0!==n)return!0}}}else if(null===s&&null===r&&(null===o||1===o||-1===o))return!0;throw Error(a+"Invalid BigNumber: "+e)},W.maximum=W.max=function(){return V(arguments,-1)},W.minimum=W.min=function(){return V(arguments,1)},W.random=(T=9007199254740992,_=Math.random()*T&2097151?function(){return i(Math.random()*T)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,s,o,c,u=0,h=[],p=new W(R);if(null==e?e=A:y(e,0,f),o=r(e/l),L)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));u<o;)(c=131072*t[u]+(t[u+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[u]=n[0],t[u+1]=n[1]):(h.push(c%1e14),u+=2);u=o/2}else{if(!crypto.randomBytes)throw L=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(o*=7);u<o;)(c=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(h.push(c%1e14),u+=7);u=o/7}if(!L)for(;u<o;)(c=_())<9e15&&(h[u++]=c%1e14);for(o=h[--u],e%=l,o&&e&&(c=d[l-e],h[u]=i(o/c)*c);0===h[u];h.pop(),u--);if(u<0)h=[s=0];else{for(s=-1;0===h[0];h.splice(0,1),s-=l);for(u=1,c=h[0];c>=10;c/=10,u++);u<l&&(s-=l-u)}return p.e=s,p.c=h,p}),W.sum=function(){for(var e=1,t=arguments,n=new W(t[0]);e<t.length;)n=n.plus(t[e++]);return n},S=function(){var e="0123456789";function t(e,t,n,s){for(var r,i,a=[0],o=0,c=e.length;o<c;){for(i=a.length;i--;a[i]*=t);for(a[0]+=s.indexOf(e.charAt(o++)),r=0;r<a.length;r++)a[r]>n-1&&(null==a[r+1]&&(a[r+1]=0),a[r+1]+=a[r]/n|0,a[r]%=n)}return a.reverse()}return function(s,r,i,a,o){var c,l,u,d,h,f,p,g,y=s.indexOf("."),w=A,b=M;for(y>=0&&(d=H,H=0,s=s.replace(".",""),f=(g=new W(r)).pow(s.length-y),H=d,g.c=t(v(m(f.c),f.e,"0"),10,i,e),g.e=g.c.length),u=d=(p=t(s,r,i,o?(c=q,e):(c=e,q))).length;0==p[--d];p.pop());if(!p[0])return c.charAt(0);if(y<0?--u:(f.c=p,f.e=u,f.s=a,p=(f=n(f,g,w,b,i)).c,h=f.r,u=f.e),y=p[l=u+w+1],d=i/2,h=h||l<0||null!=p[l+1],h=b<4?(null!=y||h)&&(0==b||b==(f.s<0?3:2)):y>d||y==d&&(4==b||h||6==b&&1&p[l-1]||b==(f.s<0?8:7)),l<1||!p[0])s=h?v(c.charAt(1),-w,c.charAt(0)):c.charAt(0);else{if(p.length=l,h)for(--i;++p[--l]>i;)p[l]=0,l||(++u,p=[1].concat(p));for(d=p.length;!p[--d];);for(y=0,s="";y<=d;s+=c.charAt(p[y++]));s=v(s,u,c.charAt(0))}return s}}(),n=function(){function e(e,t,n){var s,r,i,a,o=0,c=e.length,l=t%h,u=t/h|0;for(e=e.slice();c--;)o=((r=l*(i=e[c]%h)+(s=u*i+(a=e[c]/h|0)*l)%h*h+o)/n|0)+(s/h|0)+u*a,e[c]=r%n;return o&&(e=[o].concat(e)),e}function t(e,t,n,s){var r,i;if(n!=s)i=n>s?1:-1;else for(r=i=0;r<n;r++)if(e[r]!=t[r]){i=e[r]>t[r]?1:-1;break}return i}function n(e,t,n,s){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*s+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(s,r,a,o,u){var d,h,f,m,g,y,w,b,v,S,k,T,_,C,E,P,j,I=s.s==r.s?1:-1,O=s.c,R=r.c;if(!(O&&O[0]&&R&&R[0]))return new W(s.s&&r.s&&(O?!R||O[0]!=R[0]:R)?O&&0==O[0]||!R?0*I:I/0:NaN);for(v=(b=new W(I)).c=[],I=a+(h=s.e-r.e)+1,u||(u=c,h=p(s.e/l)-p(r.e/l),I=I/l|0),f=0;R[f]==(O[f]||0);f++);if(R[f]>(O[f]||0)&&h--,I<0)v.push(1),m=!0;else{for(C=O.length,P=R.length,f=0,I+=2,(g=i(u/(R[0]+1)))>1&&(R=e(R,g,u),O=e(O,g,u),P=R.length,C=O.length),_=P,k=(S=O.slice(0,P)).length;k<P;S[k++]=0);j=R.slice(),j=[0].concat(j),E=R[0],R[1]>=u/2&&E++;do{if(g=0,(d=t(R,S,P,k))<0){if(T=S[0],P!=k&&(T=T*u+(S[1]||0)),(g=i(T/E))>1)for(g>=u&&(g=u-1),w=(y=e(R,g,u)).length,k=S.length;1==t(y,S,w,k);)g--,n(y,P<w?j:R,w,u),w=y.length,d=1;else 0==g&&(d=g=1),w=(y=R.slice()).length;if(w<k&&(y=[0].concat(y)),n(S,y,k,u),k=S.length,-1==d)for(;t(R,S,P,k)<1;)g++,n(S,P<k?j:R,k,u),k=S.length}else 0===d&&(g++,S=[0]);v[f++]=g,S[0]?S[k++]=O[_]||0:(S=[O[_]],k=1)}while((_++<C||null!=S[0])&&I--);m=null!=S[0],v[0]||v.splice(0,1)}if(u==c){for(f=1,I=v[0];I>=10;I/=10,f++);G(b,a+(b.e=f+h*l-1)+1,o,m)}else b.e=h,b.r=+m;return b}}(),C=/^(-?)0([xbo])(?=\w[\w.]*$)/i,E=/^([^.]+)\.$/,P=/^\.([^.]+)$/,j=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,k=function(e,t,n,s){var r,i=n?t:t.replace(I,"");if(j.test(i))e.s=isNaN(i)?null:i<0?-1:1;else{if(!n&&(i=i.replace(C,(function(e,t,n){return r="x"==(n=n.toLowerCase())?16:"b"==n?2:8,s&&s!=r?e:t})),s&&(r=s,i=i.replace(E,"$1").replace(P,"0.$1")),t!=i))return new W(i,r);if(W.DEBUG)throw Error(a+"Not a"+(s?" base "+s:"")+" number: "+t);e.s=null}e.c=e.e=null},O.absoluteValue=O.abs=function(){var e=new W(this);return e.s<0&&(e.s=1),e},O.comparedTo=function(e,t){return g(this,new W(e,t))},O.decimalPlaces=O.dp=function(e,t){var n,s,r,i=this;if(null!=e)return y(e,0,f),null==t?t=M:y(t,0,8),G(new W(i),e+i.e+1,t);if(!(n=i.c))return null;if(s=((r=n.length-1)-p(this.e/l))*l,r=n[r])for(;r%10==0;r/=10,s--);return s<0&&(s=0),s},O.dividedBy=O.div=function(e,t){return n(this,new W(e,t),A,M)},O.dividedToIntegerBy=O.idiv=function(e,t){return n(this,new W(e,t),0,1)},O.exponentiatedBy=O.pow=function(e,t){var n,s,o,c,u,d,h,f,p=this;if((e=new W(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+J(e));if(null!=t&&(t=new W(t)),u=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return f=new W(Math.pow(+J(p),u?e.s*(2-w(e)):+J(e))),t?f.mod(t):f;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new W(NaN);(s=!d&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||u&&p.c[1]>=24e7:p.c[0]<8e13||u&&p.c[0]<=9999975e7)))return c=p.s<0&&w(e)?-0:0,p.e>-1&&(c=1/c),new W(d?1/c:c);H&&(c=r(H/l+2))}for(u?(n=new W(.5),d&&(e.s=1),h=w(e)):h=(o=Math.abs(+J(e)))%2,f=new W(R);;){if(h){if(!(f=f.times(p)).c)break;c?f.c.length>c&&(f.c.length=c):s&&(f=f.mod(t))}if(o){if(0===(o=i(o/2)))break;h=o%2}else if(G(e=e.times(n),e.e+1,1),e.e>14)h=w(e);else{if(0===(o=+J(e)))break;h=o%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):s&&(p=p.mod(t))}return s?f:(d&&(f=R.div(f)),t?f.mod(t):c?G(f,H,M,undefined):f)},O.integerValue=function(e){var t=new W(this);return null==e?e=M:y(e,0,8),G(t,t.e+1,e)},O.isEqualTo=O.eq=function(e,t){return 0===g(this,new W(e,t))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(e,t){return g(this,new W(e,t))>0},O.isGreaterThanOrEqualTo=O.gte=function(e,t){return 1===(t=g(this,new W(e,t)))||0===t},O.isInteger=function(){return!!this.c&&p(this.e/l)>this.c.length-2},O.isLessThan=O.lt=function(e,t){return g(this,new W(e,t))<0},O.isLessThanOrEqualTo=O.lte=function(e,t){return-1===(t=g(this,new W(e,t)))||0===t},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(e,t){var n,s,r,i,a=this,o=a.s;if(t=(e=new W(e,t)).s,!o||!t)return new W(NaN);if(o!=t)return e.s=-t,a.plus(e);var u=a.e/l,d=e.e/l,h=a.c,f=e.c;if(!u||!d){if(!h||!f)return h?(e.s=-t,e):new W(f?a:NaN);if(!h[0]||!f[0])return f[0]?(e.s=-t,e):new W(h[0]?a:3==M?-0:0)}if(u=p(u),d=p(d),h=h.slice(),o=u-d){for((i=o<0)?(o=-o,r=h):(d=u,r=f),r.reverse(),t=o;t--;r.push(0));r.reverse()}else for(s=(i=(o=h.length)<(t=f.length))?o:t,o=t=0;t<s;t++)if(h[t]!=f[t]){i=h[t]<f[t];break}if(i&&(r=h,h=f,f=r,e.s=-e.s),(t=(s=f.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=c-1;s>o;){if(h[--s]<f[s]){for(n=s;n&&!h[--n];h[n]=t);--h[n],h[s]+=c}h[s]-=f[s]}for(;0==h[0];h.splice(0,1),--d);return h[0]?z(e,h,d):(e.s=3==M?-1:1,e.c=[e.e=0],e)},O.modulo=O.mod=function(e,t){var s,r,i=this;return e=new W(e,t),!i.c||!e.s||e.c&&!e.c[0]?new W(NaN):!e.c||i.c&&!i.c[0]?new W(i):(9==$?(r=e.s,e.s=1,s=n(i,e,0,3),e.s=r,s.s*=r):s=n(i,e,0,$),(e=i.minus(s.times(e))).c[0]||1!=$||(e.s=i.s),e)},O.multipliedBy=O.times=function(e,t){var n,s,r,i,a,o,u,d,f,m,g,y,w,b,v,S=this,k=S.c,T=(e=new W(e,t)).c;if(!(k&&T&&k[0]&&T[0]))return!S.s||!e.s||k&&!k[0]&&!T||T&&!T[0]&&!k?e.c=e.e=e.s=null:(e.s*=S.s,k&&T?(e.c=[0],e.e=0):e.c=e.e=null),e;for(s=p(S.e/l)+p(e.e/l),e.s*=S.s,(u=k.length)<(m=T.length)&&(w=k,k=T,T=w,r=u,u=m,m=r),r=u+m,w=[];r--;w.push(0));for(b=c,v=h,r=m;--r>=0;){for(n=0,g=T[r]%v,y=T[r]/v|0,i=r+(a=u);i>r;)n=((d=g*(d=k[--a]%v)+(o=y*d+(f=k[a]/v|0)*g)%v*v+w[i]+n)/b|0)+(o/v|0)+y*f,w[i--]=d%b;w[i]=n}return n?++s:w.splice(0,1),z(e,w,s)},O.negated=function(){var e=new W(this);return e.s=-e.s||null,e},O.plus=function(e,t){var n,s=this,r=s.s;if(t=(e=new W(e,t)).s,!r||!t)return new W(NaN);if(r!=t)return e.s=-t,s.minus(e);var i=s.e/l,a=e.e/l,o=s.c,u=e.c;if(!i||!a){if(!o||!u)return new W(r/0);if(!o[0]||!u[0])return u[0]?e:new W(o[0]?s:0*r)}if(i=p(i),a=p(a),o=o.slice(),r=i-a){for(r>0?(a=i,n=u):(r=-r,n=o),n.reverse();r--;n.push(0));n.reverse()}for((r=o.length)-(t=u.length)<0&&(n=u,u=o,o=n,t=r),r=0;t;)r=(o[--t]=o[t]+u[t]+r)/c|0,o[t]=c===o[t]?0:o[t]%c;return r&&(o=[r].concat(o),++a),z(e,o,a)},O.precision=O.sd=function(e,t){var n,s,r,i=this;if(null!=e&&e!==!!e)return y(e,1,f),null==t?t=M:y(t,0,8),G(new W(i),e,t);if(!(n=i.c))return null;if(s=(r=n.length-1)*l+1,r=n[r]){for(;r%10==0;r/=10,s--);for(r=n[0];r>=10;r/=10,s++);}return e&&i.e+1>s&&(s=i.e+1),s},O.shiftedBy=function(e){return y(e,-9007199254740991,u),this.times("1e"+e)},O.squareRoot=O.sqrt=function(){var e,t,s,r,i,a=this,o=a.c,c=a.s,l=a.e,u=A+4,d=new W("0.5");if(1!==c||!o||!o[0])return new W(!c||c<0&&(!o||o[0])?NaN:o?a:1/0);if(0==(c=Math.sqrt(+J(a)))||c==1/0?(((t=m(o)).length+l)%2==0&&(t+="0"),c=Math.sqrt(+t),l=p((l+1)/2)-(l<0||l%2),s=new W(t=c==1/0?"5e"+l:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+l)):s=new W(c+""),s.c[0])for((c=(l=s.e)+u)<3&&(c=0);;)if(i=s,s=d.times(i.plus(n(a,i,u,1))),m(i.c).slice(0,c)===(t=m(s.c)).slice(0,c)){if(s.e<l&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(G(s,s.e+A+2,1),e=!s.times(s).eq(a));break}if(!r&&(G(i,i.e+A+2,0),i.times(i).eq(a))){s=i;break}u+=4,c+=4,r=1}return G(s,s.e+A+1,M,e)},O.toExponential=function(e,t){return null!=e&&(y(e,0,f),e++),K(this,e,t,1)},O.toFixed=function(e,t){return null!=e&&(y(e,0,f),e=e+this.e+1),K(this,e,t)},O.toFormat=function(e,t,n){var s,r=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=F;else if("object"!=typeof n)throw Error(a+"Argument not an object: "+n);if(s=r.toFixed(e,t),r.c){var i,o=s.split("."),c=+n.groupSize,l=+n.secondaryGroupSize,u=n.groupSeparator||"",d=o[0],h=o[1],f=r.s<0,p=f?d.slice(1):d,m=p.length;if(l&&(i=c,c=l,l=i,m-=i),c>0&&m>0){for(i=m%c||c,d=p.substr(0,i);i<m;i+=c)d+=u+p.substr(i,c);l>0&&(d+=u+p.slice(i)),f&&(d="-"+d)}s=h?d+(n.decimalSeparator||"")+((l=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):d}return(n.prefix||"")+s+(n.suffix||"")},O.toFraction=function(e){var t,s,r,i,o,c,u,h,f,p,g,y,w=this,b=w.c;if(null!=e&&(!(u=new W(e)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(a+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+J(u));if(!b)return new W(w);for(t=new W(R),f=s=new W(R),r=h=new W(R),y=m(b),o=t.e=y.length-w.e-1,t.c[0]=d[(c=o%l)<0?l+c:c],e=!e||u.comparedTo(t)>0?o>0?t:f:u,c=B,B=1/0,u=new W(y),h.c[0]=0;p=n(u,t,0,1),1!=(i=s.plus(p.times(r))).comparedTo(e);)s=r,r=i,f=h.plus(p.times(i=f)),h=i,t=u.minus(p.times(i=t)),u=i;return i=n(e.minus(s),r,0,1),h=h.plus(i.times(f)),s=s.plus(i.times(r)),h.s=f.s=w.s,g=n(f,r,o*=2,M).minus(w).abs().comparedTo(n(h,s,o,M).minus(w).abs())<1?[f,r]:[h,s],B=c,g},O.toNumber=function(){return+J(this)},O.toPrecision=function(e,t){return null!=e&&y(e,1,f),K(this,e,t,2)},O.toString=function(e){var t,n=this,s=n.s,r=n.e;return null===r?s?(t="Infinity",s<0&&(t="-"+t)):t="NaN":(null==e?t=r<=x||r>=N?b(m(n.c),r):v(m(n.c),r,"0"):10===e&&U?t=v(m((n=G(new W(n),A+r+1,M)).c),n.e,"0"):(y(e,2,q.length,"Base"),t=S(v(m(n.c),r,"0"),10,e,s,!0)),s<0&&n.c[0]&&(t="-"+t)),t},O.valueOf=O.toJSON=function(){return J(this)},O._isBigNumber=!0,null!=t&&W.set(t),W}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define((function(){return n})):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"@metamask/smart-transactions-controller>bignumber.js",file:"node_modules/@metamask/smart-transactions-controller/node_modules/bignumber.js/bignumber.js"}],[2561,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports={name:"@metamask/smart-transactions-controller",version:"16.1.0",description:"Improves success rates for swaps by trialing transactions privately and finding minimum fees",repository:{type:"git",url:"https://github.com/MetaMask/smart-transactions-controller.git"},license:"SEE LICENSE IN LICENSE",main:"dist/index.js",types:"dist/index.d.ts",files:["dist/"],scripts:{build:"tsc --project tsconfig.build.json","build:clean":"rm -rf dist && yarn build","build:link":"yarn build && cd dist && yarn link && rm -rf node_modules && cd ..",lint:"yarn lint:eslint && yarn lint:misc --check","lint:eslint":"eslint . --cache --ext js,ts","lint:fix":"yarn lint:eslint --fix && yarn lint:misc --write","lint:misc":"prettier '**/*.json' '**/*.md' '!CHANGELOG.md' '**/*.yml' '!.yarnrc.yml' --ignore-path .gitignore",prepack:"./scripts/prepack.sh",test:"jest","test:watch":"jest --watchAll"},dependencies:{"@babel/runtime":"^7.24.1","@ethereumjs/tx":"^5.2.1","@ethereumjs/util":"^9.0.2","@ethersproject/bytes":"^5.7.0","@metamask/base-controller":"^7.0.1","@metamask/controller-utils":"^11.0.0","@metamask/eth-json-rpc-provider":"^4.1.6","@metamask/eth-query":"^4.0.0","@metamask/polling-controller":"^12.0.0","bignumber.js":"^9.0.1","fast-json-patch":"^3.1.0",lodash:"^4.17.21"},devDependencies:{"@lavamoat/allow-scripts":"^3.2.1","@lavamoat/preinstall-always-fail":"^2.1.0","@metamask/auto-changelog":"^3.1.0","@metamask/eslint-config":"^12.2.0","@metamask/eslint-config-jest":"^12.1.0","@metamask/eslint-config-nodejs":"^12.1.0","@metamask/eslint-config-typescript":"^12.1.0","@metamask/gas-fee-controller":"^22.0.0","@metamask/json-rpc-engine":"^10.0.1","@metamask/network-controller":"^22.0.0","@metamask/transaction-controller":"^42.0.0","@types/jest":"^26.0.24","@types/lodash":"^4.14.194","@types/node":"^18.19.17","@types/sinon":"^9.0.10","@typescript-eslint/eslint-plugin":"^5.33.0","@typescript-eslint/parser":"^5.33.0",eslint:"^8.48.0","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"~2.26.0","eslint-plugin-jest":"^27.1.5","eslint-plugin-jsdoc":"^39.2.9","eslint-plugin-n":"^15.7.0","eslint-plugin-prettier":"^4.2.1","eslint-plugin-promise":"^6.1.1","isomorphic-fetch":"^3.0.0",jest:"^29.7.0",nock:"^14.0.0-beta.7",prettier:"^2.8.8","prettier-plugin-packagejson":"^2.4.3",sinon:"^9.2.4","ts-jest":"^29.1.4",typescript:"~4.8.4"},peerDependencies:{"@metamask/network-controller":"^22.0.0","@metamask/transaction-controller":"^42.0.0"},peerDependenciesMeta:{"@metamask/accounts-controller":{optional:!0},"@metamask/approval-controller":{optional:!0}},packageManager:"yarn@3.2.1",engines:{node:"^18.18 || >=20"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"},lavamoat:{allowScripts:{"@lavamoat/preinstall-always-fail":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>keccak":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>secp256k1":!1,"@metamask/controller-utils>babel-runtime>core-js":!1,"@metamask/transaction-controller>@metamask/accounts-controller>@metamask/keyring-controller>ethereumjs-wallet>ethereum-cryptography>keccak":!1,"@metamask/transaction-controller>@metamask/accounts-controller>@metamask/keyring-controller>ethereumjs-wallet>ethereum-cryptography>secp256k1":!1}}}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/package.json"}],[2562,{"../index.cjs":2565,"../snaps/Timer.cjs":2586,"@metamask/base-controller":1332,"@metamask/snaps-rpc-methods":2630,"@metamask/snaps-utils":2777,"@metamask/utils":2874,immer:4573,luxon:4789,nanoid:4883},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},m=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.CronjobController=n.DAILY_TIMEOUT=void 0;const g=e("@metamask/base-controller"),y=e("@metamask/snaps-rpc-methods"),w=e("@metamask/snaps-utils"),b=e("@metamask/utils"),v=e("immer"),S=e("luxon"),k=e("nanoid"),T=e("../index.cjs"),_=e("../snaps/Timer.cjs");n.DAILY_TIMEOUT=(0,b.inMilliseconds)(24,b.Duration.Hour);const C="CronjobController";class E extends g.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{jobs:{persist:!0,anonymous:!1},events:{persist:!0,anonymous:!1}},name:C,state:{jobs:{},events:{},...t}}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),p(this,i,new Map,"f"),p(this,a,new Map,"f"),this._handleSnapRegisterEvent=this._handleSnapRegisterEvent.bind(this),this._handleSnapUnregisterEvent=this._handleSnapUnregisterEvent.bind(this),this._handleEventSnapUpdated=this._handleEventSnapUpdated.bind(this),this._handleSnapDisabledEvent=this._handleSnapDisabledEvent.bind(this),this._handleSnapEnabledEvent=this._handleSnapEnabledEvent.bind(this),this.messagingSystem.subscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.subscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.subscribe("SnapController:snapEnabled",this._handleSnapEnabledEvent),this.messagingSystem.subscribe("SnapController:snapDisabled",this._handleSnapDisabledEvent),this.messagingSystem.subscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),this.messagingSystem.registerActionHandler(`${C}:scheduleBackgroundEvent`,((...e)=>this.scheduleBackgroundEvent(...e))),this.messagingSystem.registerActionHandler(`${C}:cancelBackgroundEvent`,((...e)=>this.cancelBackgroundEvent(...e))),this.messagingSystem.registerActionHandler(`${C}:getBackgroundEvents`,((...e)=>this.getBackgroundEvents(...e))),this.dailyCheckIn().catch((e=>{(0,w.logError)(e)})),m(this,s,"m",f).call(this,Object.values(this.state.events))}register(e){const t=m(this,s,"m",c).call(this,e);t?.forEach((e=>m(this,s,"m",l).call(this,e)))}scheduleBackgroundEvent(e){const t=S.DateTime.fromJSDate(new Date).toUTC().startOf("second").toISO({suppressMilliseconds:!0});(0,b.assert)(t);const n={...e,id:(0,k.nanoid)(),scheduledAt:t};return m(this,s,"m",d).call(this,n),this.update((e=>{e.events[n.id]=(0,v.castDraft)(n)})),n.id}cancelBackgroundEvent(e,t){(0,b.assert)(this.state.events[t],`A background event with the id of "${t}" does not exist.`),(0,b.assert)(this.state.events[t].snapId===e,"Only the origin that scheduled this event can cancel it.");const n=m(this,i,"f").get(t);n?.cancel(),m(this,i,"f").delete(t),m(this,a,"f").delete(t),this.update((e=>{delete e.events[t]}))}getBackgroundEvents(e){return Object.values(this.state.events).filter((t=>t.snapId===e))}unregister(e,t=!1){const n=[...m(this,a,"f").entries()].filter((([t,n])=>n===e));if(n.length){const e=[];n.forEach((([n])=>{const s=m(this,i,"f").get(n);s&&(s.cancel(),m(this,i,"f").delete(n),m(this,a,"f").delete(n),!t&&this.state.events[n]&&e.push(n))})),e.length>0&&this.update((t=>{e.forEach((e=>{delete t.events[e]}))}))}}async dailyCheckIn(){const e=m(this,s,"m",o).call(this);for(const t of e){const e=(0,w.parseCronExpression)(t.expression),n=this.state.jobs[t.id]?.lastRun;n!==undefined&&e.hasPrev()&&e.prev().getTime()>n&&await m(this,s,"m",u).call(this,t),m(this,s,"m",l).call(this,t)}p(this,r,new _.Timer(n.DAILY_TIMEOUT),"f"),m(this,r,"f").start((()=>{this.dailyCheckIn().catch((e=>{(0,w.logError)(e)}))}))}destroy(){super.destroy(),this.messagingSystem.unsubscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.unsubscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.unsubscribe("SnapController:snapEnabled",this._handleSnapEnabledEvent),this.messagingSystem.unsubscribe("SnapController:snapDisabled",this._handleSnapDisabledEvent),this.messagingSystem.unsubscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),m(this,a,"f").forEach((e=>this.unregister(e)))}_handleSnapRegisterEvent(e){this.register(e.id)}_handleSnapEnabledEvent(e){const t=this.getBackgroundEvents(e.id);m(this,s,"m",f).call(this,t),this.register(e.id)}_handleSnapUnregisterEvent(e){this.unregister(e.id)}_handleSnapDisabledEvent(e){this.unregister(e.id,!0)}_handleEventSnapUpdated(e){this.unregister(e.id),this.register(e.id)}}n.CronjobController=E,r=new WeakMap,i=new WeakMap,a=new WeakMap,s=new WeakSet,o=function(){const e=this.messagingSystem.call("SnapController:getAll");return(0,T.getRunnableSnaps)(e).map((e=>m(this,s,"m",c).call(this,e.id))).flat().filter((e=>e!==undefined))},c=function(e){const t=this.messagingSystem.call("PermissionController:getPermissions",e),n=t?.[y.SnapEndowments.Cronjob],s=(0,y.getCronjobCaveatJobs)(n);return s?.map(((t,n)=>({...t,id:`${e}-${n}`,snapId:e})))},l=function e(t){if(m(this,i,"f").has(t.id))return;const r=(0,w.parseCronExpression)(t.expression).next(),o=new Date,c=r.getTime()-o.getTime();if(c>n.DAILY_TIMEOUT)return;const l=new _.Timer(c);l.start((()=>{m(this,s,"m",u).call(this,t).catch((e=>{(0,w.logError)(e)})),m(this,i,"f").delete(t.id),m(this,s,"m",e).call(this,t)})),this.state.jobs[t.id]?.lastRun||m(this,s,"m",h).call(this,t.id,0),m(this,i,"f").set(t.id,l),m(this,a,"f").set(t.id,t.snapId)},u=async function(e){m(this,s,"m",h).call(this,e.id,Date.now()),await this.messagingSystem.call("SnapController:handleRequest",{snapId:e.snapId,origin:"",handler:w.HandlerType.OnCronjob,request:e.request})},d=function(e){const t=new Date(e.date),n=new Date,s=t.getTime()-n.getTime();if(s<=0)throw new Error("Cannot schedule an event in the past.");const r=new _.Timer(s);r.start((()=>{this.messagingSystem.call("SnapController:handleRequest",{snapId:e.snapId,origin:"",handler:w.HandlerType.OnCronjob,request:e.request}).catch((e=>{(0,w.logError)(e)})),m(this,i,"f").delete(e.id),m(this,a,"f").delete(e.id),this.update((t=>{delete t.events[e.id]}))})),m(this,i,"f").set(e.id,r),m(this,a,"f").set(e.id,e.snapId)},h=function(e,t){this.update((n=>{n.jobs[e]={lastRun:t}}))},f=function(e){for(const t of e){const{date:e}=t,n=new Date;new Date(e).getTime()<n.getTime()?(this.update((e=>{delete e.events[t.id]})),(0,w.logWarning)(`Background event with id "${t.id}" not scheduled as its date has expired.`)):m(this,s,"m",d).call(this,t)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/cronjob/CronjobController.cjs"}],[2563,{"./CronjobController.cjs":2562},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./CronjobController.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/cronjob/index.cjs"}],[2564,{"@metamask/utils":2874,"@xstate/fsm":3522},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.forceStrict=n.validateMachine=void 0;const s=e("@metamask/utils"),r=e("@xstate/fsm");n.validateMachine=function(e){(0,s.assert)("_options"in e,"The machine is not an @xstate/fsm machine");const t=e,n=new Set,r=e=>{return(t=e,Array.isArray(t)?t:t===undefined||null===t?[]:[t]).flatMap((e=>"string"==typeof e?[e]:((0,s.assert)("function"==typeof e),[]))).forEach(n.add.bind(n));var t};for(const e of Object.values(t.config.states)){r(e.entry),r(e.exit);for(const t of Object.values(e.on??{}))r(t.actions)}n.forEach((e=>(0,s.assert)(t._options.actions!==undefined&&e in t._options.actions,`Action "${e}" doesn't have an implementation`)))},n.forceStrict=function(e){let t=!1;e.subscribe((e=>{(0,s.assert)(!t||e.changed,"Invalid state transition"),t=!0}));const n=e.send.bind(e);e.send=(...t)=>((0,s.assert)(e.status===r.InterpreterStatus.Running,"Interpreter is stopped"),n(...t))}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/fsm.cjs"}],[2565,{"./cronjob/index.cjs":2563,"./insights/index.cjs":2567,"./interface/index.cjs":2569,"./multichain/index.cjs":2573,"./services/index.cjs":2578,"./snaps/index.cjs":2588,"./utils.cjs":2598},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./services/index.cjs"),n),r(e("./snaps/index.cjs"),n),r(e("./utils.cjs"),n),r(e("./cronjob/index.cjs"),n),r(e("./interface/index.cjs"),n),r(e("./insights/index.cjs"),n),r(e("./multichain/index.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/index.cjs"}],[2566,{"../snaps/index.cjs":2588,"@metamask/base-controller":1332,"@metamask/snaps-rpc-methods":2630,"@metamask/snaps-utils":2777,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapInsightsController=void 0;const p=e("@metamask/base-controller"),m=e("@metamask/snaps-rpc-methods"),g=e("@metamask/snaps-utils"),y=e("@metamask/utils"),w=e("../snaps/index.cjs");class b extends p.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{insights:{persist:!1,anonymous:!1}},name:"SnapInsightsController",state:{insights:{},...t}}),s.add(this),this.messagingSystem.subscribe("TransactionController:unapprovedTransactionAdded",f(this,s,"m",a).bind(this)),this.messagingSystem.subscribe("TransactionController:transactionStatusUpdated",f(this,s,"m",l).bind(this)),this.messagingSystem.subscribe("SignatureController:stateChange",f(this,s,"m",o).bind(this))}}n.SnapInsightsController=b,s=new WeakSet,r=function(e){return(0,y.hasProperty)(this.state.insights,e)},i=function(e){const t=this.messagingSystem.call("SnapController:getAll");return(0,w.getRunnableSnaps)(t).reduce(((t,n)=>{const s=this.messagingSystem.call("PermissionController:getPermissions",n.id);return s&&(0,y.hasProperty)(s,e)&&t.push({snapId:n.id,permission:s[e]}),t}),[])},a=function(e){const{id:t,txParams:n,chainId:r,origin:a}=e,o=`eip155:${(0,y.hexToBigInt)(r).toString(10)}`;f(this,s,"m",i).call(this,m.SnapEndowments.TransactionInsight).forEach((({snapId:e,permission:r})=>{const i=(0,m.getTransactionOriginCaveat)(r)&&a?a:null;this.update((n=>{var s;(s=n.insights)[t]??(s[t]={}),n.insights[t][e]={snapId:e,loading:!0}})),f(this,s,"m",d).call(this,{snapId:e,handler:g.HandlerType.OnTransaction,params:{transaction:n,chainId:o,transactionOrigin:i}}).then((n=>f(this,s,"m",h).call(this,{id:t,snapId:e,response:n}))).catch((n=>f(this,s,"m",h).call(this,{id:t,snapId:e,error:n})))}))},o=function(e){for(const t of Object.keys(this.state.insights))(0,y.hasProperty)(e.unapprovedTypedMessages,t)||(0,y.hasProperty)(e.unapprovedPersonalMsgs,t)||f(this,s,"m",u).call(this,t);if(e.unapprovedPersonalMsgCount>0||e.unapprovedTypedMessagesCount>0){const t=f(this,s,"m",i).call(this,m.SnapEndowments.SignatureInsight);for(const n of Object.values(e.unapprovedPersonalMsgs))f(this,s,"m",c).call(this,t,n);for(const n of Object.values(e.unapprovedTypedMessages))f(this,s,"m",c).call(this,t,n)}},c=function(e,t){const{id:n,msgParams:i}=t;if(f(this,s,"m",r).call(this,n))return;const{from:a,data:o,signatureMethod:c,origin:l}=i,u={from:a,data:"eth_signTypedData_v3"===c||"eth_signTypedData_v4"===c?JSON.parse(o):o,signatureMethod:c};e.forEach((({snapId:e,permission:t})=>{const r=(0,m.getSignatureOriginCaveat)(t),i=l&&r?l:null;this.update((t=>{var s;(s=t.insights)[n]??(s[n]={}),t.insights[n][e]={snapId:e,loading:!0}})),f(this,s,"m",d).call(this,{snapId:e,handler:g.HandlerType.OnSignature,params:{signature:u,signatureOrigin:i}}).then((t=>f(this,s,"m",h).call(this,{id:n,snapId:e,response:t}))).catch((t=>f(this,s,"m",h).call(this,{id:n,snapId:e,error:t})))}))},l=function({transactionMeta:e}){"unapproved"!==e.status&&f(this,s,"m",u).call(this,e.id)},u=function(e){f(this,s,"m",r).call(this,e)&&(Object.values(this.state.insights[e]).filter((e=>e.interfaceId)).forEach((e=>{this.messagingSystem.call("SnapInterfaceController:deleteInterface",e.interfaceId)})),this.update((t=>{delete t.insights[e]})))},d=async function({snapId:e,handler:t,params:n}){return this.messagingSystem.call("SnapController:handleRequest",{snapId:e,origin:"",handler:t,request:{method:"",params:n}})},h=function({id:e,snapId:t,response:n,error:i}){f(this,s,"m",r).call(this,e)&&this.update((s=>{s.insights[e][t].loading=!1,s.insights[e][t].interfaceId=n?.id,s.insights[e][t].severity=n?.severity,s.insights[e][t].error=i?.message}))}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/insights/SnapInsightsController.cjs"}],[2567,{"./SnapInsightsController.cjs":2566},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./SnapInsightsController.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/insights/index.cjs"}],[2568,{"./utils.cjs":2570,"@metamask/base-controller":1332,"@metamask/snaps-sdk":2676,"@metamask/snaps-utils":2777,"@metamask/utils":2874,immer:4573,nanoid:4883},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapInterfaceController=void 0;const p=e("@metamask/base-controller"),m=e("@metamask/snaps-sdk"),g=e("@metamask/snaps-utils"),y=e("@metamask/utils"),w=e("immer"),b=e("nanoid"),v=e("./utils.cjs"),S=1e7,k="SnapInterfaceController";class T extends p.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{interfaces:{persist:e=>Object.entries(e).reduce(((e,[t,n])=>n.contentType===m.ContentType.Notification?(e[t]=n,e):e),{}),anonymous:!1}},name:k,state:{interfaces:{},...t}}),s.add(this),this.messagingSystem.subscribe("NotificationServicesController:notificationsListUpdated",f(this,s,"m",h).bind(this)),f(this,s,"m",r).call(this)}async createInterface(e,t,n,r){const i=(0,v.getJsxInterface)(t);await f(this,s,"m",d).call(this,i),(0,v.validateInterfaceContext)(n);const a=(0,b.nanoid)(),o=(0,v.constructState)({},i);return this.update((t=>{t.interfaces[a]={snapId:e,content:(0,w.castDraft)(i),state:o,context:n??null,contentType:r??null}})),a}getInterface(e,t){return f(this,s,"m",i).call(this,e,t),this.state.interfaces[t]}async updateInterface(e,t,n,r){f(this,s,"m",i).call(this,e,t);const a=(0,v.getJsxInterface)(n);await f(this,s,"m",d).call(this,a),(0,v.validateInterfaceContext)(r);const o=this.state.interfaces[t].state,c=(0,v.constructState)(o,a);this.update((e=>{e.interfaces[t].state=c,e.interfaces[t].content=(0,w.castDraft)(a),r&&(e.interfaces[t].context=r)}))}deleteInterface(e){this.update((t=>{delete t.interfaces[e]}))}updateInterfaceState(e,t){this.update((n=>{n.interfaces[e].state=t}))}async resolveInterface(e,t,n){f(this,s,"m",i).call(this,e,t),f(this,s,"m",a).call(this,t),await f(this,s,"m",u).call(this,t,n),this.deleteInterface(t)}}n.SnapInterfaceController=T,s=new WeakSet,r=function(){this.messagingSystem.registerActionHandler(`${k}:createInterface`,this.createInterface.bind(this)),this.messagingSystem.registerActionHandler(`${k}:getInterface`,this.getInterface.bind(this)),this.messagingSystem.registerActionHandler(`${k}:updateInterface`,this.updateInterface.bind(this)),this.messagingSystem.registerActionHandler(`${k}:deleteInterface`,this.deleteInterface.bind(this)),this.messagingSystem.registerActionHandler(`${k}:updateInterfaceState`,this.updateInterfaceState.bind(this)),this.messagingSystem.registerActionHandler(`${k}:resolveInterface`,this.resolveInterface.bind(this))},i=function(e,t){const n=this.state.interfaces[t];(0,y.assert)(n!==undefined,`Interface with id '${t}' not found.`),(0,y.assert)(n.snapId===e,`Interface not created by ${e}.`)},a=function(e){(0,y.assert)(f(this,s,"m",l).call(this,e),`Approval request with id '${e}' not found.`)},o=async function(){await this.messagingSystem.call("PhishingController:maybeUpdateState")},c=function(e){return this.messagingSystem.call("PhishingController:testOrigin",e).result},l=function(e){return this.messagingSystem.call("ApprovalController:hasRequest",{id:e})},u=async function(e,t){await this.messagingSystem.call("ApprovalController:acceptRequest",e,t)},d=async function(e){const t=(0,g.getJsonSizeUnsafe)(e);(0,y.assert)(t<=S,"A Snap UI may not be larger than 10 MB."),await f(this,s,"m",o).call(this),(0,g.validateJsxLinks)(e,f(this,s,"m",c).bind(this),(e=>this.messagingSystem.call("SnapController:get",e)))},h=function(e){const t=e.filter((e=>"snap"===e.type&&(0,y.hasProperty)(e.data,"detailedView"))),n=new Set(t.map((e=>e.data.detailedView.interfaceId)));this.update((e=>{Object.entries(e.interfaces).forEach((([t,s])=>{s.contentType!==m.ContentType.Notification||n.has(t)||delete e.interfaces[t]}))}))}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/interface/SnapInterfaceController.cjs"}],[2569,{"./SnapInterfaceController.cjs":2568},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./SnapInterfaceController.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/interface/index.cjs"}],[257,{"../../../shared/constants/network":5658,"bignumber.js":3902,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s,r=e("lodash"),i=(s=e("bignumber.js"))&&s.__esModule?s:{default:s},a=e("../../../shared/constants/network");const o=e=>new i.default(e||"0x0",16).gt(0),c=["0x3","0x2a","0x4"],l={"0x3":{rpcUrl:(0,a.getRpcUrl)({network:"ropsten"}),nickname:"Ropsten",ticker:"RopstenETH"},"0x2a":{rpcUrl:(0,a.getRpcUrl)({network:"kovan"}),nickname:"Kovan",ticker:"KovanETH"},"0x4":{rpcUrl:(0,a.getRpcUrl)({network:"rinkeby"}),nickname:"Rinkeby",ticker:"RinkebyETH"}};n.default={version:74,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=74;const n=function(e){var t,n;const s=(null==e?void 0:e.PreferencesController)||{},i=s.preferences||{},a=(null==e?void 0:e.NetworkController)||{},u=(null==a?void 0:a.provider)||{},d=c.filter((e=>e===(null==u?void 0:u.chainId)));if(!i.showTestNetworks&&0===d.length)return e;const h=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},f=(null===(n=e.CachedBalancesController)||void 0===n?void 0:n.cachedBalances)||{},p=Object.values(h).filter((({chainId:e})=>c.includes(e))).map((({chainId:e})=>e)),m=c.filter((e=>Object.values(f[e]||{}).some(o))),g=(0,r.uniq)([...m,...p,...d]),y=s.frequentRpcListDetail??[];g.forEach((e=>{y.find((t=>t.chainId===e))||y.unshift({rpcUrl:l[e].rpcUrl,chainId:e,ticker:l[e].ticker,nickname:l[e].nickname,rpcPrefs:{}})})),y.length&&(s.frequentRpcListDetail=y);if(d.length){const e=d[0];a.provider={...a.provider,type:"rpc",rpcUrl:l[e].rpcUrl,chainId:e,nickname:l[e].nickname,ticker:l[e].ticker}}return{...e,PreferencesController:{...s},NetworkController:{...a}}}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/074.js"}],[2570,{"@metamask/snaps-sdk":2676,"@metamask/snaps-sdk/jsx":2757,"@metamask/snaps-utils":2777},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateInterfaceContext=n.constructState=n.assertNameIsUnique=n.getJsxInterface=void 0;const s=e("@metamask/snaps-sdk"),r=e("@metamask/snaps-sdk/jsx"),i=e("@metamask/snaps-utils");function a(e,t){(0,s.assert)(e[t]===undefined,`Duplicate component names are not allowed, found multiple instances of: "${t}".`)}function o(e,t,n){const s=n?e[n]:e,r=s?.[t.props.name];return"FileInput"===t.type?r??null:function(e){return"Checkbox"===e.type?e.props.checked:e.props.value}(t)??r??function(e){switch(e.type){case"Dropdown":{const t=(0,i.getJsxChildren)(e);return t[0]?.props.value}case"RadioGroup":{const t=(0,i.getJsxChildren)(e);return t[0]?.props.value}case"Selector":{const t=(0,i.getJsxChildren)(e);return t[0]?.props.value}case"Checkbox":return!1;default:return null}}(t)??null}n.getJsxInterface=function(e){return(0,r.isJSXElementUnsafe)(e)?e:(0,i.getJsxElementFromComponent)(e)},n.assertNameIsUnique=a,n.constructState=function(e,t){const n={},s=[];return(0,i.walkJsx)(t,((t,r)=>{let i=s[s.length-1];if(i&&r<=i.depth&&(s.pop(),i=s[s.length-1]),"Form"===t.type)return a(n,t.props.name),s.push({name:t.props.name,depth:r}),void(n[t.props.name]={});if(i&&("Input"===t.type||"Dropdown"===t.type||"RadioGroup"===t.type||"FileInput"===t.type||"Checkbox"===t.type||"Selector"===t.type)){const s=n[i.name];return a(s,t.props.name),void(s[t.props.name]=o(e,t,i.name))}"Input"!==t.type&&"Dropdown"!==t.type&&"RadioGroup"!==t.type&&"FileInput"!==t.type&&"Checkbox"!==t.type&&"Selector"!==t.type||(a(n,t.props.name),n[t.props.name]=o(e,t))})),n};const c=1e6;n.validateInterfaceContext=function(e){if(!e)return;const t=(0,i.getJsonSizeUnsafe)(e);(0,s.assert)(t<=c,"A Snap interface context may not be larger than 1 MB.")}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/interface/utils.cjs"}],[2571,{"@metamask/snaps-utils":2777,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.log=void 0;const s=e("@metamask/snaps-utils"),r=e("@metamask/utils");n.log=(0,r.createModuleLogger)(s.snapsLogger,"snaps-controllers")}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/logging.cjs"}],[2572,{"../snaps/index.cjs":2588,"@metamask/rpc-errors":2484,"@metamask/snaps-rpc-methods":2630,"@metamask/snaps-utils":2777,"@metamask/utils":2874,nanoid:4883},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},d=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.MultichainRouter=void 0;const h=e("@metamask/rpc-errors"),f=e("@metamask/snaps-rpc-methods"),p=e("@metamask/snaps-utils"),m=e("@metamask/utils"),g=e("nanoid"),y=e("../snaps/index.cjs"),w="MultichainRouter";n.MultichainRouter=class{constructor({messenger:e,withSnapKeyring:t}){s.add(this),this.name=w,this.state=null,r.set(this,void 0),i.set(this,void 0),u(this,r,e,"f"),u(this,i,t,"f"),d(this,r,"f").registerActionHandler(`${w}:handleRequest`,(async(...e)=>this.handleRequest(...e))),d(this,r,"f").registerActionHandler(`${w}:getSupportedMethods`,((...e)=>this.getSupportedMethods(...e))),d(this,r,"f").registerActionHandler(`${w}:getSupportedAccounts`,((...e)=>this.getSupportedAccounts(...e))),d(this,r,"f").registerActionHandler(`${w}:isSupportedScope`,((...e)=>this.isSupportedScope(...e)))}async handleRequest({connectedAddresses:e,origin:t,scope:n,request:a}){(0,m.assert)(!n.startsWith(m.KnownCaipNamespace.Eip155)&&!n.startsWith("wallet:eip155"));const l={jsonrpc:"2.0",id:a.id??(0,g.nanoid)(),method:a.method,params:a.params},{method:u,params:f}=l,y=await d(this,s,"m",o).call(this,e,n,l);if(y)return d(this,i,"f").call(this,(async e=>e.submitRequest({account:y,scope:n,method:u,params:f})));const w=d(this,s,"m",c).call(this,n).find((e=>e.methods.includes(u)));if(w)return d(this,r,"f").call("SnapController:handleRequest",{snapId:w.snapId,origin:t,request:{method:"",params:{request:l,scope:n}},handler:p.HandlerType.OnProtocolRequest});throw h.rpcErrors.methodNotFound()}getSupportedMethods(e){const t=d(this,s,"m",l).call(this,e).flatMap((e=>e.methods)),n=d(this,s,"m",c).call(this,e).flatMap((e=>e.methods));return Array.from(new Set([...t,...n]))}getSupportedAccounts(e){return d(this,s,"m",l).call(this,e).map((t=>`${e}:${t.address}`))}isSupportedScope(e){return d(this,r,"f").call("AccountsController:listMultichainAccounts",e).some((e=>e.metadata.snap?.enabled))}},r=new WeakMap,i=new WeakMap,s=new WeakSet,a=async function(e,t,n){try{const s=await d(this,i,"f").call(this,(async s=>s.resolveAccountAddress(e,t,n))),r=s?.address;return r?(0,m.parseCaipAccountId)(r).address:null}catch{throw h.rpcErrors.internal()}},o=async function(e,t,n){const i=d(this,r,"f").call("AccountsController:listMultichainAccounts",t).filter((e=>Boolean(e.metadata.snap?.enabled)&&e.methods.includes(n.method)));if(0===i.length)return null;const o=i[0].metadata.snap.id,c=await d(this,s,"m",a).call(this,o,t,n),l=e.map((e=>(0,m.parseCaipAccountId)(e).address)),u=i.find((e=>l.includes(e.address)&&(!c||e.address.toLowerCase()===c.toLowerCase())));if(!u)throw h.rpcErrors.invalidParams({message:"No available account found for request."});return u.id},c=function(e){const t=d(this,r,"f").call("SnapController:getAll");return(0,y.getRunnableSnaps)(t).reduce(((t,n)=>{const s=d(this,r,"f").call("PermissionController:getPermissions",n.id);if(s&&(0,m.hasProperty)(s,f.SnapEndowments.Protocol)){const r=s[f.SnapEndowments.Protocol],i=(0,f.getProtocolCaveatScopes)(r);i&&(0,m.hasProperty)(i,e)&&t.push({snapId:n.id,methods:i[e].methods})}return t}),[])},l=function(e){return d(this,r,"f").call("AccountsController:listMultichainAccounts",e).filter((e=>e.metadata.snap?.enabled))}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/multichain/MultichainRouter.cjs"}],[2573,{"./MultichainRouter.cjs":2572},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./MultichainRouter.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/multichain/index.cjs"}],[2574,{"../logging.cjs":2571,"../snaps/Timer.cjs":2586,"../utils.cjs":2598,"@metamask/json-rpc-engine":1827,"@metamask/json-rpc-middleware-stream":1831,"@metamask/object-multiplex":2310,"@metamask/rpc-errors":2484,"@metamask/snaps-utils":2777,"@metamask/utils":2874,nanoid:4883,"readable-stream":5198},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p,m,g=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},y=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},w=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.setupMultiplex=n.AbstractExecutionService=void 0;const b=e("@metamask/json-rpc-engine"),v=e("@metamask/json-rpc-middleware-stream"),S=w(e("@metamask/object-multiplex")),k=e("@metamask/rpc-errors"),T=e("@metamask/snaps-utils"),_=e("@metamask/utils"),C=e("nanoid"),E=e("readable-stream"),P=e("../logging.cjs"),j=e("../snaps/Timer.cjs"),I=e("../utils.cjs"),O="ExecutionService";function R(e,t){const n=new S.default;return(0,E.pipeline)(e,n,e,(e=>{e&&(t?(0,T.logError)(`"${t}" stream failure.`,e):(0,T.logError)(e))})),n}n.AbstractExecutionService=class{constructor({setupSnapProvider:e,messenger:t,initTimeout:n=(0,_.inMilliseconds)(60,_.Duration.Second),pingTimeout:h=(0,_.inMilliseconds)(2,_.Duration.Second),terminationTimeout:f=(0,_.inMilliseconds)(1,_.Duration.Second),usePing:p=!0}){s.add(this),this.name=O,this.state=null,r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,void 0),g(this,r,new Map,"f"),this.jobs=new Map,this.setupSnapProvider=e,g(this,i,new Map,"f"),g(this,a,new Map,"f"),g(this,o,t,"f"),g(this,c,n,"f"),g(this,l,h,"f"),g(this,u,f,"f"),g(this,d,p,"f"),this.registerMessageHandlers()}registerMessageHandlers(){y(this,o,"f").registerActionHandler(`${O}:handleRpcRequest`,(async(e,t)=>this.handleRpcRequest(e,t))),y(this,o,"f").registerActionHandler(`${O}:executeSnap`,(async e=>this.executeSnap(e))),y(this,o,"f").registerActionHandler(`${O}:terminateSnap`,(async e=>this.terminateSnap(e))),y(this,o,"f").registerActionHandler(`${O}:terminateAllSnaps`,(async()=>this.terminateAllSnaps()))}async terminate(e){const t=this.jobs.get(e);if(!t)throw new Error(`Job with id "${e}" not found.`);try{const t=await(0,I.withTimeout)(this.command(e,{jsonrpc:"2.0",method:"terminate",params:[],id:(0,C.nanoid)()}),y(this,u,"f"));t!==I.hasTimedOut&&"OK"===t||(0,T.logError)(`Job "${e}" failed to terminate gracefully.`,t)}catch{}Object.values(t.streams).forEach((e=>{try{!e.destroyed&&e.destroy(),e.removeAllListeners()}catch(e){(0,T.logError)("Error while destroying stream",e)}})),this.terminateJob(t),this.jobs.delete(e),y(this,s,"m",m).call(this,e),(0,P.log)(`Job "${e}" terminated.`)}async initJob(e,t){const{streams:n,worker:s}=await this.initStreams(e,t),r=new b.JsonRpcEngine,i=(0,v.createStreamMiddleware)();(0,E.pipeline)(i.stream,n.command,i.stream,(e=>{e&&(0,T.logError)("Command stream failure.",e)})),r.push(i.middleware);const a={id:e,streams:n,rpcEngine:r,worker:s};return this.jobs.set(e,a),a}async initStreams(e,t){const n=await(0,I.withTimeout)(this.initEnvStream(e),t);if(n===I.hasTimedOut)throw this.terminateJob({id:e}),new Error("The Snaps execution environment failed to start.");const{worker:s,stream:r}=n,i=R(r,`Job: "${e}"`),c=i.createStream(T.SNAP_STREAM_NAMES.COMMAND),l=t=>{if(!(0,_.isJsonRpcNotification)(t))return;const n=y(this,a,"f").get(e);"OutboundRequest"===t.method?y(this,o,"f").publish("ExecutionService:outboundRequest",n):"OutboundResponse"===t.method?y(this,o,"f").publish("ExecutionService:outboundResponse",n):"UnhandledError"===t.method?(0,_.isObject)(t.params)&&t.params.error?(y(this,o,"f").publish("ExecutionService:unhandledError",n,t.params.error),c.removeListener("data",l)):(0,T.logError)(new Error(`Received malformed "${t.method}" command stream notification.`)):(0,T.logError)(new Error(`Received unexpected command stream notification "${t.method}".`))};c.on("data",l);const u=i.createStream(T.SNAP_STREAM_NAMES.JSON_RPC);return{streams:{command:c,rpc:u,_connection:r},worker:s}}async terminateSnap(e){const t=y(this,i,"f").get(e);t&&await this.terminate(t)}async terminateAllSnaps(){await Promise.all([...this.jobs.keys()].map((async e=>this.terminate(e)))),y(this,r,"f").clear()}getRpcRequestHandler(e){return y(this,r,"f").get(e)}async executeSnap({snapId:e,sourceCode:t,endowments:n}){if(y(this,i,"f").has(e))throw new Error(`Snap "${e}" is already being executed.`);const r=(0,C.nanoid)(),a=new j.Timer(y(this,c,"f")),o=await this.initJob(r,a);if(y(this,s,"m",p).call(this,e,o.id),y(this,d,"f")){if(await(0,I.withTimeout)(this.command(o.id,{jsonrpc:"2.0",method:"ping",id:(0,C.nanoid)()}),y(this,l,"f"))===I.hasTimedOut)throw new Error("The Snaps execution environment failed to start.")}const u=o.streams.rpc;this.setupSnapProvider(e,u);const h=a.remaining,m={jsonrpc:"2.0",method:"executeSnap",params:{snapId:e,sourceCode:t,endowments:n},id:(0,C.nanoid)()};(0,_.assertIsJsonRpcRequest)(m);const g=await(0,I.withTimeout)(this.command(o.id,m),h);if(g===I.hasTimedOut)throw new Error(`${e} failed to start.`);return y(this,s,"m",f).call(this,e,o.id),g}async command(e,t){const n=this.jobs.get(e);if(!n)throw new Error(`Job with id "${e}" not found.`);(0,P.log)("Parent: Sending Command",t);const s=await n.rpcEngine.handle(t);if((0,_.isJsonRpcFailure)(s))throw new k.JsonRpcError(s.error.code,s.error.message,s.error.data);return s.result}async handleRpcRequest(e,t){const n=this.getRpcRequestHandler(e);if(!n)throw new Error(`Snap execution service returned no RPC handler for running snap "${e}".`);return n(t)}},r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,s=new WeakSet,h=function(e){y(this,r,"f").delete(e)},f=function(e,t){y(this,r,"f").set(e,(async({origin:n,handler:s,request:r})=>await this.command(t,{id:(0,C.nanoid)(),jsonrpc:"2.0",method:"snapRpc",params:{origin:n,handler:s,request:r,target:e}})))},p=function(e,t){y(this,i,"f").set(e,t),y(this,a,"f").set(t,e)},m=function(e){const t=y(this,a,"f").get(e);if(!t)throw new Error(`job: "${e}" has no mapped snap.`);y(this,a,"f").delete(e),y(this,i,"f").delete(t),y(this,s,"m",h).call(this,t)},n.setupMultiplex=R}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/AbstractExecutionService.cjs"}],[2575,{"@metamask/post-message-stream":2344},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},c=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ProxyPostMessageStream=void 0;const l=e("@metamask/post-message-stream");class u extends l.BasePostMessageStream{constructor({stream:e,jobId:t}){super(),s.add(this),r.set(this,void 0),i.set(this,void 0),o(this,r,e,"f"),o(this,i,t,"f"),c(this,r,"f").on("data",c(this,s,"m",a).bind(this))}_postMessage(e){c(this,r,"f").write({jobId:c(this,i,"f"),data:e})}}n.ProxyPostMessageStream=u,r=new WeakMap,i=new WeakMap,s=new WeakSet,a=function(e){e.jobId===c(this,i,"f")&&this.push(e.data)}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/ProxyPostMessageStream.cjs"}],[2576,{"../AbstractExecutionService.cjs":2574,"@metamask/post-message-stream":2344,"@metamask/snaps-utils":2777},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.IframeExecutionService=void 0;const s=e("@metamask/post-message-stream"),r=e("@metamask/snaps-utils"),i=e("../AbstractExecutionService.cjs");class a extends i.AbstractExecutionService{constructor({iframeUrl:e,messenger:t,setupSnapProvider:n,...s}){super({...s,messenger:t,setupSnapProvider:n}),this.iframeUrl=e}terminateJob(e){document.getElementById(e.id)?.remove()}async initEnvStream(e){const t=await(0,r.createWindow)({uri:this.iframeUrl.toString(),id:e});return{worker:t,stream:new s.WindowPostMessageStream({name:"parent",target:"child",targetWindow:t,targetOrigin:"*"})}}}n.IframeExecutionService=a}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/iframe/IframeExecutionService.cjs"}],[2577,{"./IframeExecutionService.cjs":2576},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./IframeExecutionService.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/iframe/index.cjs"}],[2578,{"./AbstractExecutionService.cjs":2574,"./ProxyPostMessageStream.cjs":2575,"./iframe/index.cjs":2577,"./offscreen/index.cjs":2580,"./webworker/index.cjs":2583},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.WebWorkerExecutionService=void 0,r(e("./AbstractExecutionService.cjs"),n),r(e("./ProxyPostMessageStream.cjs"),n),r(e("./iframe/index.cjs"),n),r(e("./offscreen/index.cjs"),n);var i=e("./webworker/index.cjs");Object.defineProperty(n,"WebWorkerExecutionService",{enumerable:!0,get:function(){return i.WebWorkerExecutionService}})}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/index.cjs"}],[2579,{"../proxy/ProxyExecutionService.cjs":2581,"@metamask/post-message-stream":2344},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.OffscreenExecutionService=void 0;const a=e("@metamask/post-message-stream"),o=e("../proxy/ProxyExecutionService.cjs");class c extends o.ProxyExecutionService{constructor({messenger:e,setupSnapProvider:t,offscreenPromise:n,...i}){super({...i,messenger:e,setupSnapProvider:t,stream:new a.BrowserRuntimePostMessageStream({name:"parent",target:"child"})}),s.set(this,void 0),r(this,s,n,"f")}async initEnvStream(e){return await i(this,s,"f"),await super.initEnvStream(e)}}n.OffscreenExecutionService=c,s=new WeakMap}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/offscreen/OffscreenExecutionService.cjs"}],[258,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:75,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=75;const n=function(e){return delete e.ThreeBoxController,e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/075.js"}],[2580,{"./OffscreenExecutionService.cjs":2579},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./OffscreenExecutionService.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/offscreen/index.cjs"}],[2581,{"../AbstractExecutionService.cjs":2574,"../ProxyPostMessageStream.cjs":2575,nanoid:4883},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.ProxyExecutionService=void 0;const a=e("nanoid"),o=e("../AbstractExecutionService.cjs"),c=e("../ProxyPostMessageStream.cjs");class l extends o.AbstractExecutionService{constructor({stream:e,messenger:t,setupSnapProvider:n,...i}){super({...i,messenger:t,setupSnapProvider:n,usePing:!1}),s.set(this,void 0),r(this,s,e,"f")}async terminateJob(e){i(this,s,"f").write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:(0,a.nanoid)()}})}async initEnvStream(e){const t=new c.ProxyPostMessageStream({stream:i(this,s,"f"),jobId:e});return await new Promise((e=>{t.once("data",e),t.write({name:"command",data:{jsonrpc:"2.0",method:"ping",id:(0,a.nanoid)()}})})),{worker:e,stream:t}}}n.ProxyExecutionService=l,s=new WeakMap}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/proxy/ProxyExecutionService.cjs"}],[2582,{"../AbstractExecutionService.cjs":2574,"../ProxyPostMessageStream.cjs":2575,"@metamask/post-message-stream":2344,"@metamask/snaps-utils":2777,"@metamask/utils":2874,nanoid:4883},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.WebWorkerExecutionService=n.WORKER_POOL_ID=void 0;const o=e("@metamask/post-message-stream"),c=e("@metamask/snaps-utils"),l=e("@metamask/utils"),u=e("nanoid"),d=e("../AbstractExecutionService.cjs"),h=e("../ProxyPostMessageStream.cjs");n.WORKER_POOL_ID="snaps-worker-pool";class f extends d.AbstractExecutionService{constructor({documentUrl:e,messenger:t,setupSnapProvider:n,...a}){super({...a,messenger:t,setupSnapProvider:n}),s.set(this,void 0),r.set(this,void 0),i(this,s,e,"f")}async terminateJob(e){(0,l.assert)(a(this,r,"f"),"Runtime stream not initialized."),a(this,r,"f").write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:(0,u.nanoid)()}})}async initEnvStream(e){await this.createDocument(),(0,l.assert)(a(this,r,"f"),"Runtime stream not initialized.");return{worker:e,stream:new h.ProxyPostMessageStream({stream:a(this,r,"f"),jobId:e})}}async createDocument(){if(document.getElementById(n.WORKER_POOL_ID))return;const e=await(0,c.createWindow)({uri:a(this,s,"f").href,id:n.WORKER_POOL_ID,sandbox:!1});i(this,r,new o.WindowPostMessageStream({name:"parent",target:"child",targetWindow:e,targetOrigin:"*"}),"f")}}n.WebWorkerExecutionService=f,s=new WeakMap,r=new WeakMap}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/webworker/WebWorkerExecutionService.cjs"}],[2583,{"./WebWorkerExecutionService.cjs":2582},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./WebWorkerExecutionService.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/services/webworker/index.cjs"}],[2584,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RequestQueue=void 0;n.RequestQueue=class{constructor(e){this.maxQueueSize=e,this.queueSizes=new Map}increment(e){const t=this.queueSizes.get(e)??0;if(t>=this.maxQueueSize)throw new Error("Maximum number of requests reached. Try again later.");this.queueSizes.set(e,t+1)}decrement(e){const t=this.queueSizes.get(e)??0;if(0===t)throw new Error(`Cannot decrement, ${e} does not have any outstanding requests.`);this.queueSizes.set(e,t-1)}get(e){return this.queueSizes.get(e)??0}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/RequestQueue.cjs"}],[2585,{"../fsm.cjs":2564,"../logging.cjs":2571,"../utils.cjs":2598,"./RequestQueue.cjs":2584,"./Timer.cjs":2586,"./constants.cjs":2587,"./location/index.cjs":2590,"./registry/index.cjs":2594,"./selectors.cjs":2597,"@metamask/base-controller":1332,"@metamask/permission-controller":2322,"@metamask/rpc-errors":2484,"@metamask/snaps-rpc-methods":2630,"@metamask/snaps-sdk":2676,"@metamask/snaps-utils":2777,"@metamask/utils":2874,"@xstate/fsm":3522,"async-mutex":3837,nanoid:4883,semver:5471},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p,m,g,y,w,b,v,S,k,T,_,C,E,P,j,I,O,R,A,M,x,N,D,B,L,$,H,F,q,U,W,K,V,z,G,J,Y,X,Q,Z,ee,te,ne,se,re,ie,ae,oe,ce,le,ue,de,he,fe,pe,me,ge,ye,we,be,ve,Se,ke,Te=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},_e=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapController=n.SNAP_APPROVAL_RESULT=n.SNAP_APPROVAL_UPDATE=n.SNAP_APPROVAL_INSTALL=n.controllerName=void 0;const Ce=e("@metamask/base-controller"),Ee=e("@metamask/permission-controller"),Pe=e("@metamask/rpc-errors"),je=e("@metamask/snaps-rpc-methods"),Ie=e("@metamask/snaps-sdk"),Oe=e("@metamask/snaps-utils"),Re=e("@metamask/utils"),Ae=e("@xstate/fsm"),Me=e("async-mutex"),xe=e("nanoid"),Ne=e("semver"),De=e("./constants.cjs"),Be=e("./location/index.cjs"),Le=e("./registry/index.cjs"),$e=e("./RequestQueue.cjs"),He=e("./selectors.cjs"),Fe=e("./Timer.cjs"),qe=e("../fsm.cjs"),Ue=e("../logging.cjs"),We=e("../utils.cjs");n.controllerName="SnapController",n.SNAP_APPROVAL_INSTALL="wallet_installSnap",n.SNAP_APPROVAL_UPDATE="wallet_updateSnap",n.SNAP_APPROVAL_RESULT="wallet_installSnapResult";const Ke=new Set(["initialPermissions","id","version","enabled","blocked"]),Ve={snaps:{},snapStates:{},unencryptedSnapStates:{}};function ze(e){return Object.keys(e).reduce(((t,n)=>(Ke.has(n)&&(t[n]=e[n]),t)),{})}class Ge extends Ce.BaseController{constructor({closeAllConnections:e,messenger:t,state:E,dynamicPermissions:P=["eth_accounts"],environmentEndowmentPermissions:j=[],excludedPermissions:I={},idleTimeCheckInterval:O=(0,Re.inMilliseconds)(5,Re.Duration.Second),maxIdleTime:R=(0,Re.inMilliseconds)(30,Re.Duration.Second),maxRequestTime:A=(0,Re.inMilliseconds)(60,Re.Duration.Second),fetchFunction:M=globalThis.fetch.bind(undefined),featureFlags:x={},detectSnapLocation:N=Be.detectSnapLocation,preinstalledSnaps:D=null,encryptor:B,getMnemonic:L,getFeatureFlags:$=(()=>({})),clientCryptography:H}){super({messenger:t,metadata:{snapStates:{persist:!0,anonymous:!1},unencryptedSnapStates:{persist:!0,anonymous:!1},snaps:{persist:e=>Object.values(e).filter((e=>e.status!==Oe.SnapStatus.Installing)).map((e=>({...e,status:Oe.SnapStatus.Stopped}))).reduce(((e,t)=>(e[t.id]=t,e)),{}),anonymous:!1}},name:n.controllerName,state:{...Ve,...E}}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),u.set(this,void 0),d.set(this,void 0),h.set(this,void 0),f.set(this,void 0),p.set(this,void 0),m.set(this,void 0),g.set(this,void 0),y.set(this,void 0),w.set(this,void 0),b.set(this,void 0),v.set(this,void 0),S.set(this,void 0),Te(this,r,e,"f"),Te(this,i,P,"f"),Te(this,a,j,"f"),Te(this,o,I,"f"),Te(this,c,x,"f"),Te(this,l,M,"f"),Te(this,u,O,"f"),Te(this,d,R,"f"),this.maxRequestTime=A,Te(this,g,N,"f"),Te(this,h,B,"f"),Te(this,f,L,"f"),Te(this,p,$,"f"),Te(this,m,H,"f"),Te(this,S,D,"f"),this._onUnhandledSnapError=this._onUnhandledSnapError.bind(this),this._onOutboundRequest=this._onOutboundRequest.bind(this),this._onOutboundResponse=this._onOutboundResponse.bind(this),Te(this,w,new Map,"f"),Te(this,y,new Map,"f"),_e(this,s,"m",C).call(this),this.messagingSystem.subscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.subscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.subscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.subscribe("SnapController:snapInstalled",(({id:e},t)=>{_e(this,s,"m",Se).call(this,t,e,Oe.HandlerType.OnInstall).catch((t=>{(0,Oe.logError)(`Error when calling \`onInstall\` lifecycle hook for snap "${e}": ${(0,Ie.getErrorMessage)(t)}`)}))})),this.messagingSystem.subscribe("SnapController:snapUpdated",(({id:e},t,n)=>{_e(this,s,"m",Se).call(this,n,e,Oe.HandlerType.OnUpdate).catch((t=>{(0,Oe.logError)(`Error when calling \`onUpdate\` lifecycle hook for snap "${e}": ${(0,Ie.getErrorMessage)(t)}`)}))})),this.messagingSystem.subscribe("KeyringController:lock",_e(this,s,"m",ke).bind(this)),_e(this,s,"m",k).call(this),_e(this,s,"m",T).call(this),_e(this,S,"f")&&_e(this,s,"m",_).call(this,_e(this,S,"f")),Object.values(this.state?.snaps??{}).forEach((e=>_e(this,s,"m",me).call(this,e.id)))}async updateBlockedSnaps(){_e(this,s,"m",O).call(this),await this.messagingSystem.call("SnapsRegistry:update");const e=await this.messagingSystem.call("SnapsRegistry:get",Object.values(this.state.snaps).reduce(((e,t)=>(e[t.id]={version:t.version,checksum:t.manifest.source.shasum},e)),{}));await Promise.all(Object.entries(e).map((async([e,{status:t,reason:n}])=>t===Le.SnapsRegistryStatus.Blocked?_e(this,s,"m",E).call(this,e,n):_e(this,s,"m",P).call(this,e))))}_onUnhandledSnapError(e,t){(0,Oe.logError)(`Unhandled error from "${e}":`,t),this.stopSnap(e,Oe.SnapStatusEvents.Crash).catch((e=>{(0,Oe.logError)(e)}))}_onOutboundRequest(e){const t=_e(this,s,"m",pe).call(this,e);t.pendingInboundRequests.filter((e=>"running"===e.timer.status)).forEach((e=>e.timer.pause())),t.pendingOutboundRequests+=1}_onOutboundResponse(e){const t=_e(this,s,"m",pe).call(this,e);t.pendingOutboundRequests-=1,0===t.pendingOutboundRequests&&t.pendingInboundRequests.filter((e=>"paused"===e.timer.status)).forEach((e=>e.timer.resume()))}async startSnap(e){_e(this,s,"m",O).call(this);const t=this.state.snaps[e];if(!t.enabled)throw new Error(`Snap "${e}" is disabled.`);await _e(this,s,"m",G).call(this,{snapId:e,sourceCode:t.sourceCode})}enableSnap(e){if(this.getExpect(e),this.state.snaps[e].blocked)throw new Error(`Snap "${e}" is blocked and cannot be enabled.`);this.update((t=>{t.snaps[e].enabled=!0})),this.messagingSystem.publish("SnapController:snapEnabled",this.getTruncatedExpect(e))}async disableSnap(e){if(!this.has(e))throw new Error(`Snap "${e}" not found.`);this.update((t=>{t.snaps[e].enabled=!1})),this.isRunning(e)&&await this.stopSnap(e,Oe.SnapStatusEvents.Stop),this.messagingSystem.publish("SnapController:snapDisabled",this.getTruncatedExpect(e))}async stopSnap(e,t=Oe.SnapStatusEvents.Stop){const n=_e(this,s,"m",fe).call(this,e);if(!n)throw new Error(`The snap "${e}" is not running.`);if(!n.stopping){n.stopping=!0;try{this.isRunning(e)&&(_e(this,r,"f")?.call(this,e),await _e(this,s,"m",M).call(this,e))}finally{n.lastRequest=null,n.pendingInboundRequests=[],n.pendingOutboundRequests=0,n.stopping=!1,this.isRunning(e)&&_e(this,s,"m",A).call(this,e,t)}}}async stopAllSnaps(e=Oe.SnapStatusEvents.Stop){const t=Object.values(this.state.snaps).filter((e=>this.isRunning(e.id))).map((async t=>this.stopSnap(t.id,e)));await Promise.allSettled(t)}isRunning(e){return"running"===this.getExpect(e).status}has(e){return Boolean(this.get(e))}get(e){return this.state.snaps[e]}getExpect(e){const t=this.get(e);return(0,Re.assert)(t!==undefined,new Error(`Snap "${e}" not found.`)),t}getTruncated(e){const t=this.get(e);return t?ze(t):null}getTruncatedExpect(e){return ze(this.getExpect(e))}async updateSnapState(e,t,n){const r=_e(this,s,"m",pe).call(this,e);n?r.state=t:r.unencryptedState=t,_e(this,s,"m",$).call(this,e,t,n).catch((e=>{(0,Oe.logError)(e)}))}clearSnapState(e,t){const n=_e(this,s,"m",pe).call(this,e);t?n.state=null:n.unencryptedState=null,_e(this,s,"m",$).call(this,e,null,t).catch((e=>{(0,Oe.logError)(e)}))}async getSnapState(e,t){const n=_e(this,s,"m",pe).call(this,e),r=t?n.state:n.unencryptedState;if(r!==undefined)return r;const i=t?this.state.snapStates[e]:this.state.unencryptedSnapStates[e];if(null===i||i===undefined)return null;if(!t){const e=JSON.parse(i);return n.unencryptedState=e,e}const a=await _e(this,s,"m",D).call(this,e,i);return n.state=a,a}async getSnapFile(e,t,n=Ie.AuxiliaryFileEncoding.Base64){const s=this.getExpect(e),r=(0,Oe.normalizeRelative)(t),i=s.auxiliaryFiles?.find((e=>e.path===r))?.value;if(!i)return null;const a=await(0,Oe.encodeAuxiliaryFile)(i,n);return(0,Re.assert)(a.length<Oe.MAX_FILE_SIZE,`Failed to encode static file to "${n}": Static files must be less than 64 MB when encoded.`),a}async clearState(){const e=Object.keys(this.state.snaps);_e(this,r,"f")&&e.forEach((e=>{_e(this,r,"f")?.call(this,e)})),await this.messagingSystem.call("ExecutionService:terminateAllSnaps"),e.forEach((e=>_e(this,s,"m",U).call(this,e))),this.update((e=>{e.snaps={},e.snapStates={}})),_e(this,y,"f").clear(),_e(this,S,"f")&&(_e(this,s,"m",_).call(this,_e(this,S,"f")),Object.values(this.state?.snaps).forEach((e=>_e(this,s,"m",me).call(this,e.id))))}async removeSnap(e){return this.removeSnaps([e])}async removeSnaps(e){if(!Array.isArray(e))throw new Error("Expected array of snap ids.");e.forEach((e=>{const t=this.getExpect(e);(0,Re.assert)(!1!==t.removable,`${e} is not removable.`)})),await Promise.all(e.map((async e=>{const t=this.getExpect(e),n=this.getTruncatedExpect(e);await this.disableSnap(e),_e(this,s,"m",U).call(this,e),_e(this,s,"m",q).call(this,e),_e(this,y,"f").delete(e),this.update((t=>{delete t.snaps[e],delete t.snapStates[e],delete t.unencryptedSnapStates[e]})),t.status!==Oe.SnapStatus.Installing&&this.messagingSystem.publish("SnapController:snapUninstalled",n)})))}removeSnapFromSubject(e,t){const n=this.messagingSystem.call("PermissionController:getPermissions",e),s=n?.[je.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===Oe.SnapCaveatType.SnapIds));if(!s)return;if(Boolean(s.value?.[t])){const n={...s.value};delete n[t],Object.keys(n).length>0?this.messagingSystem.call("PermissionController:updateCaveat",e,je.WALLET_SNAP_PERMISSION_KEY,Oe.SnapCaveatType.SnapIds,n):this.messagingSystem.call("PermissionController:revokePermissions",{[e]:[je.WALLET_SNAP_PERMISSION_KEY]})}}revokeDynamicSnapPermissions(e,t){(0,Re.assert)(t.every((e=>_e(this,i,"f").includes(e))),"Non-dynamic permissions cannot be revoked"),this.messagingSystem.call("PermissionController:revokePermissions",{[e]:t})}incrementActiveReferences(e){_e(this,s,"m",pe).call(this,e).activeReferences+=1}decrementActiveReferences(e){const t=_e(this,s,"m",pe).call(this,e);(0,Re.assert)(t.activeReferences>0,"SnapController reference management is in an invalid state."),t.activeReferences-=1}getAllSnaps(){return Object.values(this.state.snaps).map(ze)}getRunnableSnaps(){return(0,He.getRunnableSnaps)(this.getAllSnaps())}getPermittedSnaps(e){const t=this.messagingSystem.call("PermissionController:getPermissions",e)??{},n=t[je.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===Oe.SnapCaveatType.SnapIds))?.value??{};return Object.keys(n).reduce(((e,t)=>{const n=this.get(t),s=this.getTruncated(t);return s&&n?.status!==Oe.SnapStatus.Installing&&(e[t]=s),e}),{})}async installSnaps(e,t){_e(this,s,"m",O).call(this);const n={},r=Object.keys(t),i=[],a=[];try{for(const[r,{version:o}]of Object.entries(t)){(0,Oe.assertIsValidSnapId)(r);const[t,u]=(0,Oe.resolveVersionRange)(o);if(t)throw Pe.rpcErrors.invalidParams(`The "version" field must be a valid SemVer version range if specified. Received: "${o}".`);const d=_e(this,g,"f").call(this,r,{versionRange:u,fetch:_e(this,l,"f"),allowLocal:_e(this,c,"f").allowLocalSnaps,resolveVersion:async e=>_e(this,c,"f").requireAllowlist?await _e(this,s,"m",V).call(this,r,e):e}),h=this.has(r)&&!d.shouldAlwaysReload;if(h&&_e(this,s,"m",ve).call(this,r,u)){const e=this.getExpect(r);i.push({snapId:r,oldVersion:e.version});let t=_e(this,s,"m",le).call(this,r);if(t!==undefined)throw new Error("This snap is already being updated.");t=_e(this,s,"m",ue).call(this,r),t.newVersion=u}else h||a.push(r);n[r]=await this.processRequestedSnap(e,r,d,u)}a.forEach((t=>this.messagingSystem.publish("SnapController:snapInstalled",this.getTruncatedExpect(t),e,!1))),i.forEach((({snapId:t,oldVersion:n})=>this.messagingSystem.publish("SnapController:snapUpdated",this.getTruncatedExpect(t),n,e,!1))),r.forEach((e=>_e(this,w,"f").delete(e)))}catch(e){const t=a.filter((e=>this.has(e)));await this.removeSnaps(t);const n=[..._e(this,w,"f").keys()],r=i.map((({snapId:e})=>e)).filter((e=>n.includes(e)));throw await _e(this,s,"m",he).call(this,r),e}return n}async processRequestedSnap(e,t,r,i){const a=this.getTruncated(t);if(a&&!r.shouldAlwaysReload)return(0,Re.satisfiesVersionRange)(a.version,i)?a:await this.updateSnap(e,t,r,i,!1);_e(this,s,"m",I).call(this);let o=_e(this,s,"m",W).call(this,{origin:e,snapId:t,type:n.SNAP_APPROVAL_INSTALL});this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!1),a&&this.isRunning(t)&&await this.stopSnap(t,Oe.SnapStatusEvents.Stop),a&&r.shouldAlwaysReload&&_e(this,s,"m",U).call(this,t);try{const{sourceCode:a}=await _e(this,s,"m",z).call(this,{origin:e,id:t,location:r,versionRange:i});await this.authorize(t,o),o=_e(this,s,"m",W).call(this,{origin:e,snapId:t,type:n.SNAP_APPROVAL_RESULT}),await _e(this,s,"m",G).call(this,{snapId:t,sourceCode:a});const c=this.getTruncatedExpect(t);return _e(this,s,"m",K).call(this,o.id,{loading:!1,type:n.SNAP_APPROVAL_INSTALL}),c}catch(r){(0,Oe.logError)(`Error when adding ${t}.`,r);const i=r instanceof Error?r.message:r.toString();throw _e(this,s,"m",K).call(this,o.id,{loading:!1,type:n.SNAP_APPROVAL_INSTALL,error:i}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!1,i),r}}async updateSnap(e,t,r,i=Oe.DEFAULT_REQUESTED_SNAP_VERSION,a=!0){_e(this,s,"m",I).call(this),_e(this,s,"m",O).call(this);const o=this.getExpect(t);if(o.preinstalled)throw new Error("Preinstalled Snaps cannot be manually updated.");if(!(0,Re.isValidSemVerRange)(i))throw new Error(`Received invalid snap version range: "${i}".`);let c=_e(this,s,"m",W).call(this,{origin:e,snapId:t,type:n.SNAP_APPROVAL_UPDATE});try{this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!0);const l=o.manifest,u=await(0,We.fetchSnap)(t,r),{sourceCode:d,manifest:h}=u,f=h.result,p=f.version;if(!(0,Re.gtVersion)(p,o.version))throw Pe.rpcErrors.invalidParams(`Snap "${t}@${o.version}" is already installed. Couldn't update to a version inside requested "${i}" range.`);if(!(0,Re.satisfiesVersionRange)(p,i))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${p}" which doesn't satisfy requested version range "${i}".`);await _e(this,s,"m",j).call(this,t,{version:p,checksum:f.source.shasum,permissions:f.initialPermissions,platformVersion:f.platformVersion});const m=(0,je.processSnapPermissions)(f.initialPermissions);_e(this,s,"m",X).call(this,m);const{newPermissions:g,unusedPermissions:y,approvedPermissions:w}=_e(this,s,"m",ge).call(this,t,m),{newConnections:b,unusedConnections:v,approvedConnections:S}=_e(this,s,"m",we).call(this,t,l.initialConnections??{},f.initialConnections??{});_e(this,s,"m",K).call(this,c.id,{permissions:g,newVersion:f.version,newPermissions:g,approvedPermissions:w,unusedPermissions:y,newConnections:b,unusedConnections:v,approvedConnections:S,loading:!1});const{permissions:k,...T}=await c.promise;c=_e(this,s,"m",W).call(this,{origin:e,snapId:t,type:n.SNAP_APPROVAL_RESULT}),this.isRunning(t)&&await this.stopSnap(t,Oe.SnapStatusEvents.Stop),_e(this,s,"m",A).call(this,t,Oe.SnapStatusEvents.Update),_e(this,s,"m",Y).call(this,{origin:e,id:t,files:u,isUpdate:!0}),_e(this,s,"m",be).call(this,{snapId:t,unusedPermissions:y,newPermissions:k,requestData:T}),f.initialConnections&&_e(this,s,"m",H).call(this,t,l.initialConnections??null,f.initialConnections);const _=_e(this,s,"m",le).call(this,t);_!==undefined&&(_.permissions.revoked=y,_.permissions.granted=k,_.permissions.requestData=T);const C=d.toString();(0,Re.assert)("string"==typeof C&&C.length>0,`Invalid source code for snap "${t}".`);try{await _e(this,s,"m",G).call(this,{snapId:t,sourceCode:C})}catch{throw new Error(`Snap ${t} crashed with updated source code.`)}const E=this.getTruncatedExpect(t);return a&&this.messagingSystem.publish("SnapController:snapUpdated",E,o.version,e,!1),_e(this,s,"m",K).call(this,c.id,{loading:!1,type:n.SNAP_APPROVAL_UPDATE}),E}catch(r){(0,Oe.logError)(`Error when updating ${t},`,r);const i=r instanceof Error?r.message:r.toString();throw _e(this,s,"m",K).call(this,c.id,{loading:!1,error:i,type:n.SNAP_APPROVAL_UPDATE}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!0,i),r}}async getRegistryMetadata(e){return _e(this,s,"m",O).call(this),await this.messagingSystem.call("SnapsRegistry:getMetadata",e)}async authorize(e,t){(0,Ue.log)(`Authorizing snap: ${e}`);const n=this.state.snaps[e],{initialPermissions:r,initialConnections:i}=n;try{const a=(0,je.processSnapPermissions)(r);_e(this,s,"m",X).call(this,a),_e(this,s,"m",K).call(this,t.id,{loading:!1,connections:i??{},permissions:a});const{permissions:o,...c}=await t.promise;_e(this,s,"m",be).call(this,{snapId:e,newPermissions:o,requestData:c}),n.manifest.initialConnections&&_e(this,s,"m",H).call(this,e,null,n.manifest.initialConnections)}finally{_e(this,s,"m",pe).call(this,e).installPromise=null}}destroy(){super.destroy(),_e(this,b,"f")&&clearTimeout(_e(this,b,"f")),this.messagingSystem.unsubscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.unsubscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.unsubscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.clearEventSubscriptions("SnapController:snapInstalled"),this.messagingSystem.clearEventSubscriptions("SnapController:snapUpdated")}async handleRequest({snapId:e,origin:t,handler:n,request:r}){_e(this,s,"m",O).call(this);const i={jsonrpc:"2.0",id:(0,xe.nanoid)(),...r};(0,Re.assertIsJsonRpcRequest)(i);const a=je.handlerEndowments[n];(0,Re.assert)("string"==typeof a||null===a,"'permissionName' must be either a string or null.");const o=this.messagingSystem.call("PermissionController:getPermissions",e);if(!(null===a||o&&(0,Re.hasProperty)(o,a)))throw new Error(`Snap "${e}" is not permitted to use "${a}".`);const c=a?o[a]:undefined;if(a===je.SnapEndowments.Rpc||a===je.SnapEndowments.Keyring){(0,Re.assert)(c);const n=this.messagingSystem.call("SubjectMetadataController:getSubjectMetadata",t),s=a===je.SnapEndowments.Rpc?(0,je.getRpcCaveatOrigins)(c):(0,je.getKeyringCaveatOrigins)(c);if((0,Re.assert)(s),!(0,Oe.isOriginAllowed)(s,n?.subjectType??Ee.SubjectType.Website,t))throw new Error(`Snap "${e}" is not permitted to handle requests from "${t}".`)}const l=_e(this,s,"m",ee).call(this,e);if(!l)throw new Error(`Snap RPC message handler not found for snap "${e}".`);return l({origin:t,handler:n,request:i,timeout:_e(this,s,"m",Z).call(this,c)})}}n.SnapController=Ge,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,y=new WeakMap,w=new WeakMap,b=new WeakMap,v=new WeakMap,S=new WeakMap,s=new WeakSet,k=function(){const e=({snapId:e})=>this.getExpect(e).enabled,t={initial:Oe.SnapStatus.Installing,states:{[Oe.SnapStatus.Installing]:{on:{[Oe.SnapStatusEvents.Start]:{target:Oe.SnapStatus.Running,cond:e}}},[Oe.SnapStatus.Updating]:{on:{[Oe.SnapStatusEvents.Start]:{target:Oe.SnapStatus.Running,cond:e},[Oe.SnapStatusEvents.Stop]:Oe.SnapStatus.Stopped}},[Oe.SnapStatus.Running]:{on:{[Oe.SnapStatusEvents.Stop]:Oe.SnapStatus.Stopped,[Oe.SnapStatusEvents.Crash]:Oe.SnapStatus.Crashed}},[Oe.SnapStatus.Stopped]:{on:{[Oe.SnapStatusEvents.Start]:{target:Oe.SnapStatus.Running,cond:e},[Oe.SnapStatusEvents.Update]:Oe.SnapStatus.Updating}},[Oe.SnapStatus.Crashed]:{on:{[Oe.SnapStatusEvents.Start]:{target:Oe.SnapStatus.Running,cond:e},[Oe.SnapStatusEvents.Update]:Oe.SnapStatus.Updating}}}};Te(this,v,(0,Ae.createMachine)(t),"f"),(0,qe.validateMachine)(_e(this,v,"f"))},T=function(){this.messagingSystem.registerActionHandler(`${n.controllerName}:clearSnapState`,((...e)=>this.clearSnapState(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:get`,((...e)=>this.get(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:getSnapState`,(async(...e)=>this.getSnapState(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:handleRequest`,(async(...e)=>this.handleRequest(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:has`,((...e)=>this.has(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:updateBlockedSnaps`,(async()=>this.updateBlockedSnaps())),this.messagingSystem.registerActionHandler(`${n.controllerName}:updateSnapState`,(async(...e)=>this.updateSnapState(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:enable`,((...e)=>this.enableSnap(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:disable`,(async(...e)=>this.disableSnap(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:remove`,(async(...e)=>this.removeSnap(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:getPermitted`,((...e)=>this.getPermittedSnaps(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:install`,(async(...e)=>this.installSnaps(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:getAll`,((...e)=>this.getAllSnaps(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:getRunnableSnaps`,((...e)=>this.getRunnableSnaps(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:incrementActiveReferences`,((...e)=>this.incrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:decrementActiveReferences`,((...e)=>this.decrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:getRegistryMetadata`,(async(...e)=>this.getRegistryMetadata(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:disconnectOrigin`,((...e)=>this.removeSnapFromSubject(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:revokeDynamicPermissions`,((...e)=>this.revokeDynamicSnapPermissions(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:getFile`,(async(...e)=>this.getSnapFile(...e))),this.messagingSystem.registerActionHandler(`${n.controllerName}:stopAllSnaps`,(async(...e)=>this.stopAllSnaps(...e)))},_=function(e){for(const{snapId:t,manifest:n,files:r,removable:i,hidden:a,hideSnapBranding:o}of e){const e=this.get(t),c=e!==undefined,l=c&&(0,Re.gtVersion)(n.version,e.version);if(c&&(!l||!0!==e.preinstalled))continue;const u=new Oe.VirtualFile({path:Oe.NpmSnapFileNames.Manifest,value:JSON.stringify(n),result:n}),d=r.map((({path:e,value:t})=>new Oe.VirtualFile({value:t,path:e}))),{filePath:h,iconPath:f}=n.source.location.npm,p=d.find((e=>e.path===h)),m=f?d.find((e=>e.path===f)):undefined;(0,Re.assert)(p,"Source code not provided for preinstalled snap."),(0,Re.assert)(!f||f&&m,"Icon not provided for preinstalled snap."),(0,Re.assert)(n.source.files===undefined,"Auxiliary files are not currently supported for preinstalled snaps.");const g=n.source.locales?.map((e=>d.find((t=>t.path===e))))??[],y=(0,Oe.getValidatedLocalizationFiles)(g.filter(Boolean));(0,Re.assert)(g.length===y.length,"Missing localization files for preinstalled snap.");const w={manifest:u,sourceCode:p,svgIcon:m,auxiliaryFiles:[],localizationFiles:y};_e(this,s,"m",Y).call(this,{id:t,origin:"metamask",files:w,removable:i,hidden:a,hideSnapBranding:o,preinstalled:!0});const b=(0,je.processSnapPermissions)(n.initialPermissions);_e(this,s,"m",X).call(this,b);const{newPermissions:v,unusedPermissions:S}=_e(this,s,"m",ge).call(this,t,b);_e(this,s,"m",be).call(this,{snapId:t,newPermissions:v,unusedPermissions:S}),n.initialConnections&&_e(this,s,"m",H).call(this,t,e?.initialConnections??null,n.initialConnections),this.update((e=>{e.snaps[t].status=Oe.SnapStatus.Stopped})),l?this.messagingSystem.publish("SnapController:snapUpdated",this.getTruncatedExpect(t),e.version,"metamask",!0):this.messagingSystem.publish("SnapController:snapInstalled",this.getTruncatedExpect(t),"metamask",!0)}},C=function e(){Te(this,b,setTimeout((()=>{_e(this,s,"m",R).call(this).catch((e=>{(0,Oe.logError)(e)})),_e(this,s,"m",e).call(this)}),_e(this,u,"f")),"f")},E=async function(e,t){if(this.has(e)){try{this.update((n=>{n.snaps[e].blocked=!0,n.snaps[e].blockInformation=t})),await this.disableSnap(e)}catch(t){(0,Oe.logError)(`Encountered error when stopping blocked snap "${e}".`,t)}this.messagingSystem.publish(`${n.controllerName}:snapBlocked`,e,t)}},P=function(e){this.has(e)&&this.state.snaps[e].blocked&&(this.update((t=>{t.snaps[e].blocked=!1,delete t.snaps[e].blockInformation})),this.messagingSystem.publish(`${n.controllerName}:snapUnblocked`,e))},j=async function(e,{platformVersion:t,...n}){const r=(await this.messagingSystem.call("SnapsRegistry:get",{[e]:n}))[e];if(r.status===Le.SnapsRegistryStatus.Blocked)throw new Error(`Cannot install version "${n.version}" of snap "${e}": The version is blocked. ${r.reason?.explanation??""}`);const i=Object.keys(n.permissions).some((e=>!De.ALLOWED_PERMISSIONS.includes(e)));if(_e(this,c,"f").requireAllowlist&&i&&r.status!==Le.SnapsRegistryStatus.Verified)throw new Error(`Cannot install version "${n.version}" of snap "${e}": ${r.status===Le.SnapsRegistryStatus.Unavailable?"The registry is temporarily unavailable.":"The snap is not on the allowlist."}`);_e(this,s,"m",Q).call(this,e,t)},I=function(){(0,Re.assert)(!0!==_e(this,c,"f").disableSnapInstallation,"Installing Snaps is currently disabled in this version of MetaMask.")},O=function(){const e=_e(this,p,"f").call(this);(0,Re.assert)(!0!==e.disableSnaps,"The Snaps platform requires basic functionality to be used. Enable basic functionality in the settings to use the Snaps platform.")},R=async function(){const e=[..._e(this,y,"f").entries()];return Promise.all(e.filter((([e,t])=>0===t.activeReferences&&0===t.pendingInboundRequests.length&&t.lastRequest&&_e(this,d,"f")&&(0,Re.timeSince)(t.lastRequest)>_e(this,d,"f"))).map((async([e])=>this.stopSnap(e,Oe.SnapStatusEvents.Stop))))},A=function(e,t){const{interpreter:n}=_e(this,s,"m",pe).call(this,e);n.send(t),this.update((t=>{t.snaps[e].status=n.state.value}))},M=async function(e){await this.messagingSystem.call("ExecutionService:terminateSnap",e),await new Promise((e=>setTimeout(e,1)));_e(this,s,"m",pe).call(this,e).pendingInboundRequests.filter((e=>"finished"!==e.timer.status)).forEach((e=>e.timer.finish())),await new Promise((e=>setTimeout(e,1))),this.messagingSystem.publish("SnapController:snapTerminated",this.getTruncatedExpect(e))},x=async function({snapId:e,salt:t,useCache:n,keyMetadata:r}){const i=_e(this,s,"m",pe).call(this,e);if(i.encryptionKey&&i.encryptionSalt&&n)return{key:await _e(this,h,"f").importKey(i.encryptionKey),salt:i.encryptionSalt};const a=t??_e(this,h,"f").generateSalt(),o=await _e(this,f,"f").call(this),c=await(0,je.getEncryptionEntropy)({snapId:e,mnemonicPhrase:o,cryptographicFunctions:_e(this,m,"f")}),l=await _e(this,h,"f").keyFromPassword(c,a,!0,r),u=await _e(this,h,"f").exportKey(l);return n&&(i.encryptionKey=u,i.encryptionSalt=a),{key:l,salt:a}},N=function(e){const t=_e(this,s,"m",pe).call(this,e);return null!==t.encryptionKey&&null!==t.encryptionSalt},D=async function(e,t){try{const n=JSON.parse(t),{salt:r,keyMetadata:i}=n,a=_e(this,s,"m",N).call(this,e)||_e(this,h,"f").isVaultUpdated(t),{key:o}=await _e(this,s,"m",x).call(this,{snapId:e,salt:r,useCache:a,keyMetadata:i??De.LEGACY_ENCRYPTION_KEY_DERIVATION_OPTIONS});return await _e(this,h,"f").decryptWithKey(o,n)}catch{throw Pe.rpcErrors.internal({message:"Failed to decrypt snap state, the state must be corrupted."})}},B=async function(e,t){const{key:n,salt:r}=await _e(this,s,"m",x).call(this,{snapId:e,useCache:!0}),i=await _e(this,h,"f").encryptWithKey(n,t);return i.salt=r,JSON.stringify(i)},L=async function(e,t,n){return null===t?null:n?await _e(this,s,"m",B).call(this,e,t):JSON.stringify(t)},$=async function(e,t,n){const r=_e(this,s,"m",pe).call(this,e);await r.stateMutex.runExclusive((async()=>{const r=await _e(this,s,"m",L).call(this,e,t,n);return n?this.update((t=>{t.snapStates[e]=r})):this.update((t=>{t.unencryptedSnapStates[e]=r}))}))},H=function(e,t,n){if(t){const s=(0,We.setDiff)(t,n);for(const t of Object.keys(s))this.removeSnapFromSubject(t,e)}for(const t of Object.keys(n))_e(this,s,"m",F).call(this,t,e)},F=function(e,t){const n=this.messagingSystem.call("PermissionController:getPermissions",e),s=n?.[je.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===Oe.SnapCaveatType.SnapIds));if(Boolean(s?.value?.[t]))return;if(s)return void this.messagingSystem.call("PermissionController:updateCaveat",e,je.WALLET_SNAP_PERMISSION_KEY,Oe.SnapCaveatType.SnapIds,{...s.value,[t]:{}});const r={[je.WALLET_SNAP_PERMISSION_KEY]:{caveats:[{type:Oe.SnapCaveatType.SnapIds,value:{[t]:{}}}]}};this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:r,subject:{origin:e}})},q=function(e){const t=this.messagingSystem.call("PermissionController:getSubjectNames");for(const n of t)this.removeSnapFromSubject(n,e)},U=function(e){this.messagingSystem.call("PermissionController:hasPermissions",e)&&this.messagingSystem.call("PermissionController:revokeAllPermissions",e)},W=function({origin:e,snapId:t,type:n}){const s=(0,xe.nanoid)();return{id:s,promise:this.messagingSystem.call("ApprovalController:addRequest",{origin:e,id:s,type:n,requestData:{metadata:{id:s,origin:t,dappOrigin:e},snapId:t},requestState:{loading:!0}},!0)}},K=function(e,t){try{this.messagingSystem.call("ApprovalController:updateRequestState",{id:e,requestState:t})}catch{}},V=async function(e,t){return await this.messagingSystem.call("SnapsRegistry:resolveVersion",e,t)},z=async function(e){const{id:t,location:n,versionRange:r}=e;_e(this,s,"m",me).call(this,t);const i=_e(this,s,"m",pe).call(this,t);i.installPromise||((0,Ue.log)(`Adding snap: ${t}`),i.installPromise=(async()=>{const i=await(0,We.fetchSnap)(t,n),a=i.manifest.result;if(!(0,Re.satisfiesVersionRange)(a.version,r))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${a.version}" which doesn't satisfy requested version range "${r}".`);return await _e(this,s,"m",j).call(this,t,{version:a.version,checksum:a.source.shasum,permissions:a.initialPermissions,platformVersion:a.platformVersion}),_e(this,s,"m",Y).call(this,{...e,files:i,id:t})})());try{return await i.installPromise}catch(e){throw i.installPromise=null,e}},G=async function(e){const{snapId:t}=e;if(this.isRunning(t))throw new Error(`Snap "${t}" is already started.`);try{const n=_e(this,s,"m",pe).call(this,t),r=await this.messagingSystem.call("ExecutionService:executeSnap",{...e,endowments:await _e(this,s,"m",J).call(this,t)});return _e(this,s,"m",A).call(this,t,Oe.SnapStatusEvents.Start),n.lastRequest=Date.now(),r}catch(e){throw await _e(this,s,"m",M).call(this,t),e}},J=async function(e){let t=[];for(const n of _e(this,a,"f"))if(this.messagingSystem.call("PermissionController:hasPermission",e,n)){const s=await this.messagingSystem.call("PermissionController:getEndowments",e,n);if(s){if(!Array.isArray(s)||s.some((e=>"string"!=typeof e)))throw new Error("Expected an array of string endowment names.");t=t.concat(s)}}const n=[...new Set([...Oe.DEFAULT_ENDOWMENTS,...t])];return n.length<Oe.DEFAULT_ENDOWMENTS.length+t.length&&(0,Oe.logError)(`Duplicate endowments found for ${e}. Default endowments should not be requested.`,t),n},Y=function(e){const{id:t,origin:n,files:r,isUpdate:i=!1,removable:a,preinstalled:o,hidden:c,hideSnapBranding:l}=e,{manifest:u,sourceCode:d,svgIcon:h,auxiliaryFiles:f,localizationFiles:p}=r;(0,Oe.assertIsSnapManifest)(u.result);const{version:m}=u.result,g=d.toString();(0,Re.assert)("string"==typeof g&&g.length>0,`Invalid source code for snap "${t}".`);const y=f.map((e=>((0,Re.assert)("string"==typeof e.data.base64),{path:e.path,value:e.data.base64}))),w=this.state.snaps[t],b=[...w?.versionHistory??[],{version:m,date:Date.now(),origin:n}],S=p.map((e=>e.result)),k={...w,blocked:!1,enabled:!0,removable:a,preinstalled:o,hidden:c,hideSnapBranding:l,id:t,initialConnections:u.result.initialConnections,initialPermissions:u.result.initialPermissions,manifest:u.result,status:_e(this,v,"f").config.initial,sourceCode:g,version:m,versionHistory:b,auxiliaryFiles:y,localizationFiles:S};delete k.blockInformation;const{inversePatches:T}=this.update((e=>{e.snaps[t]=k}));if(i){const e=_e(this,s,"m",le).call(this,t);e!==undefined&&(e.statePatches=T)}const{proposedName:_}=(0,Oe.getLocalizedSnapManifest)(u.result,"en",S);return this.messagingSystem.call("SubjectMetadataController:addSubjectMetadata",{subjectType:Ee.SubjectType.Snap,name:_,origin:k.id,version:m,svgIcon:h?.toString()??null}),{...k,sourceCode:g}},X=function(e){const t=Object.keys(e),n=Array.from(new Set(Object.values(je.handlerEndowments)));(0,Re.assert)(t.some((e=>n.includes(e))),`A snap must request at least one of the following permissions: ${n.filter((e=>null!==e)).join(", ")}.`);const s=t.reduce(((e,t)=>((0,Re.hasProperty)(_e(this,o,"f"),t)&&e.push(_e(this,o,"f")[t]),e)),[]);(0,Re.assert)(0===s.length,`One or more permissions are not allowed:\n${s.join("\n")}`)},Q=function(e,t){if(t!==undefined&&(0,Ne.gt)(t,(0,Oe.getPlatformVersion)())){const n=`The Snap "${e}" requires platform version "${t}" which is greater than the current platform version "${(0,Oe.getPlatformVersion)()}".`;if(_e(this,c,"f").rejectInvalidPlatformVersion)throw new Error(n);(0,Oe.logWarning)(n)}},Z=function(e){return(0,je.getMaxRequestTimeCaveat)(e)??this.maxRequestTime},ee=function(e){const t=_e(this,s,"m",pe).call(this,e),n=t.rpcHandler;if(n)return n;const r=new $e.RequestQueue(5),i=new Map,a=async({origin:t,handler:n,request:a,timeout:o})=>{if(!this.state.snaps[e].enabled)throw new Error(`Snap "${e}" is disabled.`);if(this.state.snaps[e].status===Oe.SnapStatus.Installing)throw new Error(`Snap "${e}" is currently being installed. Please try again later.`);if(!this.isRunning(e)){let n=i.get(e);if(n){if(r.get(t)>=r.maxQueueSize)throw new Error("Exceeds maximum number of requests waiting to be resolved, please try again.")}else n=this.startSnap(e),i.set(e,n);r.increment(t);try{await n}finally{r.decrement(t),i.get(e)===n&&i.delete(e)}}const c=new Fe.Timer(o);_e(this,s,"m",oe).call(this,e,a.id,c);const l=this.messagingSystem.call("ExecutionService:handleRpcRequest",e,{origin:t,handler:n,request:a});try{const t=await(0,We.withTimeout)(l,c);if(t===We.hasTimedOut)throw new Error(`${e} failed to respond to the request in time.`);await _e(this,s,"m",ae).call(this,e,n,t);const r=await _e(this,s,"m",se).call(this,e,n,a,t);return _e(this,s,"m",ce).call(this,e,a.id),r}catch(t){_e(this,s,"m",ce).call(this,e,a.id);const[n,r]=(0,Oe.unwrapError)(t);throw r||await this.stopSnap(e,Oe.SnapStatusEvents.Crash),n}};return t.rpcHandler=a,a},te=async function(e,t,n){return this.messagingSystem.call("SnapInterfaceController:createInterface",e,t,undefined,n)},ne=function(e,t){(0,Re.assert)(this.messagingSystem.call("SnapInterfaceController:getInterface",e,t))},se=async function(e,t,n,r){switch(t){case Oe.HandlerType.OnTransaction:case Oe.HandlerType.OnSignature:case Oe.HandlerType.OnHomePage:case Oe.HandlerType.OnSettingsPage:{const t=r;if(t&&(0,Re.hasProperty)(t,"content")){const{content:n,...r}=t;return{...r,id:await _e(this,s,"m",te).call(this,e,n)}}return r}case Oe.HandlerType.OnAssetsLookup:return _e(this,s,"m",re).call(this,e,n,r);case Oe.HandlerType.OnAssetsConversion:return _e(this,s,"m",ie).call(this,n,r);default:return r}},re=function(e,{params:t},{assets:n}){const s=this.messagingSystem.call("PermissionController:getPermissions",e);(0,Re.assert)(s);const r=s[je.SnapEndowments.Assets],i=(0,je.getChainIdsCaveat)(r);(0,Re.assert)(i);const{assets:a}=t;return{assets:Object.keys(n).reduce(((e,t)=>{const s=t;return i.some((e=>s.startsWith(e)))&&a.includes(s)&&(e[s]=n[s]),e}),{})}},ie=function({params:e},{conversionRates:t}){const{conversions:n}=e;return{conversionRates:n.reduce(((e,n)=>{var s;const r=t[n.from]?.[n.to];return r&&(e[s=n.from]??(e[s]={}),e[n.from][n.to]=r),e}),{})}},ae=async function(e,t,n){switch(t){case Oe.HandlerType.OnTransaction:(0,Re.assertStruct)(n,Oe.OnTransactionResponseStruct),n&&(0,Re.hasProperty)(n,"id")&&_e(this,s,"m",ne).call(this,e,n.id);break;case Oe.HandlerType.OnSignature:(0,Re.assertStruct)(n,Oe.OnSignatureResponseStruct),n&&(0,Re.hasProperty)(n,"id")&&_e(this,s,"m",ne).call(this,e,n.id);break;case Oe.HandlerType.OnHomePage:(0,Re.assertStruct)(n,Oe.OnHomePageResponseStruct),n&&(0,Re.hasProperty)(n,"id")&&_e(this,s,"m",ne).call(this,e,n.id);break;case Oe.HandlerType.OnSettingsPage:(0,Re.assertStruct)(n,Oe.OnSettingsPageResponseStruct),n&&(0,Re.hasProperty)(n,"id")&&_e(this,s,"m",ne).call(this,e,n.id);break;case Oe.HandlerType.OnNameLookup:(0,Re.assertStruct)(n,Oe.OnNameLookupResponseStruct);break;case Oe.HandlerType.OnAssetsLookup:(0,Re.assertStruct)(n,Ie.OnAssetsLookupResponseStruct);break;case Oe.HandlerType.OnAssetsConversion:(0,Re.assertStruct)(n,Ie.OnAssetsConversionResponseStruct)}},oe=function(e,t,n){const r=_e(this,s,"m",pe).call(this,e);r.pendingInboundRequests.push({requestId:t,timer:n}),r.lastRequest=null},ce=function(e,t){const n=_e(this,s,"m",pe).call(this,e);n.pendingInboundRequests=n.pendingInboundRequests.filter((e=>e.requestId!==t)),0===n.pendingInboundRequests.length&&(n.lastRequest=Date.now())},le=function(e){return _e(this,w,"f").get(e)},ue=function(e){(0,Re.assert)(_e(this,w,"f").get(e)===undefined,new Error(`Snap "${e}" rollback snapshot already exists.`)),_e(this,w,"f").set(e,{statePatches:[],permissions:{},newVersion:""});const t=_e(this,w,"f").get(e);return(0,Re.assert)(t!==undefined,new Error(`Snapshot creation failed for ${e}.`)),t},de=async function(e){const t=_e(this,s,"m",le).call(this,e);if(!t)throw new Error("A snapshot does not exist for this snap.");await this.stopSnap(e,Oe.SnapStatusEvents.Stop),this.get(e)?.status!==Oe.SnapStatus.Stopped&&_e(this,s,"m",A).call(this,e,Oe.SnapStatusEvents.Stop);const{statePatches:n,permissions:r}=t;n?.length&&this.applyPatches(n),this.get(e)?.status!==Oe.SnapStatus.Stopped&&this.update((t=>{t.snaps[e].status=Oe.SnapStatus.Stopped})),_e(this,s,"m",be).call(this,{snapId:e,unusedPermissions:r.granted,newPermissions:r.revoked,requestData:r.requestData});const i=this.getTruncatedExpect(e);this.messagingSystem.publish("SnapController:snapRolledback",i,t.newVersion),_e(this,w,"f").delete(e)},he=async function(e){for(const t of e)await _e(this,s,"m",de).call(this,t)},fe=function(e){return _e(this,y,"f").get(e)},pe=function(e){const t=_e(this,s,"m",fe).call(this,e);return(0,Re.assert)(t!==undefined,new Error(`Snap "${e}" runtime data not found`)),t},me=function(e){if(_e(this,y,"f").has(e))return;const t=this.get(e),n=(0,Ae.interpret)(_e(this,v,"f"));n.start({context:{snapId:e},value:t?.status??_e(this,v,"f").config.initial}),(0,qe.forceStrict)(n),_e(this,y,"f").set(e,{lastRequest:null,rpcHandler:null,installPromise:null,encryptionKey:null,encryptionSalt:null,activeReferences:0,pendingInboundRequests:[],pendingOutboundRequests:0,interpreter:n,stopping:!1,stateMutex:new Me.Mutex})},ge=function(e,t){const n=this.messagingSystem.call("PermissionController:getPermissions",e)??{},s=(0,We.permissionsDiff)(t,n),r=(0,We.permissionsDiff)(n,t);return{newPermissions:s,unusedPermissions:r,approvedPermissions:(0,We.permissionsDiff)(n,r)}},ye=function(e,t){const n=this.messagingSystem.call("PermissionController:getPermissions",t),s=n?.[je.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===Oe.SnapCaveatType.SnapIds));return Boolean(s?.value?.[e])},we=function(e,t,n){const r=Object.keys(t).filter((t=>_e(this,s,"m",ye).call(this,e,t))).reduce(((e,n)=>(e[n]=t[n],e)),{}),i=(0,We.setDiff)(n,r),a=(0,We.setDiff)(r,n);return{newConnections:i,unusedConnections:a,approvedConnections:(0,We.setDiff)(r,a)}},be=function({snapId:e,unusedPermissions:t={},newPermissions:n={},requestData:s}){const r=Object.keys(t);(0,Re.isNonEmptyArray)(r)&&this.messagingSystem.call("PermissionController:revokePermissions",{[e]:r}),(0,Re.isNonEmptyArray)(Object.keys(n))&&this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:n,subject:{origin:e},requestData:s})},ve=function(e,t){const n=this.getExpect(e);return!(0,Re.satisfiesVersionRange)(n.version,t)&&!(0,Re.gtRange)(n.version,t)},Se=async function(e,t,n){const s=je.handlerEndowments[n];(0,Re.assert)(s,"Lifecycle hook must have an endowment.");this.messagingSystem.call("PermissionController:hasPermission",t,s)&&await this.handleRequest({snapId:t,handler:n,origin:e,request:{jsonrpc:"2.0",method:n}})},ke=function(){for(const e of _e(this,y,"f").values())e.encryptionKey=null,e.encryptionSalt=null,e.state=undefined}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/SnapController.cjs"}],[2586,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Timer=void 0;const s=e("@metamask/utils");n.Timer=class{constructor(e){(0,s.assert)(!Number.isNaN(e),new TypeError("Can't start a timer with NaN time")),(0,s.assert)(e>=0,new TypeError("Can't start a timer with negative time")),this.state={value:"stopped",remaining:e}}get status(){return this.state.value}get remaining(){return this.state.remaining}cancel(){(0,s.assert)("paused"===this.status||"running"===this.status,new Error("Tried to cancel a not running Timer")),this.onFinish(!1)}finish(){(0,s.assert)("finished"!==this.status,new Error("Tried to finish a finished Timer.")),this.onFinish(!0)}pause(){(0,s.assert)("running"===this.state.value,new Error("Tried to pause a not running Timer"));const{callback:e,start:t,timeout:n,remaining:r}=this.state;n!==undefined&&clearTimeout(n),this.state={value:"paused",callback:e,remaining:r-(Date.now()-t)}}start(e){(0,s.assert)("stopped"===this.state.value,new Error("Tried to start an already running Timer"));const{remaining:t}=this.state;this.state={value:"paused",remaining:t,callback:e},this.resume()}resume(){(0,s.assert)("paused"===this.state.value,new Error("Tried to resume not paused Timer"));const{remaining:e,callback:t}=this.state,n=Date.now();let r;e!==Number.POSITIVE_INFINITY&&(r=setTimeout((()=>this.onFinish(!0)),e)),this.state={value:"running",callback:t,remaining:e,start:n,timeout:r}}onFinish(e){(0,s.assert)("running"===this.state.value||"paused"===this.state.value),"running"===this.state.value&&this.state.timeout!==undefined&&clearTimeout(this.state.timeout);const{callback:t,remaining:n}=this.state;this.state={value:"finished",remaining:"running"===this.state.value?n-(Date.now()-this.state.start):n},e&&t()}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/Timer.cjs"}],[2587,{"@metamask/snaps-rpc-methods":2630},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LEGACY_ENCRYPTION_KEY_DERIVATION_OPTIONS=n.ALLOWED_PERMISSIONS=void 0;const s=e("@metamask/snaps-rpc-methods");n.ALLOWED_PERMISSIONS=Object.freeze(["snap_dialog","snap_manageState","snap_notify","snap_getLocale",s.SnapEndowments.Cronjob,s.SnapEndowments.HomePage,s.SnapEndowments.LifecycleHooks,s.SnapEndowments.EthereumProvider,s.SnapEndowments.TransactionInsight,s.SnapEndowments.SignatureInsight]),n.LEGACY_ENCRYPTION_KEY_DERIVATION_OPTIONS={algorithm:"PBKDF2",params:{iterations:1e4}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/constants.cjs"}],[2588,{"./SnapController.cjs":2585,"./location/index.cjs":2590,"./registry/index.cjs":2594,"./selectors.cjs":2597},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./location/index.cjs"),n),r(e("./SnapController.cjs"),n),r(e("./selectors.cjs"),n),r(e("./registry/index.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/index.cjs"}],[2589,{"@metamask/snaps-utils":2777,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.HttpLocation=void 0;const s=e("@metamask/snaps-utils"),r=e("@metamask/utils");n.HttpLocation=class{constructor(e,t={}){this.cache=new Map,(0,r.assertStruct)(e.toString(),s.HttpSnapIdStruct,"Invalid Snap Id: "),this.fetchFn=t.fetch??globalThis.fetch.bind(undefined),this.fetchOptions=t.fetchOptions,this.url=e}async manifest(){if(this.validatedManifest)return this.validatedManifest.clone();const e=new URL(s.NpmSnapFileNames.Manifest,this.url).toString(),t=await this.fetchFn(e,this.fetchOptions);if(!t.ok)throw new Error(`Failed to fetch "${e}". Status code: ${t.status}.`);const n=await t.text(),r=(0,s.parseJson)(n),i=new s.VirtualFile({value:n,result:(0,s.createSnapManifest)(r),path:s.NpmSnapFileNames.Manifest,data:{canonicalPath:e}});return this.validatedManifest=i,this.manifest()}async fetch(e){const t=(0,s.normalizeRelative)(e),n=this.cache.get(t);if(n!==undefined)return n.clone();const i=this.toCanonical(t).toString(),a=await this.fetchFn(i,this.fetchOptions);if(!a.ok)throw new Error(`Failed to fetch "${i}". Status code: ${a.status}.`);const o=await a.arrayBuffer(),c=new s.VirtualFile({value:new Uint8Array(o),path:t,data:{canonicalPath:i}});return(0,r.assert)(!this.cache.has(t),"Corrupted cache, multiple files with same path."),this.cache.set(t,c),this.fetch(t)}get root(){return new URL(this.url)}toCanonical(e){return(0,r.assert)(!e.startsWith("/"),"Tried to parse absolute path."),new URL(e,this.url)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/location/http.cjs"}],[259,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:76,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=76;const n=function(e){var t;if(e.CollectiblesController){const{allCollectibleContracts:t,allCollectibles:n,ignoredCollectibles:s,...r}=e.CollectiblesController;e.NftController={...t?{allNftContracts:t}:{},...n?{allNfts:n}:{},...s?{ignoredNfts:s}:{},...r},delete e.CollectiblesController}null!==(t=e.PreferencesController)&&void 0!==t&&t.useCollectibleDetection&&(e.PreferencesController.useNftDetection=e.PreferencesController.useCollectibleDetection,delete e.PreferencesController.useCollectibleDetection);return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/076.js"}],[2590,{"./http.cjs":2589,"./local.cjs":2591,"./location.cjs":2592,"./npm.cjs":2593},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./location.cjs"),n),r(e("./npm.cjs"),n),r(e("./local.cjs"),n),r(e("./http.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/location/index.cjs"}],[2591,{"./http.cjs":2589,"@metamask/snaps-utils":2777,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.LocalLocation=void 0;const a=e("@metamask/snaps-utils"),o=e("@metamask/utils"),c=e("./http.cjs");function l(e){return(0,o.assert)(e.data.canonicalPath!==undefined),e.data.canonicalPath=`local:${e.data.canonicalPath}`,e}n.LocalLocation=class{constructor(e,t={}){s.set(this,void 0),(0,o.assertStruct)(e.toString(),a.LocalSnapIdStruct,"Invalid Snap Id"),(0,o.assert)(t.fetchOptions===undefined,"Currently adding fetch options to local: is unsupported."),r(this,s,new c.HttpLocation(new URL(e.toString().slice(a.SnapIdPrefixes.local.length)),{...t,fetchOptions:{cache:"no-cache"}}),"f")}async manifest(){return l(await i(this,s,"f").manifest())}async fetch(e){return l(await i(this,s,"f").fetch(e))}get shouldAlwaysReload(){return!0}},s=new WeakMap}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/location/local.cjs"}],[2592,{"./http.cjs":2589,"./local.cjs":2591,"./npm.cjs":2593,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.detectSnapLocation=void 0;const s=e("@metamask/utils"),r=e("./http.cjs"),i=e("./local.cjs"),a=e("./npm.cjs");n.detectSnapLocation=function(e,t){const n=t?.allowHttp??!1,o=t?.allowLocal??!1,c=new URL(e);switch(c.protocol){case"npm:":return new a.NpmLocation(c,t);case"local:":return(0,s.assert)(o,new TypeError("Fetching local snaps is disabled.")),new i.LocalLocation(c,t);case"http:":case"https:":return(0,s.assert)(n,new TypeError("Fetching snaps through http/https is disabled.")),new r.HttpLocation(c,t);default:throw new TypeError(`Unrecognized "${c.protocol}" snap location protocol.`)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/location/location.cjs"}],[2593,{"@metamask/snaps-utils":2777,"@metamask/utils":2874,"browserify-zlib":3992,"concat-stream":2599,"get-npm-tarball-url":4404,"readable-stream":5198,"readable-web-to-node-stream":5199,"tar-stream":2603},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},c=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getNpmCanonicalBasePath=n.fetchNpmMetadata=n.NpmLocation=n.TARBALL_SIZE_SAFETY_LIMIT=n.BaseNpmLocation=n.DEFAULT_NPM_REGISTRY=void 0;const u=e("@metamask/snaps-utils"),d=e("@metamask/utils"),h=e("browserify-zlib"),f=l(e("concat-stream")),p=l(e("get-npm-tarball-url")),m=e("readable-stream"),g=e("readable-web-to-node-stream"),y=e("tar-stream");n.DEFAULT_NPM_REGISTRY=new URL("https://registry.npmjs.org");class w{constructor(e,t={}){s.add(this),r.set(this,void 0),i.set(this,void 0);const a=t.allowCustomRegistries??!1,o=t.fetch??globalThis.fetch.bind(undefined),c=t.versionRange??u.DEFAULT_REQUESTED_SNAP_VERSION,l=t.resolveVersion??(async e=>e);let h;(0,d.assertStruct)(e.toString(),u.NpmSnapIdStruct,"Invalid Snap Id: "),""===e.host&&""===e.port&&""===e.username&&""===e.password?h=n.DEFAULT_NPM_REGISTRY:(h="https://",e.username&&(h+=e.username,e.password&&(h+=`:${e.password}`),h+="@"),h+=e.host,h=new URL(h),(0,d.assert)(a,new TypeError(`Custom NPM registries are disabled, tried to use "${h.toString()}".`))),(0,d.assert)("/"===h.pathname&&""===h.search&&""===h.hash),(0,d.assert)(""!==e.pathname&&"/"!==e.pathname,new TypeError("The package name in NPM location is empty."));let f=e.pathname;f.startsWith("/")&&(f=f.slice(1)),this.meta={requestedRange:c,registry:h,packageName:f,fetch:o,resolveVersion:l}}async manifest(){if(o(this,r,"f"))return o(this,r,"f").clone();const e=await this.fetch("snap.manifest.json"),t=(0,u.parseJson)(e.toString());return e.result=(0,u.createSnapManifest)(t),c(this,r,e,"f"),this.manifest()}async fetch(e){const t=(0,u.normalizeRelative)(e);o(this,i,"f")||(await o(this,s,"m",a).call(this),(0,d.assert)(o(this,i,"f")!==undefined));const n=o(this,i,"f").get(t);return(0,d.assert)(n!==undefined,new TypeError(`File "${e}" not found in package.`)),n.clone()}get packageName(){return this.meta.packageName}get version(){return(0,d.assert)(this.meta.version!==undefined,"Tried to access version without first fetching NPM package."),this.meta.version}get registry(){return this.meta.registry}get versionRange(){return this.meta.requestedRange}}n.BaseNpmLocation=w,r=new WeakMap,i=new WeakMap,s=new WeakSet,a=async function(){(0,d.assert)(o(this,i,"f")===undefined);const e=await this.meta.resolveVersion(this.meta.requestedRange),{tarballURL:t,targetVersion:n}=await async function(e,t,n,s){if(S(n)&&(0,d.isValidSemVerVersion)(t))return{tarballURL:(0,p.default)(e,t),targetVersion:t};const r=await b(e,n,s),i=Object.keys(r?.versions??{}).map((e=>((0,d.assertIsSemVerVersion)(e),e))),a=(0,u.getTargetVersion)(i,t);if(null===a)throw new Error(`Failed to find a matching version in npm metadata for package "${e}" and requested semver range "${t}".`);const o=r?.versions?.[a]?.dist?.tarball;return{tarballURL:o,targetVersion:a}}(this.meta.packageName,e,this.meta.registry,this.meta.fetch);if(!(0,u.isValidUrl)(t)||!t.toString().endsWith(".tgz"))throw new Error(`Failed to find valid tarball URL in NPM metadata for package "${this.meta.packageName}".`);const s=new URL(t);s.hostname=this.meta.registry.hostname,s.protocol=this.meta.registry.protocol;const r=await this.fetchNpmTarball(s);c(this,i,r,"f"),this.meta.version=n},n.TARBALL_SIZE_SAFETY_LIMIT=262144e3;async function b(e,t,n){const s=await n(new URL(e,t).toString(),{headers:{accept:S(t)?"application/vnd.npm.install-v1+json; q=1.0, application/json; q=0.8, */*":"application/json"}});if(!s.ok)throw new Error(`Failed to fetch NPM registry entry. Status code: ${s.status}.`);const r=await s.json();if(!(0,d.isObject)(r))throw new Error(`Failed to fetch package "${e}" metadata from npm.`);return r}function v(e,t){let n="npm://";return""!==e.username&&(n+=e.username,""!==e.password&&(n+=`:${e.password}`),n+="@"),`${n}${e.host}/${t}/`}function S(e){return e.toString()===n.DEFAULT_NPM_REGISTRY.toString()}n.NpmLocation=class extends w{async fetchNpmTarball(e){const t=await this.meta.fetch(e.toString());if(!t.ok||!t.body)throw new Error(`Failed to fetch tarball for package "${this.meta.packageName}".`);const s=t.headers.get("content-length");(0,d.assert)(s,"Snap tarball has invalid content-length");const r=parseInt(s,10);return(0,d.assert)(r<=n.TARBALL_SIZE_SAFETY_LIMIT,"Snap tarball exceeds size limit"),new Promise(((e,s)=>{const r=new Map,i=function(e,t){(0,d.assert)(e.endsWith("/"),"Base needs to end with '/' for relative paths to be added as children instead of siblings."),(0,d.assert)(e.startsWith("npm:"),'Protocol mismatch, expected "npm:".');const s=(0,y.extract)();let r=0;return s.on("entry",((i,a,o)=>{const{name:c,type:l}=i;if("file"===l){const i=c.replace(k,"");return a.pipe((0,f.default)({encoding:"uint8array"},(a=>{try{r+=a.byteLength,(0,d.assert)(r<n.TARBALL_SIZE_SAFETY_LIMIT,`Snap tarball exceeds limit of ${n.TARBALL_SIZE_SAFETY_LIMIT} bytes.`);const s=new u.VirtualFile({value:a,path:i,data:{canonicalPath:new URL(i,e).toString()}});return(0,d.assert)(!t.has(i),"Malformed tarball, multiple files with the same path."),t.set(i,s),o()}catch(e){return s.destroy(e)}})))}return a.on("end",(()=>o())),a.resume()})),s}(v(this.meta.registry,this.meta.packageName),r),a=t.body;if("pipeThrough"in a&&"DecompressionStream"in globalThis){const t=new DecompressionStream("gzip"),n=a.pipeThrough(t);(0,m.pipeline)(T(n),i,(t=>{t?s(t):e(r)}))}else(0,m.pipeline)(T(a),(0,h.createGunzip)(),i,(t=>{t?s(t):e(r)}))}))}},n.fetchNpmMetadata=b,n.getNpmCanonicalBasePath=v;const k=/^package\//u;function T(e){return"function"!=typeof e.getReader?e:new g.ReadableWebToNodeStream(e)}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/location/npm.cjs"}],[2594,{"./json.cjs":2595,"./registry.cjs":2596},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),r(e("./registry.cjs"),n),r(e("./json.cjs"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/registry/index.cjs"}],[2595,{"./registry.cjs":2596,"@metamask/base-controller":1332,"@metamask/snaps-registry":2609,"@metamask/snaps-utils":2777,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s,r,i,a,o,c,l,u,d,h,f,p,m,g,y,w,b,v=this&&this.__classPrivateFieldSet||function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},S=this&&this.__classPrivateFieldGet||function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.JsonSnapsRegistry=void 0;const k=e("@metamask/base-controller"),T=e("@metamask/snaps-registry"),_=e("@metamask/snaps-utils"),C=e("@metamask/utils"),E=e("./registry.cjs"),P={database:null,lastUpdated:null,databaseUnavailable:!1};class j extends k.BaseController{constructor({messenger:e,state:t,url:n={registry:"https://acl.execution.metamask.io/latest/registry.json",signature:"https://acl.execution.metamask.io/latest/signature.json"},publicKey:u="0x025b65308f0f0fb8bc7f7ff87bfc296e0330eee5d3c1d1ee4a048b2fd6a86fa0a6",fetchFunction:h=globalThis.fetch.bind(undefined),recentFetchThreshold:f=(0,C.inMilliseconds)(5,C.Duration.Minute),refetchOnAllowlistMiss:p=!0}){super({messenger:e,metadata:{database:{persist:!0,anonymous:!1},lastUpdated:{persist:!0,anonymous:!1},databaseUnavailable:{persist:!0,anonymous:!1}},name:"SnapsRegistry",state:{...P,...t}}),s.add(this),r.set(this,void 0),i.set(this,void 0),a.set(this,void 0),o.set(this,void 0),c.set(this,void 0),l.set(this,void 0),v(this,r,n,"f"),v(this,i,u,"f"),v(this,a,h,"f"),v(this,o,f,"f"),v(this,c,p,"f"),v(this,l,null,"f"),this.messagingSystem.registerActionHandler("SnapsRegistry:get",(async(...e)=>S(this,s,"m",m).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:getMetadata",(async(...e)=>S(this,s,"m",y).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:resolveVersion",(async(...e)=>S(this,s,"m",g).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:update",(async()=>S(this,s,"m",d).call(this)))}}n.JsonSnapsRegistry=j,r=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,s=new WeakSet,u=function(){return this.state.lastUpdated&&Date.now()-this.state.lastUpdated<S(this,o,"f")},d=async function(){S(this,l,"f")?await S(this,l,"f"):(null===S(this,l,"f")&&v(this,l,S(this,s,"m",h).call(this),"f"),await S(this,l,"f"),v(this,l,null,"f"))},h=async function(){if(!S(this,s,"m",u).call(this))try{const e=await S(this,s,"m",b).call(this,S(this,r,"f").registry),t=await S(this,s,"m",b).call(this,S(this,r,"f").signature);S(this,s,"m",w).call(this,e,t),this.update((t=>{t.database=JSON.parse(e),t.lastUpdated=Date.now(),t.databaseUnavailable=!1}))}catch{this.update((e=>{e.databaseUnavailable=!0}))}},f=async function(){return null===this.state.database&&await S(this,s,"m",d).call(this),this.state.database},p=async function e(t,n,r=!1){const i=await S(this,s,"m",f).call(this),a=i?.blockedSnaps.find((e=>"id"in e?e.id===t&&(0,C.satisfiesVersionRange)(n.version,e.versionRange):e.checksum===n.checksum));if(a)return{status:E.SnapsRegistryStatus.Blocked,reason:a.reason};const o=i?.verifiedSnaps[t],l=o?.versions?.[n.version];return l&&l.checksum===n.checksum?{status:E.SnapsRegistryStatus.Verified}:S(this,c,"f")&&!r?(await S(this,s,"m",d).call(this),S(this,s,"m",e).call(this,t,n,!0)):{status:this.state.databaseUnavailable?E.SnapsRegistryStatus.Unavailable:E.SnapsRegistryStatus.Unverified}},m=async function(e){return Object.entries(e).reduce((async(e,[t,n])=>{const r=await S(this,s,"m",p).call(this,t,n),i=await e;return i[t]=r,i}),Promise.resolve({}))},g=async function e(t,n,r=!1){const i=await S(this,s,"m",f).call(this),a=i?.verifiedSnaps[t]?.versions??null;if(!a&&S(this,c,"f")&&!r)return await S(this,s,"m",d).call(this),S(this,s,"m",e).call(this,t,n,!0);if(!a)return n;const o=(0,_.getTargetVersion)(Object.keys(a),n);return o||!S(this,c,"f")||r?o?((0,C.assertIsSemVerRange)(o),o):n:(await S(this,s,"m",d).call(this),S(this,s,"m",e).call(this,t,n,!0))},y=async function(e){const t=await S(this,s,"m",f).call(this);return t?.verifiedSnaps[e]?.metadata??null},w=function(e,t){(0,C.assert)(S(this,i,"f"),"No public key provided.");const n=(0,T.verify)({registry:e,signature:JSON.parse(t),publicKey:S(this,i,"f")});(0,C.assert)(n,"Invalid registry signature.")},b=async function(e){const t=await S(this,a,"f").call(this,e);if(!t.ok)throw new Error(`Failed to fetch ${e}.`);return await t.text()}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/registry/json.cjs"}],[2596,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s;Object.defineProperty(n,"__esModule",{value:!0}),n.SnapsRegistryStatus=void 0,function(e){e[e.Unverified=0]="Unverified",e[e.Blocked=1]="Blocked",e[e.Verified=2]="Verified",e[e.Unavailable=3]="Unavailable"}(s||(n.SnapsRegistryStatus=s={}))}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/registry/registry.cjs"}],[2597,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRunnableSnaps=void 0;n.getRunnableSnaps=e=>e.filter((e=>e.enabled&&!e.blocked))}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/snaps/selectors.cjs"}],[2598,{"./snaps/Timer.cjs":2586,"@metamask/snaps-sdk":2676,"@metamask/snaps-utils":2777,"fast-deep-equal":4351},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.fetchSnap=n.getSnapFiles=n.withTimeout=n.hasTimedOut=n.delayWithTimer=n.delay=n.permissionsDiff=n.setDiff=void 0;const r=e("@metamask/snaps-sdk"),i=e("@metamask/snaps-utils"),a=s(e("fast-deep-equal")),o=e("./snaps/Timer.cjs");function c(e,t){let n;const s=new Promise(((s,r)=>{e.start((()=>{t===undefined?s():s(t)})),n=r}));return s.cancel=()=>{"finished"!==e.status&&(e.cancel(),n(new Error("The delay has been canceled.")))},s}async function l(e,t){return t&&0!==t.length?await Promise.all(t.map((async t=>e.fetch(t)))):[]}n.setDiff=function(e,t){return Object.entries(e).reduce(((e,[n,s])=>(n in t||(e[n]=s),e)),{})},n.permissionsDiff=function(e,t){return Object.entries(e).reduce(((e,[n,s])=>{const r=n in t;return(!r||r&&!(0,a.default)(s.caveats??[],t[n].caveats??[]))&&(e[n]=s),e}),{})},n.delay=function(e,t){return c(new o.Timer(e),t)},n.delayWithTimer=c,n.hasTimedOut=Symbol("Used to check if the requested promise has timeout (see withTimeout)"),n.withTimeout=async function(e,t){const s=c("number"==typeof t?new o.Timer(t):t,n.hasTimedOut);try{return await Promise.race([e,s])}finally{s.cancel()}},n.getSnapFiles=l,n.fetchSnap=async function(e,t){try{const e=await t.manifest(),n=await t.fetch(e.result.source.location.npm.filePath);(0,r.assert)(n.size<i.MAX_FILE_SIZE,"Snap source code must be smaller than 64 MB.");const{iconPath:s}=e.result.source.location.npm,a=s?await t.fetch(s):undefined,o=await l(t,e.result.source.files);(0,i.validateAuxiliaryFiles)(o),await Promise.all(o.map((async e=>{e.data.base64=await(0,i.encodeBase64)(e)})));const c=await l(t,e.result.source.locales),u={manifest:e,sourceCode:n,svgIcon:a,auxiliaryFiles:o,localizationFiles:(0,i.getValidatedLocalizationFiles)(c)};return await(0,i.validateFetchedSnap)(u),u}catch(t){throw new Error(`Failed to fetch snap "${e}": ${(0,r.getErrorMessage)(t)}.`)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/utils.cjs"}],[2599,{buffer:3998,"buffer-from":4003,inherits:4574,"readable-stream":5198,typedarray:5541},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var s=e("readable-stream").Writable,r=e("inherits"),i=e("buffer-from");if("undefined"==typeof Uint8Array)var a=e("typedarray").Uint8Array;else a=Uint8Array;function o(e,t){if(!(this instanceof o))return new o(e,t);"function"==typeof e&&(t=e,e={}),e||(e={});var n=e.encoding,r=!1;n?"u8"!==(n=String(n).toLowerCase())&&"uint8"!==n||(n="uint8array"):r=!0,s.call(this,{objectMode:!0}),this.encoding=n,this.shouldInferEncoding=r,t&&this.on("finish",(function(){t(this.getBody())})),this.body=[]}t.exports=o,r(o,s),o.prototype._write=function(e,t,n){this.body.push(e),n()},o.prototype.inferEncoding=function(e){var t=e===undefined?this.body[0]:e;return n.isBuffer(t)?"buffer":"undefined"!=typeof Uint8Array&&t instanceof Uint8Array?"uint8array":Array.isArray(t)?"array":"string"==typeof t?"string":"[object Object]"===Object.prototype.toString.call(t)?"object":"buffer"},o.prototype.getBody=function(){return this.encoding||0!==this.body.length?(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),"array"===this.encoding?function(e){for(var t=[],n=0;n<e.length;n++)t.push.apply(t,e[n]);return t}(this.body):"string"===this.encoding?function(e){for(var t=[],s=0;s<e.length;s++){var r=e[s];"string"==typeof r||n.isBuffer(r)?t.push(r):c(r)?t.push(i(r)):t.push(i(String(r)))}t=n.isBuffer(e[0])?(t=n.concat(t)).toString("utf8"):t.join("");return t}(this.body):"buffer"===this.encoding?function(e){for(var t=[],s=0;s<e.length;s++){var r=e[s];n.isBuffer(r)?t.push(r):c(r)?t.push(i(r)):t.push(i(String(r)))}return n.concat(t)}(this.body):"uint8array"===this.encoding?function(e){for(var t=0,n=0;n<e.length;n++)"string"==typeof e[n]&&(e[n]=i(e[n])),t+=e[n].length;for(var s=new a(t),r=(n=0,0);n<e.length;n++)for(var o=e[n],c=0;c<o.length;c++)s[r++]=o[c];return s}(this.body):this.body):[]};Array.isArray;function c(e){return"string"==typeof e||(t=e,/Array\]$/.test(Object.prototype.toString.call(t)))||e&&"function"==typeof e.subarray;var t}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>concat-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/concat-stream/index.js"}],[26,{"./cronjob-controller-messenger":24,"./execution-service-messenger":25,"./rate-limit-controller-messenger":27,"./snap-controller-messenger":28,"./snap-insights-controller-messenger":29,"./snap-interface-controller-messenger":30,"./snaps-registry-messenger":31},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getCronjobControllerMessenger",{enumerable:!0,get:function(){return s.getCronjobControllerMessenger}}),Object.defineProperty(n,"getExecutionServiceMessenger",{enumerable:!0,get:function(){return r.getExecutionServiceMessenger}}),Object.defineProperty(n,"getRateLimitControllerInitMessenger",{enumerable:!0,get:function(){return i.getRateLimitControllerInitMessenger}}),Object.defineProperty(n,"getRateLimitControllerMessenger",{enumerable:!0,get:function(){return i.getRateLimitControllerMessenger}}),Object.defineProperty(n,"getSnapControllerInitMessenger",{enumerable:!0,get:function(){return a.getSnapControllerInitMessenger}}),Object.defineProperty(n,"getSnapControllerMessenger",{enumerable:!0,get:function(){return a.getSnapControllerMessenger}}),Object.defineProperty(n,"getSnapInsightsControllerMessenger",{enumerable:!0,get:function(){return o.getSnapInsightsControllerMessenger}}),Object.defineProperty(n,"getSnapInterfaceControllerMessenger",{enumerable:!0,get:function(){return c.getSnapInterfaceControllerMessenger}}),Object.defineProperty(n,"getSnapsRegistryMessenger",{enumerable:!0,get:function(){return l.getSnapsRegistryMessenger}});var s=e("./cronjob-controller-messenger"),r=e("./execution-service-messenger"),i=e("./rate-limit-controller-messenger"),a=e("./snap-controller-messenger"),o=e("./snap-insights-controller-messenger"),c=e("./snap-interface-controller-messenger"),l=e("./snaps-registry-messenger")}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/index.ts"}],[260,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){(0,s.hasProperty)(e,"PreferencesController")&&(0,s.isObject)(e.PreferencesController)&&(0,s.hasProperty)(e.PreferencesController,"frequentRpcListDetail")&&(0,s.isObject)(e.NetworkController)&&(0,s.hasProperty)(e.NetworkController,"networkConfigurations")&&delete e.PreferencesController.frequentRpcListDetail;return{...e}};var s=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-082.ts"}],[2600,{fs:3963},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s={S_IFMT:61440,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960};try{t.exports=e("fs").constants||s}catch{t.exports=s}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/tar-stream/constants.js"}],[2601,{"./headers":2602,b4a:3892,"fast-fifo":4353,streamx:5520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{Writable:s,Readable:r,getStreamError:i}=e("streamx"),a=e("fast-fifo"),o=e("b4a"),c=e("./headers"),l=o.alloc(0);class u{constructor(){this.buffered=0,this.shifted=0,this.queue=new a,this._offset=0}push(e){this.buffered+=e.byteLength,this.queue.push(e)}shiftFirst(e){return 0===this._buffered?null:this._next(e)}shift(e){if(e>this.buffered)return null;if(0===e)return l;let t=this._next(e);if(e===t.byteLength)return t;const n=[t];for(;(e-=t.byteLength)>0;)t=this._next(e),n.push(t);return o.concat(n)}_next(e){const t=this.queue.peek(),n=t.byteLength-this._offset;if(e>=n){const e=this._offset?t.subarray(this._offset,t.byteLength):t;return this.queue.shift(),this._offset=0,this.buffered-=n,this.shifted+=n,e}return this.buffered-=e,this.shifted+=e,t.subarray(this._offset,this._offset+=e)}}class d extends r{constructor(e,t,n){super(),this.header=t,this.offset=n,this._parent=e}_read(e){0===this.header.size&&this.push(null),this._parent._stream===this&&this._parent._update(),e(null)}_predestroy(){this._parent.destroy(i(this))}_detach(){this._parent._stream===this&&(this._parent._stream=null,this._parent._missing=p(this.header.size),this._parent._update())}_destroy(e){this._detach(),e(null)}}class h extends s{constructor(e){super(e),e||(e={}),this._buffer=new u,this._offset=0,this._header=null,this._stream=null,this._missing=0,this._longHeader=!1,this._callback=f,this._locked=!1,this._finished=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null,this._filenameEncoding=e.filenameEncoding||"utf-8",this._allowUnknownFormat=!!e.allowUnknownFormat,this._unlockBound=this._unlock.bind(this)}_unlock(e){if(this._locked=!1,e)return this.destroy(e),void this._continueWrite(e);this._update()}_consumeHeader(){if(this._locked)return!1;this._offset=this._buffer.shifted;try{this._header=c.decode(this._buffer.shift(512),this._filenameEncoding,this._allowUnknownFormat)}catch(e){return this._continueWrite(e),!1}if(!this._header)return!0;switch(this._header.type){case"gnu-long-path":case"gnu-long-link-path":case"pax-global-header":case"pax-header":return this._longHeader=!0,this._missing=this._header.size,!0}return this._locked=!0,this._applyLongHeaders(),0===this._header.size||"directory"===this._header.type?(this.emit("entry",this._header,this._createStream(),this._unlockBound),!0):(this._stream=this._createStream(),this._missing=this._header.size,this.emit("entry",this._header,this._stream,this._unlockBound),!0)}_applyLongHeaders(){this._gnuLongPath&&(this._header.name=this._gnuLongPath,this._gnuLongPath=null),this._gnuLongLinkPath&&(this._header.linkname=this._gnuLongLinkPath,this._gnuLongLinkPath=null),this._pax&&(this._pax.path&&(this._header.name=this._pax.path),this._pax.linkpath&&(this._header.linkname=this._pax.linkpath),this._pax.size&&(this._header.size=parseInt(this._pax.size,10)),this._header.pax=this._pax,this._pax=null)}_decodeLongHeader(e){switch(this._header.type){case"gnu-long-path":this._gnuLongPath=c.decodeLongPath(e,this._filenameEncoding);break;case"gnu-long-link-path":this._gnuLongLinkPath=c.decodeLongPath(e,this._filenameEncoding);break;case"pax-global-header":this._paxGlobal=c.decodePax(e);break;case"pax-header":this._pax=null===this._paxGlobal?c.decodePax(e):Object.assign({},this._paxGlobal,c.decodePax(e))}}_consumeLongHeader(){this._longHeader=!1,this._missing=p(this._header.size);const e=this._buffer.shift(this._header.size);try{this._decodeLongHeader(e)}catch(e){return this._continueWrite(e),!1}return!0}_consumeStream(){const e=this._buffer.shiftFirst(this._missing);if(null===e)return!1;this._missing-=e.byteLength;const t=this._stream.push(e);return 0===this._missing?(this._stream.push(null),t&&this._stream._detach(),t&&!1===this._locked):t}_createStream(){return new d(this,this._header,this._offset)}_update(){for(;this._buffer.buffered>0&&!this.destroying;)if(this._missing>0){if(null!==this._stream){if(!1===this._consumeStream())return;continue}if(!0===this._longHeader){if(this._missing>this._buffer.buffered)break;if(!1===this._consumeLongHeader())return!1;continue}const e=this._buffer.shiftFirst(this._missing);null!==e&&(this._missing-=e.byteLength)}else{if(this._buffer.buffered<512)break;if(null!==this._stream||!1===this._consumeHeader())return}this._continueWrite(null)}_continueWrite(e){const t=this._callback;this._callback=f,t(e)}_write(e,t){this._callback=t,this._buffer.push(e),this._update()}_final(e){this._finished=0===this._missing&&0===this._buffer.buffered,e(this._finished?null:new Error("Unexpected end of data"))}_predestroy(){this._continueWrite(null)}_destroy(e){this._stream&&this._stream.destroy(i(this)),e(null)}[Symbol.asyncIterator](){let e=null,t=null,n=null,s=null,r=null;const i=this;return this.on("entry",(function(e,i,a){r=a,i.on("error",f),t?(t({value:i,done:!1}),t=n=null):s=i})),this.on("error",(t=>{e=t})),this.on("close",(function(){if(a(e),!t)return;e?n(e):t({value:undefined,done:!0});t=n=null})),{[Symbol.asyncIterator](){return this},next:()=>new Promise(o),return:()=>c(null),throw:e=>c(e)};function a(e){if(!r)return;const t=r;r=null,t(e)}function o(r,o){return e?o(e):s?(r({value:s,done:!1}),void(s=null)):(t=r,n=o,a(null),void(i._finished&&t&&(t({value:undefined,done:!0}),t=n=null)))}function c(e){return i.destroy(e),a(e),new Promise(((t,n)=>{if(i.destroyed)return t({value:undefined,done:!0});i.once("close",(function(){e?n(e):t({value:undefined,done:!0})}))}))}}}function f(){}function p(e){return(e&=511)&&512-e}t.exports=function(e){return new h(e)}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/tar-stream/extract.js"}],[2602,{b4a:3892},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const s=e("b4a"),r="0000000000000000000",i="7777777777777777777",a="0".charCodeAt(0),o=s.from([117,115,116,97,114,0]),c=s.from([a,a]),l=s.from([117,115,116,97,114,32]),u=s.from([32,0]),d=257,h=263;function f(e,t,n,s){for(;n<s;n++)if(e[n]===t)return n;return s}function p(e){let t=256;for(let n=0;n<148;n++)t+=e[n];for(let n=156;n<512;n++)t+=e[n];return t}function m(e,t){return(e=e.toString(8)).length>t?i.slice(0,t)+" ":r.slice(0,t-e.length)+e+" "}function g(e,t,n){if(128&(e=e.subarray(t,t+n))[t=0])return function(e){let t;if(128===e[0])t=!0;else{if(255!==e[0])return null;t=!1}const n=[];let s;for(s=e.length-1;s>0;s--){const r=e[s];t?n.push(r):n.push(255-r)}let r=0;const i=n.length;for(s=0;s<i;s++)r+=n[s]*Math.pow(256,s);return t?r:-1*r}(e);{for(;t<e.length&&32===e[t];)t++;const n=(r=f(e,32,t,e.length),i=e.length,a=e.length,"number"!=typeof r?a:(r=~~r)>=i?i:r>=0||(r+=i)>=0?r:0);for(;t<n&&0===e[t];)t++;return n===t?0:parseInt(s.toString(e.subarray(t,n)),8)}var r,i,a}function y(e,t,n,r){return s.toString(e.subarray(t,f(e,0,t,t+n)),r)}function w(e){const t=s.byteLength(e);let n=Math.floor(Math.log(t)/Math.log(10))+1;return t+n>=Math.pow(10,n)&&n++,t+n+e}n.decodeLongPath=function(e,t){return y(e,0,e.length,t)},n.encodePax=function(e){let t="";e.name&&(t+=w(" path="+e.name+"\n")),e.linkname&&(t+=w(" linkpath="+e.linkname+"\n"));const n=e.pax;if(n)for(const e in n)t+=w(" "+e+"="+n[e]+"\n");return s.from(t)},n.decodePax=function(e){const t={};for(;e.length;){let n=0;for(;n<e.length&&32!==e[n];)n++;const r=parseInt(s.toString(e.subarray(0,n)),10);if(!r)return t;const i=s.toString(e.subarray(n+1,r-1)),a=i.indexOf("=");if(-1===a)return t;t[i.slice(0,a)]=i.slice(a+1),e=e.subarray(r)}return t},n.encode=function(e){const t=s.alloc(512);let n=e.name,r="";if(5===e.typeflag&&"/"!==n[n.length-1]&&(n+="/"),s.byteLength(n)!==n.length)return null;for(;s.byteLength(n)>100;){const e=n.indexOf("/");if(-1===e)return null;r+=r?"/"+n.slice(0,e):n.slice(0,e),n=n.slice(e+1)}return s.byteLength(n)>100||s.byteLength(r)>155||e.linkname&&s.byteLength(e.linkname)>100?null:(s.write(t,n),s.write(t,m(4095&e.mode,6),100),s.write(t,m(e.uid,6),108),s.write(t,m(e.gid,6),116),function(e,t,n){e.toString(8).length>11?function(e,t,n){t[n]=128;for(let s=11;s>0;s--)t[n+s]=255&e,e=Math.floor(e/256)}(e,t,n):s.write(t,m(e,11),n)}(e.size,t,124),s.write(t,m(e.mtime.getTime()/1e3|0,11),136),t[156]=a+function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0}(e.type),e.linkname&&s.write(t,e.linkname,157),s.copy(o,t,d),s.copy(c,t,263),e.uname&&s.write(t,e.uname,265),e.gname&&s.write(t,e.gname,297),s.write(t,m(e.devmajor||0,6),329),s.write(t,m(e.devminor||0,6),337),r&&s.write(t,r,345),s.write(t,m(p(t),6),148),t)},n.decode=function(e,t,n){let r=0===e[156]?0:e[156]-a,i=y(e,0,100,t);const c=g(e,100,8),f=g(e,108,8),m=g(e,116,8),w=g(e,124,12),b=g(e,136,12),v=function(e){switch(e){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null}(r),S=0===e[157]?null:y(e,157,100,t),k=y(e,265,32),T=y(e,297,32),_=g(e,329,8),C=g(e,337,8),E=p(e);if(256===E)return null;if(E!==g(e,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(function(e){return s.equals(o,e.subarray(d,263))}(e))e[345]&&(i=y(e,345,155,t)+"/"+i);else if(function(e){return s.equals(l,e.subarray(d,263))&&s.equals(u,e.subarray(h,265))}(e));else if(!n)throw new Error("Invalid tar header: unknown format.");return 0===r&&i&&"/"===i[i.length-1]&&(r=5),{name:i,mode:c,uid:f,gid:m,size:w,mtime:new Date(1e3*b),type:v,linkname:S,uname:k,gname:T,devmajor:_,devminor:C,pax:null}}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/tar-stream/headers.js"}],[2603,{"./extract":2601,"./pack":2604},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){n.extract=e("./extract"),n.pack=e("./pack")}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/tar-stream/index.js"}],[2604,{"./constants":2600,"./headers":2602,b4a:3892,streamx:5520},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){const{Readable:s,Writable:r,getStreamError:i}=e("streamx"),a=e("b4a"),o=e("./constants"),c=e("./headers"),l=a.alloc(1024);class u extends r{constructor(e,t,n){super({mapWritable:p,eagerOpen:!0}),this.written=0,this.header=t,this._callback=n,this._linkname=null,this._isLinkname="symlink"===t.type&&!t.linkname,this._isVoid="file"!==t.type&&"contiguous-file"!==t.type,this._finished=!1,this._pack=e,this._openCallback=null,null===this._pack._stream?this._pack._stream=this:this._pack._pending.push(this)}_open(e){this._openCallback=e,this._pack._stream===this&&this._continueOpen()}_continuePack(e){if(null===this._callback)return;const t=this._callback;this._callback=null,t(e)}_continueOpen(){null===this._pack._stream&&(this._pack._stream=this);const e=this._openCallback;if(this._openCallback=null,null!==e){if(this._pack.destroying)return e(new Error("pack stream destroyed"));if(this._pack._finalized)return e(new Error("pack stream is already finalized"));this._pack._stream=this,this._isLinkname||this._pack._encode(this.header),this._isVoid&&(this._finish(),this._continuePack(null)),e(null)}}_write(e,t){return this._isLinkname?(this._linkname=this._linkname?a.concat([this._linkname,e]):e,t(null)):this._isVoid?e.byteLength>0?t(new Error("No body allowed for this entry")):t():(this.written+=e.byteLength,this._pack.push(e)?t():void(this._pack._drain=t))}_finish(){this._finished||(this._finished=!0,this._isLinkname&&(this.header.linkname=this._linkname?a.toString(this._linkname,"utf-8"):"",this._pack._encode(this.header)),f(this._pack,this.header.size),this._pack._done(this))}_final(e){if(this.written!==this.header.size)return e(new Error("Size mismatch"));this._finish(),e(null)}_getError(){return i(this)||new Error("tar entry destroyed")}_predestroy(){this._pack.destroy(this._getError())}_destroy(e){this._pack._done(this),this._continuePack(this._finished?null:this._getError()),e()}}class d extends s{constructor(e){super(e),this._drain=h,this._finalized=!1,this._finalizing=!1,this._pending=[],this._stream=null}entry(e,t,n){if(this._finalized||this.destroying)throw new Error("already finalized or destroyed");"function"==typeof t&&(n=t,t=null),n||(n=h),e.size&&"symlink"!==e.type||(e.size=0),e.type||(e.type=function(e){switch(e&o.S_IFMT){case o.S_IFBLK:return"block-device";case o.S_IFCHR:return"character-device";case o.S_IFDIR:return"directory";case o.S_IFIFO:return"fifo";case o.S_IFLNK:return"symlink"}return"file"}(e.mode)),e.mode||(e.mode="directory"===e.type?493:420),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),"string"==typeof t&&(t=a.from(t));const s=new u(this,e,n);return a.isBuffer(t)?(e.size=t.byteLength,s.write(t),s.end(),s):(s._isVoid,s)}finalize(){this._stream||this._pending.length>0?this._finalizing=!0:this._finalized||(this._finalized=!0,this.push(l),this.push(null))}_done(e){e===this._stream&&(this._stream=null,this._finalizing&&this.finalize(),this._pending.length&&this._pending.shift()._continueOpen())}_encode(e){if(!e.pax){const t=c.encode(e);if(t)return void this.push(t)}this._encodePax(e)}_encodePax(e){const t=c.encodePax({name:e.name,linkname:e.linkname,pax:e.pax}),n={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.byteLength,mtime:e.mtime,type:"pax-header",linkname:e.linkname&&"PaxHeader",uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};this.push(c.encode(n)),this.push(t),f(this,t.byteLength),n.size=e.size,n.type=e.type,this.push(c.encode(n))}_doDrain(){const e=this._drain;this._drain=h,e()}_predestroy(){const e=i(this);for(this._stream&&this._stream.destroy(e);this._pending.length;){const t=this._pending.shift();t.destroy(e),t._continueOpen()}this._doDrain()}_read(e){this._doDrain(),e()}}function h(){}function f(e,t){(t&=511)&&e.push(l.subarray(0,512-t))}function p(e){return a.isBuffer(e)?e:a.from(e)}t.exports=function(e){return new d(e)}}}},{package:"@metamask/snaps-controllers>tar-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/tar-stream/pack.js"}],[2609,{"./verify":2610,"@metamask/superstruct":2799,"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){s===undefined&&(s=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,s,r)}:function(e,t,n,s){s===undefined&&(s=n),e[s]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapsRegistryDatabaseStruct=n.BlockedSnapStruct=n.BlockReasonStruct=n.VerifiedSnapStruct=n.ImagePathStruct=n.AdditionalSourceCodeStruct=n.SupportStruct=n.AuditStruct=n.AuthorStruct=void 0;const i=e("@metamask/superstruct"),a=e("@metamask/utils"),o=(0,i.refine)((0,i.string)(),"Npm ID",(e=>e.startsWith("npm:"))),c=(0,i.object)({checksum:a.ChecksumStruct});n.AuthorStruct=(0,i.object)({name:(0,i.string)(),website:(0,i.string)()}),n.AuditStruct=(0,i.object)({auditor:(0,i.string)(),report:(0,i.string)()}),n.SupportStruct=(0,i.object)({knowledgeBase:(0,i.optional)((0,i.string)()),faq:(0,i.optional)((0,i.string)()),contact:(0,i.optional)((0,i.string)()),keyRecovery:(0,i.optional)((0,i.string)())}),n.AdditionalSourceCodeStruct=(0,i.object)({name:(0,i.string)(),url:(0,i.string)()}),n.ImagePathStruct=(0,i.pattern)((0,i.string)(),/\.\/images\/.*\/\d+\.(?:png|jpe?g)$/u),n.VerifiedSnapStruct=(0,i.object)({id:o,metadata:(0,i.object)({name:(0,i.string)(),type:(0,i.optional)((0,i.enums)(["account"])),author:(0,i.optional)(n.AuthorStruct),website:(0,i.optional)((0,i.string)()),onboard:(0,i.optional)((0,i.boolean)()),summary:(0,i.optional)((0,i.string)()),description:(0,i.optional)((0,i.string)()),audits:(0,i.optional)((0,i.array)(n.AuditStruct)),category:(0,i.optional)((0,i.enums)(["interoperability","notifications","transaction insights","account management","name resolution"])),tags:(0,i.optional)((0,i.array)((0,i.string)())),support:(0,i.optional)(n.SupportStruct),sourceCode:(0,i.optional)((0,i.string)()),hidden:(0,i.optional)((0,i.boolean)()),privateCode:(0,i.optional)((0,i.boolean)()),privacyPolicy:(0,i.optional)((0,i.string)()),termsOfUse:(0,i.optional)((0,i.string)()),additionalSourceCode:(0,i.optional)((0,i.array)(n.AdditionalSourceCodeStruct)),screenshots:(0,i.optional)((0,i.size)((0,i.array)(n.ImagePathStruct),3,3))}),versions:(0,i.record)(a.VersionStruct,c)}),n.BlockReasonStruct=(0,i.object)({explanation:(0,i.optional)((0,i.string)()),url:(0,i.optional)((0,i.string)())}),n.BlockedSnapStruct=(0,i.union)([(0,i.object)({id:o,versionRange:a.VersionRangeStruct,reason:(0,i.optional)(n.BlockReasonStruct)}),(0,i.object)({checksum:a.ChecksumStruct,reason:(0,i.optional)(n.BlockReasonStruct)})]),n.SnapsRegistryDatabaseStruct=(0,i.object)({verifiedSnaps:(0,i.record)(o,n.VerifiedSnapStruct),blockedSnaps:(0,i.array)(n.BlockedSnapStruct)}),r(e("./verify"),n)}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/index.js"}],[261,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){(0,s.hasProperty)(e,"NetworkController")&&(0,s.isObject)(e.NetworkController)&&(0,s.hasProperty)(e.NetworkController,"network")&&(0,s.hasProperty)(e.NetworkController,"networkId")&&delete e.NetworkController.network;return{...e}};var s=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-084.ts"}],[2610,{"@metamask/superstruct":2799,"@metamask/utils":2874,"@noble/curves/secp256k1":2915,"@noble/hashes/sha256":2924},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.verify=n.SignatureStruct=void 0;const s=e("@metamask/superstruct"),r=e("@metamask/utils"),i=e("@noble/curves/secp256k1"),a=e("@noble/hashes/sha256");n.SignatureStruct=(0,s.object)({signature:r.StrictHexStruct,curve:(0,s.literal)("secp256k1"),format:(0,s.literal)("DER")}),n.verify=function({registry:e,signature:t,publicKey:s}){(0,r.assertStruct)(t,n.SignatureStruct,"Invalid signature object");const o=(0,r.hexToBytes)(s);return i.secp256k1.verify((0,r.remove0x)(t.signature),(0,a.sha256)((0,r.stringToBytes)(e)),o)}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/verify.js"}],[262,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){(0,s.hasProperty)(e,"NetworkController")&&(0,s.isObject)(e.NetworkController)&&(0,s.hasProperty)(e.NetworkController,"provider")&&(0,s.hasProperty)(e.NetworkController,"providerConfig")&&delete e.NetworkController.provider;return{...e}};var s=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-086.ts"}],[263,{"@metamask/utils":2874},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if((0,s.hasProperty)(e,"NftController")&&(0,s.isObject)(e.NftController)){const t=e.NftController;if((0,s.hasProperty)(t,"allNftContracts")&&(0,s.isObject)(t.allNftContracts)){const{allNftContracts:e}=t;Object.keys(e).every((t=>(0,s.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,s.isObject)(n)&&r(n))for(const e of Object.keys(n))(0,s.isStrictHexString)(e)||delete n[e]}))}if((0,s.hasProperty)(t,"allNfts")&&(0,s.isObject)(t.allNfts)){const{allNfts:e}=t;Object.keys(e).every((t=>(0,s.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,s.isObject)(n)&&r(n))for(const e of Object.keys(n))(0,s.isStrictHexString)(e)||delete n[e]}))}e.NftController=t}if((0,s.hasProperty)(e,"TokenListController")&&(0,s.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,s.hasProperty)(t,"tokensChainsCache")&&(0,s.isObject)(t.tokensChainsCache)&&r(t.tokensChainsCache))for(const e of Object.keys(t.tokensChainsCache))(0,s.isStrictHexString)(e)||delete t.tokensChainsCache[e]}if((0,s.hasProperty)(e,"TokensController")&&(0,s.isObject)(e.TokensController)){const t=e.TokensController;if((0,s.hasProperty)(t,"allTokens")&&(0,s.isObject)(t.allTokens)&&r(t.allTokens)){const{allTokens:e}=t;for(const n of Object.keys(e))(0,s.isStrictHexString)(n)||delete t.allTokens[n]}if((0,s.hasProperty)(t,"allIgnoredTokens")&&(0,s.isObject)(t.allIgnoredTokens)&&r(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const n of Object.keys(e))(0,s.isStrictHexString)(n)||delete t.allIgnoredTokens[n]}if((0,s.hasProperty)(t,"allDetectedTokens")&&(0,s.isObject)(t.allDetectedTokens)&&r(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const n of Object.keys(e))(0,s.isStrictHexString)(n)||delete t.allDetectedTokens[n]}e.TokensController=t}return e};var s=e("@metamask/utils");function r(e){return Object.keys(e).some((e=>(0,s.isStrictHexString)(e)))}}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-088.ts"}],[264,{"./077-supplements/077-supplement-for-082":260,"./077-supplements/077-supplement-for-084":261,"./077-supplements/077-supplement-for-086":262,"./077-supplements/077-supplement-for-088":263,"@metamask/utils":2874,lodash:4779,loglevel:4787},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash"),r=u(e("loglevel")),i=e("@metamask/utils"),a=u(e("./077-supplements/077-supplement-for-082")),o=u(e("./077-supplements/077-supplement-for-084")),c=u(e("./077-supplements/077-supplement-for-086")),l=u(e("./077-supplements/077-supplement-for-088"));function u(e){return e&&e.__esModule?e:{default:e}}n.default={version:77,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=77;let n=function(e){if(!(0,i.hasProperty)(e,"TokenListController"))return r.default.warn("Skipping migration, TokenListController state is missing"),e;var t,n;if(!(0,i.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,i.hasProperty)(e.TokenListController,"tokensChainsCache"))return r.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;const{TokenListController:s}=e,{tokensChainsCache:a}=s;let o,c;for(const e in a){var l,u;if(o=a[e].data||{},c={},Array.isArray(o))for(const e of o)c[e.address]=e;else if((null===(l=Object.keys(o)[0])||void 0===l?void 0:l.toLowerCase())!==(null===(u=o[Object.keys(o)[0]])||void 0===u||null===(u=u.address)||void 0===u?void 0:u.toLowerCase()))for(const e in o)c[o[e].address]=o[e];a[e].data=Object.keys(c).length>0?c:o}return s.tokensChainsCache=a,{...e,TokenListController:{...s}}}(t.data);return n=(0,a.default)(n),n=(0,o.default)(n),n=(0,c.default)(n),n=(0,l.default)(n),t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/077.js"}],[265,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if(!(0,r.hasProperty)(e,"PhishingController")||!(0,r.isObject)(e.PhishingController))return e;const{PhishingController:t}=e;return delete t.phishing,delete t.lastFetched,e}(t.data),t},n.version=void 0;var s=e("lodash"),r=e("@metamask/utils");const i=n.version=78}}},{package:"$root$",file:"app/scripts/migrations/078.ts"}],[266,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:79,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=79;const n=function(e){var t,n;(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.collectiblesDetectionNoticeDismissed)!==undefined&&delete e.AppStateController.collectiblesDetectionNoticeDismissed;(null==e||null===(n=e.metamask)||void 0===n?void 0:n.collectiblesDropdownState)!==undefined&&delete e.metamask.collectiblesDropdownState;return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/079.js"}],[267,{lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=e("lodash");n.default={version:80,async migrate(e){const t=(0,s.cloneDeep)(e);t.meta.version=80;const n=function(e){var t;(null==e||null===(t=e.metamask)||void 0===t?void 0:t.showPortfolioTooltip)!==undefined&&delete e.metamask.showPortfolioTooltip;return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/080.js"}],[268,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,s.cloneDeep)(e);t.meta.version=i;const n=function(e){if(!(0,r.hasProperty)(e,"SnapController")||!(0,r.hasProperty)(e,"PermissionController")||!(0,r.isObject)(e.PermissionController))return e;const{PermissionController:t}=e,{subjects:n}=t;if(!(0,r.isObject)(n))return e;const i="wallet_snap_";for(const[t,a]of Object.entries(n)){if(!(0,r.isObject)(a)||!(0,r.isObject)(a.permissions))return e;let n,o=1;const{permissions:c}=a,l={...c};for(const[a,u]of Object.entries(c))if(a.startsWith(i)){if(!(0,r.isObject)(u)||!(0,r.hasProperty)(u,"id")||!(0,r.hasProperty)(u,"date"))return e;if((0,r.hasProperty)(l,"wallet_snap")||(l.wallet_snap={caveats:[{type:"snapIds",value:{}}],invoker:t,parentCapability:"wallet_snap"}),!(0,r.isObject)(l.wallet_snap))return e;if(!(0,s.isArray)(l.wallet_snap.caveats))return e;const c=a.slice(i.length),d=l.wallet_snap.caveats[0];if(!(0,r.isObject)(d))return e;if(!(0,r.hasProperty)(d,"type")||"snapIds"!==d.type||!(0,r.hasProperty)(d,"value")||!(0,r.isObject)(d.value))return e;if(d.value[c]={},"number"!=typeof u.date||"string"!=typeof u.id)return e;u.date>o&&(o=u.date,n=u.id),delete l[a]}l.wallet_snap&&(l.wallet_snap.date=o,l.wallet_snap.id=n,a.permissions=l)}return e}(t.data);return t.data=n,t},n.version=void 0;var s=e("lodash"),r=e("@metamask/utils");const i=n.version=81}}},{package:"$root$",file:"app/scripts/migrations/081.ts"}],[269,{"@metamask/utils":2874,lodash:4779,loglevel:4787,uuid:5587},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=c,t.data=function(e){if(!(0,i.hasProperty)(e,"PreferencesController"))return o.default.warn("state.PreferencesController is undefined"),e;if(!(0,i.isObject)(e.PreferencesController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController)),e}if(!(0,i.hasProperty)(e,"NetworkController")||!(0,i.isObject)(e.NetworkController)){var s,r;return null===(s=global.sentry)||void 0===s||null===(r=s.captureException)||void 0===r||r.call(s,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,i.hasProperty)(e.PreferencesController,"frequentRpcListDetail")||!Array.isArray(e.PreferencesController.frequentRpcListDetail)){var c,l;if(!(e.NetworkController.networkConfigurations&&e.PreferencesController.frequentRpcListDetail===undefined))null===(c=global.sentry)||void 0===c||null===(l=c.captureException)||void 0===l||l.call(c,new Error("typeof state.PreferencesController.frequentRpcListDetail is "+typeof e.PreferencesController.frequentRpcListDetail));return e}if(!e.PreferencesController.frequentRpcListDetail.every(i.isObject)){var u,d;const t=e.PreferencesController.frequentRpcListDetail.find((e=>!(0,i.isObject)(e)));return null===(u=global.sentry)||void 0===u||null===(d=u.captureException)||void 0===d||d.call(u,new Error("state.PreferencesController.frequentRpcListDetail contains an element of type "+typeof t)),e}const{PreferencesController:h,NetworkController:f}=e,{frequentRpcListDetail:p}=h;if(!Array.isArray(p))return e;const m=p.reduce(((e,{rpcUrl:t,chainId:n,ticker:s,nickname:r,rpcPrefs:i})=>({...e,[(0,a.v4)()]:{rpcUrl:t,chainId:n,ticker:s,rpcPrefs:i,nickname:r}})),{});return delete h.frequentRpcListDetail,{...e,NetworkController:{...f,networkConfigurations:m},PreferencesController:{...h}}}(t.data),t},n.version=void 0;var s,r=e("lodash"),i=e("@metamask/utils"),a=e("uuid"),o=(s=e("loglevel"))&&s.__esModule?s:{default:s};const c=n.version=82}}},{package:"$root$",file:"app/scripts/migrations/082.ts"}],[27,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getRateLimitControllerInitMessenger=function(e){return e.getRestricted({name:"RateLimitController",allowedActions:["SubjectMetadataController:getState","NotificationServicesController:updateMetamaskNotificationsList"],allowedEvents:[]})},n.getRateLimitControllerMessenger=function(e){return e.getRestricted({name:"RateLimitController",allowedEvents:[],allowedActions:[]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/rate-limit-controller-messenger.ts"}],[270,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if(!(0,r.isObject)(e.NetworkController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}const{NetworkController:s}=e;if(!(0,r.isObject)(s.networkConfigurations)){var i,a;return null===(i=global.sentry)||void 0===i||null===(a=i.captureException)||void 0===a||a.call(i,new Error("typeof NetworkController.networkConfigurations is "+typeof s.networkConfigurations)),e}const{networkConfigurations:o}=s,c={};for(const t of Object.keys(o)){const n=o[t];if(!(0,r.isObject)(n))return e;c[t]={...n,id:t}}return{...e,NetworkController:{...s,networkConfigurations:c}}}(t.data),t},n.version=void 0;var s=e("lodash"),r=e("@metamask/utils");const i=n.version=83}}},{package:"$root$",file:"app/scripts/migrations/083.ts"}],[271,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if(!(0,r.hasProperty)(e,"NetworkController")||!(0,r.isObject)(e.NetworkController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,r.hasProperty)(e.NetworkController,"network")){var s,i;if(e.NetworkController.networkId===undefined)null===(s=global.sentry)||void 0===s||null===(i=s.captureException)||void 0===i||i.call(s,new Error("typeof state.NetworkController.network is "+typeof e.NetworkController.network));return e}const a={...e.NetworkController};"loading"===a.network?(a.networkId=null,a.networkStatus="unknown"):(a.networkId=a.network,a.networkStatus="available");return delete a.network,{...e,NetworkController:a}}(t.data),t},n.version=void 0;var s=e("lodash"),r=e("@metamask/utils");const i=n.version=84}}},{package:"$root$",file:"app/scripts/migrations/084.ts"}],[272,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if(!(0,r.isObject)(e.NetworkController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}return delete e.NetworkController.previousProviderStore,e}(t.data),t},n.version=void 0;var s=e("lodash"),r=e("@metamask/utils");const i=n.version=85}}},{package:"$root$",file:"app/scripts/migrations/085.ts"}],[273,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if((0,s.hasProperty)(e,"NetworkController")&&(0,s.isObject)(e.NetworkController)&&(0,s.hasProperty)(e.NetworkController,"provider")){const t=e.NetworkController;return t.providerConfig=t.provider,delete t.provider,{...e,NetworkController:t}}var t,n;if((0,s.isObject)(e.NetworkController)){if(!(0,s.hasProperty)(e.NetworkController,"provider")){var r,i;if(e.NetworkController.providerConfig===undefined)null===(r=global.sentry)||void 0===r||null===(i=r.captureException)||void 0===i||i.call(r,new Error("typeof state.NetworkController.provider is "+typeof e.NetworkController.provider))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var s=e("@metamask/utils"),r=e("lodash");const i=n.version=86}}},{package:"$root$",file:"app/scripts/migrations/086.ts"}],[274,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if(!(0,s.isObject)(e.TokensController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.TokensController is "+typeof e.TokensController)),e}return delete e.TokensController.suggestedAssets,e}(t.data),t},n.version=void 0;var s=e("@metamask/utils"),r=e("lodash");const i=n.version=87}}},{package:"$root$",file:"app/scripts/migrations/087.ts"}],[275,{"@metamask/utils":2874,"bn.js":3950,lodash:4779,loglevel:4787},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=c,function(e){if((0,s.hasProperty)(e,"NftController")&&(0,s.isObject)(e.NftController)){const c=e.NftController;if((0,s.hasProperty)(c,"allNftContracts")&&(0,s.isObject)(c.allNftContracts)){const{allNftContracts:e}=c;Object.keys(e).every((t=>(0,s.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,s.isObject)(n)){for(const e of Object.keys(n))"undefined"!==e&&e!==undefined&&"null"!==e||delete n[e];e[t]=(0,i.mapKeys)(n,((e,t)=>l(t)))}}))}else if((0,s.hasProperty)(c,"allNftContracts")){var t,n;null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NftController.allNftContracts is "+typeof c.allNftContracts))}else a.default.warn("typeof state.NftController.allNftContracts is "+typeof c.allNftContracts);if((0,s.hasProperty)(c,"allNfts")&&(0,s.isObject)(c.allNfts)){const{allNfts:e}=c;Object.keys(e).every((t=>(0,s.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,s.isObject)(n)){for(const e of Object.keys(n))"undefined"!==e&&e!==undefined&&"null"!==e||delete n[e];e[t]=(0,i.mapKeys)(n,((e,t)=>l(t)))}}))}else if((0,s.hasProperty)(c,"allNfts")){var r,o;null===(r=global.sentry)||void 0===r||null===(o=r.captureException)||void 0===o||o.call(r,new Error("typeof state.NftController.allNfts is "+typeof c.allNfts))}else a.default.warn("typeof state.NftController.allNfts is "+typeof c.allNfts);e.NftController=c}else if((0,s.hasProperty)(e,"NftController")){var c,u;null===(c=global.sentry)||void 0===c||null===(u=c.captureException)||void 0===u||u.call(c,new Error("typeof state.NftController is "+typeof e.NftController))}else a.default.warn("typeof state.NftController is undefined");if((0,s.hasProperty)(e,"TokenListController")&&(0,s.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,s.hasProperty)(t,"tokensChainsCache")&&(0,s.isObject)(t.tokensChainsCache)){for(const e of Object.keys(t.tokensChainsCache))"undefined"!==e&&e!==undefined&&"null"!==e||delete t.tokensChainsCache[e];t.tokensChainsCache=(0,i.mapKeys)(t.tokensChainsCache,((e,t)=>l(t)))}else if((0,s.hasProperty)(t,"tokensChainsCache")){var d,h;null===(d=global.sentry)||void 0===d||null===(h=d.captureException)||void 0===h||h.call(d,new Error("typeof state.TokenListController.tokensChainsCache is "+typeof e.TokenListController.tokensChainsCache))}else a.default.warn("typeof state.TokenListController.tokensChainsCache is undefined")}else a.default.warn("typeof state.TokenListController is "+typeof e.TokenListController);if((0,s.hasProperty)(e,"TokensController")&&(0,s.isObject)(e.TokensController)){const t=e.TokensController;if((0,s.hasProperty)(t,"allTokens")&&(0,s.isObject)(t.allTokens)){const{allTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allTokens=(0,i.mapKeys)(e,((e,t)=>l(t)))}else if((0,s.hasProperty)(t,"allTokens")){var f,p;null===(f=global.sentry)||void 0===f||null===(p=f.captureException)||void 0===p||p.call(f,new Error("typeof state.TokensController.allTokens is "+typeof t.allTokens))}else a.default.warn("typeof state.TokensController.allTokens is "+typeof t.allTokens);if((0,s.hasProperty)(t,"allIgnoredTokens")&&(0,s.isObject)(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allIgnoredTokens=(0,i.mapKeys)(e,((e,t)=>l(t)))}else if((0,s.hasProperty)(t,"allIgnoredTokens")){var m,g;null===(m=global.sentry)||void 0===m||null===(g=m.captureException)||void 0===g||g.call(m,new Error("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens))}else a.default.warn("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens);if((0,s.hasProperty)(t,"allDetectedTokens")&&(0,s.isObject)(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined&&"null"!==t||delete e[t];t.allDetectedTokens=(0,i.mapKeys)(e,((e,t)=>l(t)))}else if((0,s.hasProperty)(t,"allDetectedTokens")){var y,w;null===(y=global.sentry)||void 0===y||null===(w=y.captureException)||void 0===w||w.call(y,new Error("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens))}else a.default.warn("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens);e.TokensController=t}else{var b,v;null===(b=global.sentry)||void 0===b||null===(v=b.captureException)||void 0===v||v.call(b,new Error("typeof state.TokensController is "+typeof e.TokensController))}}(t.data),t},n.version=void 0;var s=e("@metamask/utils"),r=o(e("bn.js")),i=e("lodash"),a=o(e("loglevel"));function o(e){return e&&e.__esModule?e:{default:e}}const c=n.version=88;function l(e){if("string"==typeof e&&(0,s.isStrictHexString)(e))return e;return`0x${r.default.isBN(e)?e.toString(16):new r.default(e.toString(10),10).toString(16)}`}}}},{package:"$root$",file:"app/scripts/migrations/088.ts"}],[276,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if((0,s.hasProperty)(e,"NetworkController")&&(0,s.isObject)(e.NetworkController)&&(0,s.hasProperty)(e.NetworkController,"providerConfig")&&(0,s.isObject)(e.NetworkController.providerConfig)){const{networkConfigurations:t,providerConfig:n}=e.NetworkController;if(!(0,s.isObject)(t))return e;if(n.id)return e;let r;for(const i of Object.keys(t)){const a=t[i];if(!(0,s.isObject)(a))return e;if(a.rpcUrl===n.rpcUrl){r=a.id;break}}return r?(e.NetworkController.providerConfig={...n,id:r},{...e,NetworkController:e.NetworkController}):e}var t,n;if((0,s.isObject)(e.NetworkController)){if(!(0,s.isObject)(e.NetworkController.providerConfig)){var r,i;null===(r=global.sentry)||void 0===r||null===(i=r.captureException)||void 0===i||i.call(r,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var s=e("@metamask/utils"),r=e("lodash");const i=n.version=89}}},{package:"$root$",file:"app/scripts/migrations/089.ts"}],[277,{"@metamask/utils":2874,lodash:4779,loglevel:4787},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if(!(0,i.hasProperty)(e,"PhishingController"))return a.default.warn("typeof state.PhishingController is undefined"),e;if(!(0,i.isObject)(e.PhishingController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController)),e}if(!(0,i.hasProperty)(e.PhishingController,"listState"))return a.default.warn("typeof state.PhishingController.listState is "+typeof e.PhishingController),e;return delete e.PhishingController.listState,e}(t.data),t},n.version=void 0;var s,r=e("lodash"),i=e("@metamask/utils"),a=(s=e("loglevel"))&&s.__esModule?s:{default:s};const o=n.version=90}}},{package:"$root$",file:"app/scripts/migrations/090.ts"}],[278,{"@metamask/utils":2874,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,t.data=function(e){if((0,s.hasProperty)(e,"NetworkController")&&(0,s.isObject)(e.NetworkController)&&(0,s.hasProperty)(e.NetworkController,"networkConfigurations")&&(0,s.isObject)(e.NetworkController.networkConfigurations)){const{networkConfigurations:t}=e.NetworkController;for(const[e,n]of Object.entries(t))(0,s.isObject)(n)&&(n.chainId||delete t[e]);return e.NetworkController={...e.NetworkController,networkConfigurations:t},{...e,NetworkController:e.NetworkController}}var t,n;if((0,s.isObject)(e.NetworkController)){if(!(0,s.isObject)(e.NetworkController.networkConfigurations)){var r,i;null===(r=global.sentry)||void 0===r||null===(i=r.captureException)||void 0===i||i.call(r,new Error("typeof state.NetworkController.networkConfigurations is "+typeof e.NetworkController.networkConfigurations))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var s=e("@metamask/utils"),r=e("lodash");const i=n.version=91}}},{package:"$root$",file:"app/scripts/migrations/091.ts"}],[279,{"@metamask/utils":2874,lodash:4779,loglevel:4787},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if(!(0,i.hasProperty)(e,"TokenListController"))return a.default.warn("Skipping migration, TokenListController state is missing"),e;var t,n;if(!(0,i.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,i.hasProperty)(e.TokenListController,"tokensChainsCache"))return a.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;e.TokenListController.tokensChainsCache===undefined&&delete e.TokenListController.tokensChainsCache;return e}(t.data),t},n.version=void 0;var s,r=e("lodash"),i=e("@metamask/utils"),a=(s=e("loglevel"))&&s.__esModule?s:{default:s};const o=n.version=92.1}}},{package:"$root$",file:"app/scripts/migrations/092.1.ts"}],[28,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSnapControllerInitMessenger=function(e){return e.getRestricted({name:"SnapControllerInit",allowedEvents:[],allowedActions:["KeyringController:getKeyringsByType","PreferencesController:getState"]})},n.getSnapControllerMessenger=function(e){return e.getRestricted({name:"SnapController",allowedEvents:["ExecutionService:unhandledError","ExecutionService:outboundRequest","ExecutionService:outboundResponse","KeyringController:lock"],allowedActions:["PermissionController:getEndowments","PermissionController:getPermissions","PermissionController:hasPermission","PermissionController:hasPermissions","PermissionController:requestPermissions","PermissionController:revokeAllPermissions","PermissionController:revokePermissions","PermissionController:revokePermissionForAllSubjects","PermissionController:getSubjectNames","PermissionController:updateCaveat","ApprovalController:addRequest","ApprovalController:updateRequestState","PermissionController:grantPermissions","SubjectMetadataController:getSubjectMetadata","SubjectMetadataController:addSubjectMetadata","ExecutionService:executeSnap","ExecutionService:terminateSnap","ExecutionService:terminateAllSnaps","ExecutionService:handleRpcRequest","SnapsRegistry:get","SnapsRegistry:getMetadata","SnapsRegistry:update","SnapsRegistry:resolveVersion","SnapInterfaceController:createInterface","SnapInterfaceController:getInterface"]})}}}},{package:"$root$",file:"app/scripts/controller-init/messengers/snaps/snap-controller-messenger.ts"}],[280,{"@metamask/utils":2874,"@sentry/browser":3008,lodash:4779},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=a,t.data=function(e){return function(e){const t=["networkId","networkStatus","providerConfig","networkDetails","networkConfigurations"];if(!(0,s.hasProperty)(e,"NetworkController")||!(0,i.isObject)(e.NetworkController))return(0,r.captureException)(`Migration ${a}: Invalid NetworkController state: ${typeof e.NetworkController}`),e;const n=e.NetworkController,o=(0,i.pick)(n,t);return{...e,NetworkController:o}}(e)}(t.data),t},n.version=void 0;var s=e("@metamask/utils"),r=e("@sentry/browser"),i=e("lodash");const a=n.version=92.2}}},{package:"$root$",file:"app/scripts/migrations/092.2.ts"}]],[],{});